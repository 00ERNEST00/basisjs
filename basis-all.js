/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(t){function y(b,e){for(var c in e)b[c]=e[c];return b}function x(b,e){for(var c in e)if(c in b==false)b[c]=e[c];return b}function z(b){return b==null||b==undefined}function A(b){return b}function D(b){var e={};b.names=function(c){return Object.slice(e,typeof c=="string"?c.qw():c)};b.extend=function(c){x(e,c);y(this,c);return this};return b}function J(b,e){for(var c=b.split("."),g=t,k,f,j;c.length;){k=c.shift();f=(f?f+".":"")+k;if(!g[k]){g[k]=D((!c.length?e:null)||function(){},f);if(j)j.namespaces_[f]=
g[k]}g=g[k];if(!j){j=g;if(!j.namespaces_)j.namespaces_={}}}return r[b]=g}y(Object,{extend:y,complete:x,keys:function(b){var e=[];for(var c in b)e.push(c);return e},values:function(b){var e=[];for(var c in b)e.push(b[c]);return e},slice:function(b,e){var c={};if(!e)return y(c,b);for(var g=0,k;k=e[g++];)if(k in b)c[k]=b[k];return c},splice:function(b,e){var c={};if(!e)return y(c,b);for(var g=0,k;k=e[g++];)if(k in b){c[k]=b[k];delete b[k]}return c},iterate:function(b,e,c){var g=[];for(var k in b)g.push(e.call(c,
k,b[k]));return g},coalesce:function(){for(var b=arguments,e=0;e<b.length;e++)if(b[e]!=null)return b[e]}});var H=function(){},B=function(){var b=1,e={},c={},g=function(k){return k.modificator};g.getter=g;g.getterIdx_=b++;return function(k,f){var j,q;if(!f){if(k.getter)return k.getter;if(typeof k=="function")return k}if(typeof k!="function")if(c[k])j=c[k];else{j=new Function("object","return object != null ? object."+k+" : object");j.path=k;j.getterIdx_=b++;c[k]=j}else{j=k;if(!j.getterIdx_)j.getterIdx_=
b++}q=j.getterIdx_;var a=e[q];if(a)if(typeof f=="undefined"){if(a.nmg)return a.nmg}else for(q=0;q<a.length;q++){if(a[q].modificator===f)return a[q].getter}else a=e[q]=[];var i=true;switch(f&&typeof f){case "string":q=function(m){return f.format(j(m))};break;case "function":q=function(m){return f(j(m))};break;case "object":i=false;q=function(m){return f[j(m)]};break;default:q=j.path?j:function(m){return j(m)}}if(i){a.push({getter:q,modificator:f});if(typeof f=="undefined")a.nmg=q}return q.getter=q}}();
y(Function,{$undefined:function(b){return b==undefined},$defined:function(b){return b!=undefined},$isNull:z,$isNotNull:function(b){return b!=null&&b!=undefined},$isSame:function(b){return b===this},$isNotSame:function(b){return b!==this},$self:A,$const:function(b){return function(){return b}},$false:function(){return false},$true:function(){return true},$null:function(){return null},$undef:H,getter:B,def:function(b,e,c){c=c||z;return function(g){g=b(g);return c(g)?e:g}},wrapper:function(b){return function(e){var c=
{};c[b]=e;return c}},lazyInit:function(b,e){var c=0,g,k;return g=function(){if(!c++){g.inited=true;g.data=k=b.apply(e||this,arguments)}return k}},lazyInitAndRun:function(b,e,c){var g=0,k,f;return k=function(){if(!g++){k.inited=true;k.data=f=b.call(c||this)}e.apply(f,arguments);return f}},runOnce:function(b,e){var c=0;return function(){if(!c++)return b.apply(e||this,arguments)}}});x(Function.prototype,{bind:function(b){var e=this,c=Array.from(arguments,1);return c.length?function(){return e.apply(b,
c.concat.apply(c,arguments))}:function(){return e.apply(b,arguments)}}});x(Array,{isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"}});y(Array,{from:function(b,e){if(b!=null){var c=b.length;if(typeof c=="undefined")return[b];e||(e=0);if(c-e>0){for(var g=[],k=0,f=e;f<c;)g[k++]=b[f++];return g}}return[]},create:function(b,e,c){for(var g=[],k=0;k<b;k++)g[k]=typeof e=="function"?e.call(c,k,g):e;return g}});x(Array.prototype,{indexOf:function(b,e){e=parseInt(e)||0;if(e<0)return-1;
for(;e<this.length;e++)if(this[e]===b)return e;return-1},lastIndexOf:function(b,e){var c=this.length;e=parseInt(e);for(e=isNaN(e)||e>=c?c-1:(e+c)%c;e>=0;e--)if(this[e]===b)return e;return-1},forEach:function(b,e){for(var c=0,g=this.length;c<g;c++)c in this&&b.call(e,this[c],c,this)},every:function(b,e){for(var c=0,g=this.length;c<g;c++)if(c in this&&!b.call(e,this[c],c,this))return false;return true},some:function(b,e){for(var c=0,g=this.length;c<g;c++)if(c in this&&b.call(e,this[c],c,this))return true;
return false},filter:function(b,e){for(var c=[],g=0,k=this.length;g<k;g++)g in this&&b.call(e,this[g],g,this)&&c.push(this[g]);return c},map:function(b,e){for(var c=[],g=0,k=this.length;g<k;g++)if(g in this)c[g]=b.call(e,this[g],g,this);return c},reduce:function(b,e){var c=this.length,g=arguments.length;if(c==0&&g==1)throw new TypeError;var k,f=0;if(g>1){k=e;f=1}for(g=0;g<c;g++)if(g in this)k=f++?b.call(null,k,this[g],g,this):this[g];return k}});y(Array.prototype,{flatten:function(){return this.concat.apply([],
this)},repeat:function(b){return Array.create(parseInt(b)||0,this).flatten()},item:function(b){b=parseInt(b||0);return this[b>=0?b:this.length+b]},search:function(b,e,c){Array.lastSearchIndex=-1;e=Function.getter(e||A);c=parseInt(c)||0;for(var g=this.length;c<g;c++)if(e(this[c])===b)return this[Array.lastSearchIndex=c]},lastSearch:function(b,e,c){Array.lastSearchIndex=-1;e=Function.getter(e||A);var g=this.length;c=isNaN(c)||c==null?g:parseInt(c);for(g=c>g?g:c;g-- >0;)if(e(this[g])===b)return this[Array.lastSearchIndex=
g]},binarySearchPos:function(b,e,c,g,k,f){if(!this.length)return g?-1:0;e=Function.getter(e||A);c=!!c;var j;k=isNaN(k)?0:k;var q=isNaN(f)?this.length-1:f;do{f=k+q>>1;j=e(this[f]);if(c?b>j:b<j)q=f-1;else if(c?b<j:b>j)k=f+1;else return b==j?f:g?-1:0}while(k<=q);return g?-1:f+(j<b^c)},binarySearch:function(b,e){return this.binarySearchPos(b,e,false,true)},add:function(b){return this.indexOf(b)==-1&&!!this.push(b)},remove:function(b){b=this.indexOf(b);return b!=-1&&!!this.splice(b,1)},has:function(b){return this.indexOf(b)!=
-1},merge:function(b){return this.reduce(y,b||{})},sortAsObject:function(b,e,c){b=Function.getter(b);c=c?-1:1;return this.map(function(g,k){return{i:k,v:b(g)}}).sort(e||function(g,k){return c*(g.v>k.v||-(g.v<k.v)||(g.i>k.i?1:-1))}).map(function(g){return this[g.i]},this)},set:function(b){if(this!==b){this.length=0;this.push.apply(this,b)}return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var C=Array.prototype.splice;Array.prototype.splice=function(){var b=Array.from(arguments);
if(b.length<2)b[1]=this.length;return C.apply(this,b)}}var F={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};x(String,{toLowerCase:function(b){return String(b).toLowerCase()},toUpperCase:function(b){return String(b).toUpperCase()},trim:function(b){return String(b).trim()},trimLeft:function(b){return String(b).trimLeft()},
trimRight:function(b){return String(b).trimRight()},isEmpty:function(b){return b==null||String(b)==""},isNotEmpty:function(b){return b!=null&&String(b)!=""}});x(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});y(String.prototype,{toObject:function(b){try{return Function("return 0,"+this)()}catch(e){if(b)throw e;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:
function(){for(var b=[],e=this.length,c=0;c<e;c++)b[c]=this.charAt(c);return b},repeat:function(b){return(new Array(parseInt(b)+1||0)).join(this)},qw:function(){var b=this.trim();return b?b.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,"\\$&")},format:function(b){for(var e={},c=0;c<arguments.length;c++)e[c]=arguments[c];typeof b=="object"&&y(e,b);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(g,k,f,j,q){g=k in e?e[k]:q?"":
g;if(f&&!isNaN(g)){g=Number(g);return f=="."?g.toFixed(j):g.lead(j)}return g})},quote:function(b,e){b=b||'"';e=e||F[b]||b;var c=(b.length==1?b:"")+(e.length==1?e:"");return b+(c?this.replace(new RegExp("["+c.forRegExp()+"]","g"),"\\$&"):this)+e},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(b,e){return e.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(b){return"-"+b.toLowerCase()})}});
String.format=String.prototype.format;if("|||".split(/\|/).length+"|||".split(/(\|)/).length!=11)String.prototype.split=function(b){if(b==""||b&&b.source=="")return this.toArray();var e=[],c=0,g;if(b instanceof RegExp)for(b.global||(b=new RegExp(b.source,/\/([mi]*)$/.exec(b)[1]+"g"));g=b.exec(this);){g[0]=this.substring(c,g.index);e.push.apply(e,g);c=b.lastIndex}else for(;(g=this.indexOf(b,c))!=-1;){e.push(this.substring(c,g));c=g+b.length}e.push(this.substr(c));return e};if("12".substr(-1)!="2"){var G=
String.prototype.substr;String.prototype.substr=function(b,e){return G.call(this,b<0?Math.max(0,this.length+b):b,e)}}y(Number.prototype,{fit:function(b,e){if(!isNaN(b)&&this<b)return Number(b);if(!isNaN(e)&&this>e)return Number(e);return this},between:function(b,e){return!isNaN(this)&&this>=b&&this<=e},quote:function(b,e){return(this+"").quote(b,e)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(b){return!b||isNaN(b)?0:
Math.floor(this/b)*b},lead:function(b,e){return(this+"").replace(/\d+/,function(c){return(b-=c.length-1)>1?Array(b).join(e||0)+c:c})},group:function(b,e){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(g,k){return!k+(c.length-k)%(b||3)?g:(e||" ")+g})})},format:function(b,e,c,g,k){b=this.toFixed(b);if(e||k)b=b.replace(/(\d+)(\.?)/,function(f,j,q){return(e?Number(j).group(3,e):j)+(q?k||q:"")});if(c)b=b.replace(/^-?/,"$&"+(c||""));return b+(g||"")}});x(Date,{now:function(){return+new Date}});
(new Date).getYear()<1900&&y(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(b){return this.setFullYear(!isNaN(b)&&b<100?Number(b)+1900:b)}});var r={},v=function(){function b(f,j){for(var q=r[f],a=j?j.split(/\./):[];q&&a.length;)q=q[a.shift()];return q}var e=t.document?t.document.getElementsByTagName("SCRIPT"):null,c=(e?e[e.length-1].src:module.filename).replace(/[^\/]+$/,""),g={},k;if(typeof require=="function")k=function(f){return require(requirePath+f.replace(/\./g,
"/"))};else{k=function(f,j){var q=f.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],a=f.substr(q.length?q.length+1:0),i=b(q,a),m=/^basis\./.test(q)?c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!r[q]||!i)if(/^https?:/.test(m))if(g[f])throw"Attempt to load namespace, probably cycle require";else{g[f]=1;m=m+(j||"")+f.replace(/\./g,"/")+".js";var u=new XMLHttpRequest;u.open("POST",m,false);u.send(null);if(u.status==200){try{(new Function(u.responseText)).call(t)}catch(h){throw h;
}k.sequence.push(f.replace(/\./g,"/")+".js")}else if(u.status==404&&a)v(q);else throw"!";}else throw"Path `"+f+"` can't be resolved";return i||b(q,a)};k.sequence=[]}return k}(),s=function(){function b(f){return typeof f=="function"&&f.basisClass_}var e=Function(),c={id:1};y(e,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var f in this)this[f]=null;this.destroy=
H}},create:function(f){if(typeof f!="function")f=e;var j=Function();j.prototype=f.prototype;j={className:f.className+"._SubClass_",basisClass_:true,superClass_:f,extendConstructor_:!!f.extendConstructor_,__extend__:function(u){return u&&(typeof u=="object"||typeof u=="function"&&!b(u))?e.create.call(null,m,u):u},extend:e.extend,subclass:function(){return e.create.apply(null,[m].concat(Array.from(arguments)))},prototype:new j};for(var q=arguments,a=1;a<q.length;a++)j.extend(typeof q[a]=="function"&&
!b(q[a])?q[a](f.prototype):q[a]);var i={},m=j.extendConstructor_?function(u,h){this.eventObjectId=c.id++;var d;for(var n in u){d=this[n];this[n]=d&&d.__extend__?d.__extend__(u[n]):u[n]}this.init(h||i)}:function(){this.eventObjectId=c.id++;this.init.apply(this,arguments)};j.prototype.constructor=m;y(m,j);return m},extend:function(f){var j=this.prototype;if(f.prototype)f=f.prototype;var q=Object.keys(f);f.toString!==Object.prototype.toString&&q.add("toString");for(var a=q.length;a-- >0;){var i=q[a],
m=f[i],u=j[i];if(i=="className"||i=="extendConstructor_")this[i]=m;else j[i]=u&&u.__extend__?u.__extend__(m):m}return this}});var g=function(f,j){return{__extend__:function(q){var a=Function();a.prototype=this;a=new a;j(a,q);return a}}.__extend__(f)},k=function(f){return g(f,y)};return J("basis.Class",e.create).extend({BaseClass:e,create:e.create,isClass:b,CustomExtendProperty:g,ExtensibleProperty:k,NestedExtProperty:function(f){return g(f,function(j,q){for(var a in q){var i=j[a];j[a]=i&&i.__extend__?
i.__extend__(q[a]):k(q[a])}})}})}(),l=function(){function b(f){var j=c[f];j||(j=c[f]=function(){var q=this.handlers_,a,i;if(q&&q.length){q=e.call(q);for(var m=q.length;m-- >0;){a=q[m];i=a.handler[f];typeof i=="function"&&i.apply(a.thisObject,arguments)}}});return j}var e=Array.prototype.slice,c={},g,k=s(null,{handlers_:null,event_destroy:g=b("destroy","object"),listen:s.NestedExtProperty(),extendConstructor_:true,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,
thisObject:this.handlerContext||this})},addHandler:function(f,j){var q=this.handlers_;if(!q)q=this.handlers_=[];j||(j=this);for(var a=q.length,i;a-- >0;){i=q[a];if(i.handler===f&&i.thisObject===j)return false}return!!q.push({handler:f,thisObject:j||this})},removeHandler:function(f,j){var q=this.handlers_;if(q){j||(j=this);for(var a=q.length,i;a-- >0;){i=q[a];if(i.handler===f&&i.thisObject===j)return!!q.splice(a,1)}return false}},destroy:function(){if(this.handlers_){g.call(this,this);this.handlers_=
null}}});k.createEvent=b;k.event=c;return k}(),p=function(){var b=[];return{add:function(e){e!=null&&b.push(e)},remove:function(e){b.remove(e)}}}();(function(){function b(a){if(e){if(a.source!=t||a.data!=c)return;basis.dom.event.kill(a)}if(g.length){a=g.shift();delete k[a.key];a.fn()}}var e=typeof addEventListener=="function"&&typeof postMessage=="function",c="zeroTimeoutMessage",g=[],k={},f=1;e&&t.addEventListener("message",b,true);var j=setTimeout;t.setTimeout=function(a,i){var m;if(i)m=j.call(t,
a,i);else{m={key:"z"+f++,fn:typeof a=="function"?a:new Function(a)};k[m.key]=m;g.push(m);if(e)postMessage(c,"*");else m.timer=j.call(t,b,0);m=m.key}return m};var q=clearTimeout;t.clearTimeout=function(a){if(/z\d+/.test(a)){var i=k[a];if(i){clearTimeout(i.timer);g.remove(i);delete k[a]}}else return q.call(t,a)}})();var o=function(){function b(){if(!i)if(f.length){var m=Date.now(),u=Math.max(f[0].eventTime,m);if(u<q){clearTimeout(a);a=setTimeout(c,(q=u)-m)}}else{a=clearTimeout(a);q=g}}function e(m,
u){var h=m.eventObjectId,d=j[u]&&j[u][h];if(d){f.remove(d);delete j[u][h];b()}}function c(){var m=Date.now();m=f.binarySearchPos(m+15,k);i=true;f.splice(0,m).forEach(function(u){delete j[u.eventName][u.object.eventObjectId];u.callback.call(u.object)});i=false;q=g;b()}var g=2E12,k=B("eventTime"),f=[],j={},q=g,a=null,i=false;p.add({destroy:function(){i=true;clearTimeout(a);f.length=0;j=null}});return{add:function(m,u,h){var d=m.eventObjectId,n=j[u];n||(n=j[u]={});var w=n[d];if(w){if(isNaN(h))return e(m,
u);if(w.eventTime==h)return;f.remove(w);w.eventTime=h}else{if(isNaN(h))return;w=n[d]={eventName:u,object:m,eventTime:h,callback:m[u]}}f.splice(f.binarySearchPos(h,k),0,w);b()},remove:e}}();J("basis").extend({namespace:J,platformFeature:{},EventObject:l,TimeEventManager:o,Cleaner:p,require:v});t.basis.locale={}})(this);
(function(t,y){function x(p){var o=1E6;p=String(p).split(".");for(var b=0,e=0;b<4&&b<p.length;b++,o/=100)e+=p[b]*o;return e}function z(){for(var p=0;p<arguments.length;p++){var o=arguments[p].toLowerCase();if(o in D){if(D[o])return true}else{var b=o.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(b){D[o]=false;var e=b[1].toLowerCase(),c=x(b[3]);b=b[4]||"=";if(e=J[e])return D[o]=!c||b=="="&&e==c||b=="+"&&e>=c||b=="-"&&e<c}}}return false}var A="basis.ua",D={},J={},H=y.navigator&&y.navigator.userAgent,B=
"unknown",C="unknown",F={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]};for(var G in F)if(!(G=="MSIE"&&y.opera))if(!(G=="Safari"&&H.match(/chrome/i)))if(!(G=="AppleWebKit"&&H.match(/iphone/i)))if(H.match(new RegExp(G+
".(\\d+(\\.\\d+)*)","i"))){var r=F[G],v=y.opera&&typeof y.opera.version=="function"?y.opera.version():RegExp.$1,s=x(v);B=r[0]+s;C=r[0]+" "+v;for(B=0;B<r.length;B++)J[r[B].toLowerCase()]=s}t.platformFeature.datauri=false;H=typeof Image!="undefined"?new Image:{};H.onload=function(){t.platformFeature.datauri=true};H.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";F={set:function(p,o,b,e){document.cookie=p+"="+(o==null?"":escape(o))+";path="+(e||(location.pathname.indexOf("/")==
0?"":"/")+location.pathname)+(b?";expires="+(new Date(Date.now()+b*1E3)).toGMTString():"")},get:function(p){return(p=document.cookie.match(new RegExp("(^|;)\\s*"+p+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(p[2])},remove:function(p,o){document.cookie=p+"=;expires="+(new Date(0)).toGMTString()+";path="+(o||(location.pathname.indexOf("/")==0?"":"/")+location.pathname)}};if(z("IE7-"))try{document.execCommand("BackgroundImageCache",false,true)}catch(l){}A=t.namespace(A);A.toString=function(){return C};return A.extend({testImage:H,
prettyName:C,test:z,is:function(p){return z(p)},Cookies:F})})(basis,this);
(function(t,y){function x(a,i,m){if(i!=null)return a.insertBefore(c(i)?i:J(i),m||null)}function z(a){return B("",a.cloneNode(true)).innerHTML}function A(a){return c(a)||a&&a.nodeType?a:typeof a=="string"?r.getElementById(a):null}function D(a,i,m){var u,h=[];m=typeof m=="string"?getter(m):m||Function.$true;i&26&&m(a)&&h.push(a);switch(i){case 1:case 2:for(u=a;(u=u[l])&&u!==a.document;)m(u)&&h.push(u);break;case 64:for(u=a[p];u;){m(u)&&h.push(u);u=u[o]}break;case 4:case 8:if(a[p]){i=new g(a);i.nodes(m,
h)}break;case 128:i=new g(a,m);for(i.cursor_=a[o]||a[l];u=i.next();)h.push(u);break;case 256:for(u=a;u=u[o];)m(u)&&h.push(u);break;case 32:m(a[l])&&h.push(a[l]);break;case 512:i=new g(a,m,g.BACKWARD);for(i.cursor_=a[b]||a[l];u=i.next();)h.push(u);break;case 1024:for(u=a;u=u[b];)m(u)&&h.push(u);break}return h}function J(a){return r.createTextNode(a!=null?a:"")}function H(){for(var a=r.createDocumentFragment(),i=arguments.length,m=H.array=[],u=0;u<i;u++)m.push(x(a,arguments[u]));return a}function B(a){var i=
a!=undefined&&typeof a!="string",m=(i?a.description:a)||"",u="div",h=m.match(/^([a-z0-9\_\-]+)(.*)$/i);if(h){u=h[1];m=h[2]}if(m!=""){for(var d=[],n={},w;h=q.exec(m);){if(h[8])throw new Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+m+"\n\nProblem place:\n> "+m.substr(0,h.index)+"--\>"+m.substr(h.index)+"<--");w=h[1]||h[2]||h[3];if(h[1])n.id=w;else if(h[2])d.push(w);else if(w!="class")n[w]=h[4]?G(h[5],h[6],h[7]):w}if(f&&n.name&&/^(input|textarea|select)$/i.test(u))u=
"<"+u+" name="+n.name+">"}m=r.createElement(u);if(n){if(n.style&&j)m.style.cssText=n.style;for(var E in n)m.setAttribute(E,n[E],0)}if(d&&d.length)m.className=d.join(" ");arguments.length>1&&x(m,H.apply(0,Array.from(arguments,1).flatten()));if(i){a.css&&t.cssom&&t.cssom.setStyle(m,a.css);if(t.dom.event)for(var K in a)if(typeof a[K]=="function")t.dom.event.addHandler(m,K,a[K],m);else a[K]instanceof t.dom.event.Handler&&t.dom.event.addHandler(m,K,a[K].handler,a[K].thisObject)}return m}function C(a,i){return a[l]?
a[l].replaceChild(i,a):a}function F(a){if(r.selection){var i=r.selection.createRange();i.compareEndPoints("StartToEnd",i)!=0&&i.collapse(a);return i.getBookmark().charCodeAt(2)-2}}var G=Object.coalesce,r=y.document,v=t.Class,s=r.createElement("div"),l="parentNode",p="firstChild",o="nextSibling",b="previousSibling",e;e=typeof s.compareDocumentPosition=="function"?function(a,i){return a.compareDocumentPosition(i)}:function(a,i){if(a==i)return 0;if(a.document!=i.document)return 33;return a.sourceIndex>
i.sourceIndex?2|8*i.contains(childA):4|16*a.contains(childB)};var c;if(typeof Node!="undefined"){c=function(a){return a instanceof Node};if(!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else c=function(a){return a&&a.ownerDocument===r};var g=v(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,i,m){this.setRoot(a);this.setDirection(m);if(typeof i=="function")this.filter=i},setDirection:function(a){Object.extend(this,a?{a:"lastChild",
b:b,c:o,d:p}:{a:p,b:o,c:b,d:"lastChild"})},setRoot:function(a){this.root_=a||r;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,i){var m;i||(i=[]);for(this.reset();m=this.next(a);)i.push(m);return i},next:function(a){a=a||this.filter;var i=this.cursor_||this.root_;do for(var m=i[this.a];!m;){if(i===this.root_)return this.cursor_=null;(m=i[this.b])||(i=i[l])}while(!a(i=m));return this.cursor_=
i},prev:function(a){a=a||this.filter;var i=this.cursor_,m=this.c,u=this.d;do{var h=i?i[m]:this.root_[u];if(h){for(;h[u];)h=h[u];i=h}else if(i)i=i[l];if(!i||i===this.root_){i=null;break}}while(!a(i));return this.cursor_=i},destroy:function(){this.cursor_=this.root_=null}});g.BACKWARD=true;var k="textContent innerText nodeValue".qw(),f=function(){var a=r.createElement("input");a.name="a";return!/name/.test(z(a))}(),j;s.setAttribute("style","color: red");j=s.style.color!=="red";var q=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return t.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:g,outerHTML:z,textContent:function(a){for(var i=0,m;m=k[i++];)if(a[m]!=null)return a[m];return D(a,4,function(u){return u.nodeType==3}).map(getter("nodeValue")).join("")},get:A,tag:function(a,i){a=A(a)||r;return i=="*"&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(i||"*"))},axis:D,findAncestor:function(a,i,m){for(;a&&a!==m;){if(i(a))return a;a=a.parentNode}},createElement:B,createText:J,createFragment:H,insert:function(a,
i,m,u){a=A(a);if(!a)throw new Error("basis.dom.insert: destination node can't be null");switch(m){case undefined:case "end":u=null;break;case "begin":u=a[p];break;case "before":break;case "after":u=u[o];break;default:u=Number(m).between(0,a.childNodes.length)?a.childNodes[m]:null}m=!c(a);if(!i||!Array.isArray(i))m=m?i&&a.insertBefore(i,u):x(a,i,u);else if(m){m=[];for(var h=0,d=i.length;h<d;h++)m[h]=a.insertBefore(i[h],u)}else{a.insertBefore(H.apply(0,i),u);m=H.array}return m},remove:function(a){return a[l]?
a[l].removeChild(a):a},replace:C,swap:function(a,i){if(a===i||e(a,i)&25)return false;C(a,s);C(i,a);C(s,i);return true},clone:function(a,i){var m=a.cloneNode(!i);m.attachEvent&&D(m,8).forEach(Event.clearHandlers);return m},clear:function(a){for(a=A(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,i,m){var u=[];m=Function.getter(m||Function.$self);for(var h in i)for(var d=0;d<a.length;d++){var n=m(a[d]);u[d]=i[h](a[d],d,n)?B(h,n):a[d]}return u},setAttribute:function(a,i,m){m==null?
a.removeAttribute(i):a.setAttribute(i,m)},parentOf:function(a,i){return a.contains(i)},isInside:function(a,i){return a==i||i.contains(a)},focus:function(a,i){try{a=A(a);a.focus();i&&a.select&&a.select()}catch(m){}},setSelectionRange:function(a,i,m){if(arguments.length<3)m=i;if(a.setSelectionRange)a.setSelectionRange(i,m);else if(a.createTextRange){var u=a.createTextRange();u.collapse(true);u.moveStart("character",i);u.moveEnd("character",m-i);u.select()}},getSelectionStart:function(a){return typeof a.selectionStart!=
"undefined"?a.selectionStart:F(true)},getSelectionEnd:function(a){return typeof a.selectionEnd!="undefined"?a.selectionEnd:F(false)}})})(basis,this);
(function(t,y){function x(b){return b||y.event}function z(b){return typeof b=="string"?G.get(b):b}function A(b){b=x(b);if(b.stopPropagation)b.stopPropagation();else b.cancelBubble=true}function D(b){b=x(b);if(b.preventDefault)b.preventDefault();else b.returnValue=false}function J(b){var e=Array.from(l[b.type]);if(e)for(var c=e.length;c-- >0;){var g=e[c];g.handler.call(g.thisObject,b)}}function H(b,e,c,g){b=z(b);if(!b)throw new Error("Event.addHandler: can't attach event listener to undefined");if(typeof c!=
"function")throw new Error("Event.addHandler: handler must be a function");b[v]||(b[v]={});var k={handler:c,thisObject:g},f=b[v],j=f[e];if(j){for(b=0;e=j[b];b++)if(e.handler===c&&e.thisObject===g)return;j.push(k)}else{j=f[e]=[k];j.fireEvent=function(q){q=x(q);if(p&&q)if(typeof q.returnValue=="undefined"){J(q);if(q.cancelBubble===true)return;if(typeof q.returnValue=="undefined")q.returnValue=true}for(var a=0,i;i=j[a++];)i.handler.call(i.thisObject,q)};b.addEventListener?b.addEventListener(e,j.fireEvent,
false):b.attachEvent("on"+e,j.fireEvent)}}function B(b,e,c,g){b=z(b);var k=b[v];if(k)if(k=k[e])for(var f=0,j;j=k[f];f++)if(j.handler===c&&j.thisObject===g){k.splice(f,1);k.length||C(b,e);return}}function C(b,e){b=z(b);var c=b[v];if(c)if(typeof e!="string")for(e in c)C(b,e);else{var g=c[e];if(g){b.removeEventListener?b.removeEventListener(e,g.fireEvent,false):b.detachEvent("on"+e,g.fireEvent);delete c[e]}}}var F=y.document,G=t.dom,r=Function.$null,v="__basisEvents",s={mousewheel:["mousewheel","DOMMouseScroll"]},
l={},p=!F.addEventListener,o=function(){function b(){e++||setTimeout(function(){for(var k=0;k<c.length;k++)c[k].callback.call(c[k].thisObject)},10)}var e=false,c=[];if(t.ua.is("ie7-"))(function(){var k="_"+Date.now();F.write('<script id="'+k+'" defer src="//:"><\/script>');z(k).onreadystatechange=function(){if(this.readyState=="complete"){G.remove(this);b()}}})();else if(t.ua.is("safari525-"))var g=setInterval(function(){if(/loaded|complete/.test(F.readyState)){clearInterval(g);b()}},15);else H(F,
"DOMContentLoaded",b,false);H(F,"load",b,false);H(y,"load",b,false);return function(k,f){e||c.push({callback:k,thisObject:f})}}();return t.namespace("basis.dom.event",x).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(b){return s[b]||[b]},Handler:function(b,
e){this.handler=b;this.thisObject=e},sender:function(b){b=x(b);return b.target||b.srcElement},cancelBubble:A,cancelDefault:D,kill:function(b,e){if(e=z(e))H(e,b,Event.kill);else{D(b);A(b)}},key:function(b){b=x(b);return b.keyCode||b.which||0},charCode:function(b){b=x(b);return b.charCode||b.keyCode||0},mouseButton:function(b,e){b=x(b);return typeof b.which=="number"?b.which==e.VALUE:b.button&e.BIT},mouseX:function(b){b=x(b);return b.changedTouches?b.changedTouches[0].pageX:"pageX"in b?b.pageX:b.clientX+
(F.documentElement.scrollLeft||F.body.scrollLeft)},mouseY:function(b){b=x(b);return b.changedTouches?b.changedTouches[0].pageY:"pageY"in b?b.pageY:b.clientY+(F.documentElement.scrollTop||F.body.scrollTop)},wheelDelta:function(b){b=x(b);return"wheelDelta"in b?b.wheelDelta/120:b.type=="DOMMouseScroll"?-b.detail/3:0},addGlobalHandler:function(b,e,c){var g=l[b];if(g)for(b=g.length;b-- >0;){var k=g[b];if(k.handler===e&&k.thisObject===c)return}else{F.addEventListener?F.addEventListener(b,J,true):H(F,b,
r);g=l[b]=[]}g.push({handler:e,thisObject:c})},removeGlobalHandler:function(b,e,c){var g=l[b];if(g)for(var k=0,f;f=g[k];k++)if(f.handler===e&&f.thisObject===c){g.splice(k,1);if(!g.length){delete l[b];F.removeEventListener?F.removeEventListener(b,J,true):B(F,b,r)}return}},addHandler:H,addHandlers:function(b,e,c){b=z(b);for(var g in e)H(b,g,e[g],c)},removeHandler:B,clearHandlers:C,fireEvent:function(b,e){b=z(b);var c=b[v];c&&c[e]&&c[e].fireEvent()},onLoad:o,onUnload:function(b,e){H(y,"unload",b,e)}})})(basis,
this);
(function(){function t(a,i,m){for(var u=1,h;i;){if(i&1){h=v[u];if(m&u){a.addHandler(h.handler,h.context);h.action(h.context.add,a)}else{a.removeHandler(h.handler,h.context);h.action(h.context.remove,a)}}i>>=1;u<<=1}}function y(a,i){var m={},u;if(a&&a.length)u=m.inserted=a;if(i&&i.length)u=m.deleted=i;if(u)return m}function x(a){return Array.isArray(a)?a.map(x):{data:a}}var z=basis.Class,A=basis.EventObject,D=Object.values,J=Function.$self,H=Function.$true,B=Function.$false,C=A.createEvent,F=A.event,
G={},r=[],v={},s=1,l={NONE:0,MASK:0,regType:function(a,i,m){v[s]={handler:i,action:m,context:{add:function(u,h){if(h){var d=l[a]+"_"+u.eventObjectId;if(!h.subscribers_)h.subscribers_={};if(!h.subscribers_[d]){var n=h.subscriberCount;h.subscribers_[d]=u;h.subscriberCount+=1;h.event_subscribersChanged(h,n)}}},remove:function(u,h){if(h){var d=l[a]+"_"+u.eventObjectId;if(h.subscribers_[d]){var n=h.subscriberCount;delete h.subscribers_[d];h.subscriberCount-=1;h.event_subscribersChanged(h,n)}}}}};l[a]=
s;l.MASK|=s;s<<=1}};l.regType("DELEGATE",{delegateChanged:function(a,i){this.remove(a,i);this.add(a,a.delegate)}},function(a,i){a(i,i.delegate)});l.regType("TARGET",{targetChanged:function(a,i){this.remove(a,i);this.add(a,a.target)}},function(a,i){a(i,i.target)});l.regType("SOURCE",{sourceChanged:function(a,i){this.remove(a,i);this.add(a,a.source)},sourcesChanged:function(a,i){var m;if(m=i.inserted)for(var u=m.length;u-- >0;)this.add(a,m[u]);if(m=i.deleted)for(u=m.length;u-- >0;)this.remove(a,m[u])}},
function(a,i){for(var m=i.sources||[i.source],u=0,h;h=m[u++];)a(i,h)});var p=z(A,{state:"ready",data:null,canHaveDelegate:true,delegate:null,root:null,cascadeDestroy:false,isTarget:false,target:null,active:false,subscribeTo:l.DELEGATE+l.TARGET,subscriberCount:0,subscribers_:null,event_update:C("update","object","delta"),event_stateChanged:C("stateChanged","object","oldState"),event_delegateChanged:C("delegateChanged","object","oldDelegate"),event_rootChanged:C("rootChanged","object","oldRoot"),event_targetChanged:C("targetChanged",
"object","oldTarget")&&function(a,i){var m=this.listen.target;if(m){i&&i.removeHandler(m,this);this.target&&this.target.addHandler(m,this)}F.targetChanged.call(this,a,i)},event_subscribersChanged:C("subscribersChanged","object"),event_activeChanged:C("activeChanged","object"),listen:{delegate:{update:function(a,i){this.data=a.data;this.event_update(this,i)},stateChanged:function(a,i){this.state=a.state;this.event_stateChanged(this,i)},targetChanged:function(a,i){this.target=a.target;this.event_targetChanged(this,
i)},rootChanged:function(a,i){this.data=a.data;this.event_rootChanged(this,i)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(a){A.prototype.init.call(this,a);if(a=this.delegate){this.delegate=null;this.data=a.data;this.state=a.state;this.setDelegate(a)}else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&t(this,this.subscribeTo,l.MASK)},isConnected:function(a){if(a instanceof p){for(;a&&a!==this&&a!==a.delegate;)a=
a.delegate;return a===this}return false},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},setDelegate:function(a){if(this.canHaveDelegate&&a&&a instanceof p){if(a.delegate&&this.isConnected(a))return false}else a=null;if(this.delegate!==a){var i=this.state,m=this.data,u=this.delegate,h=this.target,d=this.root,n={};u&&u.removeHandler(this.listen.delegate,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;this.state=a.state;this.target=a.target;
a.addHandler(this.listen.delegate,this);for(var w in a.data)if(w in m===false)n[w]=undefined;for(w in m)if(m[w]!==a.data[w])n[w]=m[w]}else{this.target=this.delegate=null;this.root=this;this.data={};for(w in m)this.data[w]=m[w]}this.event_delegateChanged(this,u);this.root!==d&&this.event_rootChanged(this,d);this.target!==h&&this.event_targetChanged(this,h);if(a){for(w in n){this.event_update(this,n);break}if(i!==this.state&&(String(i)!=this.state||i.data!==this.state.data))this.event_stateChanged(this,
i)}return true}return false},setState:function(a,i){var m=this.target||this.getRootDelegate();if(m!==this)return m.setState(a,i);if(this.state!=String(a)||this.state.data!=i){m=this.state;this.state=Object(String(a));this.state.data=i;this.event_stateChanged(this,m);return true}return false},deprecate:function(){this.state!="processing"&&this.setState("deprecated")},update:function(a){var i=this.target||this.getRootDelegate();if(i!==this)return i.update(a);if(a){i={};var m=0;for(var u in a)if(this.data[u]!==
a[u]){m++;i[u]=this.data[u];this.data[u]=a[u]}if(m){this.event_update(this,i);return i}}return false},setActive:function(a){a=!!a;if(this.active!=a){this.active=a;this.event_activeChanged(this);t(this,this.subscribeTo,l.MASK*a);return true}return false},setSubscription:function(a){a=a&l.MASK;var i=this.subscribeTo^a;if(i){this.subscribeTo=a;this.active&&t(this,i,a);return true}return false},destroy:function(){this.active&&t(this,this.subscribeTo,0);this.delegate&&this.setDelegate();A.prototype.destroy.call(this);
this.data=G;this.state="undefined";this.target=this.root=null}}),o=z(null,{itemClass:p,keyGetter:J,map_:null,extendConstructor_:true,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a){var i={};if(a instanceof p)i.delegate=a;else i.data={id:a,title:a};return new this.itemClass(i)},get:function(a,i){var m=a instanceof p?a.eventObjectId:a,u=this.map_[m];if(!u&&i){u=this.map_[m]=this.create(a,i);u.addHandler({destroy:function(){delete this.map_[m]}},
this)}return u},destroy:function(){basis.Cleaner.remove(this);for(var a=D(this.map_),i=0,m;m=a[i++];)m.destroy()}}),b=z(p,{state:"undefined",itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:C("datasetChanged","dataset","delta")&&function(a,i){var m,u=0,h=0,d;if(m=i.inserted)for(;d=m[u];){this.item_[d.eventObjectId]=d;u++}if(m=i.deleted)for(;d=m[h];){delete this.item_[d.eventObjectId];h++}this.itemCount+=u-h;this.cache_=null;F.datasetChanged.call(this,a,i)},init:function(a){p.prototype.init.call(this,
a);this.memberMap_={};this.item_={}},has:function(a){return!!(a&&this.item_[a.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=D(this.item_);return this.cache_},pick:function(){for(var a in this.item_)return this.item_[a];return null},top:function(a){var i=[];if(a)for(var m in this.item_)if(i.push(this.item_[m])>=a)break;return i},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();p.prototype.destroy.call(this);
this.cache_=r;this.itemCount=0;this.item_=this.memberMap_=null}}),e=z(b,{listen:{item:{destroy:function(a){this.memberMap_[a.eventObjectId]&&this.remove([a])}}},init:function(a){b.prototype.init.call(this,a);if(a=this.items){this.set(a);this.items=null}},add:function(a){for(var i,m=this.memberMap_,u=[],h=0;h<a.length;h++){var d=a[h];if(d instanceof p){var n=d.eventObjectId;if(!m[n]){m[n]=d;d.addHandler(this.listen.item,this);u.push(d)}}}if(u.length)this.event_datasetChanged(this,i={inserted:u});return i},
remove:function(a){for(var i,m=this.memberMap_,u=[],h=0;h<a.length;h++){var d=a[h];if(d instanceof p){var n=d.eventObjectId;if(m[n]){d.removeHandler(this.listen.item,this);delete m[n];u.push(d)}}}if(u.length)this.event_datasetChanged(this,i={deleted:u});return i},set:function(a){if(!this.itemCount)return this.add(a);if(!a.length)return this.clear();for(var i=this.memberMap_,m={},u=[],h=[],d,n,w=0;w<a.length;w++){d=a[w];if(d instanceof p){n=d.eventObjectId;m[n]=d;if(!i[n]){i[n]=d;d.addHandler(this.listen.item,
this);h.push(d)}}}for(n in i)if(!m[n]){d=i[n];d.removeHandler(this.listen.item,this);delete i[n];u.push(d)}if(a=y(h,u))this.event_datasetChanged(this,a);return a},sync:function(a,i){if(a){e.setAccumulateState(true);for(var m=this.memberMap_,u,h,d={},n=[],w,E=0;E<a.length;E++){u=a[E];if(u instanceof p){h=u.eventObjectId;d[h]=u;m[h]||n.push(u)}}for(h in this.item_)d[h]||this.item_[h].destroy();if(i&&n.length)w=this.add(n);e.setAccumulateState(false);return w}},clear:function(){var a,i=this.getItems();
if(i.length){for(a=i.length;a-- >0;)i[a].removeHandler(this.listen.item,this);this.event_datasetChanged(this,a={deleted:i});this.memberMap_={}}return a}});e.setAccumulateState=function(){function a(E){var K=E.dataset;h.call(K,K,E)}function i(E,K){var P=E.eventObjectId,O=K.inserted,U=K.deleted,I=w[P];if(O&&U){if(I){delete w[P];a(I)}return h.call(E,E,K)}if(I){var L=I[O?"inserted":"deleted"];if(L)return L.push.apply(L,O||U);else a(I)}w[P]=K;K.dataset=E}function m(){d=1;setAccumulateState(false)}var u=
b.prototype,h=u.event_datasetChanged,d=0,n,w={};return function(E){if(E){if(d==0){u.event_datasetChanged=i;n=setTimeout(m,0)}d++}else{d-=d>0;if(d==0){clearTimeout(n);u.event_datasetChanged=h;E=w;w={};D(E).forEach(a)}}}}();var c={datasetChanged:function(a,i){var m=this.memberMap_,u={},h,d;if(i.inserted)for(var n=0;h=i.inserted[n];n++){d=h.eventObjectId;if(m[d])m[d].count++;else m[d]={count:1,object:h};u[d]=m[d]}if(i.deleted)for(n=0;h=i.deleted[n];n++){d=h.eventObjectId;u[d]=m[d];m[d].count--}this.applyRule(u)},
destroy:function(a){this.removeSource(a)}},g=z(b,{subscribeTo:l.SOURCE,event_sourcesChanged:C("sourcesChanged","dataset","delta"),sources:null,rule:function(a){return a>0},listen:{source:c},init:function(a){b.prototype.init.call(this,a);a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){if(typeof a!="function")a=g.UNION;if(this.rule!==a){this.rule=a;this.applyRule()}},applyRule:function(a){var i=this.memberMap_,m=this.rule,u=this.sources.length,h=[],d=[],n,w;a||
(a=i);for(var E in a){n=i[E];w=u&&n.count&&m(n.count,u);if(w!=!!this.item_[E])(w?h:d).push(n.object);n.count==0&&delete i[E]}if(a=y(h,d))this.event_datasetChanged(this,a)},addSource:function(a){if(a instanceof b)if(this.sources.add(a)){a.addHandler(this.listen.source,this);var i=this.memberMap_;for(var m in a.item_)if(i[m])i[m].count++;else i[m]={count:1,object:a.item_[m]};this.applyRule();this.event_sourcesChanged(this,{inserted:[a]});return true}},removeSource:function(a){if(this.sources.remove(a)){a.removeHandler(this.listen.source,
this);var i=this.memberMap_;for(var m in a.item_)i[m].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[a]});return true}},setSources:function(a){for(var i=Array.from(this.sources),m=0,u;u=a[m];m++)if(u instanceof b)i.remove(u)||this.addSource(u);i.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){b.prototype.destroy.call(this);this.sources=null}});g.UNION=g.prototype.rule;g.INTERSECTION=function(a,i){return a==
i};g.DIFFERENCE=function(a){return a==1};g.MORE_THAN_ONE_INCLUDE=function(a,i){return i==1||a>1};g.AT_LEAST_ONE_EXCLUDE=function(a,i){return i==1||a<i};var k=function(a){return!this.has(a)};c=z(b,{minuend:null,subtrahend:null,listen:{minuend:{datasetChanged:function(a,i){if(this.subtrahend){var m=y(i.inserted&&i.inserted.filter(k,this.subtrahend),i.deleted&&i.deleted.filter(this.has,this));m&&this.event_datasetChanged(this,m)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(a,
i){if(this.minuend){var m=y(i.deleted&&i.deleted.filter(k,this),i.inserted&&i.inserted.filter(this.has,this));m&&this.event_datasetChanged(this,m)}},destroy:function(){this.setOperands(this.minuend,null)}}},init:function(a){b.prototype.init.call(this,a);a=this.minuend;var i=this.subtrahend;this.subtrahend=this.minuend=null;if(a||i)this.setOperands(a,i)},setOperands:function(a,i){var m;if(a instanceof b==false)a=null;if(i instanceof b==false)i=null;var u=this.minuend,h=this.subtrahend;if(u!==a){u&&
u.removeHandler(this.listen.minuend,this);if(this.minuend=a)a.addHandler(this.listen.minuend,this)}if(h!==i){h&&h.removeHandler(this.listen.subtrahend,this);if(this.subtrahend=i)i.addHandler(this.listen.subtrahend,this)}if(!a||!i){if(this.itemCount)this.event_datasetChanged(this,m={deleted:this.getItems()})}else{m=[];u=[];for(var d in this.item_)if(!a.item_[d]||i.item_[d])m.push(this.item_[d]);for(d in a.item_)!this.item_[d]&&!i.item_[d]&&u.push(a.item_[d]);if(m=y(u,m))this.event_datasetChanged(this,
m)}return m},clear:function(){this.setOperands()}});var f={update:function(a){var i=this.map?this.map(a):a;if(i instanceof p==false||this.reduce(i))i=null;var m=this.sourceMap_[a.eventObjectId],u=m.member;if(u!=i){var h=this.memberMap_,d,n;m.member=i;if(u){m=u.eventObjectId;this.removeMemberRef&&this.removeMemberRef(u,a);if(--h[m]==0){delete h[m];n=[u]}}if(i){u=i.eventObjectId;this.addMemberRef&&this.addMemberRef(i,a);if(h[u])h[u]++;else{h[u]=1;d=[i]}}if(a=y(d,n))this.event_datasetChanged(this,a)}}},
j={datasetChanged:function(a,i){var m=this.sourceMap_,u=this.memberMap_,h=[],d=[],n,w,E;e.setAccumulateState(true);if(i.inserted)for(var K=0;n=i.inserted[K];K++){E=this.map?this.map(n):n;if(E instanceof p==false||this.reduce(E))E=null;n.addHandler(this.listen.sourceObject,this);m[n.eventObjectId]={sourceObject:n,member:E};if(E){w=E.eventObjectId;if(u[w])u[w]++;else{u[w]=1;h.push(E)}this.addMemberRef&&this.addMemberRef(E,n)}}if(i.deleted)for(K=0;n=i.deleted[K];K++){w=n.eventObjectId;E=m[w].member;
n.removeHandler(this.listen.sourceObject,this);delete m[w];if(E){w=E.eventObjectId;if(--u[w]==0){delete u[w];d.push(E)}this.removeMemberRef&&this.removeMemberRef(E,n)}}e.setAccumulateState(false);if(i=y(h,d))this.event_datasetChanged(this,i)},destroy:function(){this.setSource()}},q=z(b,{source:null,event_sourceChanged:C("sourceChanged","dataset","oldSource"),map:J,reduce:B,rule:B,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:f,source:j},init:function(a){b.prototype.init.call(this,
a);this.sourceMap_={};if(a=this.source){this.source=null;this.setSource(a)}},setRule:function(a){if(typeof a!="function")a=H;if(this.rule!==a){this.rule=a;return this.applyRule()}},setMap:function(a){if(typeof a!="function")a=J;if(this.map!==a){this.map=a;return this.applyRule()}},setSource:function(a){if(a instanceof b==false)a=null;if(this.source!==a){var i=this.source;if(i){i.removeHandler(this.listen.source,this);this.listen.source.datasetChanged.call(this,i,{deleted:i.getItems()})}if(this.source=
a){a.addHandler(this.listen.source,this);this.listen.source.datasetChanged.call(this,a,{inserted:a.getItems()})}this.event_sourceChanged(this,i)}},applyRule:function(){var a=this.sourceMap_,i=this.memberMap_,m,u,h,d,n,w=[],E=[];for(var K in a){n=a[K];d=n.sourceObject;m=n.member;u=this.map?this.map(d):d;if(u instanceof p==false||this.reduce(u))u=null;if(m!=u){n.member=u;if(m){h=m.eventObjectId;this.removeMemberRef&&this.removeMemberRef(m,d);i[h]--}if(u){m=u.eventObjectId;this.addMemberRef&&this.addMemberRef(u,
d);if(m in i)i[m]++;else{i[m]=1;w.push(u)}}}}for(h in this.item_)if(i[h]==0){delete i[h];E.push(this.item_[h])}if(a=y(w,E))this.event_datasetChanged(this,a);return a},clear:function(){this.setSource()},destroy:function(){b.prototype.destroy.call(this);this.sourceMap_=null}});B=z(q,{reduce:function(a){return!this.rule(a)},rule:H});z=z(q,{map:function(a){return this.keyMap.resolve(a)},rule:H,subsetClass:b,keyMap:null,addMemberRef:function(a,i){a.event_datasetChanged(a,{inserted:[i]})},removeMemberRef:function(a,
i){a.event_datasetChanged(a,{deleted:[i]})},init:function(a){if(!this.keyMap||this.keyMap instanceof o==false)this.keyMap=new o(Object.extend({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));q.prototype.init.call(this,a)},getSubset:function(a,i){return this.keyMap.get(a,i)},destroy:function(){q.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});Object.extend(e,{Merge:g,Subtract:c,MapReduce:q,Subset:B,Split:z});basis.namespace("basis.data",x).extend({STATE:{UNDEFINED:"undefined",
READY:"ready",PROCESSING:"processing",ERROR:"error",DEPRECATED:"deprecated"},Subscription:l,Object:p,DataObject:p,KeyObjectMap:o,AbstractDataset:b,Dataset:e,AggregateDataset:g,Collection:B,Grouping:z});basis.namespace("basis.data.dataset").extend({Merge:g,Subtract:c,MapReduce:q,Subset:B,Split:z})})();
(function(t,y){function x(e,c,g,k){c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i);for(var f=l(),j,q=0;q<c.length;q++){if(q%2){j=c[q].split(/\|/);e.getters[j[0]]=g+"childNodes["+k+"]";j=j.length>1?j[1]:j[0]}else j=c[q].length?c[q]:null;if(j!=null){if(s){f.lastChild&&f.appendChild(H.createComment(""));k++}f.appendChild(p(j));k++}}return f}function z(e){return function(c){if(!(c&&c.type=="click"&&c.which==3)){var g=t.dom.event.sender(c),k,f;do if(k=g.getAttributeNode&&g.getAttributeNode(e))break;while(g=
g.parentNode);if(g&&k){do if(f=g.basisObjectId)if((f=G[f])&&f.templateAction){g=k.nodeValue.qw();k=0;for(var j;j=g[k++];)f.templateAction(j,t.dom.event(c));break}while(g=g.parentNode)}}}}function A(e,c,g){c=c.trim();if(!c)return"";for(var k="",f;f=v.exec(c);){var j=f[2],q=f[4]||f[5]||j;if(f[3])e.getters[f[3]]=g+'.getAttributeNode("'+j+'")';if(f=j.match(/^event-([a-z]+)/i)){var a=f[1];if(!F[a]){F[a]=true;f=0;a=t.dom.event.browserEvents(a);for(var i;i=a[f++];)t.dom.event.addGlobalHandler(i,z(j))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(m,u){m=t.dom.event(m);var h=this,d;do if(d=h.basisObjectId)if((d=G[d])&&d.templateAction){h=u.qw();for(var n=0,w;w=h[n++];)d.templateAction(w,t.dom.event(m));break}while(h=h.parentNode)}}k+=j=="class"?q.trim().replace(/^(.)|\s+/g,".$1"):"["+j+(q?"="+q.quote('"'):"")+"]"}return k}function D(e,c){if(!e.stack)e.stack=[];if(!e.source)e.source=e.str;c||(c=".");for(var g=l(),k,f=0,j,q=e.stack;j=r.exec(e.str);){k=RegExp.leftContext;e.str=e.str.substr(k.length+j[0].length);if(k.length){g.appendChild(x(e,
k,c,f));f=g.childNodes.length}if(j[5])if(j[5]==q[q.length-1]){q.pop();return g}else throw"Wrong end tag";if(j[6]){if(j[7])e.getters[j[7]]=c+"childNodes["+f+"]";g.appendChild(H.createComment(j[6]))}else{k=j[1];var a=j[2],i=!!j[4],m=c+"childNodes["+f+"]";j=B.createElement(k+A(e,j[3],m));if(a)e.getters[a]=m;if(!i){q.push(k);j.appendChild(D(e,m+"."))}g.appendChild(j)}f++}e.str.length&&g.appendChild(x(e,e.str,c,f));if(q.length)throw"No end tag for "+q.reverse();return g}function J(e){if(!this.proto){e=
this.source;if(typeof e=="function")this.source=e=e();e=e.trim();e={str:e,getters:{element:".childNodes[0]"}};var c=D(e);e=Object.iterate(e.getters,function(q,a){for(var i=q.split(/\|/).map(String.format,"obj_.{0}"),m=a.split(/(\.?childNodes\[(\d+)\])/),u=c,h=0;h<m.length;h+=3){var d=m[h+2];if(!d)break;m[h+2]="";u=u.childNodes[d];if(u.previousSibling)u.nextSibling||(m[h+1]=".lastChild");else m[h+1]=".firstChild"}return{name:i[0],alias:i.join("="),path:"dom_"+m.join("")}}).sortAsObject("path");for(var g=
0;g<e.length;g++)for(var k=new RegExp("^"+e[g].path.forRegExp()),f=g+1,j;j=e[f++];)j.path=j.path.replace(k,e[g].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(q,a){obj_=q||{};dom_=proto_.cloneNode(true);_code_();if(a&&obj_.element){var i=obj_.element.basisObjectId=map_.seed++;map_[i]=a}return obj_}.toString().replace("_code_()",e.map(String.format,"{alias}={path};\n").join(""))))(c,G);this.clearInstance=(new Function("map_","var obj_; return "+function(q){obj_=
q;(q=obj_.element&&obj_.element.basisObjectId)&&delete map_[q];_code_()}.toString().replace("_code_()",e.map(String.format,"{alias}=null;\n").join(""))))(G)}}var H=y.document,B=t.dom,C=t.Class,F={},G={seed:1},r=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,v=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;B.createFragment();var s=B.createElement("","a","b").cloneNode(true).childNodes.length==
1,l=B.createFragment,p=B.createText,o=C(null,{__extend__:function(e){return e instanceof o?e:new o(e)},init:function(e){this.source=e},createInstance:function(e,c){J.call(this);return this.createInstance(e,c)},clearInstance:function(){J.call(this)}}),b=H.createElement("DIV");return t.namespace("basis.html").extend({Template:o,escape:function(e){return B.createElement("DIV",B.createText(e)).innerHTML},unescape:function(e){b.innerHTML=e;return b.firstChild.nodeValue},string2Html:function(e){b.innerHTML=
e;return B.createFragment.apply(null,Array.from(b.childNodes))}})})(basis,this);
(function(t){function y(d){return d.sortingValue||0}function x(d,n){d=d.sortingValue||0;n=n.sortingValue||0;return+(d>n)||-(d<n)}function z(d,n){d=d.sortingValue||0;n=n.sortingValue||0;return-(d>n)||+(d<n)}function A(d){return d.childNodes.sort(d.localSortingDesc?z:x)}function D(d,n){d.childNodes=n;d.firstChild=n[0]||null;d.lastChild=n[n.length-1]||null;for(var w=n.length-1;w>=0;w--){n[w].nextSibling=n[w+1]||null;n[w].previousSibling=n[w-1]||null;d.insertBefore(n[w],n[w].nextSibling)}}function J(d,
n){var w=d.childFactory||d.document&&d.document.childFactory,E;n=Object.extend({document:d.document,contextSelection:d.selection||d.contextSelection},n);if(w){E=w.call(d,n);if(E instanceof d.childClass)return E}if(!E)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(d.childClass&&d.childClass.className)+" but "+(E&&E.constructor&&E.constructor.className)+")";}function H(){return t.ui.apply(this,arguments)}var B=t.Class,C=t.dom,F=t.data,G=
F.Subscription,r=F.DataObject,v=F.AbstractDataset,s=F.Dataset,l=C.AXIS_DESCENDANT,p=C.AXIS_DESCENDANT_OR_SELF,o=Function.getter,b=Object.complete,e=C.axis;F=t.EventObject.createEvent;var c=t.EventObject.event;G.regType("DATASOURCE",{dataSourceChanged:function(d,n){this.remove(d,n);this.add(d,d.dataSource)}},function(d,n){d(n,n.dataSource)});var g=B.ExtensibleProperty(),k={ownerChanged:function(){},destroy:function(d){C.replace(d.element,this)}},f=function(){var d=this.key,n=this.config,w=this.owner,
E=typeof n.existsIf!="function"||n.existsIf(w),K=w.satellite[d];if(E){E="delegate"in n;var P="dataSource"in n,O=typeof n.delegate=="function"?n.delegate(w):null,U=typeof n.dataSource=="function"?n.dataSource(w):null;if(K){E&&K.setDelegate(O);P&&K.setDataSource(U)}else{var I=w.tmpl[n.replace||d];K={owner:w};if(E)K.delegate=O;if(P)K.dataSource=U;if(n.config)Object.complete(K,typeof n.config=="function"?n.config(w):n.config);K=new n.instanceOf(K);w.satellite[d]=K;if(I&&K instanceof t.ui.Node&&K.element){C.replace(I,
K.element);K.addHandler(k,I)}}}else if(K){K.destroy();K.owner=null;delete w.satellite[d]}},j=B.CustomExtendProperty({update:true},function(d,n){for(var w in n)d[w]=n[w]?f:null}),q=B(r,{event_update:function(d,n){r.prototype.event_update.call(this,d,n);var w=this.parentNode;if(w){if(w.matchFunction){this.match();this.match(w.matchFunction)}w.insertBefore(this,this.nextSibling)}},event_childNodesModified:F("childNodesModified","node","delta"),event_dataSourceChanged:F("dataSourceChanged","node","oldDataSource"),
event_localGroupingChanged:F("localGroupingChanged","node","oldGroupingNode"),event_localSortingChanged:F("localSortingChanged","node"),event_ownerChanged:F("ownerChanged","node","oldOwner"),event_satellitesChanged:F("satellitesChanged","node","delta"),subscribeTo:r.prototype.subscribeTo+G.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:false,nodeType:"DOMWrapperNode",canHaveChildren:false,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:true,
document:null,parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:false,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:g,satellite:null,owner:null,init:function(d){var n=this.dataSource,w=this.childNodes,E=this.localGrouping;if(n)this.dataSource=null;r.prototype.init.call(this,d);if(E){this.localGrouping=null;this.setLocalGrouping(E)}if(this.canHaveChildren){this.childNodes=[];if(n){this.dataSource=null;
this.setDataSource(n)}else w&&this.setChildNodes(w)}else{if(w)this.childNodes=null;if(n)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==g)for(var K in this.satelliteConfig){d=this.satelliteConfig[K];if(B.isClass(d))d={instanceOf:d};if(typeof d=="object"){n={key:K,owner:this,config:d};d=d.hook?j.__extend__(d.hook):j;for(K in d)if(d[K]===f){this.addHandler(d,n);break}f.call(n)}}if(K=this.owner){this.owner=null;this.setOwner(K)}},appendChild:function(){},insertBefore:function(){},
removeChild:function(){},replaceChild:function(){},clear:function(){},hasChildNodes:function(){return this.childNodes.length>0},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(d){if(!d||d instanceof q==false)d=null;if(this.owner!==d){var n=this.owner;n&&n.removeHandler(this.listen.owner,this);if(this.owner=d)d.addHandler(this.listen.owner,this);this.event_ownerChanged(this,n)}},destroy:function(){r.prototype.destroy.call(this);
if(this.dataSource)this.setDataSource();else this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping){this.localGrouping.destroy();this.localGrouping=null}this.owner&&this.setOwner();if(this.satellite){for(var d in this.satellite){var n=this.satellite[d];n.destroy();n.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),a=B(q,{autoDestroyIfEmpty:false,
nodes:null,first:null,last:null,init:function(d){this.nodes=[];q.prototype.init.call(this,d)},insert:function(d,n){var w=this.nodes,E=n?w.indexOf(n):w.length;if(E==-1)E=w.length;w.splice(E,0,d);this.first=w[0]||null;this.last=w[w.length-1]||null;d.groupNode=this;this.event_childNodesModified(this,{inserted:[d]})},remove:function(d){var n=this.nodes;if(n.remove(d)){this.first=n[0]||null;this.last=n[n.length-1]||null;d.groupNode=null;this.event_childNodesModified(this,{deleted:[d]})}!this.first&&this.autoDestroyIfEmpty&&
this.destroy()},clear:function(){if(this.first){for(var d=this.nodes,n=d.length;n-- >0;)d[n].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:d});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){q.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),i={canHaveChildren:true,childClass:q,childFactory:null,listen:{dataSource:{datasetChanged:function(d,n){var w={},E=[];if(n.deleted){w.deleted=E;if(this.childNodes.length==n.deleted.length){E.push.apply(E,
this.childNodes);var K=this.dataSource;this.dataSource=null;this.clear(true);this.dataSource=K;this.colMap_={}}else{K=0;for(var P;P=n.deleted[K];K++){P=P.eventObjectId;var O=this.colMap_[P];delete this.colMap_[P];O.canHaveDelegate=true;this.removeChild(O);E.push(O)}}}if(n.inserted){w.inserted=[];for(K=0;P=n.inserted[K];K++){O=J(this,{cascadeDestroy:false,delegate:P});O.canHaveDelegate=false;this.colMap_[P.eventObjectId]=O;w.inserted.push(O);this.firstChild&&this.insertBefore(O)}}this.firstChild?this.event_childNodesModified(this,
w):this.setChildNodes(w.inserted);if(this.destroyDataSourceMember&&E.length)for(K=0;P=E[K];K++)P.destroy()},destroy:function(d){this.dataSource===d&&this.setDataSource()}}},appendChild:function(d){return this.insertBefore(d)},insertBefore:function(d,n){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(d.firstChild){var w=this;do if(w==d)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(w=w.parentNode)}if(this.dataSource&&
!this.dataSource.has(d.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(d instanceof this.childClass==false)d=J(this,d instanceof r?{delegate:d}:d);var E=d.parentNode===this,K=d.groupNode,P=this.localGrouping;w=this.localSorting;var O=this.childNodes,U=null,I=-1;if(P){U=P.getGroupNode(d);P=U.nodes;if(E&&d.nextSibling===n&&K===U)return d;if(w){w=w(d)||0;I=P.binarySearchPos(w,y,this.localSortingDesc);d.sortingValue=w}else I=n&&n.groupNode===U?
P.indexOf(n):P.length;if(I<P.length)n=P[I];else if(U.last)n=U.last.nextSibling;else{w=U;for(n=null;w=w.nextSibling;)if(n=w.first)break}if(d===n||E&&d.nextSibling===n){if(K!==U){K&&K.remove(d);U.insert(d)}return d}I=-1}else if(w){I=this.localSortingDesc;P=d.nextSibling;var L=d.previousSibling;w=w(d)||0;if(E){if(w===d.localSorting)return d;if((!P||(I?P.sortingValue<=w:P.sortingValue>=w))&&(!L||(I?L.sortingValue>=w:L.sortingValue<=w))){d.sortingValue=w;return d}}I=O.binarySearchPos(w,y,I);n=O[I];d.sortingValue=
w;if(d===n||E&&P===n)return d}else{if(n&&n.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(E){if(d.nextSibling===n)return d;if(d===n)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}if(E){if(d.nextSibling)d.nextSibling.previousSibling=d.previousSibling;else this.lastChild=d.previousSibling;if(d.previousSibling)d.previousSibling.nextSibling=d.nextSibling;else this.firstChild=d.nextSibling;d.previousSibling=null;d.nextSibling=null;if(I==-1)O.remove(d);
else{w=O.indexOf(d);O.splice(w,1);w<I&&I--}K&&K.remove(d)}else d.parentNode&&d.parentNode.removeChild(d);K!=U&&U.insert(d,n);if(n){if(I==-1)I=O.indexOf(n);if(I==-1)throw"basis.dom.wrapper: Node was not found";d.nextSibling=n;O.splice(I,0,d)}else{I=O.length;O.push(d);n={previousSibling:this.lastChild};this.lastChild=d}d.parentNode=this;d.previousSibling=n.previousSibling;if(I==0)this.firstChild=d;else n.previousSibling.nextSibling=d;n.previousSibling=d;var M=false,S=false,V=this.selection||this.contextSelection;
if(!d.document&&d.document!==this.document){M=this.document;d.document=this.document}if(!d.contextSelection&&d.contextSelection!==V){d.contextSelection=V;S=!d.selection;d.selected&&V.add([d])}if(d.firstChild&&(M||S))e(d,l).forEach(function(Z){if(M&&!Z.document)Z.document=M;if(S&&!Z.contextSelection){Z.selected&&Z.unselect();Z.contextSelection=V}});if(!E){d.match&&d.match(this.matchFunction);d.autoDelegateParent&&d.setDelegate(this);this.dataSource||this.event_childNodesModified(this,{inserted:[d]})}return d},
removeChild:function(d){if(d==null||d.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(d instanceof this.childClass==false)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(d))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(d),1);d.parentNode=null;if(d.nextSibling)d.nextSibling.previousSibling=d.previousSibling;else this.lastChild=d.previousSibling;
if(d.previousSibling)d.previousSibling.nextSibling=d.nextSibling;else this.firstChild=d.nextSibling;d.nextSibling=null;d.previousSibling=null;d.document===this.document&&e(d,p).forEach(function(K){if(K.document==this.document)K.document=null},this);if(d.contextSelection){for(var n=d.contextSelection,w=d,E=[];w;){if(w.contextSelection===n){w.selected&&E.push(w);w.contextSelection=null}if(!w.selection&&w.firstChild)w=w.firstChild;else if(w.nextSibling)w=w.nextSibling;else for(;w=w.parentNode;)if(w.nextSibling){w=
w.nextSibling;break}}n.remove(E)}d.groupNode&&d.groupNode.remove(d);this.dataSource||this.event_childNodesModified(this,{deleted:[d]});d.autoDelegateParent&&d.setDelegate();return d},replaceChild:function(d,n){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(n==null||n.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(d,n);return this.removeChild(n)},clear:function(d){if(this.dataSource)this.setDataSource();
else if(this.firstChild){var n=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:n});for(var w=n.length;w-- >0;){var E=n[w];E.parentNode=null;E.groupNode=null;if(d){if(E.selection||E.document)e(E,C.AXIS_DESCENDANT_OR_SELF).forEach(function(K){if(this.selection&&K.selection===this.selection){K.selected&&K.selection.remove([K]);K.selection=null}if(K.document===this.document)K.document=null},this);E.nextSibling=null;E.previousSibling=null;
E.autoDelegateParent&&E.setDelegate()}else E.destroy()}this.localGrouping&&this.localGrouping.clear()}},setChildNodes:function(d,n){this.dataSource||this.clear(!!n);if(d){if("length"in d==false)d=[d];if(d.length){var w=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var E=0,K=d.length;E<K;E++)this.insertBefore(d[E]);this.event_childNodesModified=w;this.event_childNodesModified(this,{inserted:this.childNodes})}}},setDataSource:function(d){if(!d||!this.canHaveChildren||
d instanceof v==false)d=null;if(this.dataSource!==d){var n=this.dataSource;if(n){this.colMap_=this.dataSource=null;n.removeHandler(this.listen.dataSource,this);n.itemCount&&this.clear()}if(d){this.dataSource=d;this.colMap_={};d.addHandler(this.listen.dataSource,this);d.itemCount&&this.listen.dataSource.datasetChanged.call(this,d,{inserted:d.getItems()})}this.event_dataSourceChanged(this,n)}},setLocalGrouping:function(d){if(typeof d=="function"||typeof d=="string")d={groupGetter:o(d)};if(d instanceof
u==false)d=d!=null&&typeof d=="object"?new this.localGroupingClass(Object.complete({},d)):null;if(this.localGrouping!==d){var n=this.localGrouping,w;if(this.localGrouping){if(!d&&this.firstChild){this.localGrouping=null;w=this.localSorting?A(this):this.childNodes;for(var E=w.length;E-- >0;)w[E].groupNode=null;D(this,w)}n.setOwner()}if(d){this.localGrouping=d;d.setOwner(this);if(this.firstChild){w=this.localSorting?A(this):this.childNodes;for(E=0;d=w[E];E++)d.groupNode=this.localGrouping.getGroupNode(d);
w=w;for(E=0;d=w[E];E++)d.groupNode.nodes.push(d);w.length=0;for(E=this.localGrouping.nullGroup;E;E=E.nextSibling){d=E.nodes;E.first=d[0]||null;E.last=d[d.length-1]||null;w.push.apply(w,d);E.event_childNodesModified(E,{inserted:d})}D(this,w)}}this.event_localGroupingChanged(this,n)}},setLocalSorting:function(d,n){if(d)d=o(d);if(this.localSorting!=d||this.localSortingDesc!=!!n){this.localSortingDesc=!!n;this.localSorting=d||null;if(d&&this.firstChild){var w=[],E;for(E=this.firstChild;E;E=E.nextSibling)E.sortingValue=
d(E)||0;if(this.localGrouping)for(var K=this.localGrouping.nullGroup;K;K=K.nextSibling){E=K.nodes=A({childNodes:K.nodes,localSortingDesc:this.localSortingDesc});K.first=E[0]||null;K.last=E[E.length-1]||null;w.push.apply(w,E)}else w=A(this);D(this,w)}this.event_localSortingChanged(this)}},setMatchFunction:function(d){if(this.matchFunction!=d){this.matchFunction=d;for(var n=this.lastChild;n;n=n.previousSibling)n.match(d)}}};G=B(q,{event_enable:F("enable","node"),event_disable:F("disable","node"),event_select:F("select",
"node"),event_unselect:F("unselect","node"),event_match:F("match","node"),event_unmatch:F("unmatch","node"),selectable:true,selected:false,selection:null,contextSelection:null,matchFunction:null,matched:true,disabled:false,init:function(d){if(this.selection&&this.selection instanceof v==false)this.selection=new h(this.selection);q.prototype.init.call(this,d);this.disabled&&this.event_disable(this);if(this.selected){this.selected=false;this.select(true)}},setSelection:function(d){if(this.selection==
d)return false;var n=this.selection;e(this,l,function(w){if(w.contextSelection==n){w.selected&&n&&n.remove([w]);w.contextSelection=d}});this.selection=d;return true},hasOwnSelection:function(){return!!this.selection},select:function(d){var n=this.selected,w=this.contextSelection;if(w)if(d)n?w.remove([this]):w.add([this]);else this.selectable&&w.set([this]);else if(!n&&this.selectable&&!this.isDisabled()){this.selected=true;this.event_select(this)}return this.selected!=n},unselect:function(){var d=
this.selected;if(d){var n=this.contextSelection;if(n)n.remove([this]);else{this.selected=false;this.event_unselect(this)}}return this.selected!=d},enable:function(){if(this.disabled){this.disabled=false;this.event_enable(this)}},disable:function(){if(!this.disabled){this.disabled=true;this.event_disable(this)}},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!C.findAncestor(this,o("disabled"))},match:function(d){if(typeof d!="function")if(this.matched){if(this.underMatch_){this.underMatch_(this,
true);this.underMatch_=null}}else{this.matched=true;this.event_match(this)}else if(d(this)){this.underMatch_=d;if(!this.matched){this.matched=true;this.event_match(this)}}else{this.underMatch_=null;if(this.matched){this.matched=false;this.event_unmatch(this)}}},setMatchFunction:function(){},destroy:function(){if(this.hasOwnSelection()){this.selection.destroy();delete this.selection}this.unselect();q.prototype.destroy.call(this)}});var m=B(G,i,{}),u=B(q,i,{event_childNodesModified:function(d,n){c.childNodesModified.call(this,
d,n);this.nullGroup.nextSibling=this.firstChild;if(n.inserted&&this.dataSource&&this.nullGroup.first)for(var w=this.owner,E=Array.from(this.nullGroup.nodes),K=E.length;K-- >0;)w.insertBefore(E[K],E[K].nextSibling)},event_ownerChanged:function(d,n){n&&n.localGrouping===this&&n.setLocalGrouping(null,true);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);c.ownerChanged.call(this,d,n);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:true,
autoDestroyEmptyGroups:true,titleGetter:o("data.title"),groupGetter:Function.$undef,childClass:a,childFactory:function(d){return new this.childClass(b(d,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?false:this.autoDestroyEmptyGroups}))},init:function(d){this.map_={};this.nullGroup=new a({autoDestroyIfEmpty:false});q.prototype.init.call(this,d)},getGroupNode:function(d){d=this.groupGetter(d);var n=d instanceof r,w=this.map_[n?d.eventObjectId:d];if(!w&&!this.dataSource)w=this.appendChild(n?
{delegate:d}:{data:{id:d,title:d}});return w||this.nullGroup},insertBefore:function(d,n){d=i.insertBefore.call(this,d,n);if("groupId_"in d==false){d.groupId_=d.delegate?d.delegate.eventObjectId:d.data.id;this.map_[d.groupId_]=d}if(d.first){var w=this.owner,E=w.childNodes,K=d.first,P=d.last,O,U,I;for(O=d;O=O.previousSibling;)if(I=O.last)break;if(!I)I=this.nullGroup.last;for(O=d;O=O.nextSibling;)if(U=O.first)break;if(K.previousSibling!==I||P.nextSibling!==U){if(K.previousSibling)K.previousSibling.nextSibling=
P.nextSibling;if(P.nextSibling)P.nextSibling.previousSibling=K.previousSibling;O=E.splice(E.indexOf(K),d.nodes.length);var L=E.indexOf(U);O.unshift(L!=-1?L:E.length,0);E.splice.apply(E,O);K.previousSibling=I;P.nextSibling=U;if(I)I.nextSibling=K;if(U)U.previousSibling=P;w.firstChild=E[0];w.lastChild=E[E.length-1]}}return d},removeChild:function(d){i.removeChild.call(this,d);delete this.map_[d.groupId_];return d},clear:function(){i.clear.call(this);this.map_={}},destroy:function(){this.setOwner();q.prototype.destroy.call(this);
this.map_=null}});q.prototype.localGroupingClass=u;F=B(v,{autoDestroy:true,sourceNode:null,listen:{sourceNode:{childNodesModified:function(d,n){var w=this.memberMap_,E={},K=0,P=0,O=n.inserted,U=n.deleted;if(O&&O.length)for(E.inserted=O;d=O[K];){w[d.eventObjectId]=d;K++}if(U&&U.length)for(E.deleted=U;d=U[P];){delete w[d.eventObjectId];P++}if(K||P)this.event_datasetChanged(this,E)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:F("sourceNodeChanged")&&
function(d,n){c.sourceNodeChanged.call(this,d,n);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:false,init:function(d,n){v.prototype.init.call(this,n);d&&this.setSourceNode(d)},setSourceNode:function(d){if(d instanceof q==false)d=null;if(d!==this.sourceNode){var n=this.sourceNode;if(n){n.removeHandler(this.listen.sourceNode,this);this.listen.sourceNode.childNodesModified.call(this,n,{deleted:n.childNodes})}if(d){d.addHandler(this.listen.sourceNode,this);this.listen.sourceNode.childNodesModified.call(this,
d,{inserted:d.childNodes})}this.sourceNode=d;this.event_sourceNodeChanged(this,n)}},destroy:function(){this.setSourceNode();v.prototype.destroy.call(this)}});var h=B(s,{multiple:false,event_datasetChanged:function(d,n){s.prototype.event_datasetChanged.call(this,d,n);if(n.inserted)for(var w=0,E;E=n.inserted[w];w++)if(!E.selected){E.selected=true;E.event_select()}if(n.deleted)for(w=0;E=n.deleted[w];w++)if(E.selected){E.selected=false;E.event_unselect()}},add:function(d){if(!this.multiple)if(this.itemCount)return this.set(d);
else d.splice(1);for(var n=[],w=0,E;E=d[w];w++)E.contextSelection==this&&E.selectable&&n.push(E);return s.prototype.add.call(this,n)},set:function(d){for(var n=[],w=0,E;E=d[w];w++)E.contextSelection==this&&E.selectable&&n.push(E);this.multiple||d.splice(1);return s.prototype.set.call(this,n)}});t.namespace("basis.dom.wrapper",H).extend({AbstractNode:q,InteractiveNode:G,Node:m,GroupingNode:u,PartitionNode:a,simpleTemplate:H,ChildNodesDataset:F,Selection:h})})(basis);
(function(t,y){function x(h,d){return D(d,true).getRule(h,true)}function z(h,d){var n=h.match(/^([^{]+)\{(.*)\}\s*$/);if(n){for(var w=n[1].trim().split(/\s*,\s*/),E=0;E<w.length;E++)this.addRule(w[E],n[2]||null,d++);return d-1}}function A(h,d){var n=s.createElement(!h?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:d?"alternate ":"",url:h.quote('"')}));s.tag(null,"HEAD")[0].appendChild(n);n=n.sheet||n.styleSheet;try{if(!n.cssRules)n.cssRules=n.rules}catch(w){}if(!n.insertRule)n.insertRule=
z;if(!n.deleteRule)n.deleteRule=n.removeRule;return n}function D(h,d){h||(h="DefaultGenericStyleSheet");if(!c[h])if(d)c[h]=new f(A());return c[h]}function J(h,d,n,w){w=w||{};d=d.qw();for(var E=0,K;K=d[E];E++)if(typeof k.style[K]!="undefined"){if(n)t.platformFeature["css-"+h]=K;g[h]={key:K,getter:w[K]};return}}function H(h,d){var n=g[h];if(h=n?n.key:h.replace(/^-ms-/,"ms-").camelize())return{key:h,value:n&&n.getter?n.getter(d):d}}function B(h,d,n){if(typeof h.setProperty=="function")return h.setProperty(d,
n);if(d=H(d,n))return h.style[d.key]=d.value}function C(h,d){for(var n in d)B(h,n,d[n]);return h}function F(h,d){return B(h,"display",typeof d=="string"?d:d?"":"none")}function G(h,d){return B(h,"visibility",d?"":"hidden")}function r(h){return m[h]||(m[h]=new RegExp("\\s*\\b"+h+"\\b"))}var v=y.document,s=t.dom,l=t.dom.event,p=t.Class,o=/\s*!important/i,b=String("important"),e=1,c={},g={},k=s.createElement("DIV");J("opacity","opacity MozOpacity KhtmlOpacity filter",true,{fitler:function(h){return"alpha(opacity:"+
parseInt(h*100)+")"}});J("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",true);J("float","cssFloat styleFloat");var f=p(null,{styleSheet:null,rules:null,init:function(h){this.styleSheet=h;this.rules=[];this.map_={}},getRule:function(h,d){if(!this.map_[h])if(d){for(var n=this.styleSheet,w=this.rules.length,E=n.insertRule(h+"{}",w),K=w;K<=E;K++)this.rules.push(new j(n.cssRules[K]));this.map_[h]=w!=E?new q(this.rules.splice(w)):this.rules[w]}return this.map_[h]},deleteRule:function(h){var d=
this.map_[h];if(d){d=d.rules||[d];for(var n=0;n<d.length;n++){var w=this.rules.indexOf(d[n]);this.stylesheet.deleteRule(w);this.rules.splice(w,1)}delete this.map_[h]}},destroy:function(){delete this.rules}}),j=p(null,{rule:null,selector:"",init:function(h){if(h){this.rule=h;this.selector=h.selectorText}},setProperty:function(h,d){var n,w=!!o.test(d),E=this.rule.style;if(w||(E.getPropertyPriority?E.getPropertyPriority(h)==b:false)){d=d.replace(o,"");if(n=H(h,d)){var K=n.key;if(E.setProperty){w||E.removeProperty(K);
E.setProperty(K,n.value,w?b:"")}else{n=K+": "+n.value+(w?" !"+b:"")+";";E.cssText=E.cssText.replace(new RegExp(E[K]?K+"\\s*:\\s*"+E[K]+"(\\s*!"+b+")?\\s*;?":"^","i"),n)}}}else B(this.rule,h,d)},setStyle:function(h){Object.iterate(h,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),q=p(null,{rules:null,init:function(h){this.rules=h},destroy:function(){delete this.rules}});["setProperty","setStyle","clear"].forEach(function(h){q.prototype[h]=
function(){for(var d,n=0;d=this.rules[n];n++)d[h].apply(d,arguments)}});var a={};["em","ex","px","%"].forEach(function(h){a[h=="%"?"percent":h]=function(d){return d==0||isNaN(d)?"0":d+h}});var i,m={},u=p(null,{init:function(h){this.element=h},toString:function(){return this.element.className},set:function(h){this.clear();h.qw().forEach(this.add,this)},replace:function(h,d,n){n=n||"";typeof h!="undefined"&&this.remove(n+h);typeof d!="undefined"&&this.add(n+d)},bool:function(h,d){d?this.add(h):this.remove(h)},
clear:function(){this.element.className=""},contains:function(h){return!!this.element.className.match(r(h))},item:function(h){return this.element.className.qw()[h]},add:function(h){this.element.className.match(r(h))||(this.element.className+=" "+h)},remove:function(h){var d=this.element.className;h=d.replace(r(h),"");if(h!=d)this.element.className=h},toggle:function(h){var d=this.contains(h);d?this.remove(h):this.add(h);return!d}});if(y.DOMTokenList&&v.documentElement.classList){p=u.prototype;Object.extend(y.DOMTokenList.prototype,
{set:p.set,replace:p.replace,bool:p.bool,clear:function(){for(var h=this.length;h-- >0;)this.remove(this[h])}});i=function(h){return(typeof h=="string"?s.get(h):h).classList}}else i=function(h){return new u(typeof h=="string"?s.get(h):h)};l.onLoad(function(){i(v.body).bool("opacity-not-support",!t.platformFeature["css-opacity"])});s.extend({setStyleProperty:B,setStyle:C,display:F,show:function(h){return F(h,1)},hide:function(h){return F(h)},visibility:G,visible:function(h){return G(h,1)},invisible:function(h){return G(h)}});
return t.namespace("basis.cssom").extend({setStyleProperty:B,setStyle:C,classList:i,uniqueRule:function(h){var d="genericRule-"+e++;h&&i(h).add(d);h=x("."+d);h.token=d;return h},cssRule:x,getStyleSheet:D,addStyleSheet:A,CssStyleSheetWrapper:f,CssRuleWrapper:j,CssRuleWrapperSet:q}).extend(a)})(basis,this);
(function(t){function y(p){return!!(!(p%400)||p%100&&!(p%4))}function x(p,o){return p==1?28+y(o):J[p]}function z(p,o){return o.replace(v,function(b,e){return G[e](p)})}function A(p,o,b,e,c,g,k){return new Date(p,o-1,b,e||0,c||0,g||0,k||0)}var D=Function.getter,J=[31,28,31,30,31,30,31,31,30,31,30,31],H={day:864E5,hour:36E5,minute:6E4,second:1E3},B="year month day hour minute second millisecond".qw(),C={},F={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(p,o){C[p]=D("get"+o+"()");F[p]=new Function("d,v","d.set"+o+"(v)")});var G={y:D("getFullYear().toString().substr(2)"),Y:D("getFullYear()"),d:D("getDate()"),D:D("getDate()","{0:02}"),m:D("getMonth() + 1"),M:D("getMonth() + 1","{0:02}"),h:D("getHours()"),H:D("getHours()","{0:02}"),i:D("getHours() % 12 || 12","{0:02}"),p:D("getHours() > 12",{"true":"pm","false":"am"}),P:D("getHours() > 12",{"true":"PM","false":"AM"}),I:D("getMinutes()","{0:02}"),s:D("getSeconds()"),
S:D("getSeconds()","{0:02}"),z:D("getMilliseconds()"),Z:D("getMilliseconds()","{0:03}")},r=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,v=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return y(this.getFullYear())},getMonthDayCount:function(){return x(this.getMonth(),this.getFullYear())},add:function(p,o){var b=C[p];if(!b)throw new Error("Unknown date part: "+p);var e;if(p=="year"||p=="month"){e=this.getDate();e>28&&this.setDate(1)}F[p](this,
b(this)+o);if(e>28){b=this.getMonthDayCount();e>b&&this.setDate(b)}return this},diff:function(p,o){if(p=="year"||p=="month"){var b=Number(this)-Number(o)>0?-1:1,e=b>0?this:o,c=b>0?o:this,g=e.getFullYear();g=c.getFullYear()-g;if(p=="year")return b*g;e=e.getMonth();c=c.getMonth();return b*(g?(g>1?(g-1)*12:0)+(11-e)+(c+1):c-e)}else{b=Math.floor((o-this)/H[p]);return b+Number(C[p](new Date(o-b*H[p]))-C[p](this)!=0)}},set:function(p,o){var b=F[p];if(!b)throw new Error("Unknown date part: "+p);var e;if(p==
"year"||p=="month"){e=this.getDate();e>28&&this.setDate(1)}b(this,o);if(e>28){b=this.getMonthDayCount();e>b&&this.setDate(b)}return this},get:function(p){if(C[p])return C[p](this);throw new Error("Unknown date part: "+p);},toISODateString:function(){return z(this,"%Y-%M-%D")},toISOTimeString:function(){return z(this,"%H:%I:%S.%Z")},fromDate:function(p){if(p instanceof Date){this.setFullYear(p.getFullYear(),p.getMonth(),p.getDate());this.setTime(p.getTime())}return this},toFormat:function(p){return z(this,
p)}});var s=Date.prototype.toISOString;if(s&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return s.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(p){var o=String(p).match(r);if(!o)throw new Error("Value of date isn't in ISO format: "+p);o[2]-=1;p=0;for(var b;b=B[p];p++)this.set(b,o[p+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,
toODBCTime:Date.prototype.toISOTimeString,toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var l=/\D/;Date.fromISOString=function(p){return p?A.apply(null,String(p).split(l)):null};Date.timer=function(p){var o=p||new Date;o.measure=function(b){return b?((new Date-o)/1E3).toFixed(3):new Date-o};return o};t.namespace("basis.date").extend({isLeapYear:y,getMonthDayCount:x,format:z})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.html.Template,A=t.cssom.classList,D=Function.getter,J=t.Cleaner,H=t.dom.wrapper.Node,B=t.dom.wrapper.PartitionNode,C=t.dom.wrapper.GroupingNode,F=y.ExtensibleProperty(),G=function(v){return{template:new z("<div/>"),action:F,cssClassName:null,event_update:function(s,l){v.event_update.call(this,s,l);this.templateUpdate(this.tmpl,"update",l)},event_select:function(s){v.event_select.call(this,s);A(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(s){v.event_unselect.call(this,s);A(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(s){v.event_disable.call(this,s);A(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(s){v.event_enable.call(this,s);A(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(s){v.event_match.call(this,s);x.display(this.element,true)},event_unmatch:function(s){v.event_unmatch.call(this,s);x.display(this.element,
false)},init:function(s){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere){this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode;this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere}if(this.content)x.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=x.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;v.init.call(this,s);if(this.id)this.element.id=
this.id;if(s=this.cssClassName){if(typeof s=="string")s={element:s};for(var l in s){var p=this.tmpl[l];if(p){p=A(p);for(var o=String(s[l]).qw(),b=0,e;e=o[b++];)p.add(e)}}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&x.insert(this.container,this.element)},templateAction:function(s,l){var p=this.action[s];p&&p.call(this,l)},templateUpdate:function(){},destroy:function(){var s=this.element;v.destroy.call(this);s&&s.parentNode&&s.parentNode.removeChild(s);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}};H=y(H,G,{});D=y(B,G,{titleGetter:D("data.title"),templateUpdate:function(v){if(v.titleText)v.titleText.nodeValue=String(this.titleGetter(this))}});G=function(v){return{insertBefore:function(s,l){s=v.insertBefore.call(this,s,l);var p=s.groupNode||this,o=s.nextSibling;p=p.childNodesElement||p.element||this.childNodesElement||this.element;var b=s.element;o=(o&&o.element.parentNode==p?o.element:null)||p.insertPoint||null;if(b.parentNode!==p||
b.nextSibling!==o)p.insertBefore(b,o);return s},removeChild:function(s){v.removeChild.call(this,s);var l=s.element,p=l.parentNode;p&&p.removeChild(l);return s},clear:function(s){if(s)for(var l=this.firstChild;l;){var p=l.element;p.parentNode&&p.parentNode.removeChild(p);l=l.nextSibling}v.clear.call(this,s)},setChildNodes:function(s,l){var p=x.createFragment(),o=this.localGrouping||this,b=o.childNodesElement||o.element;o.childNodesElement=p;v.setChildNodes.call(this,s,l);b.insertBefore(p,b.insertPoint||
null);o.childNodesElement=b}}};B=y(C,G,{childClass:D,event_ownerChanged:function(v,s){var l=this,p=this.owner,o=null;if(p)o=p.tmpl&&p.tmpl.groupsElement||p.childNodesElement||p.element;do l.element=l.childNodesElement=o;while(l=l.localGrouping);C.prototype.event_ownerChanged.call(this,v,s)}});B.prototype.localGroupingClass=B;var r=y(H,G,{childClass:H,childFactory:function(v){return new this.childClass(v)},localGroupingClass:B});y=y(r,{selection:{},init:function(v){this.document=this;r.prototype.init.call(this,
v);J.add(this)},destroy:function(){if(this.selection){this.selection.destroy();this.selection=null}r.prototype.destroy.call(this);J.remove(this)}});G=function(v,s){for(var l=v.match(/\{(this_[^\}]+)\}/g)||[],p=[],o=0;o<l.length;o++){var b=l[o].match(/\{(this_[^\|\}]+)\}/)[1];p.push("this.tmpl."+b+".nodeValue = "+b.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(e){return Object.extend({template:tmpl_,templateUpdate:function(c,g,k){e.templateUpdate.call(this,c,g,k);_code_()}},
config_)}.toString().replace("_code_()",p.join(";\n")))(new z(v),s)};t.namespace("basis.ui",G).extend({simpleTemplate:G,Node:H,Container:r,PartitionNode:D,GroupingNode:B,Control:y})})(basis);
(function(t,y){function x(a,i){if(f)try{return parseFloat(J.getComputedStyle(a,null)[i])}catch(m){return 0}else return 0}function z(a,i){if(f)return x(a,"height");else{G.setStyle(i,{borderTop:a.currentStyle.borderTopWidth+" solid red",borderBottom:a.currentStyle.borderBottomWidth+" solid red",paddingTop:a.currentStyle.paddingTop,paddingBottom:a.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"});return a.offsetHeight-i.offsetHeight}}function A(a,i){if(k){r(a).add("Basis-Layout-OnResizeElement");
a.onresize=i}else{var m=B.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});B.insert(a,m);m.onload=function(){(m.contentWindow.onresize=i)()}}}for(var D=y.document,J=D.defaultView,H=t.Class,B=t.dom,C=t.ua,F=Object.extend,G=t.cssom,r=t.cssom.classList,v=t.ui.Container,s=C.test("IE"),l=C.test("IE7+"),p=false,o=B.createElement(""),b=["","-webkit-"],e=0;e<b.length;e++)try{var c=b[e]+"box";
o.style.display=c;if(o.style.display==c){p=b[e];break}}catch(g){}var k=typeof o.onresize!="undefined",f=J&&J.getComputedStyle;o=function(){return B.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};o.className="basis.Layout.Helper";var j={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:false},q=H(null,{init:function(a,i,m){this.reset();this.setElement(a,i,m)},setElement:function(a,i,m){this.element=
B.get(a);this.offsetElement=m;i||this.recalc(this.offsetElement)},copy:function(a){["top","left","bottom","right","height","width","defined"].forEach(function(i){this[i]=a[i]},this)},reset:function(){F(this,j)},set:function(a,i){if(this.defined){switch(a.toLowerCase()){case "left":this.left=i;this.right=this.left+this.width;break;case "right":this.right=i;this.left=this.right-this.width;break;case "width":this.width=i;this.right=this.left+this.width;break;case "top":this.top=i;this.bottom=this.top+
this.height;break;case "bottom":this.bottom=i;this.top=this.bottom-this.height;break;case "height":this.height=i;this.bottom=this.top+this.height;break}if(this.width<=0||this.height<=0)this.reset()}return this},recalc:function(a){this.reset();var i=this.element;if(i){var m=i,u=D.documentElement;if(i.getBoundingClientRect){m=i.getBoundingClientRect();this.top=m.top;this.left=m.left;if(s)if(l){this.top+=u.scrollTop-u.clientTop;this.left+=u.scrollLeft-u.clientLeft}else if(i!=D.body){this.top-=D.body.clientTop-
D.body.scrollTop;this.left-=D.body.clientLeft-D.body.scrollLeft}if(a){a=new q(a);this.top-=a.top;this.left-=a.left;a.destroy()}}else if(D.getBoxObjectFor){var h=D.getBoxObjectFor(u);m=D.getBoxObjectFor(i);this.top=m.screenY-h.screenY;this.left=m.screenX-h.screenX;if(C.test("FF1.5-")){if(m=i.offsetParent){this.top-=m.scrollTop;this.left-=m.scrollLeft}if(m!=D.body){this.top+=u.scrollTop;this.left+=u.scrollLeft}}if(C.test("FF2+")){if(this.top){m=u.scrollTop;if(m>2){h=0;for(var d=Math.floor(Math.log(m)/
Math.LN2);d>=0;d-=3)h+=1<<d;if(m>h)this.top-=1}}if(this.left)this.left-=u.scrollLeft>1}if(a){a=new q(a);this.top-=a.top;this.left-=a.left;a.destroy()}}else if(i!=a){this.top=i.offsetTop;this.left=i.offsetLeft;this.top-=D.body.clientTop-D.body.scrollTop;for(this.left-=D.body.clientLeft-D.body.scrollLeft;(m=m.offsetParent)&&m!=a;){this.top+=m.offsetTop+m.clientTop-m.scrollTop;this.left+=m.offsetLeft+m.clientLeft-m.scrollLeft}}else this.top=this.left=0;this.width=i.offsetWidth;this.height=i.offsetHeight;
this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=true}return this.defined},intersection:function(a){if(!this.defined)return false;if(a instanceof q==false)a=new q(a);return a.defined&&a.right>this.left&&a.left<this.right&&a.bottom>this.top&&a.top<this.bottom},inside:function(a){if(!this.defined)return false;if(a instanceof q==false)a=new q(a);return a.defined&&a.left>=this.left&&a.right<=this.right&&a.bottom>=this.bottom&&a.top<=this.top},point:function(a){if(!this.defined)return false;
var i=a.left||a.x||0;a=a.top||a.y||0;return i>=this.left&&i<this.right&&a>=this.top&&a<this.bottom},power:function(a){if(!this.defined)return false;if(a=B.get(a)||this.element){B.setStyle(a,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"});return true}},destroy:function(){delete this.element}});b=H(q,{init:function(a,i,m){this.setBoxes(a,i,m)},setBoxes:function(a,i,m){this.boxA=a instanceof q?a:new q(a,true);this.boxB=i instanceof q?i:new q(i,true);m||this.recalc()},
recalc:function(){this.reset();if(!this.boxA.recalc()||!this.boxB.recalc())return false;if(this.boxA.intersection(this.boxB)){this.top=Math.max(this.boxA.top,this.boxB.top);this.left=Math.max(this.boxA.left,this.boxB.left);this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom);this.right=Math.min(this.boxA.right,this.boxB.right);this.width=this.right-this.left;this.height=this.bottom-this.top;if(this.width<=0||this.height<=0)this.reset();else this.defined=true}return this.defined}});e=H(q,{recalc:function(){this.reset();
var a=this.element;if(a){var i=a;this.width=a.clientWidth;this.height=a.clientHeight;if(a.getBoundingClientRect){var m=a.getBoundingClientRect();this.top=m.top;for(this.left=m.left;i=i.offsetParent;){this.top-=i.scrollTop;this.left-=i.scrollLeft}}else if(D.getBoxObjectFor){m=D.getBoxObjectFor(a);this.top=m.y;for(this.left=m.x;i=i.offsetParent;){this.top-=i.scrollTop;this.left-=i.scrollLeft}}else{m=new q(a);this.top=m.top+a.clientTop;this.left=m.left+a.clientLeft}this.bottom=this.top+this.height;this.right=
this.left+this.width;this.defined=true}return this.defined}});G.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});c=G.cssRule(".Basis-VerticalPanelStack");c.setStyle({overflow:"hidden"});if(p!==false){c.setProperty("display",p+"box");c.setProperty(p+"box-orient","vertical")}c=H(v,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(a){v.prototype.init.call(this,a);if(this.flex)p!==false&&G.setStyleProperty(this.element,p+"box-flex",this.flex);else p===false&&A(this.element,
function(){this.parentNode&&this.parentNode.realign()}.bind(this))}});H=H(v,{childClass:c,template:'<div class="Basis-VerticalPanelStack">'+(p?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(a){this.cssRule=G.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");v.prototype.init.call(this,a);if(p===false){this.realign();A(this.childNodesElement,function(){this.realign()}.bind(this))}},insertBefore:function(a,
i){if(a=v.prototype.insertBefore.call(this,a,i)){a.flex&&this.cssRule&&r(a.element).add(this.ruleClassName);this.realign();return a}},removeChild:function(a){if(v.prototype.removeChild.call(this,a)){a.flex&&this.cssRule&&r(a.element).remove(this.ruleClassName);this.realign();return a}},realign:function(){if(p===false){var a=this.element,i=this.lastChild.element,m=this.tmpl.ruller,u=(new q(i,false,a)).bottom-x(a,"paddingTop")-x(a,"borderTopWidth")||0;a=z(a,m);if(f)u+=x(i,"marginBottom");else{var h=
m.offsetHeight;m.style.height=i.currentStyle.marginBottom;u+=m.offsetHeight-h}if(u=a-u){i=0;u=u;for(a=0;h=this.childNodes[a];a++)if(h.flex){i++;u+=z(h.element,m)}i&&this.cssRule.setProperty("height",Math.max(0,u/i)+"px")}}}});t.namespace("basis.layout").extend({Box:q,Intersection:b,Viewport:e,VerticalPanel:c,VerticalPanelStack:H,Helper:o,addBlockResizeHandler:A})})(basis,this);
(function(t){var y=t.Class,x=t.dom.event,z=t.dom,A=Function.getter,D=t.cssom.classList,J=x.addGlobalHandler,H=x.removeGlobalHandler,B=t.EventObject,C=B.createEvent,F=t.layout,G=t.ua,r=t.ua.is("IE9-"),v,s={start:function(o){v&&s.over();v={dde:this,run:false,event:{initX:x.mouseX(o),initY:x.mouseY(o),deltaX:0,deltaY:0}};J("mousemove",s.move,v);J("mouseup",s.over,v);J("mousedown",s.over,v);x.cancelDefault(o);this.event_prepare(v.event)},move:function(o){var b=v.dde;if(!v.run){v.run=true;b.draging=true;
b.event_start(v.event)}if(b.axisX)v.event.deltaX=b.axisXproxy(x.mouseX(o)-v.event.initX);if(b.axisY)v.event.deltaY=b.axisYproxy(x.mouseY(o)-v.event.initY);b.event_move(v.event)},over:function(o){var b=v.dde;H("mousemove",s.move,v);H("mouseup",s.over,v);H("mousedown",s.over,v);b.draging=false;v.run&&b.event_over(v.event);v=null;x.kill(o)}},l={dragable:"Basis-Dragable",element:"Basis-DragDrop-DragElement"},p=y(B,{containerGetter:A("element"),element:null,trigger:null,baseElement:null,fixTop:true,fixRight:true,
fixBottom:true,fixLeft:true,axisX:true,axisY:true,axisXproxy:Function.$self,axisYproxy:Function.$self,event_prepare:C("prepare"),event_start:C("start"),event_move:C("move"),event_over:C("over"),init:function(o){B.prototype.init.call(this,o);o=this.element;var b=this.trigger;this.trigger=this.element=null;this.setElement(o,b);this.setBase(this.baseElement);t.Cleaner.add(this)},setElement:function(o,b){o=o&&z.get(o);b=b&&z.get(b)||o;if(this.trigger!=b){if(this.trigger){x.removeHandler(this.trigger,
"mousedown",s.start,this);r&&x.removeHandler(this.trigger,"selectstart",s.start,this)}if(this.trigger=b){x.addHandler(this.trigger,"mousedown",s.start,this);r&&x.addHandler(this.trigger,"selectstart",s.start,this)}}if(this.element!=o){this.element&&D(this.element).remove(l.dragable);(this.element=o)&&D(this.element).add(l.dragable)}},setBase:function(o){this.baseElement=z.get(o)||(G.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(v&&v.dde==this)},start:function(o){this.isDraging()||
s.start.call(this,o)},stop:function(){this.isDraging()&&s.over()},destroy:function(){t.Cleaner.remove(this);this.stop();B.prototype.destroy.call(this);this.setElement();this.setBase()}});y=y(p,{event_start:function(o){var b=this.containerGetter(this,o.initX,o.initY);if(b){var e=new F.Box(b),c=new F.Viewport(this.baseElement);D(b).add(l.element);o.element=b;o.box=e;o.viewport=c}p.prototype.event_start.call(this,o)},event_move:function(o){if(o.element){if(this.axisX){var b=o.box.left+o.deltaX;if(this.fixLeft&&
b<0)b=0;else if(this.fixRight&&b+o.box.width>o.viewport.width)b=o.viewport.width-o.box.width;o.element.style.left=b+"px"}if(this.axisY){b=o.box.top+o.deltaY;if(this.fixTop&&b<0)b=0;else if(this.fixBottom&&b+o.box.height>o.viewport.height)b=o.viewport.height-o.box.height;o.element.style.top=b+"px"}p.prototype.event_move.call(this,o)}},event_over:function(o){if(o.element){D(o.element).remove(l.element);p.prototype.event_over.call(this,o)}}});t.namespace("basis.dragdrop").extend({DragDropElement:p,MoveableElement:y})})(basis);
(function(){function t(b){if(b instanceof l)return b.set;b=b.nodeType;if(isNaN(b)==false)return b==1?s:"nodeValue"}var y=basis.Class,x=basis.dom,z=basis.Cleaner,A=Function.getter,D=basis.cssom.classList,J=basis.EventObject,H=basis.TimeEventManager,B=J.createEvent,C=basis.data,F=C.DataObject,G=C.STATE,r=y(F,{event_change:B("change"),locked:false,lockValue_:null,extendConstructor_:false,updateCount:0,init:function(b,e,c){F.prototype.init.call(this,{});e&&this.addHandler(e);this.proxy=typeof c=="function"?
c:Function.$self;this.initValue=this.value=this.proxy(b)},set:function(b,e){var c=this.value,g=this.proxy?this.proxy(b):g,k=false;if(g!==c){this.value=g;k=true;this.updateCount+=1}if(!this.locked&&(k||e))this.event_change(g,c);return k},lock:function(){if(!this.locked){this.lockValue_=this.value;this.locked=true}},unlock:function(){if(this.locked){this.locked=false;this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)}},update:function(b,e){return this.set(b,e)},reset:function(){this.set(this.initValue)},
destroy:function(){F.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),v={destroy:function(b){this.removeLink(b)}},s=function(b){x.insert(x.clear(this),b)},l=y(r,{links_:null,event_change:function(b,e){r.prototype.event_change.call(this,b,e);if(!(!this.links_.length||z.globalDestroy))for(var c=0,g;g=this.links_[c++];)this.power_(g,e)},init:function(b,e,c){r.prototype.init.call(this,b,e,c);this.links_=[];z.add(this)},addLink:function(b,
e,c){if(typeof b!="object"&&b instanceof Object==false)throw new Error("basis.data.property: Link to undefined object ignored");if(e==null)e=t(b);if(typeof c!="function")c=A(Function.$self,c);e={object:b,format:c,field:e,isEventObject:b instanceof J};this.links_.push(e);e.isEventObject&&b.addHandler(v,this);this.power_(e);return b},addLinkShortcut:function(b,e,c){return this.addLink(b,l.shortcut[e],c)},removeLink:function(b,e){if(this.links_!=null){var c=arguments.length<2;if(!c&&e==null)e=t(b);for(var g=
0,k=0,f;f=this.links_[k];k++)if(f.object===b&&(c||e==f.field))f.isEventObject&&f.object.removeHandler(v,this);else this.links_[g++]=f;this.links_.length=g}},clear:function(){for(var b=0,e;e=this.links_[b];b++)e.isEventObject&&e.object.removeHandler(v,this);this.links_.clear()},power_:function(b,e){var c=b.field;if(c!=null){var g=b.format(this.value),k=b.object;if(typeof c=="function")c.call(k,g,arguments.length<2?g:b.format(e));else k[c]=g}},destroy:function(){this.clear();r.prototype.destroy.call(this);
this.links_=null;z.remove(this)}});l.shortcut={className:function(b,e){D(this).replace(e,b)},show:function(b){x.display(this,!!b)},hide:function(b){x.display(this,!b)},disable:function(b){this.disabled=!!b},enable:function(b){this.disabled=!b}};var p=[G.READY,G.DEPRECATED,G.UNDEFINED,G.ERROR,G.PROCESSING],o={stateChanged:function(){this.fire(false,true)},update:function(){this.fire(true)},change:function(){this.fire(true)},destroy:function(b){this.remove(b)}};y=y(l,{calculateValue:function(){return this.value+
1},objects:[],timer_:null,valueChanged_:false,stateChanged_:true,state:G.UNDEFINED,extendConstructor_:true,init:function(){var b=this.handler;delete this.handler;l.prototype.init.call(this,this.value||0,b,this.proxy);if(this.objects.length){b=this.objects;this.objects=[];this.lock();this.add.apply(this,b);this.unlock()}else this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();z.add(this)},add:function(){for(var b=0,e=arguments.length;b<e;b++){var c=arguments[b];
if(c instanceof F)this.objects.add(c)&&c.addHandler(o,this);else throw new Error("basis.data.property: Instance of DataObject required");}this.fire(true,true)},remove:function(b){this.objects.remove(b)&&b.removeHandler(o,this);this.fire(true,true)},clear:function(){for(var b=0,e;e=this.objects[b];b++)e.removeHandler(o,this);this.objects.clear();this.fire(true,true)},fire:function(b,e){if(!this.locked){this.valueChanged_=this.valueChanged_||!!b;this.stateChanged_=this.stateChanged_||!!e;if(!this.timer_&&
(this.valueChanged_||this.stateChanged_)){this.timer_=true;H.add(this,"update",Date.now())}}},lock:function(){this.locked=true},unlock:function(){this.locked=false},update:function(){delete this.timer_;H.remove(this,"update");if(!z.globalDestroy){this.valueChanged_&&this.set(this.calculateValue());if(this.stateChanged_){var b=this.objects.length;if(b){for(var e=-2,c,g=0;g<b;g++){var k=this.objects[g],f=p.indexOf(String(k.state));if(f>e){c=k;e=f}}c&&this.setState(c.state,c.state.data)}else this.setState(G.UNDEFINED)}}this.stateChanged_=
this.valueChanged_=false},destroy:function(){this.lock();this.clear();H.remove(this,"update");l.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:y,AbstractProperty:r,Property:l,PropertySet:y})})();
(function(t){function y(B,C){var F=Date.now()-B;return F>=C?1:F/C}var x=t.Class,z=t.dom,A=t.data.property.Property,D=t.EventObject.createEvent,J=x(A,{duration:1E3,interval:50,startTime:0,timer:null,started:false,event_start:D("start"),event_finish:D("finish"),event_invert:D("invert"),event_change:function(B,C){B==0&&this.event_start();A.prototype.event_change.call(this,B,C);B==1&&this.event_finish()},extendConstructor_:true,init:function(B){this.run=this.run.bind(this);A.prototype.init.call(this,
B)},start:function(B){if(this.started)B&&this.invert();else{this.startTime=Date.now();this.started=true;this.run()}},run:function(){clearTimeout(this.timer);if(this.started){var B=y(this.startTime,this.duration);if(B>=1)this.stop();else{this.set(B);this.timer=setTimeout(this.run,this.interval)}}},invert:function(){this.event_invert();if(this.started){var B=y(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-B);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started){this.started=
false;this.set(1)}},destroy:function(){this.stop();this.clear();A.prototype.destroy.call()}}),H=x(null,{thread:null,setter:Function.$null,notRevert:false,timeFunction:Function.$self,init:function(B,C,F,G,r){this.thread=B instanceof J?B:new J(B);this.setRange(F,G);this.setter=C;this.notInvert=r;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(v){this.setter(this.start+this.range*this.timeFunction(v))},finish:function(){if(!this.notInvert){this.start+=
this.range;this.range*=-1}},destroy:this.destroy},this)},setRange:function(B,C){this.start=B;this.range=C-B},destroy:function(){delete this.thread}});x={CSS:{FadeIn:function(B,C){return new H(B,function(F){z.setStyle(C,{opacity:F})},0,1)},FadeOut:function(B,C){return new H(B,function(F){z.setStyle(C,{opacity:F})},1,0)}}};t.namespace("basis.animation").extend({Thread:J,Modificator:H,FX:x})})(basis);
(function(t){function y(c,g,k){return k?e?c.createElementNS(k,g):c.createNode(1,g,k):c.createElement(g)}function x(c,g,k,f){c=k?e?c.createAttributeNS(k,g):c.createNode(2,g,k):c.createAttribute(g);c.nodeValue=f;return c}function z(c,g){return c.setAttributeNodeNS?c.setAttributeNodeNS(g):c.setAttributeNode(g)}function A(c,g,k){z(c,x(c.ownerDocument,o.PREFIX+(g?":"+g:""),o.NAMESPACE,k))}function D(c,g){return c.createTextNode(String(g))}function J(c,g){var k=c.nodeType,f=c.attributes,j=c.firstChild;
if(j){if(j.nodeType!=G&&j===c.lastChild)return j.nodeValue}else{var q=f&&f[0];if(k==G){if(!q)return"";if(f.length==1&&(q.baseName||q.localName)==p&&q.namespaceURI==s)return null}else if(!q)return null}k={};q=[];var a=0,i,m,u;if(j=j){do a=q.push(j);while(j=j.nextSibling)}if(f)for(j=0;u=f[j];j++)q.push(u);g||(g={});for(j=0;i=q[j];j++){f=i.nodeName;u=g[f];if(j<a)i=J(i,g);else{if(f=="xmlns")continue;i=i.nodeValue}for(;u;){if(u.storeName)i[u.storeName]=f;if(u.rename){f=u.rename;u=g[f]}else{if(u.format)i=
u.format(i);if(!k[f]&&u.forceArray)i=[i];break}}if(f in k)if((m=k[f])&&m.push)m.push(i);else k[f]=[m,i];else k[f]=i}return k}function H(c,g,k,f){if(String(g).charAt(0)=="@")return f==null?f:x(c,g.substr(1),"",String(f));else{g=y(c,g.toString(),f&&f.xmlns||g.namespace||k);if(typeof f=="undefined"||f===null)z(g,x(c,p,s,"true"));else if(typeof f=="string"||typeof f=="number"||typeof f=="function"||typeof f=="boolean"||f.constructor===Date||f.constructor===RegExp)g.appendChild(D(c,f));else{k=f.xmlns||
k;f.xmlns&&o.BAD_SUPPORT&&A(g,"",k);for(var j in f){var q=f[j];if(!(j=="xmlns"||typeof q=="function"))if(q&&Array.isArray(q))for(var a=0;a<q.length;a++)g.appendChild(H(c,j,k,q[a]));else{if(q&&typeof q=="object"&&q.toString!==Object.prototype.toString)q=q.toString();if(q=H(c,j,k,q))q.nodeType==r?z(g,q):g.appendChild(q)}}}return g}}var B=t.dom,C=t.Class,F=t.ua,G=B.ELEMENT_NODE,r=B.ATTRIBUTE_NODE;C=C(null,{init:function(c,g,k){this.localpart=c;this.namespace=g||"";this.prefix=k||""},toString:function(){return this.prefix?
this.prefix+":"+this.localpart:this.localpart}});var v=String("http://www.w3.org/2001/XMLSchema"),s=String("http://www.w3.org/2001/XMLSchema-instance"),l=String("http://www.w3.org/2000/xmlns/"),p="nil",o={PREFIX:"xmlns",NAMESPACE:l,BAD_SUPPORT:F.test("webkit528.16-")||F.test("opera9-")},b="native",e=true;F=function(){var c=document.implementation;if(c&&c.createDocument)return function(j,q){var a=c.createDocument(j,q,null);if(a.charset&&a.charset!=document.charset)a.charset=document.charset;return a};
if(window.ActiveXObject)for(var g=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],k=0;k<g.length;k++)try{if(new ActiveXObject(g[k])){b=g[k];e=false;return function(j,q){var a=new ActiveXObject(b);a.documentElement=y(a,q,j);return a}}}catch(f){}throw new Error("Browser doesn't support for XML document!");}();t.namespace("basis.xml").extend({NAMESPACE:{XMLShema:v,XMLShemaInstance:s,Namespace:l},XMLNS:o,QName:C,getElementsByTagNameNS:function(c,g,k){if(c.getElementsByTagNameNS)return c.getElementsByTagNameNS(k,
g);var f=[];c.ownerDocument.setProperty("SelectionNamespaces",'xmlns:x="'+k+'"');c=c.selectNodes("//x:"+g);g=0;for(var j;j=c[g++];)j.namespaceURI==k&&f.push(j);return f},addNamespace:A,createDocument:F,createElementNS:y,createAttributeNS:x,setAttributeNodeNS:z,createText:D,createCDATA:function(c,g){return c.createCDATASection(g)},XML2Object:J,XML2String:function(c){if(typeof XMLSerializer!="undefined")return(new XMLSerializer).serializeToString(c);if(typeof c.xml=="string")return c.xml;if(c.nodeType==
B.DOCUMENT_NODE)c=c.documentElement;return B.outerHTML(c)},Object2XML:H})})(basis);
(function(t){function y(r,v){return r<<v|r>>>32-v}function x(r){var v=[];do{v.push((r&15).toString(16));r>>=4}while(r);v.length&1&&v.push("0");return v.reverse().join("")}function z(r){if(typeof r=="number")return x(r);var v=[];v=Array.isArray(r)?r.map(z):String(r).toArray().map(function(s){return x(s.charCodeAt(0))});return v.join("")}t.namespace("basis.crypt",function(r){F=r||"";return G});var A=Array.create(255,function(r){return String.fromCharCode(r)}),D=function(){function r(s){for(var l="",
p=s.length,o=0;o<p;o++){var b=s.charCodeAt(o);l+=b<128?A[b]:b<2048?A[b>>6|192]+A[b&63|128]:A[b>>12|224]+A[b>>6&63|128]+A[b&63|128]}return l}function v(s){for(var l="",p=s.length,o,b,e,c=0;c<p;){o=s.charCodeAt(c++);if(o<128)l+=A[o];else{b=s.charCodeAt(c++);if(o&32){e=s.charCodeAt(c++);l+=String.fromCharCode((o&15)<<12|(b&63)<<6|e&63)}else l+=String.fromCharCode((o&31)<<6|b&63)}}return l}return t.namespace("basis.crypt.UTF16").extend({toBytes:function(s){for(var l=[],p=s.length,o=0;o<p;o++){var b=s.charCodeAt(o);
l.push(b&255,b>>8)}return l},fromBytes:function(s){for(var l="",p=s.length,o,b,e=0;e<p;){o=s[e++]||0;b=s[e++]||0;l+=String.fromCharCode(b<<8|o)}return l},toUTF8:r,fromUTF8:v,toUTF8Bytes:function(s){return J.toBytes(r(s))},fromUTF8Bytes:function(s){return v(J.fromBytes(s))}})}(),J=function(){return t.namespace("basis.crypt.UTF8").extend({toBytes:function(r){for(var v=r.length,s=new Array(v),l=0;l<v;l++)s[l]=r.charCodeAt(l);return s},fromBytes:function(r){for(var v=r.length,s="",l=0;l<v;l++)s+=A[r[l]];
return s},toUTF16:function(r){return D.fromUTF8(r)},fromUTF16:function(r){return D.toUTF8(r)},toUTF16Bytes:function(r){return D.toBytes(D.fromUTF8(r))},fromUTF16Bytes:function(r){return D.toUTF8(D.fromBytes(r))}})}(),H=function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),v={};r.forEach(function(s,l){v[s]=l});return t.namespace("basis.crypt.Base64").extend({encode:function(s,l){if(s.constructor!=Array)s=l?D.toUTF8Bytes(s):D.toBytes(s);for(var p=s.length,o=
0,b="",e,c,g,k,f;o<p;){e=s[o++];c=s[o++];g=s[o++];k=(c&15)<<2|g>>6;f=g&63;if(c==undefined)k=f=64;else if(g==undefined)f=64;b+=r[e>>2]+r[(e&3)<<4|c>>4]+r[k]+r[f]}return b},decode:function(s,l){var p=[],o,b,e,c,g=0;s=s.replace(/[^a-z0-9\+\/]/ig,"");for(var k=s.length;g<k;){o=v[s.charAt(g++)];b=v[s.charAt(g++)];e=v[s.charAt(g++)];c=v[s.charAt(g++)];p.push(o<<2|b>>4,(b&15)<<4|e>>2,(e&3)<<6|c)}if(e==null||e==64)p.pop();if(c==null||c==64)p.pop();return l?D.fromUTF8Bytes(p):D.fromBytes(p)}})}(),B=function(){function r(l){for(var p=
[],o=3;o>=0;o--)p.push(l>>o*8&255);return p}var v=[1518500249,1859775393,2400959708,3395469782],s=[function(l,p,o){return o^l&(p^o)},function(l,p,o){return l^p^o},function(l,p,o){return l&p|o&(l|p)},function(l,p,o){return p^l^o}];return function(l,p){if(l.constructor!=Array)l=p?D.toUTF8Bytes(l):D.toBytes(l);for(var o=l.length,b=[],e=0;e<o;e++)b[e>>2]|=l[e]<<(3-(e&3)<<3);if(o&3)b[o>>2]|=Math.pow(2,(4-(o&3)<<3)-1);else b[o>>2]=2147483648;b.push.apply(b,Array.create(((b.length&15)>14?30:14)-(b.length&
15),0));b.push(o>>>29);b.push(o<<3&4294967295);b.reverse();o=[1732584193,4023233417,2562383102,271733878,3285377520];for(var c=Array.from(o),g,k=b.length>>4,f=new Array(80);k--;){for(e=0;e<16;e++)f[e]=b.pop();for(e=16;e<80;e++)f[e]=y(f[e-3]^f[e-8]^f[e-14]^f[e-16],1);for(e=0;e<80;e++){g=Math.floor(e/20);o[4]=y(o[0],5)+s[g](o[1],o[2],o[3])+o[4]+f[e]+v[g]&4294967295;o[1]=y(o[1],30);o.unshift(o.pop())}for(e=0;e<5;e++)o[e]=c[e]=o[e]+c[e]&4294967295}return o.map(r).flatten()}}(),C=function(){function r(e){for(var c=
arguments,g=c.length,k=e&65535,f=e>>16,j=1;j<g;j++){var q=c[j];k+=q&65535;f+=(q>>16)+(k>>16);k&=65535}return f<<16|k&65535}function v(e){for(var c=[],g=0;g<4;g++)c.push(e>>g*8&255);return c}var s=Math.pow(2,32),l,p=[],o=[],b=[function(e,c,g){return g^e&(c^g)},function(e,c,g){return c^g&(c^e)},function(e,c,g){return e^c^g},function(e,c,g){return c^(e|~g)}];return function(e,c){if(!l){l=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var g=
0;g<64;g++){p[g]=Math.floor(Math.abs(Math.sin(g+1))*s);switch(g>>4){case 0:o[g]=g;break;case 1:o[g]=g*5+1&15;break;case 2:o[g]=g*3+5&15;break;case 3:o[g]=g*7&15;break}}}if(e.constructor!=Array)e=c?D.toUTF8Bytes(e):D.toBytes(e);g=[];for(var k=e.length,f=0;f<k;f++)g[f>>2]|=e[f]<<((f&3)<<3);g[k>>2]|=128<<((k&3)<<3);g.push.apply(g,Array(((g.length&15)>14?30:14)-(g.length&15)));g.push(k<<3&4294967295);g.push(k>>>29);k=[1732584193,4023233417,2562383102,271733878];for(var j=Array.from(k),q=g.length>>4;q--;){for(f=
0;f<64;f++){k[0]=r(y(r(k[0],b[f>>4](k[1],k[2],k[3]),g[o[f]],p[f]),l[f]),k[1]);k.unshift(k.pop())}for(f=0;f<4;f++)k[f]=j[f]=r(k[f],j[f])}return k.map(v).flatten()}}(),F="",G={};Object.iterate({sha1:function(r){return B(this,r)},sha1hex:function(r){return z(B(this,r))},md5:function(r){return C(this,r)},md5hex:function(r){return z(C(this,r))},base64:function(r){return H.encode(this,r)},base64decode:function(r){return H.encode(this,r)},hex:function(){return z(this)}},function(r,v){G[r]=function(s){s=
v.call(F,s);return F=Object.extend(typeof s!="object"?Object(s):s,G)}});t.namespace("basis.crypt").extend({HEX:z,SHA1:B,MD5:C})})(basis);
(function(t){function y(f,j){if(!f.length)return 0;var q,a,i=0,m=f.length-1;do{q=i+m>>1;a=f[q]||0;if(j<a)m=q-1;else if(j>a)i=q+1;else return j==a?q:0}while(i<=m);return q+(a<j)}function x(f,j){if(!f.length)return 0;var q,a,i,m=0,u=f.length-1;do{q=m+u>>1;i=f[q].value||0;if(i===a){i=f[q].object.eventObjectId;a=j.object.eventObjectId}else a=j.value||0;if(a<i)u=q-1;else if(a>i)m=q+1;else return a==i?q:0}while(m<=u);return q+(i<a)}function z(){for(var f=Object.slice(this.item_),j=this.index_.slice(this.offset,
this.offset+this.limit),q=[],a=0,i;i=j[a];a++){var m=i.object.eventObjectId;if(f[m])delete f[m];else q.push(i.object)}if(f=getDelta(q,values(f)))AggregateDataset.prototype.event_datasetChanged.call(this,this,f)}function A(f,j){f=Function.getter(f);var q=j+"_"+f.getterIdx_,a=s[q];if(!a){a=s[q]=this;this.indexType=j;this.indexClass=v[j];this.getter=f;this.key=q;this.createInstance=function(i){if(i instanceof G){var m=i.indexes&&i.indexes[this.key];if(!m){m=new this.indexClass(this.getter);m.addHandler(k,
i);m.key=this.key}return m}}}return a}function D(f,j,q){var a=f.indexCache_;f.lock();if(j)for(var i=0,m;m=j[i++];){var u=f.valueGetter(m);a[m.eventObjectId]=u;f.add(m,u)}if(q)for(i=0;m=q[i++];){f.remove(m,a[m.eventObjectId]);delete a[m.eventObjectId]}f.unlock()}var J=t.Class,H=t.TimeEventManager,B=t.data,C=B.KeyObjectMap,F=B.property.Property,G=B.AbstractDataset,r=B.Dataset.MapReduce;B=J(G,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(f,j){var q;if(q=j.inserted)for(var a=
0;a<q.length;a++){var i=q[a];i={value:this.valueGetter(i),object:i};var m=x(this.index_,i);this.index_.splice(m,0,i)}if(q=j.deleted)for(a=0;a<q.length;a++){i=q[a];i={value:this.valueGetter(i),object:i};m=x(this.index_,i);this.index_.splice(m,1)}z.call(this)},init:function(f){this.index_=[];AggregateDataset.prototype.init.call(this,f)},setRange:function(f,j){this.offset=f;this.limit=j;z.call(this)}});var v=J(F,{autoDestroy:true,valueGetter:Function.$null,dataSource:null,init:function(f){F.prototype.init.call(this,
this.value||0);this.indexCache_={};this.valueGetter=f},add:function(){},remove:function(){},upd:function(){}});v.Sum=J(v,{add:function(f,j){this.value+=j},remove:function(f,j){this.value-=j},upd:function(f,j,q){this.set(this.value+j-q)}});v.Avg=J(v,{sum_:0,count_:0,add:function(f,j){this.sum_+=j;this.count_+=1;this.value=this.sum_/this.count_},remove:function(f,j){this.sum_-=j;this.count_-=1;this.value=this.count_?this.sum_/this.count_:0},upd:function(f,j,q){this.sum_+=j-q;this.set(this.sum_/this.count_)}});
v.Count=J(v,{valueGetter:Function.$true,add:function(f,j){if(j)this.value+=1},remove:function(f,j){if(j)this.value-=1},upd:function(f,j){this.set(this.value+(j?1:-1))}});v.Max=J(v,{init:function(f,j){this.stack=[];v.prototype.init.call(this,f,j)},add:function(f,j){this.stack.splice(y(this.stack,j),0,j);this.value=this.stack[this.stack.length-1]},remove:function(f,j){this.stack.remove(j);this.value=this.stack[this.stack.length-1]},upd:function(f,j,q){this.stack.splice(y(this.stack,q),1);this.stack.splice(y(this.stack,
j),0,j);this.set(this.stack[this.stack.length-1])}});v.Min=J(v,{init:function(f,j){this.stack=[];v.prototype.init.call(this,f,j)},add:function(f,j){this.stack.splice(y(this.stack,j),0,j);this.value=this.stack[0]},remove:function(f,j){this.stack.remove(j);this.value=this.stack[0]},upd:function(f,j,q){this.stack.splice(y(this.stack,q),1);this.stack.splice(y(this.stack,j),0,j);this.set(this.stack[0])}});var s={},l=function(f){return function(j){return new A(j,f)}},p=l("Sum"),o=l("Avg"),b=l("Count"),
e=l("Min");l=l("Max");var c={update:function(f){var j,q,a,i=f.eventObjectId;for(var m in this.indexes){a=this.indexes[m];j=a.indexCache_[i];q=a.valueGetter(f);if(q!==j){a.upd(f,q,j);a.indexCache_[i]=q}}}},g={datasetChanged:function(f,j){if(j.inserted)for(var q=0;f=j.inserted[q++];)f.addHandler(c,this);if(j.deleted)for(q=0;f=j.deleted[q++];)f.removeHandler(c,this);for(var a in this.indexes)D(this.indexes[a],j.inserted,j.deleted)},destroy:function(){for(var f in this.indexes)this.indexes[f].destroy()}},
k={destroy:function(f){this.removeIndex(f)}};G.prototype.createIndex=function(f){if(f instanceof A!=false){if(!this.indexes){this.indexes={};this.addHandler(g);g.datasetChanged.call(this,this,{inserted:this.getItems()})}var j=f.key;if(!this.indexes[j]){f=f.createInstance(this);this.indexes[j]=f;D(f,this.getItems())}return this.indexes[j]}};G.prototype.removeIndex=function(f){if(this.indexes&&this.indexes[f.key]){delete this.indexes[f.key];f.destroy();for(var j in this.indexes)return;this.removeHandler(g);
delete this.indexes}};J=J(r,{calcs:null,indexes:null,indexes_:null,timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(f,j){r.prototype.event_sourceChanged.call(this,f,j);var q;for(var a in this.indexes_){q=this.indexes_[a];if(j){this.removeIndex(a);j.removeIndex(this.indexes[a])}this.source&&this.addIndex(a,this.source.createIndex(q))}},listen:{sourceObject:{update:function(f,j){r.prototype.listen.sourceObject.update.call(this,f,j);this.stat.sourceObjectUpdate++;
this.sourceMap_[f.eventObjectId].updated=true;this.fireUpdate()}},index:{change:function(f){this.context.indexValues[this.key]=f;this.context.stat.indexUpdate++;this.context.indexUpdated=true;this.context.fireUpdate()}},member:{subscribersChanged:function(f,j){this.stat.subscribersChanged++;if(f.subscriberCount>0&&j==0){this.stat.subscribersChangedSucc++;this.calcMember(f)}}}},map:function(f){return this.keyMap.get(f,true)},addMemberRef:function(f,j){this.memberSourceMap[f.eventObjectId]=j.eventObjectId;
f.addHandler(this.listen.member,this);this.sourceMap_[j.eventObjectId].updated=true;f.subscriberCount>0&&this.calcMember(f)},removeMemberRef:function(f){delete this.memberSourceMap[f.eventObjectId];f.removeHandler(this.listen.member,this)},init:function(f){this.indexUpdated=false;this.indexesBind_={};this.memberSourceMap={};var j=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||this.keyMap instanceof C==false)this.keyMap=new C(Object.complete({create:function(q,
a){return new this.itemClass(a)}},this.keyMap));this.stat={applyCount:0,indexUpdate:0,tryCalcMember:0,tryUpdateMember:0,calcCount:0,updateMember:0,fireUpdate:0,fireUpdateSucc:0,subscribersChanged:0,subscribersChangedSucc:0,update:0,sourceObjectUpdate:0};r.prototype.init.call(this,f);Object.iterate(j,this.addIndex,this)},addIndex:function(f,j){if(!this.indexes[f]){if(j instanceof A)if(this.indexes_[f])return;else{this.indexes_[f]=j;j=this.source&&this.source.createIndex(j)}if(j instanceof v){this.indexValues[f]=
j.value;this.indexes[f]=j;this.indexesBind_[f]={key:f,context:this};j.addHandler(this.listen.index,this.indexesBind_[f]);this.listen.index.change.call(this.indexesBind_[f],j.value)}}},removeIndex:function(f){if(this.indexes_[f]||this.indexes[f]){this.indexes[f]&&this.indexes[f].removeHandler(this.listen.index,this.indexesBind_[f]);delete this.indexValues[f];delete this.indexesBind_[f];delete this.indexes[f];delete this.indexes_[f]}},addCalc:function(f,j){this.calcs[f]=j;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},
fireUpdate:function(){this.stat.fireUpdate++;if(!this.timer_){this.stat.fireUpdateSucc++;this.timer_=true;H.add(this,"apply",Date.now())}},apply:function(){this.stat.applyCount++;for(var f in this.item_)this.calcMember(this.item_[f]);this.timer_=this.indexUpdated=false},calcMember:function(f){this.stat.tryCalcMember++;var j=this.sourceMap_[this.memberSourceMap[f.eventObjectId]];if(f.subscriberCount&&(j.updated||this.indexUpdated)){this.stat.tryUpdateMember++;j.updated=false;var q={},a,i;for(var m in this.calcs){this.stat.calcCount++;
a=this.calcs[m](j.sourceObject.data,this.indexValues);if(f.data[m]!==a&&(!isNaN(a)||!isNaN(f.data[m]))){q[m]=a;i=true}}if(i){this.stat.updateMember++;f.update(q)}}},getMember:function(f){return this.keyMap.get(f,true)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var f in this.indexes)this.removeIndexConstructor(f);r.prototype.destroy.call(this)}});t.namespace("basis.data.index").extend({IndexedDataset:B,
IndexConstructor:A,Index:v,Sum:p,Avg:o,Count:b,Max:l,Min:e,IndexMap:J})})(basis);
(function(t){function y(I){f[I]=f[I]||0;return I+f[I]++}function x(){var I=Array.from(arguments),L=I.pop();typeof L!="function"&&console.warn("Last argument for calculate field constructor must be a function");for(var M=[],S=[],V=0,Z;V<I.length;V++){Z=I[V].quote('"');M.push(Z+" in delta");S.push("data["+Z+"]")}L=(new Function("calc","return function(delta, data, oldValue){"+(M.length?"if ("+M.join(" || ")+")":"")+"return calc("+S.join(", ")+");"+(M.length?"return oldValue;":"")+"}"))(L);L.args=I;
L.isCalcField=true;return L}function z(){return x.apply(null,Array.from(arguments).concat(function(){for(var I=[],L=arguments.length;L-- >0;){if(arguments[L]==null)return null;I.push(arguments[L])}return I.join("-")}))}var A=t.Class,D=t.Cleaner,J=Object.extend,H=Function.$self,B=Function.getter,C=t.data,F=t.EventObject,G=C.Dataset,r=C.Collection,v=C.Grouping,s=C.DataObject,l=C.STATE,p={},o={string:1,number:1},b=[],e=function(I){return isNaN(I)?null:Number(I)},c=function(I){return isNaN(I)?null:Number(I)},
g=function(I){return isNaN(I)?null:parseInt(I)},k=function(I){return I==null?null:String(I)},f={},j=t.Class(null,{init:function(I){var L=this.index={};this.normalize=I;this.valueWrapper=function(M,S){var V=I(M,S);if(V!==S&&L[V])return S;return V};this.calcWrapper=function(M,S){var V=I(M,S);if(V!==S&&L[V])throw"Duplicate value for index "+S+" => "+M;return V};D.add(this)},get:function(I,L){var M=this.index[I];if(M&&(!L||M instanceof L))return M},add:function(I,L){var M=this.index[I];if(L&&(!M||M===
L)){this.index[I]=L;return true}},remove:function(I,L){if(this.index[I]===L){delete this.index[I];return true}},destroy:function(){this.index=null}});C=function(I,L){return function(M){return I.prototype[L].call(this,M&&M.map(this.wrapper))}};var q=function(I,L){return function(M){if(!this.name)this.name=y(L);I.prototype.init.call(this,M)}},a=function(I){return function(L,M){G.setAccumulateState(true);L=(L||[]).map(this.wrapper);G.setAccumulateState(false);return I.prototype.sync.call(this,L,M)}},
i=A(G,{wrapper:Function.$self,init:q(G,"EntitySet"),sync:a(G),set:C(G,"set"),add:C(G,"add"),remove:C(G,"remove"),destroy:function(){G.prototype.destroy.call(this);delete this.wrapper}}),m=A(i,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),u=A(r,{init:q(r,"EntityCollection"),sync:a(r)});u.sourceHandler=r.sourceHandler;var h=A(v,{subsetClass:m,init:q(v,"EntityGrouping"),sync:a(v),getSubset:function(I,L){var M=v.prototype.getSubset.call(this,I,L);if(M)M.wrapper=
this.wrapper;return M}}),d=function(I){if(this instanceof d){var L=new n(I||H);return function(M,S){if(M!=null){S instanceof i||(S=L.createEntitySet());S.set(M instanceof G?M.getItems():Array.from(M));return S}else return null}}};d.className="basis.entity.EntitySetWrapper";var n=A(null,{init:function(I){this.wrapper=I},createEntitySet:function(){return new i({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),w=function(I){if(this instanceof w){var L=
function(Q,W){if(Q!=null){if(Q===W||Q.entityType===M)return Q;var ba,ca=M.idField;if(o[typeof Q]){if(!ca)return;ba=Q;Q={};Q[ca]=ba}else if(M.compositeKey)ba=M.compositeKey(Q,Q);else if(ca)ba=Q[ca];else if(Z){W=M.singleton;if(!W)return M.singleton=new V(Q)}if(ba!=null&&S)W=S.get(ba,M.entityClass);if(W&&W.entityType===M)W.update(Q);else W=new V(Q);return W}else return M.singleton},M=new P(I||{},L),S=M.index__,V=M.entityClass,Z=M.isSingleton;J(L,{toString:function(){return this.typeName+"()"},entityType:M,
type:L,typeName:M.name,index:S,reader:function(Q){return M.reader(Q)},get:function(Q){return M.get(Q)},addField:function(Q,W){M.addField(Q,W)},all:M.all,createCollection:function(Q,W,ba){var ca=M.collection_[Q];if(!ca&&W)return M.collection_[Q]=new u({wrapper:L,source:ba||M.all,rule:W});return ca},getCollection:function(Q){return M.collection_[Q]},createGrouping:function(Q,W,ba){var ca=M.grouping_[Q];if(!ca&&W)return M.grouping_[Q]=new h({wrapper:L,source:ba||M.all,rule:W});return ca},getGrouping:function(Q){return M.grouping_[Q]},
getSlot:function(Q,W){return M.getSlot(Q,W)}});return L}};w.className="basis.entity.EntityTypeWrapper";var E=B("singleton"),K={};A(s,{});var P=A(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:false,index__:null,slot_:null,init:function(I,L){this.name=I.name||y(this.name);this.index__=I.index;this.idFields={};b.push(this);this.isSingleton=I.isSingleton;this.wrapper=L;this.all=new m(Object.extend(I.all||{},{wrapper:L}));this.slot_={};if(I.extensible)this.extensible=true;this.fields=
{};this.defaults={};this.aliases={};this.getters={};Object.iterate(I.fields,this.addField,this);I.constrains&&I.constrains.forEach(function(S){this.addCalcField(null,S)},this);if(this.isSingleton)this.get=E;I.aliases&&Object.iterate(I.aliases,this.addAlias,this);this.collection_={};if(I.collections)for(var M in I.collections)this.collection_[M]=new u({name:M,wrapper:L,source:this.all,rule:I.collections[M]||Function.$true});this.grouping_={};if(I.groupings)for(M in I.groupings)this.grouping_[M]=new h({name:M,
wrapper:L,source:this.all,rule:I.groupings[M]||Function.$true});this.entityClass=U(this,this.all,this.index__,this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:L,typeName:this.name,getId:function(){return this.__id__}})},reader:function(I){var L={};if(o[typeof I]){if(this.idField){L[this.idField]=I;return L}return null}if(!I||I==null)return null;for(var M in I){var S=M in this.aliases?this.aliases[M]:"";if(S&&S in this.fields)L[S]=this.fields[S].reader?this.fields[S].reader(I[M]):
I[M]}return L},addAlias:function(I,L){if(L in this.fields)if(I in this.aliases==false)this.aliases[I]=L},addField:function(I,L){if(!this.all.itemCount){this.aliases[I]=I;if(typeof L=="function")L={type:L};if("type"in L&&typeof L.type!="function")L.type=H;var M=L.type||H;if([e,c,g,k].has(M))L.id=true;if(L.id){if(!this.index__)this.index__=new j(String);this.idFields[I]=true;if(this.idField||this.compositeKey){this.idField=null;this.compositeKey=z.apply(null,Object.keys(this.idFields))}else this.idField=
I}if(L.calc)this.addCalcField(I,L.calc,void 0);else this.fields[I]=M;this.defaults[I]="defValue"in L?L.defValue:M();this.getters["get_"+I]=function(){return this.data[I]};K[I]||(K[I]={destroy:function(){this.set(I,null)}})}},addCalcField:function(I,L,M){if(!(I&&this.fields[I])){if(!this.calcs)this.calcs=[];for(var S={args:L.args,wrapper:!M?L:function(W,ba,ca){return M(L(W,ba,ca))}},V=this.calcs.length,Z=0,Q=0;Q<this.calcs.length;Q++)if(L.args.has(this.calcs[Q].key))Z=Q+1;if(I){S.key=I;for(Q=0;Q<this.calcs.length;Q++)if(this.calcs[Q].args.has(I)){V=
Q;break}if(Z>V)return;if(this.idField&&I==this.idField)this.compositeKey=L;this.fields[I]=function(W,ba){typeof console!="undefined"&&console.log("Calculate fields are readonly");return ba}}else V=Z;this.calcs.splice(Math.min(V,Z),0,S)}},get:function(I){I=this.getId(I);if(I!=null)return this.index__.get(I,this.entityClass)},getId:function(I){if((this.idField||this.compositeKey)&&I!=null){if(o[typeof I])return I;if(I&&I.entityType===this)return I.__id__;if(I instanceof s)I=I.data;return this.compositeKey?
this.compositeKey(I,I):I[this.idField]}},getSlot:function(I){var L=this.getId(I);if(L!=null){var M=this.slot_[L];if(!M){if(o[typeof I]){M={};if(this.idField&&!this.compositeKey)M[this.idField]=I;I=M}M=this.slot_[L]=new s({delegate:this.get(L),data:I})}return M}}}),O=A(s,{init:F.prototype.init,event_rollbackUpdate:F.createEvent("rollbackUpdate")}),U=function(I,L,M,S,V,Z,Q){function W(N,R,Y){var $=false,aa=I.calcs,X=N.__id__,T=N.data;try{if(aa)for(var da=0,fa;fa=aa[da++];){var ea=fa.key;if(ea){var ha=
T[ea];T[ea]=fa.wrapper(R,T,T[ea]);if(T[ea]!==ha){R[ea]=ha;$=true}}else fa.wrapper(R,T)}if(I.compositeKey)N.__id__=I.compositeKey(R,T,N.__id__);else if(ca&&ca in R)N.__id__=T[ca];N.__id__!==X&&I.index__.calcWrapper(N.__id__)}catch(ia){N.__id__=X;for(var ga in R)N.data[ga]=R[ga];if(Y)for(ga in Y)if(!N.modified)N.modified=Y;$=false}N.__id__!==X&&ba(N,X,N.__id__);return $}function ba(N,R,Y){if(R!=null){M.remove(R,N);S[R]&&S[R].setDelegate()}if(Y!=null){M.add(Y,N);S[Y]&&S[Y].setDelegate(N)}}var ca=I.idField;
return A(O,Q,{canHaveDelegate:false,modified:null,isTarget:true,extendConstructor_:false,init:function(N){O.prototype.init.call(this);this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var R,Y={};for(var $ in V){if($ in N){Y[$]=Z[$];R=V[$](N[$])}else R=Z[$];if(R&&R!==this&&R instanceof F)if(R.addHandler(K[$],this))this.fieldHandlers_[$]=true;this.data[$]=R}W(this,Y);L.event_datasetChanged(L,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+
")]"},get:function(N){return this.data[N]},set:function(N,R,Y,$){var aa=V[N];if(!aa){if(!I.extensible)return;aa=H}var X,T=this.modified;R=aa(R,this.data[N]);aa=this.data[N];if(R!==aa&&(!R||!aa||R.constructor!==Date||aa.constructor!==Date||+R!==+aa))a:{X={};if(N!=ca)if(Y){if(!T)this.modified=T={};if(N in T===false){X.rollback={key:N,value:undefined};T[N]=aa}else if(T[N]===R){X.rollback={key:N,value:R};delete T[N];if(!Object.keys(T).length)this.modified=null}}else if(T&&N in T)if(T[N]!==R){X.rollback=
{key:N,value:T[N]};T[N]=R;break a}else return false;this.data[N]=R;if(this.fieldHandlers_[N]){aa.removeHandler(K[N],this);this.fieldHandlers_[N]=false}if(R&&R!==this&&R instanceof F)if(R.addHandler(K[N],this))this.fieldHandlers_[N]=true;X.key=N;X.value=aa;X.delta={};X.delta[N]=aa}else if(!Y&&T&&N in T){X={rollback:{key:N,value:T[N]}};delete T[N];if(!Object.keys(T).length)this.modified=null}if(!$&&X){Y=X.key;N=X.delta||{};var da;if(X.rollback){da={};da[X.rollback.key]=X.rollback.value}if(W(this,N,
da))Y=true;if(Y){this.event_update(this,N);X.delta=N}da&&this.event_rollbackUpdate(this,da)}return X||false},update:function(N,R){if(N){var Y,$={},aa,X={},T;for(var da in N)if(T=this.set(da,N[da],R,true)){if(T.key){Y=true;$[T.key]=T.value}if(T.rollback){aa=true;X[T.rollback.key]=T.rollback.value}}if(W(this,$,X))Y=true;Y&&this.event_update(this,$);aa&&this.event_rollbackUpdate(this,X)}return Y?$:false},reset:function(){this.update(Z)},clear:function(){var N={};for(var R in this.data)N[R]=undefined;
return this.update(N)},commit:function(N){if(this.modified){var R=this.modified;this.modified=null}this.update(N);R&&this.event_rollbackUpdate(this,R)},rollback:function(){if(this.state!=l.PROCESSING){if(this.modified){var N=this.modified;this.modified=null;this.update(N);this.event_rollbackUpdate(this,N)}this.setState(l.READY)}},destroy:function(){for(var N in this.fieldHandlers_)this.data[N].removeHandler(K[N],this);this.fieldHandlers_=p;this.__id__&&ba(this,this.__id__,null);s.prototype.destroy.call(this);
L.event_datasetChanged(L,{deleted:[this]});this.data=p;this.modified=null}})};t.namespace("basis.entity").extend({isEntity:function(I){return I&&I instanceof U},NumericId:e,NumberId:c,IntId:g,StringId:k,Index:j,CalculateField:x,EntityType:w,Entity:U,BaseEntity:O,EntitySetType:d,EntitySet:i,ReadOnlyEntitySet:m,Collection:u,Grouping:h})})(basis);
(function(t){var y=t.Class,x=Object.extend,z=t.EventObject,A=z.createEvent;t.ua.Cookies.get("DEBUG_MODE");var D,J,H=false,B={},C=Date.now,F=x(new z,{event_sessionOpen:A("sessionOpen"),event_sessionClose:A("sessionClose"),event_sessionFreeze:A("sessionFreeze"),event_sessionUnfreeze:A("sessionUnfreeze"),isOpened:function(){return!!D},getTimestamp:function(){if(D)return J},open:function(r,v){var s;B[r]||(B[r]=new G(r));s=B[r];if(D===s)H&&this.unfreeze();else{this.close();D=s;J=C();v&&x(s.data,v);this.event_sessionOpen(this)}},
close:function(){if(D){H&&this.unfreeze();this.event_sessionClose(this);J=D=null}},freeze:function(){if(D&&!H){this.event_sessionFreeze(this);H=true;J=null}},unfreeze:function(){if(D&&H){H=false;J=C();this.event_sessionUnfreeze(this)}},storeData:function(r,v){if(D)return D.storeData(r,v);else throw new Error("No opened session");},getData:function(r){if(D)return D.getData(r);else throw new Error("No opened session");},destroy:function(){for(var r=Object.keys(B),v;v=r.pop();)B[v].destroy();z.prototype.destroy.call(this)}}),
G=y(z,{event_destroy:function(){D==this&&F.close();delete B[this.key]},extendConstructor_:false,init:function(r){z.prototype.init.call(this);this.key=r;this.data={}},storeData:function(r,v){if(H)throw new Error("Session is frozen");return this.data[r]=v},getData:function(r){if(H)throw new Error("Session is frozen");return this.data[r]},destroy:function(){z.prototype.destroy.call(this);for(var r=Object.keys(this.data),v;v=r.pop();){var s=this.data[v];s!=null&&typeof s.destroy=="function"&&s.destroy();
delete this.data[v]}}});t.namespace("basis.session").extend({SessionManager:F})})(basis);
(function(t){function y(b){var e=t.EventObject.createEvent(b),c=[b];return function(){o.dispatch.apply(this,c.concat(arguments));e.apply(this,arguments)}}function x(b,e){var c={"JS-Framework":"Basis"};if(v.test(e.method)){c["Content-Type"]=e.contentType+(e.encoding?";charset="+e.encoding:"");if(H.test("gecko"))c.Connection="close"}else if(H.test("ie"))c["If-Modified-Since"]=(new Date(0)).toGMTString();Object.iterate(Object.extend(c,e.headers),function(g,k){k!=null&&this.setRequestHeader(g,k)},b)}
function z(b){var e=this.transport;if(e){if(typeof b!="number")b=e.readyState;if(b!=this.prevReadyState_){this.prevReadyState_=b;this.event_readyStateChanged(b);if(b==4){C.remove(this,"timeoutAbort");b=r.UNDEFINED;var c;this.progress=false;e.onreadystatechange=Function.$undef;if(this.aborted){var g=this.abortedByTimeout_;g&&this.event_timeout();this.event_abort(g)}else{b=this.responseIsSuccess();this.update({text:e.responseText,xml:e.responseXML});if(b){this.event_success(e);b=r.READY}else{this.event_failure(e);
b=r.ERROR;c=this.getRequestError(e)}this.event_httpStatus(e,e.status)}this.event_complete(e);this.setState(b,c)}else this.setState(r.PROCESSING)}}}function A(b){C.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=false;this.prevReadyState_=-1;if(H.test("gecko1.8.1-")&&b.asynchronous)this.transport=p();var e=this.transport;if(this.asynchronous)e.onreadystatechange=z.bind(this);else z.call(this,0);e.open(b.method,b.location,b.asynchronous);this.progress=true;this.abortedByTimeout_=
this.aborted=false;x(e,b);this.event_start();if(this.aborted)z.call(this,4);else if(!(this.aborted||!this.progress)){this.requestStartTime=Date.now();C.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var c=b.postBody;if(b.method=="POST"&&H.test("ie9-"))if(typeof c=="object"&&typeof c.documentElement!="undefined"&&typeof c.xml=="string")c=c.xml;else if(typeof c=="string")c=c.replace(/\r/g,"");else if(c==null||c=="")c="[empty request]";e.send(c);return true}}var D=t.Class,J=t.dom.event,
H=t.ua,B=t.Cleaner,C=t.TimeEventManager,F=t.data,G=F.DataObject,r=F.STATE,v=/POST/i;F=t.ua.Cookies.get("DEBUG_AJAX");var s={};(function(){var b=s.win1251={escape:{},unescape:{}};b.escape["401"]="%A8";b.unescape.A8=1025;b.escape["451"]="%B8";b.unescape.B8=1105;for(var e=192;e<=255;e++){b.unescape[e.toHex()]=String.fromCharCode(e+848);b.escape[(e+848).toHex()]="%"+e.toHex()}})();var l="native",p=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var b=window.ActiveXObject;
if(b)for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;l=e[c];c++)try{if(new b(l))return function(){return new b(l)}}catch(g){}throw new Error(l="Browser doesn't support for XMLHttpRequest!");}(),o=function(){var b=[],e=[{handler:{start:function(){b.add(this)},complete:function(){b.remove(this)}}}];J.onUnload(function(){e.clear()});return{addHandler:function(c,g){for(var k=0,f;f=e[k];k++)if(f.handler===c&&f.thisObject===g)return false;e.push({handler:c,
thisObject:g});return true},removeHandler:function(c,g){for(var k=0,f;f=e[k];k++)if(f.handler===c&&f.thisObject===g){e.splice(k,1);return true}return false},dispatch:function(c){if(e.length)for(var g=Array.prototype.slice.call(arguments,1),k,f,j=e.length-1;k=e[j];j--){f=k.handler[c];if(typeof f=="function")f.apply(k.thisObject||this,g)}},abort:function(){for(var c=Array.from(b),g=0;g<c.length;g++)c[g].abort();return c}}}();D=D(G,{state:r.UNDEFINED,event_start:y("start"),event_readyStateChanged:y("readyStateChanged"),
event_timeout:y("timeout"),event_abort:y("abort"),event_success:y("success"),event_failure:y("failure"),event_httpStatus:y("httpStatus"),event_complete:y("complete"),event_stateChanged:function(b,e){G.prototype.event_stateChanged.call(this,b,e);for(var c=0;c<this.influence.length;c++)this.influence[c].setState(this.state,this.state.data)},influence:null,debug:F,progress:false,aborted:false,abortedByTimeout_:false,abortCalled:false,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:true,
method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(b){var e=this.influence;this.transport=p();this.requestHeaders={};this.influence=[];this.params={};e&&this.setInfluence.apply(this,e);B.add(this);G.prototype.init.call(this,b);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var b=Array.from(arguments),e=0;e<b.length;e++)b[e].setState(this.state,this.state.data);this.influence.set(b)},clearInfluence:function(){this.influence.clear()},
setParam:function(b,e){this.params[b]=e},setParams:function(b){this.clearParams();for(var e in b)this.setParam(e,b[e])},removeParam:function(b){delete this.params[b]},clearParams:function(){for(var b in this.params)delete this.params[b]},timeoutAbort:function(){this.abortedByTimeout_=true;this.abort()},abort:function(){this.aborted=true;if(this.progress){C.remove(this,"timeoutAbort");this.progress=false;this.transport.abort();this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==
Function.$undef&&z.call(this,4)}},request:function(b){b=b||this.url;var e=this.method.toUpperCase(),c,g;if(!this.transport)throw new Error("Transport is not allowed");if(!b)throw new Error("URL is not defined");this.abort();delete this.requestData_;this.update({responseText:"",responseXml:null});this.abortedByTimeout_=this.aborted=this.progress=false;c=Object.iterate(this.params,function(k,f){return f==null||f&&typeof f.toString=="function"&&f.toString()==null?null:k+"="+String(f.toString()).replace(/[\%\=\&\<\>\s\+]/g,
function(j){j=j.charCodeAt(0).toHex();return"%"+(j.length<2?"0":"")+j})}).filter(Function.$isNotNull).join("&");if(v.test(e))g=this.postBody||c||"";else if(c)b+=(b.indexOf("?")==-1?"?":"&")+c;this.requestData_={method:e,location:b,contentType:this.contentType,encoding:this.encoding,asynchronous:this.asynchronous,headers:Object.extend({},this.requestHeaders),postBody:g};return A.call(this,this.requestData_)},repeat:function(){if(this.requestData_){this.abort();return A.call(this,this.requestData_)}},
get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var b=this.transport.status;return b==undefined||b==0||b>=200&&this.transport.status<300}}catch(e){}return false},getRequestError:function(b){return{code:"SERVER_ERROR",msg:b.responseText}},destroy:function(){this.destroy=Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();G.prototype.destroy.call(this);delete this.transport;
B.remove(this)}});t.namespace("basis.net.ajax").extend({Transport:D,TransportDispatcher:o,createEvent:y})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.net.ajax,A=t.xml,D=z.Transport,J=A.QName,H=A.addNamespace,B=A.XML2Object,C=A.Object2XML,F=A.createElementNS,G=A.NAMESPACE,r=String("http://schemas.xmlsoap.org/soap/envelope/"),v=String("http://schemas.xmlsoap.org/soap/encoding/"),s=y(null,{url:null,namespace:null,init:function(c,g){this.url=c;this.namespace=g},call:function(c,g){c=this.createMethodCall(c,g,false);c.transport.abort();c.invoke(g.header,g.body,g.callback,g.mapping)},createMethodCall:function(c,
g,k){return new l(this,new J(c,this.namespace),g,k)}}),l=y(null,{service:null,transport:null,method:null,envelope:null,body:null,init:function(c,g,k,f){k=k||{};this.method=g;this.envelope=new o;this.url=c.url;this.transport=new p(g,k.callback);this.transport.requestHeaders={SOAPAction:g.namespace+(!/\/$/.test(g.namespace)?"/":"")+g};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return c.url}};k.mapping&&this.transport.setMapping(k.mapping);
k.callback&&this.transport.setCallback(k.callback);if(f)this.body=k.body||{}},repeatCall:function(){this.transport.get()},call:function(c){return this.invoke(null,c||this.body)},invoke:function(c,g,k,f){this.transport.abort();this.envelope.getBody(true).setValue(this.method,g);c&&this.envelope.getHeader(true).setValue(c,this.method.namespace);k&&this.transport.setCallback(k);f&&this.transport.setMapping(f);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();
this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),p=y(D,{callback:{},mapping:null,method:"POST",contentType:"text/xml",encoding:"utf-8",event_success:function(c){var g=c.responseXML;if(g===undefined||g.documentElement===undefined)this.event_failure(this);else{var k=Array.from(arguments);if(g.xml&&DOMParser)g=(new DOMParser).parseFromString(g.xml,"text/xml");this.responseEnvelope=new o(g.documentElement);k.push(this.getResponseData(),this.getRequestData());D.prototype.event_success.apply(this,
k)}},event_failure:function(c){var g=Array.from(arguments),k=this.state.data||this.getRequestError(c);k.isSoapFailure&&this.event_soapfailure(c,k.code,k.msg);g.push(k.code,k.msg);D.prototype.event_failure.apply(this,g)},event_soapfailure:z.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(c){return x.tag(c,"code")[0]},errorMessageGetter:function(c){return x.tag(c,"message")[0]},extendConstructor_:false,init:function(c){D.prototype.init.call(this);
this.soapMethod=c},setCallback:function(c){typeof c=="object"&&this.addHandler(c)},setMapping:function(c){this.mapping=c},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},getResponseData:function(){var c=this.responseEnvelope&&this.responseEnvelope.getBody();if(c)return this.responseDataGetter(c.getValue(this.mapping))},getRequestError:function(c){var g,k,f=false;c=c.responseXML;if(c!=undefined&&c.documentElement!=undefined){g=c.documentElement;f=
this.errorCodeGetter(g);k=this.errorMessageGetter(g);this.responseEnvelope=new o(g);g=f?f.firstChild.nodeValue:"UNKNOWN_ERROR";k=k?k.firstChild.nodeValue:"Unknown error";console.log("SoapError:",g.quote("("),k);f=true}return{code:g||"TRANSPORT_ERROR",msg:k,isSoapFailure:f}}}),o=y(null,{header:null,body:null,init:function(c){if(!c){c=A.createDocument(r,"soap:Envelope").documentElement;H(c,"xsd",G.XMLShema);H(c,"xsi",G.XMLShemaInstance);A.XMLNS.BAD_SUPPORT&&H(c,"soap",r)}this.document=c.ownerDocument;
this.element=c;this.body=this.getBody(true)},getElementByName:function(c){return A.getElementsByTagNameNS(this.element,c,r)[0]},getHeader:function(c){var g=this.header;if(!g){var k=this.getElementByName("Header");if(k||c){g=this.header=new b(k,this.document);k||this.element.insertBefore(g.element,this.element.firstChild)}}return g},setHeaderSection:function(c,g){this.getHeader(true).setSection(c,g)},getBody:function(c){var g=this.body;if(!g){var k=this.getElementByName("Body");if(k||c){g=this.body=
new e(k,this.document);k||this.element.appendChild(g.element)}}return g},destroy:function(){if(this.header){this.header.destroy();delete this.header}if(this.body){this.body.destroy();delete this.body}delete this.element;delete this.document}}),b=y(null,{init:function(c,g){this.element=c||F(g,"Header",r)},getValue:function(){return B(this.element)},setValue:function(c,g){x.clear(this.element);this.appendChild(c,g)},appendChild:function(c,g){if(c)for(var k in c){var f=this.element.appendChild(C(this.element.ownerDocument,
k,g,c[k]));A.XMLNS.BAD_SUPPORT&&H(f,"",g)}},setSection:function(c,g){var k=A.getElementsByTagNameNS(this.element,c,c.namespace)[0];k&&x.remove(k);this.appendChild(Function.wrapper(c)(g),c.namespace)}}),e=y(null,{init:function(c,g){this.element=c||F(g,"Body",r)},getValue:function(c){return B(this.element,c)},setValue:function(c,g,k){x.clear(this.element);this.appendChild(c,g,k)},appendChild:function(c,g,k){g=C(this.element.ownerDocument,c,c.namespace,Function.$defined(g)?g:{});this.element.appendChild(g);
A.XMLNS.BAD_SUPPORT&&H(g.element,"",c.namespace);k&&A.setAttributeNodeNS(g,A.createAttributeNS(document,"encodingStyle",v,k))}});t.namespace("basis.net.soap").extend({Service:s,ServiceCall:l,ServiceCallTransport:p,Envelope:o,EnvelopeHeader:b,EnvelopeBody:e})})(basis);
(function(t){var y=Function.getter,x=t.Class,z=t.dom,A=t.ui.Node,D=t.ui.Control,J=x(A,{captionGetter:y("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){A.prototype.event_select.call(this);z.focus(this.element)},event_disable:function(){A.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=true},event_enable:function(){A.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=false},init:function(H){A.prototype.init.call(this,H);this.setCaption(this.caption)},setCaption:function(H){this.caption=H;this.tmpl.captionText.nodeValue=this.captionGetter(this)}});x=x(D,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:J,getButtonByName:function(H){return this.childNodes.search(H,
y("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(H){return H.groupId||-H.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});t.namespace("basis.ui.button").extend({Button:J,ButtonPanel:x})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.html.Template,A=Function.getter,D=t.EventObject.createEvent,J=t.data.STATE,H=t.ui.Node,B=new z('<div{element|content} class="Basis-Label-State"/>'),C=new z('<div{element|content} class="Basis-Label-Processing"/>'),F=new z('<div{element|content} class="Basis-Label-Error"/>'),G=y(H,{cascadeDestroy:true,show_:false,visible_:false,visibilityGetter:Function.$false,insertPoint:x.INSERT_END,content:"[no text]",event_delegateChanged:function(e,c){(c?c.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:D("visibilityChanged"),init:function(e){var c=this.container;this.container=null;H.prototype.init.call(this,e);if(c)this.container=c;this.traceChanges_();return e},traceChanges_:function(){if(this.container&&this.visible_)this.container!=this.element.parentNode&&x.insert(this.container,this.tmpl.element,this.insertPoint);else x.remove(this.element)},setContainer:function(e){if(this.container!=e){this.container=
e;this.traceChanges_()}},setVisibility:function(e){if(this.visible_!=e){this.visible_=e;this.traceChanges_();this.event_visibilityChanged(this.visible_)}},destroy:function(){delete this.container;H.prototype.destroy.call(this)}}),r=y(G,{template:B,init:function(e){if(this.visibleStates&&!this.visibilityGetter){for(var c={},g,k=0;g=this.visibleStates[k++];)c[g]=true;this.visibilityGetter=A(Function.$self,c)}G.prototype.init.call(this,e)}});D=y(r,{event_stateChanged:function(e,c){r.prototype.event_stateChanged.call(this,
e,c);this.setVisibility(this.visibilityGetter(this.state,c))}});var v=y(D,{visibilityGetter:function(e){return e==J.PROCESSING},content:"Processing...",template:C});F=y(D,{visibilityGetter:function(e){return e==J.ERROR},content:"Error",template:F});var s={stateChanged:function(e,c){this.setVisibility(this.visibilityGetter(e.state,c))}},l={dataSourceChanged:function(e,c){c&&c.removeHandler(s,this);if(e.dataSource){e.dataSource.addHandler(s,this);s.stateChanged.call(this,e.dataSource,e.dataSource.state)}}};
B=y(r,{event_delegateChanged:function(e,c){r.prototype.event_delegateChanged.call(this,e,c);c&&c.removeHandler(l,this);if(this.delegate){this.delegate.addHandler(l,this);l.dataSourceChanged.call(this,this.delegate,c&&c.dataSource)}},template:B});C=y(B,{visibilityGetter:function(e){return e==J.PROCESSING},content:"Processing...",template:C});var p=function(){this.setVisibility(this.visibilityGetter(this.delegate?this.delegate.childNodes.length:0,this.delegate))},o={stateChanged:function(e){this.setVisibility(this.visibilityGetter(e.itemCount,
this.delegate))}},b={childNodesModified:p,dataSourceStateChanged:p,stateChanged:p,dataSourceChanged:function(e,c){c&&c.removeHandler(o,this);if(e.dataSource){e.dataSource.addHandler(o,this);o.stateChanged.call(this,e.dataSource,e.dataSource.state)}}};z=y(G,{event_delegateChanged:function(e,c){G.prototype.event_delegateChanged.call(this,e,c);c&&c.removeHandler(b,this);if(this.delegate){this.delegate.addHandler(b,this);b.dataSourceChanged.call(this,this.delegate)}p.call(this)},template:new z('<div{element|content} class="Basis-CountLabel"/>')});
y=y(z,{visibilityGetter:function(e,c){var g=c.dataSource?c.dataSource.state:c.state;return!e&&g==J.READY},content:"Empty"});t.namespace("basis.ui.label").extend({NodeLabel:G,State:r,ObjectState:D,Processing:v,Error:F,DataSourceState:B,DataSourceProcessing:C,ChildCount:z,IsEmpty:y})})(basis);
(function(t){function y(l){typeof l.expand=="function"&&l.expand()}function x(l){typeof l.collapse=="function"&&l.collapse()}var z=t.Class,A=t.dom,D=t.dom.event,J=t.cssom.classList,H=Function.getter,B=t.EventObject.createEvent,C=t.ui.Container,F=t.ui.Control,G=t.ui.PartitionNode,r=t.ui.GroupingNode,v={expandAll:function(){A.axis(this,A.AXIS_DESCENDANT_OR_SELF,y)},collapseAll:function(){A.axis(this,A.AXIS_DESCENDANT_OR_SELF,x)},expand:Function(),collapse:Function(),toggle:Function()};G=z(G,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'});
r=z(r,{childClass:G});var s=z(C,v,{canHaveChildren:false,childFactory:null,event_collapse:B("collapse"),event_expand:B("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(l){l.titleText.nodeValue=String(this.titleGetter(this))||"[no title]"},action:{select:function(l){this.isDisabled()||this.select(D(l).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:H("data.title")});H=z(s,{canHaveChildren:true,childClass:s,localGroupingClass:r,event_expand:function(){s.prototype.event_expand.call(this);J(this.element).remove("collapsed")},event_collapse:function(){s.prototype.event_collapse.call(this);J(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:true,collapsed:false,init:function(l){s.prototype.init.call(this,l);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed){this.collapsed=false;this.event_expand();return true}},collapse:function(){if(!this.collapsed&&this.collapsable){this.collapsed=true;this.event_collapse();return true}},toggle:function(){this.collapsed?this.expand():this.collapse()}});z=z(F,v,{childClass:s,localGroupingClass:r,template:'<ul class="Basis-Tree"/>'});t.namespace("basis.ui").extend({Tree:z});
t.namespace("basis.ui.tree").extend({Tree:z,Node:s,Folder:H,GroupingNode:r,PartitionNode:G})})(basis);
(function(){var t=basis.Class,y=basis.dom,x=basis.dom.event,z=basis.cssom,A=Function.getter,D=basis.cssom.classList,J=basis.Cleaner,H=basis.layout,B=basis.EventObject.createEvent,C=basis.ui.Node,F=basis.ui.Container,G=basis.ui.Control,r=basis.ui.PartitionNode,v=basis.ui.GroupingNode,s={VERTICAL:"V",HORIZONTAL:"H"},l=String("LTRTRBLBLCCTRCCBCCCCCCCC"),p={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},o={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},b={finish:function(){if(!this.visible){y.remove(this.element);
this.event_cleanup(this)}}};B=t(F,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:B("beforeShow"),event_show:B("show"),event_hide:B("hide"),event_realign:B("realign"),event_cleanup:B("cleanup"),event_layoutChanged:B("layoutChanged","oldOrientation","oldDir")&&function(f,j){var q=(f+"-"+j.qw().slice(2,4).join("-")).toLowerCase(),a=(this.orientation+
"-"+this.dir.qw().slice(2,4).join("-")).toLowerCase();D(this.element).replace(q,a,this.cssLayoutPrefix)},visible:false,autorotate:false,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:s.VERTICAL,hideOnAnyClick:true,hideOnKey:false,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(f){F.prototype.init.call(this,f);this.cssRule=z.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,
this.orientation);this.thread&&this.thread.addHandler(b,this);J.add(this)},setLayout:function(f,j,q){var a=this.dir,i=this.orientation;if(typeof f=="string")this.dir=f.toUpperCase();if(typeof j=="string")this.orientation=j;if(a!=this.dir||i!=this.orientation){this.event_layoutChanged(i,a);q||this.realign()}},flip:function(f){var j=this.dir.qw();f=f==s.VERTICAL;j[0+f]=o[j[0+f]];j[2+f]=o[j[2+f]];this.setLayout(j.join(" "))},rotate:function(f){var j=this.dir.qw();f=(f%4+4)%4;var q=[];if(!f)return j;
var a=j[0].charAt(0),i=j[1].charAt(0),m=l.indexOf(a+i)>>1;a=(m&252)+((m&3)+f&3)<<1;q.push(p[l.charAt(a)],p[l.charAt(a+1)]);a=j[2].charAt(0);i=j[3].charAt(0);m=l.indexOf(a+i)>>1;f=a!="C"&&i!="C"&&j[0]==j[2]!=(j[1]==j[3])?-f+4:f;a=(m&252)+((m&3)+f&3)<<1;q.push(p[l.charAt(a)],p[l.charAt(a+1)]);return q},isFitToViewport:function(f){if(this.visible&&this.relElement){var j=new H.Box(this.relElement,false,this.element.offsetParent),q=new H.Viewport(this.element.offsetParent),a=this.element.offsetWidth,i=
this.element.offsetHeight;f=String(f||this.dir).toUpperCase().qw();var m=f[0]=="CENTER"?j.left+(j.width>>1):j[f[0].toLowerCase()];j=f[1]=="CENTER"?j.top+(j.height>>1):j[f[1].toLowerCase()];if((f[2]!="LEFT")*(m<a>>(f[2]=="CENTER"))||(f[2]!="RIGHT")*(q.width-m<a>>(f[2]=="CENTER")))return false;if((f[3]!="TOP")*(j<i>>(f[3]=="CENTER"))||(f[3]!="BOTTOM")*(q.height-j<i>>(f[3]=="CENTER")))return false;return{x:m,y:j}}},realign:function(){if(this.visible&&this.relElement){for(var f=this.dir.qw(),j,q=0,a=
f,i=f[2],m=f[3],u=typeof this.autorotate=="number"||!this.autorotate.length?3:this.autorotate.length;this.autorotate&&q<=u;){if(j=this.isFitToViewport(a.join(" "))){i=a[2];m=a[3];this.setLayout(a.join(" "),null,true);break}if(q==u)break;if(Array.isArray(this.autorotate)){a=this.autorotate[q++];a=typeof a=="string"?a.toUpperCase().split(" "):this.rotate(a)}else a=this.rotate(++q*this.autorotate)}if(!j){j=new H.Box(this.relElement,false,this.element.offsetParent);j={x:f[0]=="CENTER"?j.left+(j.width>>
1):j[f[0].toLowerCase()],y:f[1]=="CENTER"?j.top+(j.height>>1):j[f[1].toLowerCase()]}}f=new H.Box(this.element.offsetParent);q={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(i){case "LEFT":q.left=j.x+"px";break;case "CENTER":q.left=Math.round(j.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":q.right=f.width-j.x+"px";break}switch(m){case "TOP":q.top=j.y+"px";break;case "CENTER":q.top=Math.round(j.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":q.bottom=f.height-j.y+"px";break}this.cssRule.setStyle(q);
this.event_realign()}},show:function(f,j,q){this.relElement=y.get(f)||this.relElement;this.setLayout(j||this.defaultDir,q);if(this.visible)this.realign();else if(this.relElement){D(this.element).remove("pre-transition");y.visibility(this.element,false);k.appendChild(this);this.event_beforeShow();this.visible=true;this.realign();this.thread&&this.thread.start(1);y.visibility(this.element,true);D(this.element).add("pre-transition");this.event_show()}},hide:function(){if(this.visible){if(y.parentOf(document.body,
this.element))if(this.thread)this.thread.start(1);else{y.remove(this.element);this.event_cleanup(this)}this.visible=false;this.parentNode&&k.removeChild(this);this.event_hide()}},hideAll:function(){k.clear()},destroy:function(){if(this.thread){this.thread.removeHandler(b,this);this.thread=null}this.hide();F.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;J.remove(this)}});var e=t(B,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
c=t(F,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(f){this.click();x.kill(f)}},event_childNodesModified:function(){D(this.element).bool("hasSubItems",this.hasChildNodes())},groupId:0,caption:"[untitled]",captionGetter:A("caption"),handler:null,defaultHandler:function(f){this.parentNode&&this.parentNode.defaultHandler(f)},init:function(f){F.prototype.init.call(this,f);this.setCaption(this.caption)},
setCaption:function(f){this.caption=f;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){if(!this.isDisabled()&&!(this instanceof g))this.handler?this.handler(this):this.defaultHandler(this)}});c.prototype.childClass=c;var g=t(c,{event_childNodesModified:C.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'});C=t(r,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'});
v=t(v,{childClass:C});t=t(B,{childClass:c,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:v,localGrouping:A("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'});var k=new G({id:"Basis-PopupStack",handheldMode:false,childClass:B,event_childNodesModified:function(f,j){if(j.deleted)for(var q=j.deleted.length-
1,a;a=j.deleted[q];q--)a.hide();if(j.inserted&&!j.deleted&&this.childNodes.length==j.inserted.length){D(this.element).add("IsNotEmpty");document.body.className=document.body.className;x.addGlobalHandler("click",this.hideByClick,this);x.addGlobalHandler("keydown",this.hideByKey,this);x.addGlobalHandler("scroll",this.hideByScroll,this);x.addHandler(window,"resize",this.realignAll,this)}if(this.lastChild)this.lastChild.select();else{D(this.element).remove("IsNotEmpty");document.body.className=document.body.className;
x.removeGlobalHandler("click",this.hideByClick,this);x.removeGlobalHandler("keydown",this.hideByKey,this);x.removeGlobalHandler("scroll",this.hideByScroll,this);x.removeHandler(window,"resize",this.realignAll,this)}},insertBefore:function(f,j){var q=document.documentElement.scrollTop,a=document.body.scrollTop;if(G.prototype.insertBefore.call(this,f,j)){f.documentST_=q;f.bodyST_=a;if(this.handheldMode){document.documentElement.scrollTop=0;document.body.scrollTop=0}f.element.style.zIndex=basis.ui.Window?
basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(f){if(f){f.hideOnAnyClick&&f.nextSibling&&this.removeChild(f.nextSibling);G.prototype.removeChild.call(this,f);if(this.handheldMode){document.documentElement.scrollTop=f.documentST_;document.body.scrollTop=f.bodyST_}}},realignAll:function(){for(var f=this.firstChild;f;f=f.nextSibling)f.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(f){f=x.sender(f);for(var j,q=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),
a=0,i;i=q[a];a++){if(f===i.tmpl.closeButton||y.parentOf(i.tmpl.closeButton,f)){this.removeChild(i);return}j||(j=y.axis(f,y.AXIS_ANCESTOR_OR_SELF));if(j.has(i.element)||j.some(Array.prototype.has,i.ignoreClickFor)){this.removeChild(q[a-1]);return}}this.removeChild(q.pop())},hideByKey:function(f){f=x.key(f);var j=this.lastChild;if(j&&j.hideOnKey){var q=false;if(typeof j.hideOnKey=="function")q=j.hideOnKey(f);else if(Array.isArray(j.hideOnKey))q=j.hideOnKey.has(f);q&&j.hide()}},hideByScroll:function(f){f=
x.sender(f);if(!y.parentOf(f,this.element))for(var j=this.lastChild;j;){var q=j.previousSibling;j.relElement&&j.offsetParent!==f&&y.parentOf(f,j.relElement)&&j.hide();j=q}}});x.onLoad(function(){y.insert(document.body,k.element,y.INSERT_BEGIN);k.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:s,setHandheldMode:function(f){k.handheldMode=!!f},Popup:B,Balloon:e,Menu:t,MenuGroupControl:v,MenuPartitionNode:C,MenuItem:c,MenuItemSet:g})})(basis);
(function(t){var y=t.Class,x=t.dom.event,z=t.dom,A=t.html.Template,D=t.cssom.classList,J=t.dom.wrapper,H=J.GroupingNode,B=J.PartitionNode,C=t.ui.Node,F=t.ui.Container,G=t.ui.Control,r=t.ui.PartitionNode,v=t.ui.GroupingNode,s=y(C,{template:new A('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(c){c.titleText.nodeValue=
this.titleGetter(this)}}),l=y(H,{event_ownerChanged:function(c,g){g&&z.remove(this.headerRow);if(this.owner&&this.owner.element){var k=this,f=this.owner.element;do z.insert(f,k.headerRow,z.INSERT_BEGIN);while(k=k.localGrouping)}H.prototype.event_ownerChanged.call(this,c,g)},childClass:{init:function(c){B.prototype.init.call(this,c);this.cell=new s({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(){var c=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var g=
0,k;k=this.nodes[g];g++)c+=k.cell.element.colSpan;else c=this.nodes.length;this.cell.element.colSpan=c;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{})},destroy:function(){B.prototype.destroy.call(this);this.cell.destroy()}},init:function(c){H.prototype.init.call(this,c);this.element=this.childNodesElement=this.headerRow=z.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(c,g){c=H.prototype.insertBefore.call(this,c,g);z.insert(this.headerRow,
c.cell.element,z.INSERT_BEFORE,c.nextSibling&&c.nextSibling.cell.element);return c},removeChild:function(c){z.remove(c.cell.element);H.prototype.removeChild.call(c)},destroy:function(){H.prototype.destroy.call(this);this.headerRow=null}});l.prototype.localGroupingClass=l;J=y(C,{sorting:null,defaultOrder:false,groupId:0,template:new A('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var c=this.parentNode&&this.parentNode.owner;c&&c.setLocalSorting(c.localSorting,!c.localSortingDesc)}else this.select()}},init:function(c){C.prototype.init.call(this,c);this.selectable=!!this.sorting;if(this.sorting){this.sorting=Function.getter(this.sorting);this.defaultOrder=this.defaultOrder=="desc";D(this.element).add("sortable")}},select:function(){if(!this.selected)this.order=this.defaultOrder;C.prototype.select.call(this)}});var p=y(F,{childClass:J,
localGroupingClass:l,template:new A('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(c){var g=this.childNodes.search(c.localSorting,"sorting");if(g){g.select();g.order=c.localSortingDesc;D(this.tmpl.content).bool("sort-order-desc",g.order)}else this.selection.clear()}}},init:function(c){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(g){(g=
g.pick())&&this.owner&&this.owner.setLocalSorting(g.sorting,g.order)}}};F.prototype.init.call(this,c);this.applyConfig_(this.structure)},applyConfig_:function(c){c&&this.setChildNodes(c.map(function(g){var k=g.header,f=Object.slice(g,["sorting","defaultOrder","groupId"]);f.content=(k==null||typeof k!="object"?k:k.content)||String.Entity.nbsp;if(typeof f.content=="function")f.content=f.content.call(this);f.cssClassName=(k.cssClassName||"")+" "+(g.cssClassName||"");return f},this))}}),o=y(C,{colSpan:1,
template:new A('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),setColSpan:function(c){this.element.colSpan=this.colSpan=c||1}}),b=y(F,{childClass:o,childFactory:function(c){return new this.childClass(c)},template:new A('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(c){F.prototype.init.call(this,c);this.applyConfig_(this.structure);if(this.useFooter)z.insert(this.container||this.owner.element,this.element,1)},
applyConfig_:function(c){if(c){var g=null;this.clear();this.useFooter=false;for(var k=0;k<c.length;k++){var f=c[k],j;if(f.footer){j=f.footer.content;if(typeof j=="function")j=j.call(this);this.useFooter=true;j=this.appendChild({cssClassName:(f.cssClassName||"")+" "+(f.footer.cssClassName||""),content:j,template:f.footer.template||o.prototype.template})}else if(g)g.setColSpan(g.colSpan+1);else j=this.appendChild({});if(j)g=j}}}}),e=y(C,{canHaveChildren:false,repaintCount:0,getters:[],classNames:[],
template:'<tr class="Basis-Table-Row" event-click="select"><!--{cells}--\></tr>',action:{select:function(c){this.select(x(c).ctrlKey)}},templateUpdate:function(){this.repaintCount+=1;for(var c=0,g;g=this.updaters[c];c++){var k=this.element.childNodes[g.cellIndex];g=g.getter.call(this,this,k);if(this.repaintCount>1)k.innerHTML="";if(!g||!Array.isArray(g))g=[g];for(var f=0;f<g.length;f++){var j=g[f];k.appendChild(j&&j.nodeType?j:z.createText(j!=null&&(typeof j!="string"||j!="")?j:" "))}}}});r=y(r,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><!-- {childNodesHere} --\></tbody>',
action:{click:function(){D(this.element).toggle("collapsed")}}});y=y(G,{canHaveChildren:true,childClass:e,localGroupingClass:y(v,{childClass:r}),template:new A('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><!-- {footerElement} --\></table>'),templateAction:function(c,g){G.prototype.templateAction.call(this,c,g)},init:function(c){this.applyConfig_(this.structure);G.prototype.init.call(this,
c);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new p(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new b(Object.extend({owner:this,structure:this.structure},this.footer));z.replace(this.tmpl.headerElement,this.header.element);if(!this.localSorting&&this.structure&&this.structure.search(true,function(g){return g.sorting&&"autosorting"in g})){c=this.structure[Array.lastSearchIndex];this.setLocalSorting(c.sorting,c.defaultOrder=="desc")}},applyConfig_:function(c){if(c){var g=
[],k="";this.firstChild&&this.clear();for(var f=0;f<c.length;f++){var j=c[f],q=j.body||{};if(typeof q=="function"||typeof q=="string")q={content:q};j=[j.cssClassName||"",q.cssClassName||""].join(" ").trim();var a=q.content;k+="<td"+(q.templateRef?q.templateRef.quote("{"):"")+(j?' class="'+j+'"':"")+">"+(typeof a=="string"?q.content:"")+"</td>";typeof a=="function"&&g.push({cellIndex:f,getter:a})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new A(this.childClass.prototype.template.source.replace("<!--{cells}--\>",
k)),updaters:g});if(this.rowBehaviour){var i=this.rowBehaviour;Object.keys(i).forEach(function(m){this.childClass.prototype[m]=function(){i[m].apply(this,arguments);e.prototype[m].apply(this,arguments)}},this)}}},loadData:function(c){this.setChildNodes(c.map(Function.wrapper("data")))},destroy:function(){G.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});t.namespace("basis.ui.table").extend({Table:y,Body:r,Header:p,HeaderCell:J,Row:e,Footer:b});
t.namespace("basis.ui").extend({Table:y})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.dom.event,A=t.cssom,D=t.TimeEventManager,J=t.ui.table.Table,H=t.layout.Box,B=t.layout.Viewport,C=t.ui.table,F=17;z.onLoad(function(){var G=x.createElement("");x.setStyle(G,{height:"100px",overflow:"scroll"});x.insert(document.body,G);F=(new H(G)).width-(new B(G)).width;A.cssRule(".ScrollBarWidthOwner").setStyle({width:F+"px"});x.remove(G)});y=y(J,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(G,
r){J.prototype.event_childNodesModified.call(this,G,r);D.add(this,"adjust",Date.now())},event_childUpdated:function(G,r){J.prototype.event_childUpdated.call(this,G,r);D.add(this,"adjust",Date.now())},init:function(G){J.prototype.init.call(this,G);this.headerClone=new C.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);
this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=x.insert(this.element,x.createElement(".Basis-ScrollTable-ExpandHeaderCell",x.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new H(this.header.element);if(this.footer.useFooter){x.insert(this.tmpl.foot,this.footer.element);this.footerClone=new C.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,
structure:this.structure},this.footerConfig));this.originalCells=this.originalCells.concat(this.footer.childNodes);this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes);x.setStyle(this.footerClone.element,{visibility:"hidden"});this.footerBox=new H(this.footer.element);this.footerExpandCell=x.insert(this.element,x.createElement(".Basis-ScrollTable-ExpandFooterCell"))}this.cellsAdjustmentInfo=[];G=0;for(var r,v;r=this.originalCells[G];G++){v=this.clonedCells[G];this.cellsAdjustmentInfo.push({element:v.element,
boxChangeListener:r.element,contentSource:r.content,contentDestination:v.content})}this.tableBox=new H(this.tmpl.tableElement);this.lastScrollLeftPosition=0;z.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));z.addHandler(window,"resize",this.adjust.bind(this));this.sync();D.add(this,"adjust",Date.now())},onScroll:function(){var G=this.tmpl.scrollContainer.scrollLeft;if(G!=this.lastScrollLeftPosition){x.setStyleProperty(this.tmpl.headerFooterContainer,"left",-G+"px");this.lastScrollLeftPosition=
G}},adjust:function(){this.onScroll();this.tableBox.recalc();var G=this.tableBox.width||0;if(this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth){x.setStyleProperty(this.tmpl.tableWrapperElement,"width",G+"px");x.setStyleProperty(this.tmpl.headerFooterContainer,"width",G+F+"px")}else{x.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%");x.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%")}this.cellsAdjustmentInfo.forEach(this.adjustCell);G=Math.max(0,
this.tmpl.tableWrapperElement.clientWidth-this.tmpl.tableElement.offsetWidth+F);this.headerBox.recalc();var r=this.headerBox.height||0;A.setStyleProperty(this.element,"paddingTop",r+"px");A.setStyleProperty(this.tmpl.tableElement,"marginTop",-r+"px");A.setStyle(this.headerExpandCell,{width:G+"px",height:r+"px"});if(this.footer.useFooter){this.footerBox.recalc();r=this.footerBox.height||0;A.setStyleProperty(this.element,"paddingBottom",r+"px");A.setStyleProperty(this.tmpl.tableElement,"marginBottom",
-r+"px");A.setStyle(this.footerExpandCell,{width:G+"px",height:r+"px"})}},sync:function(){this.adjust()},adjustCell:function(G){var r;r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(G.element,null).width:G.element.clientWidth+"px";A.setStyleProperty(G.boxChangeListener,"width",r)}});t.namespace("basis.ui.scrolltable").extend({ScrollTable:y})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.dom.event,A=t.cssom,D=t.cssom.classList,J=t.Cleaner,H=t.EventObject.createEvent,B=t.dragdrop,C=t.ui.Node,F=t.ui.Container,G=t.ui.Control,r=t.ui.button.ButtonPanel,v=y(C,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(p){C.prototype.init.call(this,p);x.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});J.add(this)},capture:function(p,o){if(this.captureElement=
x.get(p||document.body)){x.insert(this.captureElement,this.element);this.element.style.zIndex=o||1E3;x.show(this.element)}},release:function(){if(this.captureElement){this.element.parentNode==this.captureElement&&x.remove(this.element);this.captureElement=null;x.hide(this.element)}},destroy:function(){this.release();C.prototype.destroy.call(this);J.remove(this)}});y=y(F,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(p){var o=z.key(p);if(o==z.KEY.ESCAPE)this.closeOnEscape&&this.close(0);else o==z.KEY.ENTER&&z.sender(p).tagName!="TEXTAREA"&&z.kill(p)}},event_beforeShow:H("beforeShow"),event_open:H("open"),event_close:H("close"),event_active:H("active"),closeOnEscape:true,autocenter:true,autocenter_:false,modal:false,closed:true,moveable:true,title:"[no title]",init:function(p){F.prototype.init.call(this,p);x.hide(this.element);
p=this.tmpl.title.parentNode;this.setTitle(this.title);this.cssRule=A.uniqueRule(this.element);if(this.moveable)if(B){this.dde=new B.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||p,fixRight:false,fixBottom:false});this.dde.addHandler({move:function(){this.autocenter=false;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));x.setStyle(this.element,{top:"",left:""})}},this)}var o=Array.from(this.buttons).map(function(g){return Object.complete({click:(g.click||
this.close).bind(this)},g)},this),b=Object.slice(this,["buttonOk","buttonCancel"]);for(var e in b){var c=b[e];o.push({name:e=="buttonOk"?"ok":"cancel",caption:c.caption||c.title||c,click:(c.click||this.close).bind(this)})}if(o.length)this.buttonPanel=new r({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:o});if(!this.titleButton||this.titleButton.close!==false){D(p).add("Basis-Window-Title-ButtonPlace-Close");x.insert(p,x.createElement("SPAN.Basis-Window-Title-ButtonPlace",
x.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',x.createElement("SPAN","Close"))),x.INSERT_BEGIN)}if(this.autocenter!==false)this.autocenter=this.autocenter_=true;this.thread&&this.thread.addHandler({finish:function(){this.closed&&x.remove(this.element)}},this);J.add(this)},setTitle:function(p){x.insert(x.clear(this.tmpl.title),p)},realign:function(){if(this.autocenter){this.element.style.margin="";this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",
marginLeft:-this.element.offsetWidth/2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})}},activate:function(){this.select()},open:function(p){if(this.closed){x.visibility(this.element,false);x.show(this.element);l.appendChild(this);this.closed=false;this.realign();this.thread&&this.thread.start(true);this.event_beforeShow(p);x.visibility(this.element,true);this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select();this.event_open(p);this.event_active(p)}else this.realign()},
close:function(p){if(!this.closed){this.thread?this.thread.start(1):x.remove(this.element);l.removeChild(this);this.autocenter=this.autocenter_;this.closed=true;this.event_close(p)}},destroy:function(){if(this.dde){this.dde.destroy();delete this.dde}F.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;J.remove(this)}});var s=new v,l=new G({id:"Basis-WindowStack",childClass:y});l.addHandler({childNodesModified:function(){D(this.element).bool("IsNotEmpty",this.firstChild);var p=-1;
if(this.lastChild){for(var o=0,b;b=this.childNodes[o];o++){b.element.style.zIndex=2001+o*2;if(b.modal)p=o}this.lastChild.select()}p!=-1?s.capture(this.element,2E3+p*2):s.release()}});l.selection.addHandler({datasetChanged:function(){var p=this.pick(),o=l.lastChild;if(p){if(p.parentNode==l&&p!=o){l.insertBefore(p);l.event_childNodesModified({})}}else o&&this.add([o])}});z.onLoad(function(){x.insert(document.body,l.element,x.INSERT_BEGIN);for(var p=l.firstChild;p;p=p.nextSibling)p.realign()});t.namespace("basis.ui.window").extend({Window:y,
Blocker:v,getWindowTopZIndex:function(){return l.childNodes.length*2+2001}})})(basis);
(function(t){function y(s){this.selection&&!this.selection.itemCount&&s.select()}function x(){if(this.selection&&!this.selection.itemCount){var s=this.childNodes.search(false,"disabled");s&&s.select()}}var z=t.Class,A=t.dom,D=Function.getter,J=t.cssom.classList,H=t.EventObject.createEvent,B=t.ui.Node,C=t.ui.Container;H=z(t.ui.Control,{canHaveChildren:true,childClass:B,event_childEnabled:H("childEnabled")&&y,event_childDisabled:H("childDisabled")&&x,event_childNodesModified:x,item:function(s){s=isNaN(s)?
this.indexOf(s):parseInt(s);return s.between(0,this.childNodes.length-1)?this.childNodes[s]:null},indexOf:function(s){if(s instanceof this.childClass)return this.childNodes.indexOf(s);if(this.childNodes.search(s,"name"))return Array.lastSearchIndex;return-1}});var F=z(C,{canHaveChildren:false,event_disable:function(){C.prototype.event_disable.call(this);this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){C.prototype.event_enable.call(this);
this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var s=this.tmpl.titleText,l=this.titleGetter(this);s.nodeValue=l==null||String(l)==""?"[no title]":l},action:{select:function(){this.isDisabled()||this.select()}},
titleGetter:D("data.title"),groupId:0}),G=z(H,{childClass:F,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'});D=z(C,{event_select:function(){J(this.element).remove("Basis-Page-Hidden");C.prototype.event_select.call(this)},event_unselect:function(){J(this.element).add("Basis-Page-Hidden");
C.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'});var r=z(H,{childClass:D,template:'<div class="Basis-PageControl"/>'});B=z(F,{canHaveChildren:true,childClass:B,event_select:function(){F.prototype.event_select.call(this);J(this.tmpl.pageElement).remove("Basis-Page-Hidden")},event_unselect:function(){F.prototype.event_unselect.call(this);J(this.tmpl.pageElement).add("Basis-Page-Hidden")},
template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',destroy:function(){A.remove(this.tmpl.pageElement);F.prototype.destroy.call(this)}});var v=z(G,
{childClass:B,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'});z=z(G,{childClass:B,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',insertBefore:function(s,l){if(s=G.prototype.insertBefore.call(this,
s,l)){if(this.tmpl.pagesElement)this.tmpl.pagesElement.insertBefore(s.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null);return s}},removeChild:function(s){if(s=G.prototype.removeChild.call(this,s)){this.tmpl.pagesElement&&s.element.appendChild(s.tmpl.pageElement);return s}},clear:function(){this.childNodes.forEach(function(s){s.element.appendChild(s.tmpl.pageElement)});G.prototype.clear.call(this)}});t.namespace("basis.ui.tabs").extend({AbstractTabsControl:H,TabControl:G,Tab:F,
PageControl:r,Page:D,AccordionControl:v,TabSheetControl:z,TabSheet:B})})(basis);
(function(t){function y(c){return{hour:c.getHours(),day:c.getDate()-1,month:c.getMonth(),year:c.getFullYear()}}function x(c,g){var k={},f=o[c];if(f){var j=g.getFullYear(),q=g.getMonth(),a=g.getDate();j-=j%f[1];q=f[2]?q-q%f[2]:0;a=f[3]?a:1;k.periodStart=new Date(j,q,a);k.periodEnd=new Date(new Date(j+f[4],q+f[5],a+f[6])-1)}else k.periodStart=new Date(k.periodEnd=new Date(g));return k}var z=t.Class,A=t.dom,D=t.dom.event,J=Function.getter,H=t.cssom.classList,B=t.EventObject.createEvent,C=t.html.Template,
F=t.data.property.Property,G=t.ui.Node,r=t.ui.Container,v=t.ui.Control,s=function(c){var g=t.locale["ui.calendar"];return g?g[c]:c},l={};(function(){for(var c=32,g=2147483647;--c;){l[c]=g;g>>=1}})();var p={century:function(c){return c.periodStart.getFullYear()+" - "+c.periodEnd.getFullYear()},decade:function(c){return c.periodStart.getFullYear()+" - "+c.periodEnd.getFullYear()},year:function(c){return c.periodStart.getFullYear()},quarter:function(c){return s("QUARTER").toLowerCase().format(1+c.periodStart.getMonth().base(3)/
3)},month:function(c){return s("MONTH").SHORT[c.periodStart.getMonth()].toLowerCase()},day:function(c){return c.periodStart.getDate()}},o={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},b=z(G,{canHaveChildren:false,template:new C('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(c,g){c=="click"?this.document.templateAction(c,
g,this):G.prototype.templateAction.call(this,c,g)},templateUpdate:function(c,g,k){if(!g||"periodStart"in k||"periodEnd"in k){this.tmpl.title.nodeValue=this.titleGetter(this.data);if(this.parentNode){c=H(this.element);c.bool("before",this.data.periodStart<this.parentNode.data.periodStart);c.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd)}}},event_select:function(){G.prototype.event_select.call(this);A.focus(this.element)}}),e=z(r,{childClass:b,template:new C('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){r.prototype.event_select.call(this);H(this.tmpl.tabElement).add("selected")},event_unselect:function(){r.prototype.event_unselect.call(this);H(this.tmpl.tabElement).remove("selected")},event_update:function(c,g){r.prototype.event_update.call(this,c,g);var k=this.data,f;if("periodStart"in g||"periodEnd"in g){this.tmpl.titleText.nodeValue=this.getTitle(k.periodStart)||"-";this.firstChild||(f=[]);for(var j=x(this.nodePeriodName,(new Date(k.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(k.periodStart)||0))),q=0;q<this.nodeCount;q++){f?f.push({cssClassName:this.nodePeriodName,titleGetter:p[this.nodePeriodName],data:j}):this.childNodes[q].update(j);j=x(this.nodePeriodName,(new Date(j.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount))}f&&this.setChildNodes(f);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(k.selectedDate)||"-";if(f=this.getNodeByDate(k.selectedDate))f.select();
else k.selectedDate&&this.minDate<=k.selectedDate&&k.selectedDate<=this.maxDate?this.setViewDate(k.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:true,isNextPeriodEnabled:true,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(c){r.prototype.init.call(this,c);H(this.element).add("Basis-Calendar-Section-"+this.sectionName);D.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
false))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(c){if(c&&this.data.periodStart<=c&&c<=this.data.periodEnd){a:{var g=this.childNodes;if(g.length){var k,f,j=0,q=g.length,a;do{f=g[k=j+q>>1];if(c<(a=f.data.periodStart))q=k-1;else if(c>(f=f.data.periodEnd))j=k+1;else{c=c>=a&&c<=f?k:-1;break a}}while(j<=q)}c=-1}if(c!=-1)return this.childNodes[c]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(x(this.periodName,new Date(+this.data.periodStart-1)))},
nextPeriod:function(){this.isNextPeriodEnabled&&this.update(x(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(c){this.update(x(this.periodName,c))},getInitOffset:Function.$null});e.Month=z(e,{sectionName:"Month",periodName:"month",template:new C(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+
s("DAY").SHORT2.map(String.format,'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:J("getDate()"),getTitle:function(c){return s("MONTH").FULL[c.getMonth()]+" "+c.getFullYear()},getInitOffset:function(c){return 1+((new Date(c)).set("day",1).getDay()+5)%7}});e.Year=z(e,{sectionName:"Year",periodName:"year",
nodePeriodName:"month",nodePeriodUnit:"month",getTabTitle:J("getMonth()",function(c){return s("MONTH").FULL[c]}),getTitle:J("getFullYear()")});e.YearDecade=z(e,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:J("getFullYear()"),getTitle:function(c){return c.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});e.Century=z(e,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",
nodePeriodUnitCount:10,getTabTitle:function(c){if(c){c=c.getFullYear();c=c-c%10;return c+"-"+(Number(c.toString().substr(-2))+9).lead(2)}},getInitOffset:function(){return 1}});e.YearQuarters=z(e,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});e.Quarter=z(e,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(c){return[Math.floor(1+c.getMonth().base(3)/
3),s("QUARTER").toLowerCase(),c.getFullYear()].join(" ")}});z=z(v,{childClass:e,childFactory:Function(),template:new C(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
s("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:B("change"),event_childNodesModified:function(c,g){if(g.inserted)for(var k=0,f;f=g.inserted[k++];){f.setViewDate(this.date.value);f.update({selectedDate:this.selectedDate.value})}v.prototype.event_childNodesModified.call(this,c,g);A.insert(A.clear(this.tmpl.sectionTabs),this.childNodes.map(J("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&
this.firstChild.select()},templateAction:function(c,g,k){v.prototype.templateAction.call(this,c,g);if(k instanceof b){c=k.data.periodStart;g=this.selection.pick();this.selectedDate.set((new Date(this.selectedDate.value)).add(g.nodePeriodUnit,this.selectedDate.value.diff(g.nodePeriodUnit,c)));this.nextSection(false)}else if(!H(D.sender(g)).contains("disabled"))switch(c){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(true);break}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:true,sections:["Month","Year","YearDecade"],init:function(c){this.todayDate=new F(new Date);this.selectedDate=new F(new Date(this.date||new Date));this.date=new F(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(g,k){this.constructor.prototype.event_datasetChanged.call(this,
g,k);var f=this.pick();f&&f.update({selectedDate:this.selectedDate.value})}};v.prototype.init.call(this,c);this.selectedDate.addHandler({change:function(g){for(var k=this.firstChild;k;k=k.nextSibling)k.update({selectedDate:g})}},this);this.todayDate.addLink(this.tmpl.todayText,null,J("toFormat('%D.%M.%Y')"));this.sections&&A.insert(this,this.sections.map(function(g){return new e[g]},this))},setSection:function(c){(c=this.childNodes.search("sectionName",c))&&c.select()},nextSection:function(c){var g=
this.selection.pick();if(g=c?g.nextSibling:g.previousSibling){g.select();g.setViewDate(this.selectedDate.value)}else c||this.event_change()},selectDate:function(c){c-this.date.value!=0&&this.date.set(c)},getNextPeriod:function(c,g){if(!this.isNextPeriodEnabled(c,g))return false;if(this.map){var k=g?1:-1,f=g?"start":"till",j=g?"till":"start",q=(new Date(c)).add("millisecond",k),a=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(a){var i=x("year",q);if(i.periodEnd.getFullYear()==q.getFullYear())i[f]=
q;for(;!this.isPeriodEnabled(i.periodStart,i.periodEnd);)i=x("year",q.add("year",k));for(i[j]=x("month",i[f])[j];!this.isPeriodEnabled(i.periodStart,i.periodEnd);)i=x("month",q.add("month",k));var m=y(i[f]);j=y(i[j]);if(a=a[j.year]&&a[j.year][j.month]){if(this.periodEnableByDefault){f=l[i.periodEnd.getMonthDayCount()];a=a&f^f}for(f=m.day;f!=j.day+k;f+=k)if(a>>f&1){q=new Date(m.year,m.month,f+1);break}}else return x("day",i[f])}}return x("day",q)},isNextPeriodEnabled:function(c,g){if(!g&&this.minDate&&
this.minDate>c)return false;if(g&&this.maxDate&&this.maxDate<c)return false;if(this.map)if(this.periodEnableByDefault){if(!g&&this.minDate)return this.isPeriodEnabled(this.minDate,c);if(g&&this.maxDate)return this.isPeriodEnabled(c,this.maxDate)}else{var k=g?1:-1,f=c.getFullYear(),j=(new Date(c)).add("millisecond",k),q=j.getFullYear(),a=Object.keys(this.map.enable).filter(function(h){return k*h>=k*q}),i=a.length;if(i){a=a.sort(function(h,d){return k*(h>d)||-k*(h<d)});for(var m=0;m<i;m++){var u=x("year",
new Date(a[m],0));if(this.isPeriodEnabled(g&&a[m]==f?j:u.periodStart,!g&&a[m]==f?j:u.periodEnd))return true}}return false}return true},isPeriodEnabled:function(c,g){if(this.minDate&&this.minDate>g)return false;if(this.maxDate&&this.maxDate<c)return false;var k=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(k){var f=y(c),j=y(g),q,a,i,m=f.month,u=new Date(f.year,f.month),h=11-f.month,d=h+1+(j.year-f.year-1)*12+(j.month+1)-1;if(this.periodEnableByDefault){if(d==0)return!(q=k[f.year])||
!(a=q[f.month])||(a^2147483647)>>f.day&l[j.day-f.day+1];for(var n=0;n<=d;n++){if(!n||h==n%12){q=k[u.getFullYear()];if(!q)return true}a=q[m=u.getMonth()];if(!a)return true;i=l[u.getMonthDayCount()];if(n/d?n/d==1?(a&i^i)&l[j.day+1]:a&i^i:(a&i^i)>>f.day)return true;u.setMonth(m+1)}}else{if(d==0)return(q=k[f.year])&&(a=q[f.month])&&a>>f.day&l[j.day-f.day+1];for(n=0;n<=d;n++){if(!n||h==n%12||!q){q=k[u.getFullYear()];if(!q){n+=12;u.setMonth(m+12);continue}}if((a=q[m=u.getMonth()])&&(n/d?n/d==1?a&l[j.day+
1]:a:a>>f.day))return true;u.setMonth(m+1)}}return false}return true},destroy:function(){v.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});t.namespace("basis.ui.calendar").extend({Calendar:z,CalendarSection:e})})(basis);
(function(t){function y(h,d){return new D(h.source.replace("<!-- {fieldPlace} --\>",d))}var x=t.Class,z=t.dom.event,A=t.dom,D=t.html.Template,J=t.Cleaner,H=Object.complete,B=Function.getter,C=t.cssom.classList,F=t.data.property.Property,G=t.EventObject,r=t.dom.wrapper.Selection,v=t.ui.Control,s=t.ui.Node,l=t.ui.Container,p=G.createEvent,o=new D('<div{element|selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><!-- {fieldPlace} --\></div></div>'),
b=x(s,{canHaveChildren:false,template:o,nextFieldOnEnter:true,serializable:true,event_select:function(){A.focus(this.tmpl.field,true);s.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");s.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");s.prototype.event_disable.call(this)},event_input:p("input"),event_change:p("change"),event_keydown:p("keydown"),event_keypress:p("keypress"),event_keyup:p("keyup")&&
function(h){if(this.nextFieldOnEnter){var d=z.key(h);if(d==z.KEY.ENTER||d==z.KEY.CTRL_ENTER){z.cancelDefault(h);this.nextFieldFocus()}else this.setValid()}G.event.keyup.call(this,h)},event_focus:p("focus")&&function(h){this.valid&&this.setValid();G.event.focus.call(this,h)},event_blur:p("blur")&&function(h){this.validate(true);G.event.blur.call(this,h)},init:function(h){s.prototype.init.call(this,h);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=this.title||"";if(this.tmpl.field){z.addHandler(this.tmpl.field,
"keydown",this.keydown,this);z.addHandler(this.tmpl.field,"keyup",this.keyup,this);z.addHandler(this.tmpl.field,"keypress",this.keypress,this);z.addHandler(this.tmpl.field,"blur",this.blur,this);z.addHandler(this.tmpl.field,"focus",this.focus,this);z.addHandler(this.tmpl.field,"change",this.change,this);z.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);
this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value){this.defaultValue=this.value;this.setDefaultValue()}},setReadOnly:function(h){h?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},setSample:function(h){if(this.tmpl.sampleContainer&&h)this.sampleElement?
A.insert(A.clear(this.sampleElement),h):A.insert(this.tmpl.sampleContainer,this.sampleElement=A.createElement("SPAN.Basis-Field-Sample",h));else if(this.sampleElement){A.remove(this.sampleElement);this.sampleElement=null}},getValue:function(){return this.tmpl.field.value},setValue:function(h){h=h||"";if(this.tmpl.field.value!=h){this.tmpl.field.value=h;this.event_change()}},setMaxLength:function(h){this.maxLength=h},setMinLength:function(h){this.minLength=h},attachValidator:function(h,d){this.validators.add(h)&&
d&&this.validate()},detachValidator:function(h,d){this.validators.remove(h)&&d&&this.validate()},change:function(h){this.event_change(h)},input:function(h){this.event_input(h)},keydown:function(h){this.event_keydown(h)},keyup:function(h){this.event_keyup(h)},keypress:function(h){this.event_keypress(h)},blur:function(h){this.event_blur(h)},focus:function(h){this.event_focus(h)},select:function(){this.unselect();s.prototype.select.apply(this,arguments)},setValid:function(h,d){var n=C(this.element);
if(typeof h=="boolean"){n.bool("invalid",!h);n.bool("valid",h);if(d)this.element.title=d;else this.element.removeAttribute("title")}else{n.remove("invalid");n.remove("valid");this.element.removeAttribute("title")}this.valid=h},validate:function(h){var d;this.setValid();for(var n=0;n<this.validators.length;n++)if(d=this.validators[n](this)){h||this.setValid(false,d.message);return d}this.getValue()!=""&&this.setValid(true)},nextFieldFocus:function(){var h=A.axis(this,A.AXIS_FOLLOWING_SIBLING).search(true,
"selectable");if(h)h.select();else this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){z.clearHandlers(this.element);this.tmpl.field&&z.clearHandlers(this.tmpl.field);if(this.button){z.clearHandlers(this.button);delete this.button}this.validators.clear();s.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});b.create=function(h,d){h={radiogroup:"RadioGroup",checkgroup:"CheckGroup"}[h.toLowerCase()]||h.capitalize();
if(b[h])return new b[h](d);else throw new Error("Wrong field type `{0}`".format(h));};b.Hidden=x(b,{selectable:false,template:new D('<input{element|field} type="hidden"/>')});b.Text=x(b,{template:y(o,'<input{field} type="text"/>'),init:function(h){b.prototype.init.call(this,h);this.minLength&&this.attachValidator(q.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(h){this.tmpl.field.setAttribute("maxlength",h,0);b.prototype.setMaxLength.call(this,
h)}});b.Password=x(b.Text,{template:y(o,'<input{field} type="password"/>')});b.File=x(b,{template:y(o,'<input{field} type="file"/>')});b.Textarea=x(b,{nextFieldOnEnter:false,template:y(o,"<textarea{field}/>"),init:function(h){this.counter=A.createElement(".counter",b.LOCALE.Textarea.SYMBOLS_LEFT+": ",A.createText(0));b.prototype.init.call(this,h);this.minLength&&this.attachValidator(q.MinLength);this.maxLength&&this.attachValidator(q.MaxLength);z.addHandler(this.tmpl.field,"keyup",this.updateCounter,
this);z.addHandler(this.tmpl.field,"input",this.updateCounter,this);window.opera&&z.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=true;this.contentEditable=false})},updateCounter:function(){var h=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=h>=0?h:0},setValue:function(h){b.prototype.setValue.call(this,h);this.updateCounter()},setMaxLength:function(h){b.prototype.setMaxLength.call(this,h);if(h){this.updateCounter();A.insert(this.tmpl.sampleContainer,this.counter)}else A.remove(this.counter)},
destroy:function(){delete this.counter;b.prototype.destroy.call(this)}});b.Checkbox=x(b,{value:false,template:new D('<div{element} class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox"/><span>{titleText}</span></label></div></div>'),invert:function(){this.setValue(!this.getValue())},setValue:function(h){var d=this.tmpl.field.checked;this.tmpl.field.checked=!!h;d!=this.tmpl.field.checked&&this.event_change()},getValue:function(){return this.tmpl.field.checked}});
b.Label=x(b,{cssClassName:"Basis-Field-Label",template:y(o,"<label{field}>{fieldValueText}</label>"),setValue:function(h){b.prototype.setValue.call(this,h);this.tmpl.fieldValueText.nodeValue=this.tmpl.field.value}});var e=x(s,{canHaveChildren:false,titleGetter:function(h){return h.title||h.getValue()},valueGetter:B("value"),getTitle:function(){return this.titleGetter(this)},getValue:function(){return this.valueGetter(this)}}),c={datasetChanged:function(){this.event_change()}},g=x(b,l,{childClass:e,
template:b.prototype.template,multipleSelect:false,init:function(h){this.selection=new r({multiple:!!this.multipleSelect});this.selection.addHandler(c,this);b.prototype.init.call(this,h);J.add(this)},getValue:function(){var h=this.selection.getItems().map(B("getValue()"));return!this.selection.multiple?h[0]:h},setValue:function(h){var d={};(this.multipleSelect?Array.from(h):[h]).forEach(function(w){d[w]=true});h=[];for(var n=this.firstChild;n;n=n.nextSibling)d[n.getValue()]&&h.push(n);this.selection.set(h)},
destroy:function(){b.prototype.destroy.call(this);J.remove(this)}});g.Item=e;l=x(e,{event_select:function(){this.tmpl.field.checked=true;e.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;e.prototype.event_unselect.call(this)},template:new D('<label{element} class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>'),templateUpdate:function(h,d,n){e.prototype.templateUpdate.call(this,
h,d,n);h.field.value=this.getValue();h.titleText.nodeValue=this.getTitle()},templateAction:function(h,d){h=="select"&&!this.isDisabled()&&this.select();e.prototype.templateAction.call(this,h,d)}});b.RadioGroup=x(g,{childClass:l,template:y(o,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),childFactory:function(h){h=g.prototype.childFactory.call(this,h);if(this.name)h.tmpl.field.name=this.name;return h}});b.RadioGroup.Item=l;l=x(e,{event_select:function(){this.tmpl.field.checked=true;
e.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;e.prototype.event_unselect.call(this)},template:new D('<label{element} event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>'),templateUpdate:function(h,d,n){e.prototype.templateUpdate.call(this,h,d,n);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},templateAction:function(h,d){if(h=="click"&&!this.isDisabled()){this.select(this.parentNode.multipleSelect);
z.sender(d).tagName!="INPUT"&&z.kill(d)}e.prototype.templateAction.call(this,h,d)}});b.CheckGroup=x(g,{childClass:l,multipleSelect:true,template:y(o,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});b.CheckGroup.Item=l;l=x(e,{event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:new D("<option{element|field}>{titleText}</option>"),templateUpdate:function(h,d,n){e.prototype.templateUpdate.call(this,
h,d,n);h.field.value=this.getValue();h.field.text=this.getTitle()}});b.Select=x(g,{childClass:l,template:y(o,"<select{field|childNodesElement}/>"),event_keyup:function(h,d){this.change();g.prototype.event_keyup.call(this,h,d)},setValue:function(h){(h=this.childNodes.search(h,"getValue()"))?this.selection.set([h]):this.selection.clear()}});b.Select.Item=l;var k={show:function(){C(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){C(this.tmpl.field).remove("Basis-DropdownList-Opened")}};
l=x(e,{template:new D('<div{element} class="Basis-Combobox-Item" event-click="click">{titleText}</div>'),templateUpdate:function(h,d,n){e.prototype.templateUpdate.call(this,h,d,n);h.titleText.nodeValue=this.getTitle()},templateAction:function(h,d){if(h=="click"&&!this.isDisabled()){this.select();this.parentNode&&this.parentNode.hide();z.kill(d)}e.prototype.templateAction.call(this,h,d)}});var f={keyup:function(h){var d=z.key(h),n=this.selection.pick();switch(d){case z.KEY.DOWN:if(h.altKey)return this.popup.visible?
this.hide():!this.isDisabled()?this.show():null;n=A.axis(n?n:this.firstChild,A.AXIS_FOLLOWING_SIBLING).search(false,"disabled");break;case z.KEY.UP:if(h.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;n=n?A.axis(n,A.AXIS_PRESCENDING_SIBLING).search(false,"disabled"):this.firstChild;break}if(n){n.select();A.focus(this.tmpl.field)}},keydown:function(h){var d=z.key(h);if(d==z.KEY.DOWN||d==z.KEY.UP)z.kill(h);else if(d==z.KEY.ENTER){this.popup.visible&&this.hide();z.kill(h)}}};
b.Combobox=x(g,{childClass:l,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();g.prototype.event_enable.call(this)},event_change:function(){g.prototype.event_change.call(this);var h=this.getValue();this.property&&this.property.set(h);if(this.hidden)this.hidden.value=h;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:y(o,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent"/>'),
templateAction:function(h,d){if(h=="click"){this.isDisabled()||this.popup.visible?this.hide():this.show({});z.kill(d)}g.prototype.templateAction.call(this,h,d)},init:function(h){if(!t.ui.popup)throw new Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:Function.getter("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&
this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};g.prototype.init.call(this,h);this.satellite.captionItem.setDelegate(this.selection.pick());z.addHandlers(this.tmpl.field,f,this);if(this.name)A.insert(this.tmpl.field,this.hidden=A.createElement("INPUT[type=hidden][name={0}]".format(String(this.name).quote())));this.popup=new t.ui.popup.Popup(H({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,
handler:k,handlerContext:this},this.popup));this.property&&this.property.addLink(this,this.setValue)},show:function(){this.popup.show(this.tmpl.field);this.select()},hide:function(){this.popup.hide()},getTitle:function(){var h=this.selection.pick();return h&&h.getTitle()},getValue:function(){var h=this.selection.pick();return h&&h.getValue()},setValue:function(h){if(this.getValue()!=h)(h=this.childNodes.search(h,"getValue()"))&&!h.isDisabled()?this.selection.set([h]):this.selection.clear()},destroy:function(){if(this.property){this.property.removeLink(this);
this.property=null}this.popup.destroy();this.popup=null;g.prototype.destroy.call(this)}});b.Combobox.Item=l;var j=x(null,{init:function(h,d){this.field=h;this.message=d}}),q={NO_LOCALE:"There is no locale for this error",RegExp:function(h){if(h.constructor!=RegExp)h=new RegExp(h);return function(d){var n=d.getValue();if(n!=""&&!n.match(h))return new j(d,q.LOCALE.RegExp.WRONG_FORMAT||q.NO_LOCALE)}},Required:function(h){var d=h.getValue();if(Function.$isNull(d)||d=="")return new j(h,q.LOCALE.Required.MUST_BE_FILLED||
q.NO_LOCALE)},Number:function(h){var d=h.getValue();if(isNaN(d))return new j(h,q.LOCALE.Number.WRONG_FORMAT||q.NO_LOCALE)},Currency:function(h){var d=h.getValue();if(isNaN(d))return new j(h,q.LOCALE.Currency.WRONG_FORMAT||q.NO_LOCALE);if(d<=0)return new j(h,q.LOCALE.Currency.MUST_BE_GREATER_ZERO||q.NO_LOCALE)},Email:function(h){var d=h.getValue().trim();if(d!=""&&!d.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new j(h,q.LOCALE.Email.WRONG_FORMAT||q.NO_LOCALE)},
Url:function(h){var d=h.getValue().trim();if(d!=""&&!d.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new j(h,q.LOCALE.Url.WRONG_FORMAT||q.NO_LOCALE)},MinLength:function(h){var d=h.getValue();if((Function.$isNotNull(d.length)?d.length:String(d).length)<h.minLength)return new j(h,(q.LOCALE.MinLength.MUST_BE_LONGER_THAN||q.NO_LOCALE).format(h.minLength))},MaxLength:function(h){var d=h.getValue();if((Function.$isNotNull(d.length)?
d.length:String(d).length)>h.maxLength)return new j(h,(q.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||q.NO_LOCALE).format(h.maxLength))}};p=x(v,{canHaveChildren:true,childClass:b,childFactory:function(h){return b.create(h.type||"text",h)},onSubmit:Function.$false,event_reset:p("reset"),event_disable:function(){for(var h=this.firstChild;h;h=h.nextSibling)h.disabled||h.event_disable();v.prototype.event_disable.call(this)},event_enable:function(){for(var h=this.firstChild;h;h=h.nextSibling)h.disabled||h.event_enable();
v.prototype.event_enable.call(this)},template:new D('<div{element} class="Basis-FormContent"/>'),getFieldByName:function(h){return this.childNodes.search(h,"name")},getFieldById:function(h){return this.childNodes.search(h,"id")},serialize:function(){for(var h={},d=this.firstChild;d;d=d.nextSibling)if(d.serializable&&d.name)h[d.name]=d.getValue();return h},setData:function(h,d){this.loadData(h,d)},loadData:function(h,d){for(var n=Object.keys(h),w=this.firstChild;w;w=w.nextSibling){n.indexOf(w.name)!=
-1?w.setValue(h[w.name]):w.setDefaultValue();w.setValid()}d||this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var h=this.firstChild;h;h=h.nextSibling)h.setDefaultValue();this.event_reset()},validate:function(){for(var h,d=[],n=this.firstChild;n;n=n.nextSibling)if(h=n.validate())d.push(h);if(d.length){d[0].field.select();return d}else return true},submit:function(){this.validate()===true&&this.onSubmit&&this.onSubmit(this.serialize())}});l=x(p,{template:new D('<form{element|formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent"/></form>'),
method:"POST",init:function(h){this.selection=false;v.prototype.init.call(this,h);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=this.action;if(this.enctype)this.formElement.enctype=this.enctype;z.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(h){this.formElement.method=h?h.toUpperCase():"POST"},submit:function(){if(this.validate()===true&&!this.onSubmit())if(this.tagName==
"FORM")return false;else this.formElement.submit();return true}});var a=x(F,{matchFunction:function(h,d){if(!d){var n=h._m||this.textNodeGetter(h);if(n.constructor!=Array)n=[n];for(var w=false,E=0;E<n.length;E++){var K=n[E];if(K){var P=false,O=K.nodeValue.split(this.rx);if(O.length>1){if(!h._x)h._x=[];if(!h._m)h._m=[];A.replace(h._x[E]||K,h._x[E]=A.createElement("SPAN.matched",A.wrap(O,this.map)));h._m[E]=K;P=w=true}if(h._x&&h._x[E]&&!P){A.replace(h._x[E],h._m[E]);h._x[E]=h._m[E]}}}return w}if(h._x){for(E=
0;E<h._x.length;E++)h._x[E]&&A.replace(h._x[E],h._m[E]);delete h._x;delete h._m}return false},event_change:function(h){this.rx=this.regexpGetter(h);F.prototype.event_change.call(this,h)},extendConstructor_:true,init:function(){var h=this.startPoints||"";this.textNodeGetter=B(this.textNodeGetter||"tmpl.titleText");if(typeof this.regexpGetter!="function")this.regexpGetter=function(d){return new RegExp("("+h+")("+d.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||"SPAN.match"]=function(d,
n){return n%3==2};F.prototype.init.call(this,"",this.handlers,String.trim)}}),i={childNodesModified:function(h,d){if(d.inserted)for(var n=0,w;w=d.inserted[n];n++)this.matchFunction(w,this.value=="")}},m=x(a,{event_change:function(h){a.prototype.event_change.call(this,h);this.match()},init:function(h){a.prototype.init.call(this,h);this.node.addHandler(i,this)},match:function(){for(var h=this.node.firstChild;h;h=h.nextSibling)this.matchFunction(h,this.value=="")}}),u=x(a,{event_change:function(h){a.prototype.event_change.call(this,
h);this.node.setMatchFunction(h?this.matchFunction.bind(this):null)}});x=x(b.Text,{cssClassName:"Basis-MatchInput",matchFilterClass:u,event_keyup:function(h){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_keyup.call(this,h)},event_change:function(h){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_change.call(this,h)},init:function(h){b.Text.prototype.init.call(this,h);this.matchFilter=new this.matchFilterClass(this.matchFilter)}});t.namespace("basis.ui.form").extend({createFieldTemplate:function(h){return y(o,
h)},FormContent:p,Form:l,Field:b,Validator:q,ValidatorError:j,RadioGroup:b.RadioGroup,CheckGroup:b.CheckGroup,Combobox:b.Combobox,ComplexField:g,Matcher:m,MatchFilter:u,MatchInput:x})})(basis);
(function(){function t(l,p){if(window[l])return window[l];l=l.charAt(0).toUpperCase()+l.substr(1);for(var o=0,b;b=C[o++];)if(window[b+l])return window[b+l];return p}var y=basis.Class,x=basis.dom,z=basis.EventObject,A=basis.dom.event,D=basis.cssom.classList,J=false,H=false,B;(function(){function l(o,b){for(var e;e=b.shift();)if(typeof o.style[e]!="undefined")return e;return false}var p=x.createElement("");if(B=l(p,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))J=true;if(J)if(l(p,
["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style)H=true})();var C=["webkit","moz","o","ms"],F=t("requestAnimationFrame",function(l){return window.setTimeout(l,15)}),G=t("cancelRequestAnimFrame",clearInterval),r=y(z,{minScrollDelta:0,preventScrollX:false,preventScrollY:false,scrollPropertyType:"style",event_start:z.createEvent("start","scrollerObject"),event_finish:z.createEvent("finish","scrollerObject"),
event_startInertia:z.createEvent("startInertia","scrollerObject"),event_updatePosition:z.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(l){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=
this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;z.prototype.init.call(this,l);if(this.targetElement){A.addHandler(this.targetElement,"mousedown",this.onMouseDown,this);A.addHandler(this.targetElement,"touchstart",this.onMouseDown,this)}this.onUpdateHandler=this.onUpdate.bind(this);if(this.scrollPropertyType=="scroll"){x.setStyle(this.targetElement,{overflow:"hidden"});this.updateElementPosition=this.updatePosition_scrollTopLeft;this.calcDimentions=
this.calcDimentions_scrollTopLeft}else{x.setStyle(this.targetElement,{position:"relative"});this.updateElementPosition=J?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;this.calcDimentions=this.calcDimentions_styleTopLeft}if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var l={};l[B]="translate("+(-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px")+", "+(-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px")+")"+(H?" translateZ(0)":"");x.setStyle(this.targetElement,l)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;this.scrollX=
!this.preventScrollX&&this.maxPositionX>0;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&this.maxPositionY>0},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var l=this.targetElement.offsetParent;if(l){this.maxPositionX=this.targetElement.scrollWidth-l.offsetWidth;this.scrollX=!this.preventScrollX&&this.maxPositionX>0;this.maxPositionY=this.targetElement.scrollHeight-l.offsetHeight;
this.scrollY=!this.preventScrollY&&this.maxPositionY>0}},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating){this.targetElement.offsetWidth&&this.calcDimentions();
this.startViewportX=this.viewportX;this.startViewportY=this.viewportY;this.isUpdating=true;this.updateFrameHandle=this.nextFrame();this.startTime=this.lastUpdateTime=Date.now();this.event_start(this)}},stopUpdate:function(){if(this.isUpdating){this.resetVariables();this.isUpdating=false;G(this.updateFrameHandle);this.updateElementPosition();this.event_finish(this)}},onMouseDown:function(l){this.stopUpdate();this.panningActive=true;this.lastMouseX=A.mouseX(l);this.lastMouseY=A.mouseY(l);this.lastMotionUpdateTime=
Date.now();A.addHandler(document,"mousemove",this.onMouseMove,this);A.addHandler(document,"touchmove",this.onMouseMove,this);A.addHandler(document,"mouseup",this.onMouseUp,this);A.addHandler(document,"touchend",this.onMouseUp,this);A.cancelDefault(l)},onMouseMove:function(l){if(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)this.startUpdate();var p=Date.now(),o=p-this.lastMotionUpdateTime;this.lastMotionUpdateTime=p;if(o){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached){p=
A.mouseX(l);o=this.lastMouseX-p;this.lastMouseX=p;this.viewportTargetX+=o}if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached){l=A.mouseY(l);p=this.lastMouseY-l;this.lastMouseY=l;this.viewportTargetY+=p}if(this.minScrollDelta>0)if(!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;
if(this.minScrollDeltaYReached){this.viewportTargetX=this.viewportX;this.currentDirectionX=0}if(this.minScrollDeltaXReached){this.viewportTargetY=this.viewportY;this.currentDirectionY=0}}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var l=Date.now()-this.lastMotionUpdateTime;l=Math.max(10,l);this.lastMotionUpdateTime=0;if(this.scrollX)this.currentVelocityX*=1-Math.min(1,Math.max(0,l/100));if(this.scrollY)this.currentVelocityY*=1-Math.min(1,Math.max(0,l/100));A.removeHandler(document,
"mousemove",this.onMouseMove,this);A.removeHandler(document,"touchmove",this.onMouseMove,this);A.removeHandler(document,"mouseup",this.onMouseUp,this);A.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(l){l||(l=Date.now());var p=l-this.lastUpdateTime;this.lastUpdateTime=l;if(p){if(this.panningActive){var o;if(this.scrollX){o=this.viewportTargetX-this.lastViewportTargetX;this.lastViewportTargetX=this.viewportTargetX;if(o){this.currentVelocityX=
Math.abs(o)/p;this.currentDirectionX=o==0?0:o<0?-1:1}}if(this.scrollY){o=this.viewportTargetY-this.lastViewportTargetY;this.lastViewportTargetY=this.viewportTargetY;if(o){this.currentVelocityY=Math.abs(o)/p;this.currentDirectionY=o==0?0:o<0?-1:1}}}else if(this.processInertia){if(this.scrollX){this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*p;this.currentVelocityX*=0.94;if(this.currentVelocityX<0.001||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX){this.viewportTargetX=
Math.min(this.maxPositionX,Math.max(this.minPositionX,this.viewportTargetX));this.currentVelocityX=0}}if(this.scrollY){this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*p;this.currentVelocityY*=0.94;if(this.currentVelocityY<0.001||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY){this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY));this.currentVelocityY=0}}if(this.currentVelocityX==0&&this.currentVelocityY==0)this.processInertia=
false}p=o=0;if(this.scrollX){o=this.viewportTargetX-this.viewportX;this.viewportX+=o*(this.panningActive||this.currentVelocityX>0?1:0.12)}if(this.scrollY){p=this.viewportTargetY-this.viewportY;this.viewportY+=p*(this.panningActive||this.currentVelocityY>0?1:0.12)}o=!this.scrollX||this.currentVelocityX<0.001&&Math.abs(o)<0.1;p=!this.scrollY||this.currentVelocityY<0.001&&Math.abs(p)<0.1;if(!this.panningActive&&o&&p){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=
this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,l,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=F(this.onUpdateHandler,this.targetElement)},setPosition:function(l,p){this.viewportX=l;this.viewportY=p;if(this.isUpdating)this.stopUpdate();else{this.resetVariables();this.updateElementPosition()}},setTargetPosition:function(l,p){this.viewportTargetX=l||0;this.viewportTargetY=p||0;this.startUpdate();
this.processInertia=true},calcExpectedPosition:function(l){var p=0,o=l=="x"?this.currentVelocityX:this.currentVelocityY,b=l=="x"?this.currentDirectionX:this.currentDirectionY,e=l=="x"?this.viewportTargetX:this.viewportTargetY,c=l=="x"?this.minPositionX:this.minPositionY;l=l=="x"?this.maxPositionX:this.maxPositionY;if(o){var g=Math.log(0.001/o)/Math.log(0.94);o=o;for(var k=0;k<g;k++){p+=b*o*15;o*=0.94}}return Math.max(c,Math.min(l,e+p))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},
calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),v=y(z,{minScrollDelta:0,scrollX:true,scrollY:true,event_start:z.createEvent("start","scrollerObject"),event_finish:z.createEvent("finish","scrollerObject"),event_startInertia:z.createEvent("startInertia","scrollerObject"),event_updatePosition:z.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(l){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=
this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;z.prototype.init.call(this,l);if(this.targetElement){A.addHandler(this.targetElement,"mousedown",this.onMouseDown,this);A.addHandler(this.targetElement,"touchstart",this.onMouseDown,this)}this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=
J?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){this.targetElement.style[B]="translate("+(-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px")+", "+(-(this.isUpdating?
this.viewportY:Math.round(this.viewportY))+"px")+")"+(H?" translateZ(0)":"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating){this.isUpdating=
true;this.updateFrameHandle=this.nextFrame();this.lastUpdateTime=Date.now();this.event_start(this)}},stopUpdate:function(){if(this.isUpdating){this.resetVariables();this.isUpdating=false;G(this.updateFrameHandle);this.updateElementPosition();this.event_finish(this)}},onMouseDown:function(l){this.stopUpdate();this.panningActive=true;this.lastMouseX=A.mouseX(l);this.lastMouseY=A.mouseY(l);this.lastMotionUpdateTime=Date.now();A.addHandler(document,"mousemove",this.onMouseMove,this);A.addHandler(document,
"touchmove",this.onMouseMove,this);A.addHandler(document,"mouseup",this.onMouseUp,this);A.addHandler(document,"touchend",this.onMouseUp,this);A.cancelDefault(l)},onMouseMove:function(l){if(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)this.startUpdate();var p=Date.now(),o=p-this.lastMotionUpdateTime;this.lastMotionUpdateTime=p;if(o){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached){p=A.mouseX(l);o=this.lastMouseX-p;this.lastMouseX=p;this.viewportTargetX+=
o}if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached){l=A.mouseY(l);p=this.lastMouseY-l;this.lastMouseY=l;this.viewportTargetY+=p}if(this.minScrollDelta>0)if(!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;if(this.minScrollDeltaYReached){this.viewportTargetX=this.viewportX;this.currentDirectionX=
0}if(this.minScrollDeltaXReached){this.viewportTargetY=this.viewportY;this.currentDirectionY=0}}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var l=Date.now()-this.lastMotionUpdateTime;l=Math.max(10,l);this.lastMotionUpdateTime=0;if(this.scrollX)this.currentVelocityX*=1-Math.min(1,Math.max(0,l/100));if(this.scrollY)this.currentVelocityY*=1-Math.min(1,Math.max(0,l/100));A.removeHandler(document,"mousemove",this.onMouseMove,this);A.removeHandler(document,"touchmove",this.onMouseMove,
this);A.removeHandler(document,"mouseup",this.onMouseUp,this);A.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(l){l||(l=Date.now());var p=l-this.lastUpdateTime;this.lastUpdateTime=l;if(p){if(this.panningActive){var o;if(this.scrollX){o=this.viewportTargetX-this.lastViewportTargetX;this.lastViewportTargetX=this.viewportTargetX;if(o){this.currentVelocityX=Math.abs(o)/p;this.currentDirectionX=o==0?0:o<0?-1:1}}if(this.scrollY){o=this.viewportTargetY-
this.lastViewportTargetY;this.lastViewportTargetY=this.viewportTargetY;if(o){this.currentVelocityY=Math.abs(o)/p;this.currentDirectionY=o==0?0:o<0?-1:1}}}else if(this.processInertia){if(this.scrollX){this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*p;this.currentVelocityX*=0.94}if(this.scrollY){this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*p;this.currentVelocityY*=0.94}}p=o=0;if(this.scrollX){o=this.viewportTargetX-this.viewportX;this.viewportX+=o*(this.panningActive||
this.currentVelocityX>0?1:0.12)}if(this.scrollY){p=this.viewportTargetY-this.viewportY;this.viewportY+=p*(this.panningActive||this.currentVelocityY>0?1:0.12)}o=!this.scrollX||Math.abs(o)<0.5;p=!this.scrollY||Math.abs(p)<0.5;if(!this.panningActive&&o&&p){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,l,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=
F(this.onUpdateHandler,this.targetElement)},setPositionX:function(l,p){if(p){this.viewportTargetX=l||0;this.currentVelocityX=0;this.startUpdate()}else{this.stopUpdate();this.viewportTargetX=this.viewportX=l;this.updateElementPosition()}},setPositionY:function(l,p){if(p){this.viewportTargetY=l||0;this.currentVelocityY=0;this.startUpdate()}else{this.stopUpdate();this.viewportTargetY=this.viewportY=l;this.updateElementPosition()}},calcExpectedPosition:function(l){var p=0,o=l=="x"?this.currentVelocityX:
this.currentVelocityY,b=l=="x"?this.currentDirectionX:this.currentDirectionY;l=l=="x"?this.viewportTargetX:this.viewportTargetY;if(o){var e=Math.log(0.001/o)/Math.log(0.94);o=o;for(var c=0;c<e;c++){p+=b*o*15;o*=0.94}}return l+p},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),s=y(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',
init:function(l){basis.ui.Node.prototype.init.call(this,l);this.startProperty=this.type=="horizontal"?"left":"top";this.endProperty=this.type=="horizontal"?"right":"bottom";D(this.element).add(this.type)},recalcSize:function(l){x.display(this.element,l<1);var p=this.type=="horizontal"?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=p-p*l},updatePosition:function(l){var p=this.trackSize*l;l=this.trackSize-this.trackSize*l;if(p<0)p=0;if(l<0)l=0;var o={};o[this.startProperty]=p+"px";
o[this.endProperty]=l+"px";x.setStyle(this.tmpl.trackElement,o)}});y=y(basis.ui.Container,{useScrollbars:true,scrollX:true,scrollY:true,wheelDelta:40,event_realign:z.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(l){l=A.wheelDelta(l);this.scrollX&&this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*l,true);
this.scroller.setPositionY(this.scroller.viewportTargetY-this.wheelDelta*l,true)}},init:function(l){basis.ui.Node.prototype.init.call(this,l);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;l=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new v(l);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,
this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=new s({type:"horizontal",container:this.element});if(this.scrollY)this.vScrollbar=new s({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){D(this.element).add("scrollProcess")},finish:function(){D(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var l=this.scroller;l.panningActive||this.fixPosition();if(this.useScrollbars){this.scrollX&&this.hScrollbar.updatePosition(l.viewportX/
this.maxPositionX);this.scrollY&&this.vScrollbar.updatePosition(l.viewportY/this.maxPositionY)}},fixPosition:function(){var l=this.scroller;if(this.scrollX&&(l.viewportX<this.minPositionX||l.viewportX>this.maxPositionX))l.setPositionX(Math.min(this.maxPositionX,Math.max(this.minPositionX,l.viewportX)),true);if(this.scrollY&&(l.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))l.setPositionY(Math.min(this.maxPositionY,Math.max(this.minPositionY,l.viewportY)),true)},realign:function(){this.calcDimentions();
this.scrollUpdatePosition();this.event_realign()},calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var l=this.element.offsetWidth,p=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,p-l)}if(this.scrollY){var o=this.element.offsetHeight,b=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,b-o)}if(this.useScrollbars){this.scrollX&&this.hScrollbar.recalcSize(l/p);this.scrollY&&this.vScrollbar.recalcSize(o/b)}}},destroy:function(){this.scroller.destroy();
basis.ui.Node.prototype.destroy.call(this)}});basis.namespace("basis.ui.scroller").extend({Scroller:r,Scroller2:v,ScrollPanel:y})})(basis);
(function(t){var y=t.Class,x=t.dom,z=t.dom.event,A=t.cssom,D=t.dom.wrapper,J=t.ui.Container,H=t.animation.Modificator,B=y(t.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(r){r.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),C=y(J,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:B}}}),F=true,G=y(J,{behaviour:{click:function(r,v){v&&v.delegate.parentNode.scrollToNode(v.delegate)}},init:function(r){this.inherit(r);this.document=this;F&&z.addHandler(this.element,"mousewheel",function(v){try{this.owner.content.dispatchEvent(v)}catch(s){F=false;z.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}});y=y(D.Control,{childClass:C,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:true,init:function(r){this.inherit(Object.complete({childNodes:null},r));var v=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new v({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;A.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new D.ChildNodesDataset(this);
this.header=new G({container:this.element,childClass:v,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new G({container:this.element,childClass:v,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});x.hide(this.header.element);x.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new t.Animation.Thread({duration:400,interval:15});var s=this;this.modificator=new H(this.thread,function(l){s.content.scrollTop=parseInt(l);
s.recalc()},0,0,true);this.modificator.timeFunction=function(l){return Math.sin(Math.acos(1-l))};z.addHandler(this.content,"scroll",this.recalc,this);z.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",true);r.childNodes&&this.setChildNodes(r.childNodes);this.timer_=setInterval(function(){s.recalc()},500)},scrollToNode:function(r){if(r&&r.parentNode===this){r=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[x.index(r)]);if(this.thread){var v=
this.content.scrollTop;this.modificator.setRange(v,v);this.thread.stop();this.modificator.setRange(v,r);this.thread.start()}else this.content.scrollTop=r}},recalc:function(){var r=this.content,v=r.clientHeight,s=r.scrollHeight;r=r.scrollTop;var l=v==s;if(this.clientHeight_!=v||this.scrollHeight_!=s){this.clientHeight_=v;this.scrollHeight_=s;s=[];var p=[];if(!l){var o=this.meterElement.offsetHeight,b=0;v=o*this.childNodes.length-v;for(var e,c=0;e=this.childNodes[c];c++){e=e.element.offsetTop;s.push(e?
e-b:s[c-1]||0);p.push(e?e+v:p[c-1]||v);b+=o;v-=o}}this.topPoints=s;this.bottomPoints=p;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=l){this.isFit=l;x.display(this.header.element,!l);x.display(this.footer.element,!l)}if(!l)if(this.scrollTop_!=r){this.scrollTop_=r;if(l){this.lastTopPoint=0;this.lastBottomPoint=this.childNodes.length}else{var g=this.topPoints.binarySearchPos(r),k=this.bottomPoints.binarySearchPos(r);if(this.lastTopPoint!=g){this.lastTopPoint=g;this.header.childNodes.forEach(function(f,
j){f.element.style.display=j>=g?"none":""})}if(this.lastBottomPoint!=k){this.lastBottomPoint=k;this.footer.childNodes.forEach(function(f,j){f.element.style.display=j<k?"none":""})}}}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();z.removeHandler(this.content,"scroll",this.recalc,this);z.removeHandler(window,"resize",this.recalc,this);this.inherit()}});t.namespace("basis.ui.toc").extend({Control:y,
ControlItem:C,ControlItemHeader:B,ControlHeaderList:G})})(basis);
(function(t){var y=t.dom,x=t.dom.event,z=t.EventObject.createEvent,A=t.cssom.classList,D=t.dragdrop.DragDropElement,J=t.layout.Box,H=t.ui.Node,B=t.ui.Container,C=H.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(r){H.prototype.init.call(this,r);y.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&A(this.element).add("last");this.isRange&&A(this.element).add("range")}}),F=B.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:C,captionGetter:Function.$self,count:0,marks:null,init:function(r){B.prototype.init.call(this,r);this.apply()},apply:function(){var r=this.marks||[];if(this.count>0){var v=this;r.push.apply(r,Array.create(this.count,function(l){var p=this.closest((l+1)/v.count);return{pos:(p-this.min)/this.range_,caption:v.captionFormat(p),isLast:v.count==
l+1}},this.owner_))}var s=0;r=r.filter(Function.$isNotNull).sortAsObject("pos").map(function(l){var p=l.pos;l.width=l.pos-s;l.pos=s;s=p;return l},this);s!=1&&r.push({pos:s,width:1-s,isLast:true});this.setChildNodes(r)}}),G={move:function(){var r=this.tmpl.scrollbar;this.setValue_((x.mouseX(event)-(new J(r)).left)/r.offsetWidth*this.count_)}};z=H.subclass({event_change:z("change"),captionFormat:function(r){return Math.round(Number(r))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(r){var v=this.tmpl.scrollbar;this.setValue_((x.mouseX(r)-(new J(v)).left)/v.offsetWidth*this.count_)},focus:function(){y.focus(this.element)},step:function(r){var v=x.wheelDelta(r);if(v){y.focus(this.element);v<0?this.stepDown():this.stepUp()}else switch(x.key(r)){case x.KEY.DOWN:case x.KEY.LEFT:case 189:case 109:this.stepDown();break;case x.KEY.UP:case x.KEY.RIGHT:case 187:case 107:this.stepUp();break;case x.KEY.PAGEDOWN:this.stepDown(10);break;case x.KEY.PAGEUP:this.stepUp(10);
break;case x.KEY.HOME:this.setValue(this.min);break;case x.KEY.END:this.setValue(this.max);break}}},satelliteConfig:{marks:{instanceOf:B.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:F})}},marks:"auto",init:function(r){var v=this.step,s=this.value;this.step=0;this.value=this.min;this.value_=0;H.prototype.init.call(this,r);this.setProperties(this.min,this.max,v);this.setValue(isNaN(s)?this.min:s);this.scrollbarDD=new D({element:this.tmpl.scrollTrumb,handler:G,handlerContext:this})},
setProperties:function(r,v,s){if(r>v){var l=r;r=v;v=l}s=s||1;r=r||0;if(this.min!=r||this.max!=v||this.step!=s){this.count_=Math.ceil((v-r)/s);this.step=s;this.min=r;this.max=this.min+this.count_*this.step;this.range_=this.max-this.min;this.tmpl.minValue.nodeValue=this.captionFormat(this.min);this.tmpl.maxValue.nodeValue=this.captionFormat(this.max);A(this.element).bool("NoMax",this.max==this.min);if(this.marks)this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(p){if(typeof p!=
"object")p={count:p};p=Object.extend({captionFormat:this.captionFormat,owner_:this},p);if(p.count=="auto")p.count=Math.min(this.count_,20);return p},this));this.setValue(this.value||this.min)}},closest:function(r){return this.normalize(this.min+this.range_*r.fit(0,1)+this.step/2)},normalize:function(r){if(r<this.min)r=this.min;else if(r>this.max)r=this.max;return this.min+Math.floor(1.0E-5+(r-this.min)/this.step)*this.step},stepUp:function(r){this.setValue_(this.value_+parseInt(r||1))},stepDown:function(r){this.setValue_(this.value_-
parseInt(r||1))},setValue_:function(r){r=Math.round(r).fit(0,this.count_);if(this.value_!=r){this.value_=r;var v=this.value;this.value=this.normalize(this.min+r*this.step);this.tmpl.scrollTrumb.style.left=(100*(r/this.count_)).toFixed(4)+"%";this.event_change(this,v)}},setValue:function(r){this.setValue_((r-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;H.prototype.destroy.call(this)}});Object.extend(z,{MarkLayer:F,Mark:C});t.namespace("basis.ui.slider").extend({Slider:z})})(basis);
(function(t){function y(B,C){if(window.getComputedStyle){var F=document.defaultView.getComputedStyle(B,null);if(F)return F.getPropertyValue(C)}else if(B.currentStyle)return B.currentStyle[C]}var x=t.dom,z=t.cssom.classList,A=t.dragdrop.DragDropElement,D=t.cssom.cssRule("IFRAME"),J={width:"deltaX",height:"deltaY"},H={width:{"-1":"w-resize","1":"e-resize"},height:{"-1":"n-resize","1":"s-resize"}};A=A.subclass(function(B){return{factor:NaN,property:"width",event_prepare:function(){if(J[this.property])D.setProperty("pointerEvents",
"none");else{typeof console!="undefined"&&console.warn("Property to change `"+this.property+"` is unsupported");this.stop()}},event_start:function(C){B.event_start.call(this,C);C.delta=J[this.property];C.factor=this.factor;var F=this.element.parentNode,G=y(this.element,"float"),r=y(this.element,"position");if(C.delta=="deltaY"){F=F.clientHeight-parseFloat(y(F,"padding-top"))-parseFloat(y(F,"padding-bottom"));C.offsetStart=this.element.offsetHeight;if(isNaN(C.factor))C.factor=r!="static"&&y(this.element,
"bottom")!="auto"?-1:1}else{F=F.clientWidth-parseFloat(y(F,"padding-left"))-parseFloat(y(F,"padding-right"));C.offsetStart=this.element.offsetWidth;if(isNaN(C.factor))C.factor=G=="right"||r!="static"&&y(this.element,"right")!="auto"?-1:1}C.offsetStartInPercent=100/F;z(this.resizer).add("selected")},event_move:function(C){B.event_move.call(this,C);this.element.style[this.property]=C.offsetStartInPercent*(C.offsetStart+C.factor*C[C.delta])+"%"},event_over:function(C){B.event_over.call(this,C);z(this.resizer).remove("selected");
D.setProperty("pointerEvents","auto")},init:function(C){this.resizer=x.createElement(".Basis-Resizer");this.resizer.style.cursor=H[this.property][1];B.init.call(this,C)},setElement:function(C){var F=this.element;B.setElement.call(this,C,this.resizer);if(F!==this.element){F&&x.remove(this.resizer);this.element&&x.insert(this.element,this.resizer)}}}});t.namespace("basis.ui.resizer").extend({Resizer:A})})(basis);
(function(t){function y(r){return(100*r).toFixed(4)+"%"}function x(r){var v=r.childNodes.search(r.activePage_,"data.pageNumber");v?v.select():r.selection.clear()}var z=t.dom.event,A=t.EventObject.createEvent,D=t.cssom.classList,J=t.layout.Box,H=t.dragdrop.DragDropElement,B=t.ui.Control,C=t.ui.Node,F=C.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
action:{click:function(r){z.kill(r);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))},event_update:function(r,v){C.prototype.event_update.call(this,r,v);var s=this.pageGetter(this);this.tmpl.pageNumber.nodeValue=s+1;this.tmpl.link.href=this.urlGetter(s)}}),G={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(r){r=((this.initOffset+r.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(r*
(this.pageCount_-this.pageSpan_)));this.tmpl.scrollTrumb.style.left=y(r)},over:function(){this.setSpanStartPage(this.spanStartPage_)}};A=B.subclass({childClass:F,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(r,v){var s=this.tmpl.scrollbar;s=(z.mouseX(v)-(new J(s)).left)/s.offsetWidth;this.setSpanStartPage(Math.floor(s*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(r){(r=z.wheelDelta(r))&&this.setSpanStartPage(this.spanStartPage_+r)}},event_activePageChanged:A("activePageChanged"),event_pageCountChanged:A("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(r){B.prototype.init.call(this,r);this.setProperties(r.pageCount||0,
r.pageSpan);this.setActivePage(Math.max(r.activePage-1,0),true);this.scrollbarDD=new H({element:this.tmpl.scrollTrumb,handler:G,handlerContext:this})},setProperties:function(r,v,s){r=r||1;v=Math.min(v||10,r);if(v!=this.pageSpan_){this.pageSpan_=v;this.setChildNodes(Array.create(v,function(o){return{data:{pageNumber:o}}}))}if(this.pageCount_!=r){this.pageCount_=r;var l=1/r;this.tmpl.activePageMark.style.width=y(l/(1-l));this.tmpl.activePageMarkWrapper.style.width=y(1-l);this.event_pageCountChanged(this.pageCount_)}l=
v/r;var p=l/(1-l);this.tmpl.scrollTrumbWrapper.style.width=y(1-l);this.tmpl.scrollTrumb.style.width=y(p);D(this.element).bool("Basis-Paginator-WithNoScroll",v>=r);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(arguments.length==3?s:this.activePage_)},setActivePage:function(r,v){r=r.fit(0,this.pageCount_-1);if(r!=this.activePage_){this.activePage_=Number(r);x(this);this.event_activePageChanged(r)}this.tmpl.activePageMark.style.left=y(r/Math.max(this.pageCount_-1,1));v&&this.spotlightPage(this.activePage_)},
spotlightPage:function(r){this.setSpanStartPage(r-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(r){r=r.fit(0,this.pageCount_-this.pageSpan_);if(r!=this.spanStartPage_){this.spanStartPage_=r;for(var v=this.childNodes.length;v-- >0;)this.childNodes[v].update({pageNumber:r+v});x(this)}this.tmpl.scrollTrumb.style.left=y((r/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;B.prototype.destroy.call(this)}});t.namespace("basis.ui.paginator").extend({Paginator:A})})(basis);
(function(t){var y="basis.ui.pageslider",x=t.dom,z=t.Class,A=t.cssom.classList;y="basis.ui";z=z(t.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(){this.constructor.superClass_.prototype.event_childNodesModified.apply(this,arguments);for(var D=0,J;J=this.childNodes[D];D++)t.cssom.setStyle(J.element,{left:100*D+"%"})},init:function(D){var J="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=t.cssom.cssRule("."+J+" > .Basis-Page");
this.constructor.superClass_.prototype.init.call(this,D);A(this.element).add(J);this.scroller=new t.ui.Scroller({targetElement:this.element,preventScrollY:true,minScrollDelta:10,handler:{startInertia:function(B){var C=this.selection.pick();if(C){var F=C;if(B.currentDirectionX==0||B.currentDirectionX==1&&B.viewportX<C.element.offsetLeft||B.currentDirectionX==-1&&B.viewportX>C.element.offsetLeft){B.minScrollDeltaXReached=true;F=this.childNodes[Math.round(B.viewportX/C.element.offsetWidth)]}else F=B.currentDirectionX==
1?C.nextSibling:C.previousSibling;F||(F=C);F==C?this.slideToPage(C):F.select()}B.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var B=this.pick();B&&B.parentNode.slideToPage(B)}});if(this.selection.itemCount){var H=this;setTimeout(function(){H.slideToPage(H.selection.pick())},0)}},slideToPage:function(D){this.scroller.setTargetPosition(D.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);x.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});t.namespace(y).extend({PageSlider:z})})(basis);
(function(t){function y(D,J){for(var H=function(G){function r(b,e,c,g){p!=e&&v.push(G.substring(p,e).replace(A,'<span class="token-keyword">$1</span>'));p=c+1;v.push('<span class="token-'+b+'">'+G.substring(e,c+1)+"</span>"+(g||""))}for(var v=[],s=G.toArray(),l,p=0,o=0;o<s.length;o++)if(s[o]=="'")for(l=o;++o<s.length;){if(s[o]=="'"){r("string",l,o);break}if(s[o]=="\n")break;if(s[o]=="\\"){o++;if(s[o]=="\n"){r("string",l,o-1);l=o+1}}}else if(s[o]=='"')for(l=o;++o<s.length;){if(s[o]=='"'){r("string",
l,o);break}if(s[o]=="\n")break;if(s[o]=="\\"){o++;if(s[o]=="\n"){r("string",l,o-1);l=o}}}else if(s[o]=="/"){l=o;o++;if(s[o]=="/"){for(;++o<s.length;)if(s[o]=="\n")break;r("comment",l,o-1)}if(s[o]=="*")for(;++o<s.length;)if(s[o]=="*"&&s[o+1]=="/"){r("comment",l,++o);break}else if(s[o]=="\n"){r("comment",l,o-1,"\n");p=l=o+1}}v.push(G.substr(p).replace(A,'<span class="token-keyword">$1</span>'));return v}(function(G){G=G.trimRight().replace(/\r\n|\n\r|\r/g,"\n");J||(G=G.replace(/^(?:\s*[\n]+)+?([ \t]*)/,
"$1"));G=G.replace(/\n[ \t]+/g,function(p){return p.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!J){for(var r=1E3,v=G.split(/\n+/),s=Number(G.match(/^function/)!=null);s<v.length;s++){var l=v[s].match(/^\s*/);if(l[0].length<r)r=l[0].length;if(r==0)break}if(r>0)G=G.replace(new RegExp("(^|\\n) {"+r+"}","g"),"$1")}return G=G.replace(new RegExp("(^|\\n)( +)","g"),function(p,o,b){return o+"\u00a0".repeat(b.length)})}(D).replace(/</g,"&lt;")).join("").split("\n"),B=String(H.length>>1).length,
C=[],F=0;F<H.length;F++)C.push('<div class="line '+(F%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(F+1).lead(B)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(H[F]+"\r\n")+"</span></div>");return C.join("")}var x=t.Class,z=t.ui.Node,A=new RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+
")\\b","g");x=x(z,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',codeGetter:Function.getter("data.code"),normalize:true,templateUpdate:function(){var D=this.codeGetter(this);if(D!=this.code_){this.code_=D;this.tmpl.codeElement.innerHTML=y(D,!this.normalize)}}});t.namespace("basis.format.highlight").extend({highlight:y,SourceCodeNode:x})})(basis);
