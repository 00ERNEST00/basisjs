/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(g){function n(a,b){for(var c in b)a[c]=b[c];return a}function k(a,b){for(var c in b)!1==c in a&&(a[c]=b[c]);return a}function o(a){return null==a||void 0==a}function l(a){return a}function q(a){var b={};a.names=function(a){return Object.slice(b,"string"==typeof a?a.qw():a)};a.extend=function(a){k(b,a);n(this,a);return this};return a}function w(a,b){for(var c=a.split("."),i=g,h,j,d;c.length;)if(h=c.shift(),j=(j?j+".":"")+h,i[h]||(i[h]=q((!c.length?b:null)||function(){},j),d&&(d.namespaces_[j]=
i[h])),i=i[h],!d&&(d=i,!d.namespaces_))d.namespaces_={};return f[a]=i}n(Object,{extend:n,complete:k,keys:function(a){var b=[],c;for(c in a)b.push(c);return b},values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},slice:function(a,b){var c={};if(!b)return n(c,a);for(var i=0,h;h=b[i++];)h in a&&(c[h]=a[h]);return c},splice:function(a,b){var c={};if(!b)return n(c,a);for(var i=0,h;h=b[i++];)h in a&&(c[h]=a[h],delete a[h]);return c},iterate:function(a,b,c){var i=[],h;for(h in a)i.push(b.call(c,
h,a[h]));return i},coalesce:function(){for(var a=arguments,b=0;b<a.length;b++)if(null!=a[b])return a[b]}});var t=function(){},u=function(){var a=1,b={},c={};a++;return function(i,h){var j,d;if(!h){if(i.getter)return i.getter;if("function"==typeof i)return i}if("function"!=typeof i)c[i]?j=c[i]:(j=new Function("object","return object != null ? object."+i+" : object"),j.path=i,j.getterIdx_=a++,c[i]=j);else if(j=i,!j.getterIdx_)j.getterIdx_=a++;d=j.getterIdx_;var e=b[d];if(e)if("undefined"==typeof h){if(e.nmg)return e.nmg}else for(d=
0;d<e.length;d++){if(e[d].modificator===h)return e[d].getter}else e=b[d]=[];var y=!0;switch(h&&typeof h){case "string":d=function(a){return h.format(j(a))};break;case "function":d=function(a){return h(j(a))};break;case "object":y=!1;d=function(a){return h[j(a)]};break;default:d=j.path?j:function(a){return j(a)}}if(y&&(e.push({getter:d,modificator:h}),"undefined"==typeof h))e.nmg=d;return d.getter=d}}();n(Function,{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:o,
$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:l,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},$null:function(){return null},$undef:t,getter:u,def:function(a,b,c){c=c||o;return function(i){i=a(i);return c(i)?b:i}},wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,i;return function(){c++||(i=a.apply(b||this,arguments));
return i}},lazyInitAndRun:function(a,b,c){var i=0,h;return function(){i++||(h=a.call(c||this));b.apply(h,arguments);return h}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}});k(Function.prototype,{bind:function(a){var b=this,c=Array.from(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});k(Array,{isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)}});
n(Array,{from:function(a,b){if(null!=a){var c=a.length;if("undefined"==typeof c)return[a];b||(b=0);if(0<c-b){for(var i=[],h=0,j=b;j<c;)i[h++]=a[j++];return i}}return[]},create:function(a,b,c){for(var i=[],h="function"==typeof b,j=0;j<a;j++)i[j]=h?b.call(c,j,i):b;return i}});k(Array.prototype,{indexOf:function(a,b){b=parseInt(b)||0;if(0>b)return-1;for(;b<this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){for(var c=this.length,b=parseInt(b),b=isNaN(b)||b>=c?c-1:(b+c)%c;0<=b;b--)if(this[b]===
a)return b;return-1},forEach:function(a,b){for(var c=0,i=this.length;c<i;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,i=this.length;c<i;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0},some:function(a,b){for(var c=0,i=this.length;c<i;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1},filter:function(a,b){for(var c=[],i=0,h=this.length;i<h;i++)i in this&&a.call(b,this[i],i,this)&&c.push(this[i]);return c},map:function(a,b){for(var c=[],i=0,h=this.length;i<
h;i++)i in this&&(c[i]=a.call(b,this[i],i,this));return c},reduce:function(a,b){var c=this.length,i=arguments.length;if(0==c&&1==i)throw new TypeError;var h,j=0;1<i&&(h=b,j=1);for(i=0;i<c;i++)i in this&&(h=j++?a.call(null,h,this[i],i,this):this[i]);return h}});n(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[0<=a?a:this.length+a]},search:function(a,b,c){Array.lastSearchIndex=
-1;for(var b=Function.getter(b||l),c=parseInt(c)||0,i=this.length;c<i;c++)if(b(this[c])===a)return this[Array.lastSearchIndex=c]},lastSearch:function(a,b,c){Array.lastSearchIndex=-1;for(var b=Function.getter(b||l),i=this.length,c=isNaN(c)||null==c?i:parseInt(c),i=c>i?i:c;0<i--;)if(b(this[i])===a)return this[Array.lastSearchIndex=i]},binarySearchPos:function(a,b,c,i,h,j){if(!this.length)return i?-1:0;var b=Function.getter(b||l),c=!!c,d,h=isNaN(h)?0:h,e=isNaN(j)?this.length-1:j;do if(j=h+e>>1,d=b(this[j]),
c?a>d:a<d)e=j-1;else if(c?a<d:a>d)h=j+1;else return a==d?j:i?-1:0;while(h<=e);return i?-1:j+(d<a^c)},binarySearch:function(a,b){return this.binarySearchPos(a,b,!1,!0)},add:function(a){return-1==this.indexOf(a)&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return-1!=a&&!!this.splice(a,1)},has:function(a){return-1!=this.indexOf(a)},merge:function(a){return this.reduce(n,a||{})},sortAsObject:function(a,b,c){a=Function.getter(a);c=c?-1:1;return this.map(function(c,b){return{i:b,v:a(c)}}).sort(b||
function(a,b){return c*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){if(this!==a)this.length=0,this.push.apply(this,a);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var v=Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);if(2>a.length)a[1]=this.length;return v.apply(this,a)}}var s={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",
nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};k(String,{toLowerCase:function(a){return(""+a).toLowerCase()},toUpperCase:function(a){return(""+a).toUpperCase()},trim:function(a){return(""+a).trim()},trimLeft:function(a){return(""+a).trimLeft()},trimRight:function(a){return(""+a).trimRight()},isEmpty:function(a){return null==a||""==""+a},isNotEmpty:function(a){return null!=a&&""!=""+a}});k(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,
"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});n(String.prototype,{toObject:function(a){try{return Function("return 0,"+this)()}catch(b){if(a)throw b;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],b=this.length,c=0;c<b;c++)a[c]=this.charAt(c);return a},repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,
"\\$&")},format:function(a){for(var b={},c=0;c<arguments.length;c++)b[c]=arguments[c];"object"==typeof a&&n(b,a);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(a,c,j,d,e){a=c in b?b[c]:e?"":a;return j&&!isNaN(a)?(a=Number(a),"."==j?a.toFixed(d):a.lead(d)):a})},quote:function(a,b){var a=a||'"',b=b||s[a]||a,c=(1==a.length?a:"")+(1==b.length?b:"");return a+(c?this.replace(RegExp("["+c.forRegExp()+"]","g"),"\\$&"):this)+b},capitalize:function(){return this.charAt(0).toUpperCase()+
this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,b){return b.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});String.format=String.prototype.format;if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length)String.prototype.split=function(a){if(""==a||a&&""==a.source)return this.toArray();var b=[],c=0,i;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));i=a.exec(this);)i[0]=
this.substring(c,i.index),b.push.apply(b,i),c=a.lastIndex;else for(;-1!=(i=this.indexOf(a,c));)b.push(this.substring(c,i)),c=i+a.length;b.push(this.substr(c));return b};if("2"!="12".substr(-1)){var p=String.prototype.substr;String.prototype.substr=function(a,b){return p.call(this,0>a?Math.max(0,this.length+a):a,b)}}n(Number.prototype,{fit:function(a,b){return!isNaN(a)&&this<a?Number(a):!isNaN(b)&&this>b?Number(b):this},between:function(a,b){return!isNaN(this)&&this>=a&&this<=b},quote:function(a,b){return(this+
"").quote(a,b)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return 0>this?-1:+(0<this)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,b){return(this+"").replace(/\d+/,function(c){return 1<(a-=c.length-1)?Array(a).join(b||0)+c:c})},group:function(a,b){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(i,h){return!h+(c.length-h)%(a||3)?i:(b||" ")+i})})},format:function(a,b,c,i,h){a=this.toFixed(a);if(b||h)a=
a.replace(/(\d+)(\.?)/,function(a,c,i){return(b?Number(c).group(3,b):c)+(i?h||i:"")});c&&(a=a.replace(/^-?/,"$&"+(c||"")));return a+(i||"")}});k(Date,{now:function(){return+new Date}});1900>(new Date).getYear()&&n(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&100>a?Number(a)+1900:a)}});var f={},x=function(){function a(a,c){for(var b=f[a],h=c?c.split(/\./):[];b&&h.length;)b=b[h.shift()];return b}var b=g.document?g.document.getElementsByTagName("SCRIPT"):
null,c=(b?b[b.length-1].src:module.filename).replace(/[^\/]+$/,""),i={},h;"function"==typeof require?h=function(a){return require(requirePath+a.replace(/\./g,"/"))}:(h=function(b,d){var e=b.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],y=b.substr(e.length?e.length+1:0),m=a(e,y),r=/^basis\./.test(e)?c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!f[e]||!m)if(/^https?:/.test(r)){if(i[b])throw"Attempt to load namespace, probably cycle require";i[b]=1;var k=r+
(d||"")+b.replace(/\./g,"/")+".js",r=new XMLHttpRequest;r.open("POST",k,!1);r.send(null);if(200==r.status){try{(g.execScript||function(a){g.eval.call(g,a+"//@ sourceURL="+k)})(r.responseText)}catch(p){throw p;}h.sequence.push(b.replace(/\./g,"/")+".js")}else if(404==r.status&&y)x(e);else throw"unable to load module "+b+" by basis.require()";}else throw"Path `"+b+"` can't be resolved";return m||a(e,y)},h.sequence=[]);return h}(),r=function(){function a(a){return"function"==typeof a&&a.basisClass_}
var b=Function(),c=1,i={},h=function(){for(var a in{toString:1})return;return!0}();n(b,{className:"basis.Class",extendConstructor_:!1,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=t}},create:function(h){"function"!=typeof h&&(h=b);var j=Function();j.prototype=h.prototype;for(var j=new j,d={className:h.className+"._SubClass_",basisClass_:!0,superClass_:h,extendConstructor_:!!h.extendConstructor_,
__extend__:function(c){return c&&("object"==typeof c||"function"==typeof c&&!a(c))&&c!==i?b.create.call(null,f,c):c},extend:b.extend,subclass:function(){return b.create.apply(null,[f].concat(Array.from(arguments)))},prototype:j},e=arguments,m=1;m<e.length;m++)d.extend("function"==typeof e[m]&&!a(e[m])?e[m](h.prototype):e[m]);var B={},f=d.extendConstructor_?function(a,b){this.eventObjectId=c++;var h,i;for(i in a)h=this[i],this[i]=h&&h.__extend__?h.__extend__(a[i]):a[i];this.init(b||B)}:function(){this.eventObjectId=
c++;this.init.apply(this,arguments)};j.constructor=f;for(var D in j)j[D]===i&&(j[D]=f);n(f,d);return f},extend:function(a){var c=this.prototype;if(a.prototype)a=a.prototype;for(var b in a){var i=a[b],j=c[b];"className"==b||"extendConstructor_"==b?this[b]=i:c[b]=j&&j.__extend__?j.__extend__(i):i}if(h&&a[b="toString"]!==Object.prototype[b])c[b]=a[b];return this}});var j=function(a,c){return{__extend__:function(a){var b=Function();b.prototype=this;b=new b;c(b,a);return b}}.__extend__(a)},d=function(a){return j(a,
n)};return w("basis.Class",b.create).extend({SELF:i,BaseClass:b,create:b.create,isClass:a,CustomExtendProperty:j,ExtensibleProperty:d,NestedExtProperty:function(a){return j(a,function(a,c){for(var b in c){var h=a[b];a[b]=h&&h.__extend__?h.__extend__(c[b]):d(c[b])}})}})}(),e=function(){function a(a){var h=c[a];h||(h=c[a]=function(){var c=this.handlers_,h,i;if(c&&c.length)for(var c=b.call(c),d=c.length;0<d--;)h=c[d],i=h.handler[a],"function"==typeof i&&i.apply(h.thisObject,arguments)});return h}var b=
Array.prototype.slice,c={},i,h=r(null,{handlers_:null,event_destroy:i=a("destroy","object"),listen:r.NestedExtProperty(),extendConstructor_:!0,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,c){var b=this.handlers_;if(!b)b=this.handlers_=[];c||(c=this);for(var h=b.length,i;0<h--;)if(i=b[h],i.handler===a&&i.thisObject===c)return!1;return!!b.push({handler:a,thisObject:c||this})},removeHandler:function(a,
c){var b=this.handlers_;if(b){c||(c=this);for(var h=b.length,i;0<h--;)if(i=b[h],i.handler===a&&i.thisObject===c)return!!b.splice(h,1);return!1}},destroy:function(){if(this.handlers_)i.call(this,this),this.handlers_=null}});h.createEvent=a;h.event=c;return h}(),m=function(){var a=[];return{add:function(b){null!=b&&a.push(b)},remove:function(b){a.remove(b)}}}();(function(){function a(a){if(b){if(a.source!=g||a.data!=c)return;basis.dom.event.kill(a)}i.length&&(a=i.shift(),delete h[a.key],a.fn())}var b=
"function"==typeof addEventListener&&"function"==typeof postMessage,c="zeroTimeoutMessage",i=[],h={},j=1;b&&g.addEventListener("message",a,!0);var d=setTimeout;g.setTimeout=function(y,e){var m;e?m=d.call(g,y,e):(m={key:"z"+j++,fn:"function"==typeof y?y:new Function(y)},h[m.key]=m,i.push(m),b?postMessage(c,"*"):m.timer=d.call(g,a,0),m=m.key);return m};var e=clearTimeout;g.clearTimeout=function(a){if(/z\d+/.test(a)){var c=h[a];c&&(clearTimeout(c.timer),i.remove(c),delete h[a])}else return e.call(g,
a)}})();var d=function(){function a(){if(!f)if(j.length){var a=Date.now(),b=Math.max(j[0].eventTime,a);b<e&&(clearTimeout(y),y=setTimeout(c,(e=b)-a))}else y=clearTimeout(y),e=i}function b(c,b){var h=c.eventObjectId,i=d[b]&&d[b][h];i&&(j.remove(i),delete d[b][h],a())}function c(){var c=Date.now(),c=j.binarySearchPos(c+15,h);f=!0;j.splice(0,c).forEach(function(a){delete d[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});f=!1;e=i;a()}var i=2E12,h=u("eventTime"),j=[],d={},e=i,y=null,f=
!1;m.add({destroy:function(){f=!0;clearTimeout(y);j.length=0;d=null}});return{add:function(c,i,y){var e=c.eventObjectId,D=d[i];D||(D=d[i]={});var m=D[e];if(m){if(isNaN(y))return b(c,i);if(m.eventTime==y)return;j.remove(m);m.eventTime=y}else{if(isNaN(y))return;m=D[e]={eventName:i,object:c,eventTime:y,callback:c[i]}}j.splice(j.binarySearchPos(y,h),0,m);a()},remove:b}}();w("basis").extend({namespace:w,platformFeature:{},EventObject:e,TimeEventManager:d,Cleaner:m,require:x});g.basis.locale={}})(this);
(function(g,n){function k(e){for(var m=1E6,e=(""+e).split("."),d=0,a=0;4>d&&d<e.length;d++,m/=100)a+=e[d]*m;return a}function o(){for(var e=0;e<arguments.length;e++){var m=arguments[e].toLowerCase();if(m in q){if(q[m])return!0}else{var d=m.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(d){q[m]=!1;var a=d[1].toLowerCase(),b=k(d[3]),d=d[4]||"=";if(a=w[a])return q[m]=!b||"="==d&&a==b||"+"==d&&a>=b||"-"==d&&a<b}}}return!1}var l="basis.ua",q={},w={},t=n.navigator&&n.navigator.userAgent,u="unknown",v={MSIE:["Internet Explorer",
"msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},s;for(s in v)if(!("MSIE"==s&&n.opera)&&!("Safari"==s&&t.match(/chrome/i))&&!("AppleWebKit"==s&&t.match(/iphone/i))&&t.match(RegExp(s+".(\\d+(\\.\\d+)*)","i")))for(var p=v[s],f=n.opera&&"function"==
typeof n.opera.version?n.opera.version():RegExp.$1,x=k(f),u=p[0]+" "+f,f=0;f<p.length;f++)w[p[f].toLowerCase()]=x;g.platformFeature.datauri=!1;t="undefined"!=typeof Image?new Image:{};t.onload=function(){g.platformFeature.datauri=!0};t.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(o("IE7-"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(r){}l=g.namespace(l);l.toString=function(){return u};return l.extend({testImage:t,prettyName:u,test:o,
is:function(e){return o(e)},Cookies:{set:function(e,m,d,a){document.cookie=e+"="+(null==m?"":escape(m))+";path="+(a||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)+(d?";expires="+(new Date(Date.now()+1E3*d)).toGMTString():"")},get:function(e){return(e=document.cookie.match(RegExp("(^|;)\\s*"+e+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(e[2])},remove:function(e,m){document.cookie=e+"=;expires="+(new Date(0)).toGMTString()+";path="+(m||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)}}})})(basis,
this);
(function(g,n){function k(a,b,h){if(null!=b)return a.insertBefore(c(b)?b:w(b),h||null)}function o(a){return u("",a.cloneNode(!0)).innerHTML}function l(a){return c(a)||a&&a.nodeType?a:"string"==typeof a?f.getElementById(a):null}function q(c,b,h){var j,f=[],h="string"==typeof h?getter(h):h||Function.$true;b&26&&h(c)&&f.push(c);switch(b){case 1:case 2:for(j=c;(j=j[e])&&j!==c.document;)h(j)&&f.push(j);break;case 64:for(j=c[m];j;)h(j)&&f.push(j),j=j[d];break;case 4:case 8:c[m]&&(b=new i(c),b.nodes(h,f));
break;case 128:b=new i(c,h);for(b.cursor_=c[d]||c[e];j=b.next();)f.push(j);break;case 256:for(j=c;j=j[d];)h(j)&&f.push(j);break;case 32:h(c[e])&&f.push(c[e]);break;case 512:b=new i(c,h,i.BACKWARD);for(b.cursor_=c[a]||c[e];j=b.next();)f.push(j);break;case 1024:for(j=c;j=j[a];)h(j)&&f.push(j)}return f}function w(a){return f.createTextNode(null!=a?a:"")}function t(){for(var a=f.createDocumentFragment(),c=arguments.length,b=t.array=[],h=0;h<c;h++)b.push(k(a,arguments[h]));return a}function u(a,c){var b=
void 0!=a&&"string"!=typeof a,h=(b?a.description:a)||"",i="div",d=h.match(/^([a-z0-9\_\-]+)(.*)$/i);d&&(i=d[1],h=d[2]);if(""!=h){for(var D=[],e={},m;d=A.exec(h);){if(d[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+h+"\n\nProblem place:\n> "+h.substr(0,d.index)+"--\>"+h.substr(d.index)+"<--");m=d[1]||d[2]||d[3];d[1]?e.id=m:d[2]?D.push(m):"class"!=m&&(e[m]=d[4]?p(d[5],d[6],d[7]):m)}j&&e.name&&/^(input|textarea|select)$/i.test(i)&&(i="<"+i+" name="+e.name+">")}h=
f.createElement(i);if(e){if(e.style&&B)h.style.cssText=e.style;for(var r in e)h.setAttribute(r,e[r],0)}if(D&&D.length)h.className=D.join(" ");1<arguments.length&&k(h,t.apply(0,Array.from(arguments,1).flatten()));if(b&&(a.css&&g.cssom&&g.cssom.setStyle(h,a.css),g.dom.event))for(var x in a)"function"==typeof a[x]?g.dom.event.addHandler(h,x,a[x],h):a[x]instanceof g.dom.event.Handler&&g.dom.event.addHandler(h,x,a[x].handler,a[x].thisObject);return h}function v(a,c){return a[e]?a[e].replaceChild(c,a):
a}function s(a){if(f.selection){var c=f.selection.createRange();0!=c.compareEndPoints("StartToEnd",c)&&c.collapse(a);return c.getBookmark().charCodeAt(2)-2}}var p=Object.coalesce,f=n.document,x=g.Class,r=f.createElement("div"),e="parentNode",m="firstChild",d="nextSibling",a="previousSibling",b;b="function"==typeof r.compareDocumentPosition?function(a,c){return a.compareDocumentPosition(c)}:function(a,c){return a==c?0:a.document!=c.document?33:a.sourceIndex>c.sourceIndex?2|8*c.contains(childA):4|16*
a.contains(childB)};var c;if("undefined"!=typeof Node){if(c=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else c=function(a){return a&&a.ownerDocument===f};var i=x(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,c,b){this.setRoot(a);this.setDirection(b);if("function"==typeof c)this.filter=c},setDirection:function(c){Object.extend(this,c?{a:"lastChild",b:a,c:d,d:m}:{a:m,b:d,c:a,d:"lastChild"})},
setRoot:function(a){this.root_=a||f;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,c){var b;c||(c=[]);for(this.reset();b=this.next(a);)c.push(b);return c},next:function(a){var a=a||this.filter,c=this.cursor_||this.root_;do for(var b=c[this.a];!b;){if(c===this.root_)return this.cursor_=null;(b=c[this.b])||(c=c[e])}while(!a(c=b));return this.cursor_=c},prev:function(a){var a=a||
this.filter,c=this.cursor_,b=this.c,h=this.d;do{var i=c?c[b]:this.root_[h];if(i){for(;i[h];)i=i[h];c=i}else c&&(c=c[e]);if(!c||c===this.root_){c=null;break}}while(!a(c));return this.cursor_=c},destroy:function(){this.cursor_=this.root_=null}});i.BACKWARD=!0;var h="textContent innerText nodeValue".qw(),j=function(){var a=f.createElement("input");a.name="a";return!/name/.test(o(a))}(),B;r.setAttribute("style","color: red");B="red"!==r.style.color;var A=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return g.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:i,outerHTML:o,textContent:function(a){for(var c=0,b;b=h[c++];)if(null!=a[b])return a[b];return q(a,4,function(a){return 3==a.nodeType}).map(getter("nodeValue")).join("")},get:l,tag:function(a,c){a=l(a)||f;return"*"==c&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(c||"*"))},axis:q,findAncestor:function(a,c,b){for(;a&&a!==b;){if(c(a))return a;a=a.parentNode}},createElement:u,createText:w,createFragment:t,insert:function(a,
b,h,i){a=l(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(h){case void 0:case "end":i=null;break;case "begin":i=a[m];break;case "before":break;case "after":i=i[d];break;default:i=Number(h).between(0,a.childNodes.length)?a.childNodes[h]:null}h=!c(a);if(!b||!Array.isArray(b))h=h?b&&a.insertBefore(b,i):k(a,b,i);else if(h)for(var h=[],j=0,e=b.length;j<e;j++)h[j]=a.insertBefore(b[j],i);else a.insertBefore(t.apply(0,b),i),h=t.array;return h},remove:function(a){return a[e]?
a[e].removeChild(a):a},replace:v,swap:function(a,c){if(a===c||b(a,c)&25)return!1;v(a,r);v(c,a);v(r,c);return!0},clone:function(a,c){var b=a.cloneNode(!c);b.attachEvent&&q(b,8).forEach(Event.clearHandlers);return b},clear:function(a){for(a=l(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,c,b){var h=[],b=Function.getter(b||Function.$self),i;for(i in c)for(var j=0;j<a.length;j++){var D=b(a[j]);h[j]=c[i](a[j],j,D)?u(i,D):a[j]}return h},setAttribute:function(a,c,b){null==b?a.removeAttribute(c):
a.setAttribute(c,b)},parentOf:function(a,c){return a.contains(c)},isInside:function(a,c){return a==c||c.contains(a)},focus:function(a,c){try{a=l(a),a.focus(),c&&a.select&&a.select()}catch(b){}},setSelectionRange:function(a,c,b){3>arguments.length&&(b=c);if(a.setSelectionRange)a.setSelectionRange(c,b);else if(a.createTextRange){var h=a.createTextRange();h.collapse(!0);h.moveStart("character",c);h.moveEnd("character",b-c);h.select()}},getSelectionStart:function(a){return"undefined"!=typeof a.selectionStart?
a.selectionStart:s(!0)},getSelectionEnd:function(a){return"undefined"!=typeof a.selectionEnd?a.selectionEnd:s(!1)}})})(basis,this);
(function(g,n){function k(a){return a||n.event}function o(a){return"string"==typeof a?p.get(a):a}function l(a){a=k(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function q(a){a=k(a);a.preventDefault?a.preventDefault():a.returnValue=!1}function w(a){var b=Array.from(e[a.type]);if(b)for(var c=b.length;0<c--;){var i=b[c];i.handler.call(i.thisObject,a)}}function t(a,b,c,i){a=o(a);if(!a)throw Error("Event.addHandler: can't attach event listener to undefined");if("function"!=typeof c)throw Error("Event.addHandler: handler must be a function");
a[x]||(a[x]={});var h={handler:c,thisObject:i},j=a[x],d=j[b];if(d){for(a=0;b=d[a];a++)if(b.handler===c&&b.thisObject===i)return;d.push(h)}else d=j[b]=[h],d.fireEvent=function(a){a=k(a);if(m&&a&&"undefined"==typeof a.returnValue){w(a);if(!0===a.cancelBubble)return;if("undefined"==typeof a.returnValue)a.returnValue=!0}for(var c=0,b;b=d[c++];)b.handler.call(b.thisObject,a)},a.addEventListener?a.addEventListener(b,d.fireEvent,!1):a.attachEvent("on"+b,d.fireEvent)}function u(a,b,c,i){var a=o(a),h=a[x];
if(h&&(h=h[b]))for(var j=0,d;d=h[j];j++)if(d.handler===c&&d.thisObject===i){h.splice(j,1);h.length||v(a,b);break}}function v(a,b){var a=o(a),c=a[x];if(c)if("string"!=typeof b)for(b in c)v(a,b);else{var i=c[b];i&&(a.removeEventListener?a.removeEventListener(b,i.fireEvent,!1):a.detachEvent("on"+b,i.fireEvent),delete c[b])}}var s=n.document,p=g.dom,f=Function.$null,x="__basisEvents",r={mousewheel:["mousewheel","DOMMouseScroll"]},e={},m=!s.addEventListener,d=function(){function a(){b++||setTimeout(function(){for(var a=
0;a<c.length;a++)c[a].callback.call(c[a].thisObject)},10)}var b=!1,c=[];if(g.ua.is("ie7-"))(function(){var c="_"+Date.now();s.write('<script id="'+c+'" defer src="//:"><\/script>');o(c).onreadystatechange=function(){"complete"==this.readyState&&(p.remove(this),a())}})();else if(g.ua.is("safari525-"))var i=setInterval(function(){/loaded|complete/.test(s.readyState)&&(clearInterval(i),a())},15);else t(s,"DOMContentLoaded",a,!1);t(s,"load",a,!1);t(n,"load",a,!1);return function(a,i){b||c.push({callback:a,
thisObject:i})}}();return g.namespace("basis.dom.event",k).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return r[a]||[a]},Handler:function(a,b){this.handler=a;this.thisObject=b},sender:function(a){a=k(a);return a.target||a.srcElement},cancelBubble:l,
cancelDefault:q,kill:function(a,b){(b=o(b))?t(b,a,Event.kill):(q(a),l(a))},key:function(a){a=k(a);return a.keyCode||a.which||0},charCode:function(a){a=k(a);return a.charCode||a.keyCode||0},mouseButton:function(a,b){a=k(a);return"number"==typeof a.which?a.which==b.VALUE:a.button&b.BIT},mouseX:function(a){a=k(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(s.documentElement.scrollLeft||s.body.scrollLeft)},mouseY:function(a){a=k(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(s.documentElement.scrollTop||s.body.scrollTop)},wheelDelta:function(a){a=k(a);return"wheelDelta"in a?a.wheelDelta/120:"DOMMouseScroll"==a.type?-a.detail/3:0},addGlobalHandler:function(a,b,c){var i=e[a];if(i)for(a=i.length;0<a--;){var h=i[a];if(h.handler===b&&h.thisObject===c)return}else s.addEventListener?s.addEventListener(a,w,!0):t(s,a,f),i=e[a]=[];i.push({handler:b,thisObject:c})},removeGlobalHandler:function(a,b,c){var i=e[a];if(i)for(var h=0,j;j=i[h];h++)if(j.handler===
b&&j.thisObject===c){i.splice(h,1);i.length||(delete e[a],s.removeEventListener?s.removeEventListener(a,w,!0):u(s,a,f));break}},addHandler:t,addHandlers:function(a,b,c){var a=o(a),i;for(i in b)t(a,i,b[i],c)},removeHandler:u,clearHandlers:v,fireEvent:function(a,b){var a=o(a),c=a[x];c&&c[b]&&c[b].fireEvent()},onLoad:d,onUnload:function(a,b){t(n,"unload",a,b)}})})(basis,this);
(function(){function g(a,b,c){for(var i=1,h;b;)b&1&&(h=f[i],c&i?(a.addHandler(h.handler,h.context),h.action(h.context.add,a)):(a.removeHandler(h.handler,h.context),h.action(h.context.remove,a))),b>>=1,i<<=1}function n(a){return Array.isArray(a)?a.map(n):{data:a}}var k=basis.Class,o=basis.EventObject,l=Object.values,q=Function.$self,w=o.createEvent,t=o.event,u={},v=[],s={},p={PRIORITY:[],values_:{},add:function(a,b){var c=a.toUpperCase(),i=a.toLowerCase();this[c]=i;s[i]=!0;b&&(b=this.indexOf(b),-1==
b?this.PRIORITY.push(i):this.PRIORITY.splice(b,0,i))}};p.add("READY");p.add("DEPRECATED");p.add("UNDEFINED");p.add("ERROR");p.add("PROCESSING");var f={},x=1,r={NONE:0,MASK:0,add:function(a,b,c){f[x]={handler:b,action:c,context:{add:function(c,b){if(b){var j=r[a]+"_"+c.eventObjectId;if(!b.subscribers_)b.subscribers_={};if(!b.subscribers_[j]){var d=b.subscriberCount;b.subscribers_[j]=c;b.subscriberCount+=1;b.event_subscribersChanged(b,d)}}},remove:function(c,b){if(b){var j=r[a]+"_"+c.eventObjectId;
if(b.subscribers_[j]){var d=b.subscriberCount;delete b.subscribers_[j];b.subscriberCount-=1;b.event_subscribersChanged(b,d)}}}}};r[a]=x;r.MASK|=x;x<<=1}};r.add("DELEGATE",{delegateChanged:function(a,b){this.remove(a,b);this.add(a,a.delegate)}},function(a,b){a(b,b.delegate)});r.add("TARGET",{targetChanged:function(a,b){this.remove(a,b);this.add(a,a.target)}},function(a,b){a(b,b.target)});var e=k(o,{state:p.READY,data:null,canHaveDelegate:!0,delegate:null,root:null,cascadeDestroy:!1,isTarget:!1,target:null,
active:!1,subscribeTo:r.DELEGATE+r.TARGET,subscriberCount:0,subscribers_:null,event_update:w("update","object","delta"),event_stateChanged:w("stateChanged","object","oldState"),event_delegateChanged:w("delegateChanged","object","oldDelegate"),event_rootChanged:w("rootChanged","object","oldRoot"),event_targetChanged:w("targetChanged","object","oldTarget")&&function(a,b){var c=this.listen.target;c&&(b&&b.removeHandler(c,this),this.target&&this.target.addHandler(c,this));t.targetChanged.call(this,a,
b)},event_subscribersChanged:w("subscribersChanged","object"),event_activeChanged:w("activeChanged","object"),listen:{delegate:{update:function(a,b){this.data=a.data;this.event_update(this,b)},stateChanged:function(a,b){this.state=a.state;this.event_stateChanged(this,b)},targetChanged:function(a,b){this.target=a.target;this.event_targetChanged(this,b)},rootChanged:function(a,b){this.data=a.data;this.event_rootChanged(this,b)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},
init:function(a){o.prototype.init.call(this,a);if(a=this.delegate)this.delegate=null,this.data=a.data,this.state=a.state,this.setDelegate(a);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&g(this,this.subscribeTo,r.MASK)},isConnected:function(a){if(a instanceof e){for(;a&&a!==this&&a!==a.delegate;)a=a.delegate;return a===this}return!1},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},setDelegate:function(a){if(this.canHaveDelegate&&
a&&a instanceof e){if(a.delegate&&this.isConnected(a))return!1}else a=null;if(this.delegate!==a){var b=this.state,c=this.data,i=this.delegate,h=this.target,j=this.root,d={},m=this.listen.delegate;i&&m&&i.removeHandler(m,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;this.state=a.state;this.target=a.target;m&&a.addHandler(m,this);for(var y in a.data)!1===y in c&&(d[y]=void 0);for(y in c)c[y]!==a.data[y]&&(d[y]=c[y])}else for(y in this.target=this.delegate=null,this.root=this,this.data=
{},c)this.data[y]=c[y];this.event_delegateChanged(this,i);this.root!==j&&this.event_rootChanged(this,j);this.target!==h&&this.event_targetChanged(this,h);if(a){for(y in d){this.event_update(this,d);break}b!==this.state&&(""+b!=this.state||b.data!==this.state.data)&&this.event_stateChanged(this,b)}return!0}return!1},setState:function(a,b){var c=this.target||this.getRootDelegate();if(c!==this)return c.setState(a,b);c=""+a;if(!s[c])throw Error("Wrong state value");if(this.state!=c||this.state.data!=
b){var i=this.state;this.state=Object(c);this.state.data=b;this.event_stateChanged(this,i);return!0}return!1},deprecate:function(){this.state!=p.PROCESSING&&this.setState(p.DEPRECATED)},update:function(a){var b=this.target||this.getRootDelegate();if(b!==this)return b.update(a);if(a){var b={},c=0,i;for(i in a)this.data[i]!==a[i]&&(c++,b[i]=this.data[i],this.data[i]=a[i]);if(c)return this.event_update(this,b),b}return!1},setActive:function(a){a=!!a;return this.active!=a?(this.active=a,this.event_activeChanged(this),
g(this,this.subscribeTo,r.MASK*a),!0):!1},setSubscription:function(a){var a=a&r.MASK,b=this.subscribeTo^a;return b?(this.subscribeTo=a,this.active&&g(this,b,a),!0):!1},destroy:function(){this.active&&g(this,this.subscribeTo,0);this.delegate&&this.setDelegate();o.prototype.destroy.call(this);this.data=u;this.state=p.UNDEFINED;this.target=this.root=null}}),q=k(null,{itemClass:e,keyGetter:q,map_:null,extendConstructor_:!0,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(a){return this.get(this.keyGetter(a),
a)},create:function(a){var b={};a instanceof e?b.delegate=a:b.data={id:a,title:a};return new this.itemClass(b)},get:function(a,b){var c=a instanceof e?a.eventObjectId:a,i=this.map_[c];!i&&b&&(i=this.map_[c]=this.create(a,b),i.addHandler({destroy:function(){delete this.map_[c]}},this));return i},destroy:function(){basis.Cleaner.remove(this);for(var a=l(this.map_),b=0,c;c=a[b++];)c.destroy()}}),m=k(e,{state:p.UNDEFINED,itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:w("datasetChanged",
"dataset","delta")&&function(a,b){var c,i=0,h=0,j;if(c=b.inserted)for(;j=c[i];)this.item_[j.eventObjectId]=j,i++;if(c=b.deleted)for(;j=c[h];)delete this.item_[j.eventObjectId],h++;this.itemCount+=i-h;this.cache_=null;t.datasetChanged.call(this,a,b)},init:function(a){e.prototype.init.call(this,a);this.memberMap_={};this.item_={}},has:function(a){return!(!a||!this.item_[a.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=l(this.item_);return this.cache_},pick:function(){for(var a in this.item_)return this.item_[a];
return null},top:function(a){var b=[];if(a)for(var c in this.item_)if(b.push(this.item_[c])>=a)break;return b},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();e.prototype.destroy.call(this);this.cache_=v;this.itemCount=0;this.item_=this.memberMap_=null}}),d=k(m,{listen:{item:{destroy:function(a){this.memberMap_[a.eventObjectId]&&this.remove([a])}}},init:function(a){m.prototype.init.call(this,a);if(a=this.items)this.set(a),
this.items=null},add:function(a){for(var b,c=this.memberMap_,i=[],h=this.listen.item,j=0;j<a.length;j++){var d=a[j];if(d instanceof e){var m=d.eventObjectId;c[m]||(c[m]=d,h&&d.addHandler(h,this),i.push(d))}}i.length&&this.event_datasetChanged(this,b={inserted:i});return b},remove:function(a){for(var b,c=this.memberMap_,i=[],h=this.listen.item,j=0;j<a.length;j++){var d=a[j];if(d instanceof e){var m=d.eventObjectId;c[m]&&(h&&d.removeHandler(h,this),delete c[m],i.push(d))}}i.length&&this.event_datasetChanged(this,
b={deleted:i});return b},set:function(a){if(!this.itemCount)return this.add(a);if(!a.length)return this.clear();for(var b=this.memberMap_,c={},i=[],h=[],j,d,m,y=this.listen.item,f=0;f<a.length;f++)if(j=a[f],j instanceof e)d=j.eventObjectId,c[d]=j,b[d]||(b[d]=j,y&&j.addHandler(y,this),h.push(j));for(d in b)c[d]||(j=b[d],y&&j.removeHandler(y,this),delete b[d],i.push(j));var g;var a={},r;if(h&&h.length)r=a.inserted=h;if(i&&i.length)r=a.deleted=i;r&&(g=a);(m=g)&&this.event_datasetChanged(this,m);return m},
sync:function(a,b){if(a){d.setAccumulateState(!0);for(var c=this.memberMap_,i,h,j={},m=[],f,y=0;y<a.length;y++)if(i=a[y],i instanceof e)h=i.eventObjectId,j[h]=i,c[h]||m.push(i);for(h in this.item_)j[h]||this.item_[h].destroy();b&&m.length&&(f=this.add(m));d.setAccumulateState(!1);return f}},clear:function(){var a,b=this.getItems(),c=this.listen.item;if(b.length){if(c)for(a=b.length;0<a--;)b[a].removeHandler(c,this);this.event_datasetChanged(this,a={deleted:b});this.memberMap_={}}return a}});d.setAccumulateState=
function(){function a(a){var c=a.dataset;h.call(c,c,a)}function b(c,b){var i=c.eventObjectId,j=b.inserted,d=b.deleted,m=e[i];if(j&&d)return m&&(delete e[i],a(m)),h.call(c,c,b);if(m){var D=m[j?"inserted":"deleted"];if(D)return D.push.apply(D,j||d);a(m)}e[i]=b;b.dataset=c}function c(){j=1;setAccumulateState(!1)}var i=m.prototype,h=i.event_datasetChanged,j=0,d,e={};return function(m){if(m){if(0==j)i.event_datasetChanged=b,d=setTimeout(c,0);j++}else if(j-=0<j,0==j)clearTimeout(d),i.event_datasetChanged=
h,m=e,e={},l(m).forEach(a)}}();basis.namespace("basis.data",n).extend({STATE:p,SUBSCRIPTION:r,Object:e,DataObject:e,KeyObjectMap:q,AbstractDataset:m,Dataset:d})})(basis,this);
(function(g,n){function k(a,c,i,h){for(var c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),j=e(),d,f=0;f<c.length;f++)f%2?(d=c[f].split(/\|/),a.getters[d[0]]=i+"childNodes["+h+"]",d=1<d.length?d[1]:d[0]):d=c[f].length?c[f]:null,null!=d&&(r&&(j.lastChild&&j.appendChild(t.createComment("")),h++),j.appendChild(m(d)),h++);return j}function o(a){return function(c){if(!c||!("click"==c.type&&3==c.which)){var i=g.dom.event.sender(c),h,j;do if(h=i.getAttributeNode&&i.getAttributeNode(a))break;while(i=i.parentNode);
if(i&&h){do if(j=i.basisObjectId)if((j=p[j])&&j.templateAction){i=h.nodeValue.qw();h=0;for(var d;d=i[h++];)j.templateAction(d,g.dom.event(c));break}while(i=i.parentNode)}}}}function l(a,c,i){c=c.trim();if(!c)return"";for(var h="",j;j=x.exec(c);){var d=j[2],e=j[4]||j[5]||d;j[3]&&(a.getters[j[3]]=i+'.getAttributeNode("'+d+'")');if(j=d.match(/^event-([a-z]+)/i)){var m=j[1];if(!s[m]){s[m]=!0;j=0;for(var m=g.dom.event.browserEvents(m),f;f=m[j++];)g.dom.event.addGlobalHandler(f,o(d))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,c){var a=g.dom.event(a),b=this,h;do if(h=b.basisObjectId)if((h=p[h])&&h.templateAction){for(var b=c.qw(),i=0,j;j=b[i++];)h.templateAction(j,g.dom.event(a));break}while(b=b.parentNode)}}h+="class"==d?e.trim().replace(/^(.)|\s+/g,".$1"):"["+d+(e?"="+e.quote('"'):"")+"]"}return h}function q(a,c){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;c||(c=".");for(var i=e(),h,j=0,d,m=a.stack;d=f.exec(a.str);){h=RegExp.leftContext;a.str=a.str.substr(h.length+d[0].length);if(h.length)i.appendChild(k(a,
h,c,j)),j=i.childNodes.length;if(d[5]){if(d[5]==m[m.length-1])return m.pop(),i;throw"Wrong end tag";}if(d[6])d[7]&&(a.getters[d[7]]=c+"childNodes["+j+"]"),i.appendChild(t.createComment(d[6]));else{h=d[1];var y=d[2],g=!!d[4],r=c+"childNodes["+j+"]";d=u.createElement(h+l(a,d[3],r));y&&(a.getters[y]=r);g||(m.push(h),d.appendChild(q(a,r+".")));i.appendChild(d)}j++}a.str.length&&i.appendChild(k(a,a.str,c,j));if(m.length)throw"No end tag for "+m.reverse();return i}function w(a){if(!this.proto){a=this.source;
if("function"==typeof a)this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},c=q(a),a=Object.iterate(a.getters,function(a,b){for(var h=a.split(/\|/).map(String.format,"obj_.{0}"),i=b.split(/(\.?childNodes\[(\d+)\])/),j=c,d=0;d<i.length;d+=3){var e=i[d+2];if(!e)break;i[d+2]="";j=j.childNodes[e];j.previousSibling?j.nextSibling||(i[d+1]=".lastChild"):i[d+1]=".firstChild"}return{name:h[0],alias:h.join("="),path:"dom_"+i.join("")}}).sortAsObject("path"),i=0;i<a.length;i++)for(var h=
RegExp("^"+a[i].path.forRegExp()),j=i+1,d;d=a[j++];)d.path=d.path.replace(h,a[i].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,c){obj_=a||{};dom_=proto_.cloneNode(!0);_code_();if(c&&obj_.element){var b=obj_.element.basisObjectId=map_.seed++;map_[b]=c}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(c,p);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(p)}}var t=n.document,u=g.dom,v=g.Class,s={},p={seed:1},f=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,x=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;u.createFragment();var r=1==u.createElement("","a","b").cloneNode(!0).childNodes.length,e=u.createFragment,m=
u.createText,d=v(null,{__extend__:function(a){return a instanceof d?a:new d(a)},init:function(a){this.source=a},createInstance:function(a,c){w.call(this);return this.createInstance(a,c)},clearInstance:function(){w.call(this)}}),a=t.createElement("DIV");return g.namespace("basis.html").extend({Template:d,escape:function(a){return u.createElement("DIV",u.createText(a)).innerHTML},unescape:function(b){a.innerHTML=b;return a.firstChild.nodeValue},string2Html:function(b){a.innerHTML=b;return u.createFragment.apply(null,
Array.from(a.childNodes))}})})(basis,this);
(function(g){function n(a){return a.sortingValue||0}function k(a,c){a=a.sortingValue||0;c=c.sortingValue||0;return+(a>c)||-(a<c)}function o(a,c){a=a.sortingValue||0;c=c.sortingValue||0;return-(a>c)||+(a<c)}function l(a){return a.childNodes.sort(a.localSortingDesc?o:k)}function q(a,c){var b=c.length-1;a.childNodes=c;a.firstChild=c[0]||null;a.lastChild=c[b]||null;for(var h=b;b=c[h];h--)b.nextSibling=c[h+1]||null,b.previousSibling=c[h-1]||null,a.insertBefore(b,b.nextSibling)}function w(a,c){var b=a.childFactory||
a.document&&a.document.childFactory,h,c=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},c);if(b&&(h=b.call(a,c),h instanceof a.childClass))return h;if(!h)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(h&&h.constructor&&h.constructor.className)+")";}function t(){return g.ui.apply(this,arguments)}var u=g.Class,v=g.dom,s=g.data,p=s.SUBSCRIPTION,f=s.DataObject,
x=s.AbstractDataset,r=s.Dataset,e=v.AXIS_DESCENDANT,m=v.AXIS_DESCENDANT_OR_SELF,d=Function.getter,a=Object.complete,b=v.axis,s=g.EventObject.createEvent,c=g.EventObject.event,i={NONE:"none",PARENT:"parent",OWNER:"owner"};p.add("DATASOURCE",{dataSourceChanged:function(a,c){this.remove(a,c);this.add(a,a.dataSource)}},function(a,c){a(c,c.dataSource)});var h=u.ExtensibleProperty(),j={ownerChanged:function(){},destroy:function(a){v.replace(a.element,this)}},B=function(){var a=this.key,c=this.config,b=
this.owner,h="function"!=typeof c.existsIf||c.existsIf(b),i=b.satellite[a];if(h){var h="delegate"in c,d="dataSource"in c,e="function"==typeof c.delegate?c.delegate(b):null,m="function"==typeof c.dataSource?c.dataSource(b):null;if(i)h&&i.setDelegate(e),d&&i.setDataSource(m);else{var f=b.tmpl[c.replace||a],i={owner:b};if(h)i.delegate=e;if(d)i.dataSource=m;c.config&&Object.complete(i,"function"==typeof c.config?c.config(b):c.config);i=new c.instanceOf(i);b.satellite[a]=i;f&&i instanceof g.ui.Node&&i.element&&
(v.replace(f,i.element),i.addHandler(j,f))}}else if(i)i.destroy(),i.owner=null,delete b.satellite[a]},A=u.CustomExtendProperty({update:!0},function(a,c){for(var b in c)a[b]=c[b]?B:null}),y=u(f,{event_update:function(a,c){f.prototype.event_update.call(this,a,c);var b=this.parentNode;b&&(b.matchFunction&&this.match(b.matchFunction),b.insertBefore(this,this.nextSibling))},event_childNodesModified:s("childNodesModified","node","delta"),event_dataSourceChanged:s("dataSourceChanged","node","oldDataSource"),
event_localGroupingChanged:s("localGroupingChanged","node","oldGroupingNode"),event_localSortingChanged:s("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:s("ownerChanged","node","oldOwner"),event_satellitesChanged:s("satellitesChanged","node","delta"),subscribeTo:f.prototype.subscribeTo+p.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegate:i.NONE,nodeType:"DOMWrapperNode",canHaveChildren:!1,childNodes:null,dataSource:null,colMap_:null,
destroyDataSourceMember:!0,document:null,parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:!1,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:h,satellite:null,owner:null,init:function(a){var c=this.dataSource,b=this.childNodes,i=this.localGrouping;if(c)this.dataSource=null;f.prototype.init.call(this,a);if(i)this.localGrouping=null,this.setLocalGrouping(i);if(this.canHaveChildren)this.childNodes=[],c?(this.dataSource=
null,this.setDataSource(c)):b&&this.setChildNodes(b);else{if(b)this.childNodes=null;if(c)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==h)for(var j in this.satelliteConfig)if(a=this.satelliteConfig[j],u.isClass(a)&&(a={instanceOf:a}),"object"==typeof a){c={key:j,owner:this,config:a};a=a.hook?A.__extend__(a.hook):A;for(j in a)if(a[j]===B){this.addHandler(a,c);break}B.call(c)}if(j=this.owner)this.owner=null,this.setOwner(j)},appendChild:function(){},insertBefore:function(){},
removeChild:function(){},replaceChild:function(){},clear:function(){},hasChildNodes:function(){return 0<this.childNodes.length},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||!1==a instanceof y)a=null;if(this.owner!==a){var c=this.owner,b=this.listen.owner;this.owner=a;b&&(c&&c.removeHandler(b,this),a&&a.addHandler(b,this));this.event_ownerChanged(this,c);this.autoDelegate==i.OWNER&&this.setDelagate(a)}},
destroy:function(){f.prototype.destroy.call(this);this.dataSource?this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var c=this.satellite[a];c.destroy();c.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=
null}}),C=u(y,{autoDestroyIfEmpty:!1,nodes:null,first:null,last:null,init:function(a){this.nodes=[];y.prototype.init.call(this,a)},insert:function(a,c){var b=this.nodes,h=c?b.indexOf(c):-1;-1==h?(b.push(a),this.last=a):b.splice(h,0,a);this.first=b[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var c=this.nodes;if(c.remove(a))this.first=c[0]||null,this.last=c[c.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&
this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=this.nodes,c=a.length;0<c--;)a[c].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){y.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),E={canHaveChildren:!0,childClass:y,childFactory:null,listen:{dataSource:{datasetChanged:function(a,c){var b={},h=[];if(c.deleted)if(b.deleted=h,this.childNodes.length==
c.deleted.length){h.push.apply(h,this.childNodes);var i=this.dataSource;this.dataSource=null;this.clear(!0);this.dataSource=i;this.colMap_={}}else for(var i=0,j;j=c.deleted[i];i++){j=j.eventObjectId;var d=this.colMap_[j];delete this.colMap_[j];d.canHaveDelegate=!0;this.removeChild(d);h.push(d)}if(c.inserted){b.inserted=[];for(i=0;j=c.inserted[i];i++)d=w(this,{cascadeDestroy:!1,delegate:j}),d.canHaveDelegate=!1,this.colMap_[j.eventObjectId]=d,b.inserted.push(d),this.firstChild&&this.insertBefore(d)}this.firstChild?
this.event_childNodesModified(this,b):this.setChildNodes(b.inserted);if(this.destroyDataSourceMember&&h.length)for(i=0;j=h[i];i++)j.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,c){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var h=this;do if(h==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";
while(h=h.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";!1==a instanceof this.childClass&&(a=w(this,a instanceof f?{delegate:a}:a));var j=a.parentNode===this,d=a.groupNode,m=this.localGrouping,y=this.localSorting,g,r=this.childNodes,z,x,B=null,h=-1,k=!1,p;if(j)p=a.nextSibling,x=a.previousSibling;if(y&&(c=null,g=this.localSortingDesc,z=y(a)||0,j))if(z===a.sortingValue)k=!0;else if((!p||(g?
p.sortingValue<=z:p.sortingValue>=z))&&(!x||(g?x.sortingValue>=z:x.sortingValue<=z)))a.sortingValue=z,k=!0;if(m){B=m.getGroupNode(a);x=B.nodes;if(d===B&&(k||j&&p===c))return a;y?k?h=p&&p.groupNode===B?x.indexOf(p):x.length:(h=x.binarySearchPos(z,n,g),a.sortingValue=z):h=c&&c.groupNode===B?x.indexOf(c):x.length;if(h<x.length)c=x[h];else if(B.last)c=B.last.nextSibling;else{h=B;for(c=null;(h=h.nextSibling)&&!(c=h.first););}if(a===c||j&&a.nextSibling===c)return d!==B&&(d&&d.remove(a),B.insert(a)),a;h=
-1}else if(y){if(k)return a;h=r.binarySearchPos(z,n,g);c=r[h];a.sortingValue=z;if(a===c||j&&p===c)return a}else{if(c&&c.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(j){if(p===c)return a;if(a===c)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}j?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=
null,a.nextSibling=null,-1==h?r.remove(a):(g=r.indexOf(a),r.splice(g,1),g<h&&h--),d&&(d.remove(a),d=null)):a.parentNode&&a.parentNode.removeChild(a);d!=B&&B.insert(a,c);if(c){-1==h&&(h=r.indexOf(c));if(-1==h)throw"basis.dom.wrapper: Node was not found";a.nextSibling=c;r.splice(h,0,a)}else h=r.length,r.push(a),c={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=c.previousSibling;0==h?this.firstChild=a:c.previousSibling.nextSibling=a;c.previousSibling=a;var l=!1,
A=!1,o=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)l=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==o)a.contextSelection=o,A=!a.selection,a.selected&&o.add([a]);a.firstChild&&(l||A)&&b(a,e).forEach(function(a){if(l&&!a.document)a.document=l;if(A&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=o});j||(a.match&&a.match(this.matchFunction),a.autoDelegate==i.PARENT&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,
{inserted:[a]}));return a},removeChild:function(a){if(null==a||a.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(!1==a instanceof this.childClass)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(a))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(a),1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;
a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.document===this.document&&b(a,m).forEach(function(a){if(a.document==this.document)a.document=null},this);if(a.contextSelection){for(var c=a.contextSelection,h=a,j=[];h;){if(h.contextSelection===c)h.selected&&j.push(h),h.contextSelection=null;if(!h.selection&&h.firstChild)h=h.firstChild;else if(h.nextSibling)h=h.nextSibling;else for(;h=h.parentNode;)if(h.nextSibling){h=
h.nextSibling;break}}c.remove(j)}a.groupNode&&a.groupNode.remove(a);this.dataSource||this.event_childNodesModified(this,{deleted:[a]});a.autoDelegate==i.PARENT&&a.setDelegate();return a},replaceChild:function(a,c){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(null==c||c.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,c);return this.removeChild(c)},clear:function(a){if(this.dataSource)this.setDataSource();
else if(this.firstChild){var c=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:c});for(var h=c.length;0<h--;){var j=c[h];j.parentNode=null;j.groupNode=null;a?((j.selection||j.document)&&b(j,v.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),j.nextSibling=null,j.previousSibling=null,j.autoDelegate==
i.PARENT&&j.setDelegate()):j.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(h=a.length-1;c=a[h];h--)c.clear()}}},setChildNodes:function(a,c){this.dataSource||this.clear(!!c);if(a&&(!1=="length"in a&&(a=[a]),a.length)){var b=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var h=0,i=a.length;h<i;h++)this.insertBefore(a[h]);this.event_childNodesModified=b;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||
!this.canHaveChildren||!1==a instanceof x)a=null;if(this.dataSource!==a){var c=this.dataSource,b=this.listen.dataSource;this.dataSource=a;if(c)this.colMap_=null,b&&c.removeHandler(b,this),c.itemCount&&this.clear();if(a)this.colMap_={},b&&(a.addHandler(b,this),a.itemCount&&b.datasetChanged&&b.datasetChanged.call(this,a,{inserted:a.getItems()}));this.event_dataSourceChanged(this,c)}},setLocalGrouping:function(a){if("function"==typeof a||"string"==typeof a)a={groupGetter:d(a)};!1==a instanceof G&&(a=
null!=a&&"object"==typeof a?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var c=this.localGrouping,b;if(this.localGrouping){if(!a&&(this.localGrouping=null,this.firstChild)){b=this.localSorting?l(this):this.childNodes;for(var h=b.length;0<h--;)b[h].groupNode=null;q(this,b)}c.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){b=this.localSorting?l(this):this.childNodes;for(h=0;a=b[h];h++)a.groupNode=this.localGrouping.getGroupNode(a);for(h=
0;a=b[h];h++)a.groupNode.nodes.push(a);b.length=0;for(h=this.localGrouping.nullGroup;h;h=h.nextSibling)a=h.nodes,h.first=a[0]||null,h.last=a[a.length-1]||null,b.push.apply(b,a),h.event_childNodesModified(h,{inserted:a});q(this,b)}this.event_localGroupingChanged(this,c)}},setLocalSorting:function(a,c){a&&(a=d(a));if(this.localSorting!=a||this.localSortingDesc!=!!c){var b=this.localSorting,h=this.localSortingDesc;this.localSortingDesc=!!c;this.localSorting=a||null;if(a&&this.firstChild){var i=[],j;
for(j=this.firstChild;j;j=j.nextSibling)j.sortingValue=a(j)||0;if(this.localGrouping)for(var e=this.localGrouping.nullGroup;e;e=e.nextSibling)j=e.nodes=l({childNodes:e.nodes,localSortingDesc:this.localSortingDesc}),e.first=j[0]||null,e.last=j[j.length-1]||null,i.push.apply(i,j);else i=l(this);q(this,i)}this.event_localSortingChanged(this,b,h)}},setMatchFunction:function(a){if(this.matchFunction!=a){var c=this.matchFunction;this.matchFunction=a;for(var b=this.lastChild;b;b=b.previousSibling)b.match(a);
this.event_matchFunctionChanged(this,c)}}},p=u(y,{event_enable:s("enable","node"),event_disable:s("disable","node"),event_select:s("select","node"),event_unselect:s("unselect","node"),event_match:s("match","node"),event_unmatch:s("unmatch","node"),event_matchFunctionChanged:s("matchFunctionChanged","node","oldMatchFunction"),selectable:!0,selected:!1,selection:null,contextSelection:null,matchFunction:null,matched:!0,disabled:!1,init:function(a){if(this.selection&&!1==this.selection instanceof x)this.selection=
new z(this.selection);y.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=!1,this.select(!0)},setSelection:function(a){if(this.selection==a)return!1;var c=this.selection;b(this,e,function(b){if(b.contextSelection==c)b.selected&&c&&c.remove([b]),b.contextSelection=a});this.selection=a;return!0},hasOwnSelection:function(){return!!this.selection},select:function(a){var c=this.selected,b=this.contextSelection;if(b)a?c?b.remove([this]):b.add([this]):this.selectable&&
b.set([this]);else if(!c&&this.selectable&&!this.isDisabled())this.selected=!0,this.event_select(this);return this.selected!=c},unselect:function(){var a=this.selected;if(a){var c=this.contextSelection;c?c.remove([this]):(this.selected=!1,this.event_unselect(this))}return this.selected!=a},enable:function(){if(this.disabled)this.disabled=!1,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=!0,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&
this.document.disabled||!!v.findAncestor(this,d("disabled"))},match:function(a){"function"!=typeof a&&(a=null);this.underMatch_&&!a&&this.underMatch_(this,!0);this.underMatch_=a;a=!a||a(this);if(this.matched!=a)(this.matched=a)?this.event_match(this):this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();y.prototype.destroy.call(this)}}),F=u(p,E,{}),G=u(y,E,{event_childNodesModified:function(a,
b){c.childNodesModified.call(this,a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var h=this.owner,i=Array.from(this.nullGroup.nodes),j=i.length;0<j--;)h.insertBefore(i[j],i[j].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,!0);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);c.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},
map_:null,autoDestroyWithNoOwner:!0,autoDestroyEmptyGroups:!0,titleGetter:d("data.title"),groupGetter:Function.$undef,childClass:C,childFactory:function(c){return new this.childClass(a(c,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?!1:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new C({autoDestroyIfEmpty:!1});y.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),c=a instanceof f,b=this.map_[c?a.eventObjectId:a];!b&&!this.dataSource&&
(b=this.appendChild(c?{delegate:a}:{data:{id:a,title:a}}));return b||this.nullGroup},insertBefore:function(a,c){a=E.insertBefore.call(this,a,c);if(!1=="groupId_"in a)a.groupId_=a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=a;if(a.first){var b=this.owner,h=b.childNodes,i=a.first,j=a.last,d,e,m;for(d=a;(d=d.previousSibling)&&!(m=d.last););if(!m)m=this.nullGroup.last;for(d=a;(d=d.nextSibling)&&!(e=d.first););if(i.previousSibling!==m||j.nextSibling!==e){if(i.previousSibling)i.previousSibling.nextSibling=
j.nextSibling;if(j.nextSibling)j.nextSibling.previousSibling=i.previousSibling;d=h.splice(h.indexOf(i),a.nodes.length);var f=h.indexOf(e);d.unshift(-1!=f?f:h.length,0);h.splice.apply(h,d);i.previousSibling=m;j.nextSibling=e;if(m)m.nextSibling=i;if(e)e.previousSibling=j;b.firstChild=h[0];b.lastChild=h[h.length-1]}}return a},removeChild:function(a){E.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){E.clear.call(this);this.map_={}},destroy:function(){this.setOwner();y.prototype.destroy.call(this);
this.map_=null}});y.prototype.localGroupingClass=G;var s=u(x,{autoDestroy:!0,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,c){var b=this.memberMap_,h={},i=0,j=0,d=c.inserted,e=c.deleted;if(d&&d.length)for(h.inserted=d;a=d[i];)b[a.eventObjectId]=a,i++;if(e&&e.length)for(h.deleted=e;a=e[j];)delete b[a.eventObjectId],j++;(i||j)&&this.event_datasetChanged(this,h)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:s("sourceNodeChanged")&&
function(a,b){c.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:!1,init:function(a,c){x.prototype.init.call(this,c);a&&this.setSourceNode(a)},setSourceNode:function(a){!1==a instanceof y&&(a=null);if(a!==this.sourceNode){var c=this.sourceNode,b=this.listen.sourceNode;this.sourceNode=a;if(b){var h=b.childNodesModified;c&&(c.removeHandler(b,this),h&&h.call(this,c,{deleted:c.childNodes}));a&&(a.addHandler(b,this),h&&h.call(this,a,{inserted:a.childNodes}))}this.event_sourceNodeChanged(this,
c)}},destroy:function(){this.setSourceNode();x.prototype.destroy.call(this)}}),z=u(r,{multiple:!1,event_datasetChanged:function(a,c){r.prototype.event_datasetChanged.call(this,a,c);if(c.inserted)for(var b=0,h;h=c.inserted[b];b++)if(!h.selected)h.selected=!0,h.event_select();if(c.deleted)for(b=0;h=c.deleted[b];b++)if(h.selected)h.selected=!1,h.event_unselect()},add:function(a){if(!this.multiple){if(this.itemCount)return this.set(a);a.splice(1)}for(var c=[],b=0,h;h=a[b];b++)h.contextSelection==this&&
h.selectable&&c.push(h);return r.prototype.add.call(this,c)},set:function(a){for(var c=[],b=0,h;h=a[b];b++)h.contextSelection==this&&h.selectable&&c.push(h);this.multiple||a.splice(1);return r.prototype.set.call(this,c)}});g.namespace("basis.dom.wrapper",t).extend({DELEGATE:i,AbstractNode:y,InteractiveNode:p,Node:F,GroupingNode:G,PartitionNode:C,simpleTemplate:t,ChildNodesDataset:s,Selection:z})})(basis);
(function(g,n){function k(a,c){return q(c,!0).getRule(a,!0)}function o(a,c){var b=a.match(/^([^{]+)\{(.*)\}\s*$/);if(b){for(var h=b[1].trim().split(/\s*,\s*/),i=0;i<h.length;i++)this.addRule(h[i],b[2]||null,c++);return c-1}}function l(a,c){var b=e.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:c?"alternate ":"",url:a.quote('"')}));e.tag(null,"HEAD")[0].appendChild(b);b=b.sheet||b.styleSheet;try{if(!b.cssRules)b.cssRules=b.rules}catch(h){}if(!b.insertRule)b.insertRule=
o;if(!b.deleteRule)b.deleteRule=b.removeRule;return b}function q(a,b){a||(a="DefaultGenericStyleSheet");c[a]||b&&(c[a]=new j(l()));return c[a]}function w(a,c,b,j){for(var j=j||{},c=c.qw(),d=0,e;e=c[d];d++)if("undefined"!=typeof h.style[e]){b&&(g.platformFeature["css-"+a]=e);i[a]={key:e,getter:j[e]};break}}function t(a,c){var b=i[a];if(a=b?b.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:b&&b.getter?b.getter(c):c}}function u(a,c,b){if("function"==typeof a.setProperty)return a.setProperty(c,
b);if(c=t(c,b))return a.style[c.key]=c.value}function v(a,c){for(var b in c)u(a,b,c[b]);return a}function s(a,c){return u(a,"display","string"==typeof c?c:c?"":"none")}function p(a,c){return u(a,"visibility",c?"":"hidden")}function f(a){return E[a]||(E[a]=RegExp("\\s*\\b"+a+"\\b"))}function x(a,c){var b=(c?"g":"s")+a;return G[b]||(G[b]=RegExp((c?"":"\\s*")+"\\b"+a+"\\S*\\b"))}var r=n.document,e=g.dom,m=g.dom.event,d=g.Class,a=/\s*!important/i,b=1,c={},i={},h=e.createElement("DIV");w("opacity","opacity MozOpacity KhtmlOpacity filter",
!0,{fitler:function(a){return"alpha(opacity:"+parseInt(100*a)+")"}});w("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",!0);w("float","cssFloat styleFloat");var j=d(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,c){if(!this.map_[a]&&c){for(var b=this.styleSheet,h=this.rules.length,i=b.insertRule(a+"{}",h),j=h;j<=i;j++)this.rules.push(new B(b.cssRules[j]));this.map_[a]=h!=i?new A(this.rules.splice(h)):this.rules[h]}return this.map_[a]},
deleteRule:function(a){var c=this.map_[a];if(c){for(var c=c.rules||[c],b=0;b<c.length;b++){var h=this.rules.indexOf(c[b]);this.stylesheet.deleteRule(h);this.rules.splice(h,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),B=d(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(c,b){var h,i=!!a.test(b),j=this.rule.style;if(i||j.getPropertyPriority&&"important"==j.getPropertyPriority(c)){if(b=b.replace(a,""),h=t(c,b)){var d=
h.key;j.setProperty?(i||j.removeProperty(d),j.setProperty(d,h.value,i?"important":"")):j.cssText=j.cssText.replace(RegExp(j[d]?d+"\\s*:\\s*"+j[d]+"(\\s*!important)?\\s*;?":"^","i"),d+": "+h.value+(i?" !important":"")+";")}}else u(this.rule,c,b)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),A=d(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});["setProperty","setStyle",
"clear"].forEach(function(a){A.prototype[a]=function(){for(var c,b=0;c=this.rules[b];b++)c[a].apply(c,arguments)}});var y={};["em","ex","px","%"].forEach(function(a){y["%"==a?"percent":a]=function(c){return 0==c||isNaN(c)?"0":c+a}});var C,E={},F=d(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,c,b){b=b||"";"undefined"!=typeof a&&this.remove(b+a);"undefined"!=typeof c&&this.add(b+
c)},bool:function(a,c){c?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(f(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(f(a))||(this.element.className+=" "+a)},remove:function(a){var c=this.element.className,a=c.replace(f(a),"");if(a!=c)this.element.className=a},toggle:function(a){var c=this.contains(a);c?this.remove(a):this.add(a);return!c}}),G={},z=d(null,
{delim:"-",init:function(a,c){this.classList=c;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(x(this.prefix,!0))},set:function(a){var c=this.items(),a="undefined"!=typeof a?this.prefix+a:"",b=this.classList;if(c)if(1==c.length){if(c[0]===a)return;b.remove(c[0])}else this.clear();a&&b.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});n.DOMTokenList&&r.documentElement.classList?(d=F.prototype,Object.extend(n.DOMTokenList.prototype,{set:d.set,replace:d.replace,bool:d.bool,clear:function(){for(var a=this.length;0<a--;)this.remove(this[a])},setPrefixToken:d.setPrefixToken}),C=function(a){return("string"==typeof a?e.get(a):a).classList}):C=function(a){return new F("string"==typeof a?e.get(a):a)};m.onLoad(function(){C(r.body).bool("opacity-not-support",!g.platformFeature["css-opacity"])});e.extend({setStyleProperty:u,
setStyle:v,display:s,show:function(a){return s(a,1)},hide:function(a){return s(a)},visibility:p,visible:function(a){return p(a,1)},invisible:function(a){return p(a)}});return g.namespace("basis.cssom").extend({setStyleProperty:u,setStyle:v,classList:function(a,c){return c?new z(c,C(a)):C(a)},uniqueRule:function(a){var c="genericRule-"+b++;a&&C(a).add(c);a=k("."+c);a.token=c;return a},cssRule:k,getStyleSheet:q,addStyleSheet:l,CssStyleSheetWrapper:j,CssRuleWrapper:B,CssRuleWrapperSet:A}).extend(y)})(basis,
this);
(function(g){function n(e){return!(e%400&&(!(e%100)||e%4))}function k(e,d){return 1==e?28+n(d):w[e]}function o(e,d){return d.replace(x,function(a,b){return p[b](e)})}function l(e,d,a,b,c,i,h){return new Date(e,d-1,a,b||0,c||0,i||0,h||0)}var q=Function.getter,w=[31,28,31,30,31,30,31,31,30,31,30,31],t={day:864E5,hour:36E5,minute:6E4,second:1E3},u="year month day hour minute second millisecond".qw(),v={},s={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(e,d){v[e]=q("get"+d+"()");s[e]=new Function("d,v","d.set"+d+"(v)")});var p={y:q("getFullYear().toString().substr(2)"),Y:q("getFullYear()"),d:q("getDate()"),D:q("getDate()","{0:02}"),m:q("getMonth() + 1"),M:q("getMonth() + 1","{0:02}"),h:q("getHours()"),H:q("getHours()","{0:02}"),i:q("getHours() % 12 || 12","{0:02}"),p:q("getHours() > 12",{"true":"pm","false":"am"}),P:q("getHours() > 12",{"true":"PM","false":"AM"}),I:q("getMinutes()","{0:02}"),s:q("getSeconds()"),
S:q("getSeconds()","{0:02}"),z:q("getMilliseconds()"),Z:q("getMilliseconds()","{0:03}")},f=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,x=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return n(this.getFullYear())},getMonthDayCount:function(){return k(this.getMonth(),this.getFullYear())},add:function(e,d){var a=v[e];if(!a)throw Error("Unknown date part: "+e);var b;if("year"==e||"month"==e)b=this.getDate(),28<b&&this.setDate(1);s[e](this,a(this)+
d);28<b&&(a=this.getMonthDayCount(),b>a&&this.setDate(a));return this},diff:function(e,d){if("year"==e||"month"==e){var a=0<Number(this)-Number(d)?-1:1,b=0<a?this:d,c=0<a?d:this,i=b.getFullYear(),i=c.getFullYear()-i;if("year"==e)return a*i;b=b.getMonth();c=c.getMonth();return a*(i?(1<i?12*(i-1):0)+(11-b)+(c+1):c-b)}a=Math.floor((d-this)/t[e]);return a+Number(0!=v[e](new Date(d-a*t[e]))-v[e](this))},set:function(e,d){var a=s[e];if(!a)throw Error("Unknown date part: "+e);var b;if("year"==e||"month"==
e)b=this.getDate(),28<b&&this.setDate(1);a(this,d);28<b&&(a=this.getMonthDayCount(),b>a&&this.setDate(a));return this},get:function(e){if(v[e])return v[e](this);throw Error("Unknown date part: "+e);},toISODateString:function(){return o(this,"%Y-%M-%D")},toISOTimeString:function(){return o(this,"%H:%I:%S.%Z")},fromDate:function(e){e instanceof Date&&(this.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),this.setTime(e.getTime()));return this},toFormat:function(e){return o(this,e)}});var r=Date.prototype.toISOString;
if(r&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return r.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(e){var d=(""+e).match(f);if(!d)throw Error("Value of date isn't in ISO format: "+e);d[2]-=1;for(var e=0,a;a=u[e];e++)this.set(a,d[e+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,toODBCTime:Date.prototype.toISOTimeString,
toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var e=/\D/;Date.fromISOString=function(m){return m?l.apply(null,(""+m).split(e)):null};Date.timer=function(e){var d=e||new Date;d.measure=function(a){return a?((new Date-d)/1E3).toFixed(3):new Date-d};return d};g.namespace("basis.date").extend({isLeapYear:n,getMonthDayCount:k,format:o})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.html.Template,l=g.cssom.classList,q=Function.getter,w=g.Cleaner,t=g.dom.wrapper.Node,u=g.dom.wrapper.PartitionNode,v=g.dom.wrapper.GroupingNode,s=n.ExtensibleProperty(),p=function(f){return{template:new o("<div/>"),action:s,cssClassName:null,event_update:function(g,e){this.templateUpdate(this.tmpl,"update",e);f.event_update.call(this,g,e)},event_select:function(g){f.event_select.call(this,g);l(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(g){f.event_unselect.call(this,g);l(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(g){f.event_disable.call(this,g);l(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(g){f.event_enable.call(this,g);l(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(g){f.event_match.call(this,g);k.display(this.element,!0)},event_unmatch:function(g){f.event_unmatch.call(this,g);k.display(this.element,
!1)},init:function(g){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&k.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=k.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;f.init.call(this,g);if(this.id)this.element.id=
this.id;if(g=this.cssClassName){"string"==typeof g&&(g={element:g});for(var e in g){var m=this.tmpl[e];if(m)for(var m=l(m),d=(""+g[e]).qw(),a=0,b;b=d[a++];)m.add(b)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&k.insert(this.container,this.element)},templateAction:function(f,e){var m=this.action[f];m&&m.call(this,e)},templateUpdate:function(){},destroy:function(){var g=this.element;f.destroy.call(this);g&&g.parentNode&&g.parentNode.removeChild(g);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},t=n(t,p,{}),q=n(u,p,{titleGetter:q("data.title"),templateUpdate:function(f){if(f.titleText)f.titleText.nodeValue=""+this.titleGetter(this)}}),p=function(f){return{insertBefore:function(g,e){var g=f.insertBefore.call(this,g,e),m=g.groupNode||this,d=g.nextSibling,m=m.childNodesElement||m.element||this.childNodesElement||this.element,a=g.element,d=(d&&d.element.parentNode==m?d.element:null)||m.insertPoint||null;(a.parentNode!==m||a.nextSibling!==
d)&&m.insertBefore(a,d);return g},removeChild:function(g){f.removeChild.call(this,g);var e=g.element,m=e.parentNode;m&&m.removeChild(e);return g},clear:function(g){if(g)for(var e=this.firstChild;e;){var m=e.element;m.parentNode&&m.parentNode.removeChild(m);e=e.nextSibling}f.clear.call(this,g)},setChildNodes:function(g,e){var m=k.createFragment(),d=this.localGrouping||this,a=d.childNodesElement||d.element;d.childNodesElement=m;f.setChildNodes.call(this,g,e);a.insertBefore(m,a.insertPoint||null);d.childNodesElement=
a}}},u=n(v,p,{childClass:q,localGroupingClass:n.SELF,event_ownerChanged:function(f,g){var e=this,m=this.owner,d=null;m&&(d=m.tmpl&&m.tmpl.groupsElement||m.childNodesElement||m.element,d.appendChild(this.nullElement));do e.element=e.childNodesElement=d;while(e=e.localGrouping);v.prototype.event_ownerChanged.call(this,f,g)},init:function(f){this.element=this.childNodesElement=this.nullElement=k.createFragment();v.prototype.init.call(this,f)}}),f=n(t,p,{childClass:t,childFactory:function(f){return new this.childClass(f)},
localGroupingClass:u}),n=n(f,{selection:{},init:function(g){this.document=this;f.prototype.init.call(this,g);w.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;f.prototype.destroy.call(this);w.remove(this)}}),p=function(f,g){for(var e=f.match(/\{(this_[^\}]+)\}/g)||[],m=[],d=0;d<e.length;d++){var a=e[d].match(/\{(this_[^\|\}]+)\}/)[1];m.push("this.tmpl."+a+".nodeValue = "+a.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(c,i,h){a.templateUpdate.call(this,c,i,h);_code_()}},config_)}.toString().replace("_code_()",m.join(";\n")))(new o(f),g)};g.namespace("basis.ui",p).extend({simpleTemplate:p,Node:t,Container:f,PartitionNode:q,GroupingNode:u,Control:n})})(basis);
(function(g,n){function k(a,c){if(j)try{return parseFloat(w.getComputedStyle(a,null)[c])}catch(b){return 0}else return 0}function o(a,c){if(j)return k(a,"height");p.setStyle(c,{borderTop:a.currentStyle.borderTopWidth+" solid red",borderBottom:a.currentStyle.borderBottomWidth+" solid red",paddingTop:a.currentStyle.paddingTop,paddingBottom:a.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"});return a.offsetHeight-c.offsetHeight}function l(a,c){if(h)f(a).add("Basis-Layout-OnResizeElement"),
a.onresize=c;else{var b=u.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});u.insert(a,b);b.onload=function(){(b.contentWindow.onresize=c)()}}}for(var q=n.document,w=q.defaultView,t=g.Class,u=g.dom,v=g.ua,s=Object.extend,p=g.cssom,f=g.cssom.classList,x=g.ui.Container,r=v.test("IE"),e=v.test("IE7+"),m=!1,d=u.createElement(""),a=["","-webkit-"],b=0;b<a.length;b++)try{var c=a[b]+"box";d.style.display=
c;if(d.style.display==c){m=a[b];break}}catch(i){}var h="undefined"!=typeof d.onresize,j=w&&w.getComputedStyle,d=function(){return u.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};d.className="basis.Layout.Helper";var B={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:!1},A=t(null,{init:function(a,c,b){this.reset();this.setElement(a,c,b)},setElement:function(a,c,b){this.element=u.get(a);
this.offsetElement=b;c||this.recalc(this.offsetElement)},copy:function(a){"top,left,bottom,right,height,width,defined".split(",").forEach(function(c){this[c]=a[c]},this)},reset:function(){s(this,B)},set:function(a,c){if(this.defined){switch(a.toLowerCase()){case "left":this.left=c;this.right=this.left+this.width;break;case "right":this.right=c;this.left=this.right-this.width;break;case "width":this.width=c;this.right=this.left+this.width;break;case "top":this.top=c;this.bottom=this.top+this.height;
break;case "bottom":this.bottom=c;this.top=this.bottom-this.height;break;case "height":this.height=c,this.bottom=this.top+this.height}(0>=this.width||0>=this.height)&&this.reset()}return this},recalc:function(a){this.reset();var c=this.element;if(c){var b=c,h=q.documentElement;if(c.getBoundingClientRect)b=c.getBoundingClientRect(),this.top=b.top,this.left=b.left,r&&(e?(this.top+=h.scrollTop-h.clientTop,this.left+=h.scrollLeft-h.clientLeft):c!=q.body&&(this.top-=q.body.clientTop-q.body.scrollTop,this.left-=
q.body.clientLeft-q.body.scrollLeft)),a&&(a=new A(a),this.top-=a.top,this.left-=a.left,a.destroy());else if(q.getBoxObjectFor){var i=q.getBoxObjectFor(h),b=q.getBoxObjectFor(c);this.top=b.screenY-i.screenY;this.left=b.screenX-i.screenX;if(v.test("FF1.5-")){if(b=c.offsetParent)this.top-=b.scrollTop,this.left-=b.scrollLeft;b!=q.body&&(this.top+=h.scrollTop,this.left+=h.scrollLeft)}if(v.test("FF2+")){if(this.top&&(b=h.scrollTop,2<b)){for(var i=0,j=Math.floor(Math.log(b)/Math.LN2);0<=j;j-=3)i+=1<<j;b>
i&&(this.top-=1)}this.left&&(this.left-=1<h.scrollLeft)}a&&(a=new A(a),this.top-=a.top,this.left-=a.left,a.destroy())}else if(c!=a){this.top=c.offsetTop;this.left=c.offsetLeft;this.top-=q.body.clientTop-q.body.scrollTop;for(this.left-=q.body.clientLeft-q.body.scrollLeft;(b=b.offsetParent)&&b!=a;)this.top+=b.offsetTop+b.clientTop-b.scrollTop,this.left+=b.offsetLeft+b.clientLeft-b.scrollLeft}else this.top=this.left=0;this.width=c.offsetWidth;this.height=c.offsetHeight;this.bottom=this.top+this.height;
this.right=this.left+this.width;this.defined=!0}return this.defined},intersection:function(a){if(!this.defined)return!1;!1==a instanceof A&&(a=new A(a));return a.defined&&a.right>this.left&&a.left<this.right&&a.bottom>this.top&&a.top<this.bottom},inside:function(a){if(!this.defined)return!1;!1==a instanceof A&&(a=new A(a));return a.defined&&a.left>=this.left&&a.right<=this.right&&a.bottom>=this.bottom&&a.top<=this.top},point:function(a){if(!this.defined)return!1;var c=a.left||a.x||0,a=a.top||a.y||
0;return c>=this.left&&c<this.right&&a>=this.top&&a<this.bottom},power:function(a){if(!this.defined)return!1;if(a=u.get(a)||this.element)return u.setStyle(a,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"}),!0},destroy:function(){delete this.element}}),a=t(A,{init:function(a,c,b){this.setBoxes(a,c,b)},setBoxes:function(a,c,b){this.boxA=a instanceof A?a:new A(a,!0);this.boxB=c instanceof A?c:new A(c,!0);b||this.recalc()},recalc:function(){this.reset();if(!this.boxA.recalc()||
!this.boxB.recalc())return!1;if(this.boxA.intersection(this.boxB))this.top=Math.max(this.boxA.top,this.boxB.top),this.left=Math.max(this.boxA.left,this.boxB.left),this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom),this.right=Math.min(this.boxA.right,this.boxB.right),this.width=this.right-this.left,this.height=this.bottom-this.top,0>=this.width||0>=this.height?this.reset():this.defined=!0;return this.defined}}),b=t(A,{recalc:function(){this.reset();var a=this.element;if(a){var c=a;this.width=
a.clientWidth;this.height=a.clientHeight;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();this.top=b.top;for(this.left=b.left;c=c.offsetParent;)this.top-=c.scrollTop,this.left-=c.scrollLeft}else if(q.getBoxObjectFor){b=q.getBoxObjectFor(a);this.top=b.y;for(this.left=b.x;c=c.offsetParent;)this.top-=c.scrollTop,this.left-=c.scrollLeft}else b=new A(a),this.top=b.top+a.clientTop,this.left=b.left+a.clientLeft;this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=!0}return this.defined}});
p.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});c=p.cssRule(".Basis-VerticalPanelStack");c.setStyle({overflow:"hidden"});!1!==m&&(c.setProperty("display",m+"box"),c.setProperty(m+"box-orient","vertical"));c=t(x,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(a){x.prototype.init.call(this,a);this.flex?!1!==m&&p.setStyleProperty(this.element,m+"box-flex",this.flex):!1===m&&l(this.element,function(){this.parentNode&&this.parentNode.realign()}.bind(this))}});t=t(x,
{childClass:c,template:'<div class="Basis-VerticalPanelStack">'+(m?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(a){this.cssRule=p.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");x.prototype.init.call(this,a);!1===m&&(this.realign(),l(this.childNodesElement,function(){this.realign()}.bind(this)))},insertBefore:function(a,c){if(a=x.prototype.insertBefore.call(this,a,c))return a.flex&&
this.cssRule&&f(a.element).add(this.ruleClassName),this.realign(),a},removeChild:function(a){if(x.prototype.removeChild.call(this,a))return a.flex&&this.cssRule&&f(a.element).remove(this.ruleClassName),this.realign(),a},realign:function(){if(!1===m){var a=this.element,c=this.lastChild.element,b=this.tmpl.ruller,h=(new A(c,!1,a)).bottom-k(a,"paddingTop")-k(a,"borderTopWidth")||0,a=o(a,b);if(j)h+=k(c,"marginBottom");else{var i=b.offsetHeight;b.style.height=c.currentStyle.marginBottom;h+=b.offsetHeight-
i}if(h=a-h){for(a=c=0;i=this.childNodes[a];a++)i.flex&&(c++,h+=o(i.element,b));c&&this.cssRule.setProperty("height",Math.max(0,h/c)+"px")}}}});g.namespace("basis.layout").extend({Box:A,Intersection:a,Viewport:b,VerticalPanel:c,VerticalPanelStack:t,Helper:d,addBlockResizeHandler:l})})(basis,this);
(function(g){var n=g.Class,k=g.dom.event,o=g.dom,l=Function.getter,q=g.cssom.classList,w=k.addGlobalHandler,t=k.removeGlobalHandler,u=g.EventObject,v=u.createEvent,s=g.layout,p=g.ua,f=g.ua.is("IE9-"),x,r={start:function(e){x&&r.over();x={dde:this,run:!1,event:{initX:k.mouseX(e),initY:k.mouseY(e),deltaX:0,deltaY:0}};w("mousemove",r.move,x);w("mouseup",r.over,x);w("mousedown",r.over,x);k.cancelDefault(e);this.event_prepare(x.event)},move:function(e){var d=x.dde;if(!x.run)x.run=!0,d.draging=!0,d.event_start(x.event);
if(d.axisX)x.event.deltaX=d.axisXproxy(k.mouseX(e)-x.event.initX);if(d.axisY)x.event.deltaY=d.axisYproxy(k.mouseY(e)-x.event.initY);d.event_move(x.event)},over:function(e){var d=x.dde;t("mousemove",r.move,x);t("mouseup",r.over,x);t("mousedown",r.over,x);d.draging=!1;x.run&&d.event_over(x.event);x=null;k.kill(e)}},e=n(u,{containerGetter:l("element"),element:null,trigger:null,baseElement:null,fixTop:!0,fixRight:!0,fixBottom:!0,fixLeft:!0,axisX:!0,axisY:!0,axisXproxy:Function.$self,axisYproxy:Function.$self,
event_prepare:v("prepare"),event_start:v("start"),event_move:v("move"),event_over:v("over"),init:function(e){u.prototype.init.call(this,e);var e=this.element,d=this.trigger;this.trigger=this.element=null;this.setElement(e,d);this.setBase(this.baseElement);g.Cleaner.add(this)},setElement:function(e,d){e=e&&o.get(e);d=d&&o.get(d)||e;if(this.trigger!=d&&(this.trigger&&(k.removeHandler(this.trigger,"mousedown",r.start,this),f&&k.removeHandler(this.trigger,"selectstart",r.start,this)),this.trigger=d))k.addHandler(this.trigger,
"mousedown",r.start,this),f&&k.addHandler(this.trigger,"selectstart",r.start,this);if(this.element!=e)this.element&&q(this.element).remove("Basis-Dragable"),(this.element=e)&&q(this.element).add("Basis-Dragable")},setBase:function(e){this.baseElement=o.get(e)||(p.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(x&&x.dde==this)},start:function(e){this.isDraging()||r.start.call(this,e)},stop:function(){this.isDraging()&&r.over()},destroy:function(){g.Cleaner.remove(this);
this.stop();u.prototype.destroy.call(this);this.setElement();this.setBase()}}),n=n(e,{event_start:function(f){var d=this.containerGetter(this,f.initX,f.initY);if(d){var a=new s.Box(d),b=new s.Viewport(this.baseElement);q(d).add("Basis-DragDrop-DragElement");f.element=d;f.box=a;f.viewport=b}e.prototype.event_start.call(this,f)},event_move:function(f){if(f.element){if(this.axisX){var d=f.box.left+f.deltaX;this.fixLeft&&0>d?d=0:this.fixRight&&d+f.box.width>f.viewport.width&&(d=f.viewport.width-f.box.width);
f.element.style.left=d+"px"}if(this.axisY)d=f.box.top+f.deltaY,this.fixTop&&0>d?d=0:this.fixBottom&&d+f.box.height>f.viewport.height&&(d=f.viewport.height-f.box.height),f.element.style.top=d+"px";e.prototype.event_move.call(this,f)}},event_over:function(f){f.element&&(q(f.element).remove("Basis-DragDrop-DragElement"),e.prototype.event_over.call(this,f))}});g.namespace("basis.dragdrop").extend({DragDropElement:e,MoveableElement:n})})(basis);
(function(){function g(a){if(a instanceof e)return a.set;a=a.nodeType;if(!1==isNaN(a))return 1==a?r:"nodeValue"}var n=basis.Class,k=basis.dom,o=basis.Cleaner,l=Function.getter,q=basis.cssom.classList,w=basis.EventObject,t=basis.TimeEventManager,u=w.createEvent,v=basis.data,s=v.DataObject,p=v.STATE,f=n(s,{event_change:u("change"),locked:!1,lockValue_:null,extendConstructor_:!1,updateCount:0,init:function(a,b,c){s.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy="function"==typeof c?c:
Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,b){var c=this.value,i=this.proxy?this.proxy(a):i,h=!1;if(i!==c)this.value=i,h=!0,this.updateCount+=1;!this.locked&&(h||b)&&this.event_change(i,c);return h},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=!0},unlock:function(){if(this.locked)this.locked=!1,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,b){return this.set(a,b)},reset:function(){this.set(this.initValue)},
destroy:function(){s.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),x={destroy:function(a){this.removeLink(a)}},r=function(a){k.insert(k.clear(this),a)},e=n(f,{links_:null,event_change:function(a,b){f.prototype.event_change.call(this,a,b);if(this.links_.length&&!o.globalDestroy)for(var c=0,i;i=this.links_[c++];)this.power_(i,b)},init:function(a,b,c){f.prototype.init.call(this,a,b,c);this.links_=[];o.add(this)},addLink:function(a,b,
c){if("object"!=typeof a&&!1==a instanceof Object)throw Error("basis.data.property: Link to undefined object ignored");null==b&&(b=g(a));"function"!=typeof c&&(c=l(Function.$self,c));b={object:a,format:c,field:b,isEventObject:a instanceof w};this.links_.push(b);b.isEventObject&&a.addHandler(x,this);this.power_(b);return a},addLinkShortcut:function(a,b,c){return this.addLink(a,e.shortcut[b],c)},removeLink:function(a,b){if(null!=this.links_){var c=2>arguments.length;!c&&null==b&&(b=g(a));for(var i=
0,h=0,j;j=this.links_[h];h++)j.object===a&&(c||b==j.field)?j.isEventObject&&j.object.removeHandler(x,this):this.links_[i++]=j;this.links_.length=i}},clear:function(){for(var a=0,b;b=this.links_[a];a++)b.isEventObject&&b.object.removeHandler(x,this);this.links_.clear()},power_:function(a,b){var c=a.field;if(null!=c){var i=a.format(this.value),h=a.object;"function"==typeof c?c.call(h,i,2>arguments.length?i:a.format(b)):h[c]=i}},destroy:function(){this.clear();f.prototype.destroy.call(this);this.links_=
null;o.remove(this)}});e.shortcut={className:function(a,b){q(this).replace(b,a)},show:function(a){k.display(this,!!a)},hide:function(a){k.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var m=p.PRIORITY,d={stateChanged:function(){this.fire(!1,!0)},update:function(){this.fire(!0)},change:function(){this.fire(!0)},destroy:function(a){this.remove(a)}},n=n(e,{calculateValue:function(){return this.value+1},objects:[],timer_:null,valueChanged_:!1,stateChanged_:!0,
state:p.UNDEFINED,extendConstructor_:!0,init:function(){var a=this.handler;delete this.handler;e.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();o.add(this)},add:function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a];if(c instanceof s)this.objects.add(c)&&c.addHandler(d,this);else throw Error("basis.data.property: Instance of DataObject required");
}this.fire(!0,!0)},remove:function(a){this.objects.remove(a)&&a.removeHandler(d,this);this.fire(!0,!0)},clear:function(){for(var a=0,b;b=this.objects[a];a++)b.removeHandler(d,this);this.objects.clear();this.fire(!0,!0)},fire:function(a,b){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=!0,t.add(this,"update",Date.now())},lock:function(){this.locked=!0},unlock:function(){this.locked=
!1},update:function(){delete this.timer_;t.remove(this,"update");if(!o.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var a=this.objects.length;if(a){for(var b=-2,c,i=0;i<a;i++){var h=this.objects[i],j=m.indexOf(""+h.state);j>b&&(c=h,b=j)}c&&this.setState(c.state,c.state.data)}else this.setState(p.UNDEFINED)}this.stateChanged_=this.valueChanged_=!1},destroy:function(){this.lock();this.clear();t.remove(this,"update");e.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:n,
AbstractProperty:f,Property:e,PropertySet:n})})();
(function(g){function n(g,k){var l=Date.now()-g;return l>=k?1:l/k}var k=g.Class,o=g.dom,l=g.data.property.Property,q=g.EventObject.createEvent,w=k(l,{duration:1E3,interval:50,startTime:0,timer:null,started:!1,event_start:q("start"),event_finish:q("finish"),event_invert:q("invert"),event_change:function(g,k){0==g&&this.event_start();l.prototype.event_change.call(this,g,k);1==g&&this.event_finish()},extendConstructor_:!0,init:function(g){this.run=this.run.bind(this);l.prototype.init.call(this,g)},start:function(g){this.started?
g&&this.invert():(this.startTime=Date.now(),this.started=!0,this.run())},run:function(){clearTimeout(this.timer);if(this.started){var g=n(this.startTime,this.duration);1<=g?this.stop():(this.set(g),this.timer=setTimeout(this.run,this.interval))}},invert:function(){this.event_invert();if(this.started){var g=n(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-g);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started)this.started=!1,this.set(1)},destroy:function(){this.stop();
this.clear();l.prototype.destroy.call()}}),t=k(null,{thread:null,setter:Function.$null,notRevert:!1,timeFunction:Function.$self,init:function(g,k,l,p,f){this.thread=g instanceof w?g:new w(g);this.setRange(l,p);this.setter=k;this.notInvert=f;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(f){this.setter(this.start+this.range*this.timeFunction(f))},finish:function(){this.notInvert||(this.start+=this.range,this.range*=-1)},destroy:this.destroy},
this)},setRange:function(g,k){this.start=g;this.range=k-g},destroy:function(){delete this.thread}});g.namespace("basis.animation").extend({Thread:w,Modificator:t,FX:{CSS:{FadeIn:function(g,k){return new t(g,function(g){o.setStyle(k,{opacity:g})},0,1)},FadeOut:function(g,k){return new t(g,function(g){o.setStyle(k,{opacity:g})},1,0)}}}})})(basis);
(function(g){function n(a,b,c){return c?d?a.createElementNS(c,b):a.createNode(1,b,c):a.createElement(b)}function k(a,b,c,i){a=c?d?a.createAttributeNS(c,b):a.createNode(2,b,c):a.createAttribute(b);a.nodeValue=i;return a}function o(a,b){return a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b)}function l(a,b,c){o(a,k(a.ownerDocument,e.PREFIX+(b?":"+b:""),e.NAMESPACE,c))}function q(a,b){return a.createTextNode(""+b)}function w(a,b){var c=a.nodeType,i=a.attributes,h=a.firstChild;if(h){if(h.nodeType!=
p&&h===a.lastChild)return h.nodeValue}else{var j=i&&i[0];if(c==p){if(!j)return"";if(1==i.length&&(j.baseName||j.localName)==r&&j.namespaceURI==x)return null}else if(!j)return null}var c={},j=[],d=0,e,f,g;if(h){do d=j.push(h);while(h=h.nextSibling)}if(i)for(h=0;g=i[h];h++)j.push(g);b||(b={});for(var h=0,m;m=j[h];h++){i=m.nodeName;e=h<d;g=b[i];if(e)e=w(m,b);else{if("xmlns"==i)continue;e=m.nodeValue}for(;g;)if(g.storeName&&(e[g.storeName]=i),g.rename)i=g.rename,g=b[i];else{g.format&&(e=g.format(e));
!c[i]&&g.forceArray&&(e=[e]);break}i in c?(f=c[i])&&f.push?f.push(e):c[i]=[f,e]:c[i]=e}return c}function t(a,b,c,i){if("@"==(""+b).charAt(0))return null==i?i:k(a,b.substr(1),"",""+i);b=n(a,b.toString(),i&&i.xmlns||b.namespace||c);if("undefined"==typeof i||null===i)o(b,k(a,r,x,"true"));else if("string"==typeof i||"number"==typeof i||"function"==typeof i||"boolean"==typeof i||i.constructor===Date||i.constructor===RegExp)b.appendChild(q(a,i));else{c=i.xmlns||c;i.xmlns&&e.BAD_SUPPORT&&l(b,"",c);for(var h in i){var j=
i[h];if(!("xmlns"==h||"function"==typeof j))if(j&&Array.isArray(j))for(var d=0;d<j.length;d++)b.appendChild(t(a,h,c,j[d]));else j&&"object"==typeof j&&j.toString!==Object.prototype.toString&&(j=j.toString()),(j=t(a,h,c,j))&&(j.nodeType==f?o(b,j):b.appendChild(j))}}return b}var u=g.dom,v=g.Class,s=g.ua,p=u.ELEMENT_NODE,f=u.ATTRIBUTE_NODE,v=v(null,{init:function(a,b,c){this.localpart=a;this.namespace=b||"";this.prefix=c||""},toString:function(){return this.prefix?this.prefix+":"+this.localpart:this.localpart}}),
x="http://www.w3.org/2001/XMLSchema-instance",r="nil",e={PREFIX:"xmlns",NAMESPACE:"http://www.w3.org/2000/xmlns/",BAD_SUPPORT:s.test("webkit528.16-")||s.test("opera9-")},m="native",d=!0,s=function(){var a=document.implementation;if(a&&a.createDocument)return function(c,b){var i=a.createDocument(c,b,null);if(i.charset&&i.charset!=document.charset)i.charset=document.charset;return i};if(window.ActiveXObject)for(var b=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],c=0;c<b.length;c++)try{if(new ActiveXObject(b[c]))return m=
b[c],d=!1,function(a,c){var b=new ActiveXObject(m);b.documentElement=n(b,c,a);return b}}catch(i){}throw Error("Browser doesn't support for XML document!");}();g.namespace("basis.xml").extend({NAMESPACE:{XMLShema:"http://www.w3.org/2001/XMLSchema",XMLShemaInstance:x,Namespace:"http://www.w3.org/2000/xmlns/"},XMLNS:e,QName:v,getElementsByTagNameNS:function(a,b,c){if(a.getElementsByTagNameNS)return a.getElementsByTagNameNS(c,b);var i=[];a.ownerDocument.setProperty("SelectionNamespaces",'xmlns:x="'+c+
'"');for(var a=a.selectNodes("//x:"+b),b=0,h;h=a[b++];)h.namespaceURI==c&&i.push(h);return i},addNamespace:l,createDocument:s,createElementNS:n,createAttributeNS:k,setAttributeNodeNS:o,createText:q,createCDATA:function(a,b){return a.createCDATASection(b)},XML2Object:w,XML2String:function(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if("string"==typeof a.xml)return a.xml;if(a.nodeType==u.DOCUMENT_NODE)a=a.documentElement;return u.outerHTML(a)},Object2XML:t})})(basis);
(function(g){function n(f,g){return f<<g|f>>>32-g}function k(f){var g=[];do g.push((f&15).toString(16)),f>>=4;while(f);g.length&1&&g.push("0");return g.reverse().join("")}function o(f){if("number"==typeof f)return k(f);var g=[],g=Array.isArray(f)?f.map(o):(""+f).toArray().map(function(f){return k(f.charCodeAt(0))});return g.join("")}g.namespace("basis.crypt",function(f){s=f||"";return p});var l=Array.create(255,function(f){return String.fromCharCode(f)}),q=function(){function f(f){for(var e="",g=
f.length,d=0;d<g;d++)var a=f.charCodeAt(d),e=128>a?e+l[a]:2048>a?e+(l[a>>6|192]+l[a&63|128]):e+(l[a>>12|224]+l[a>>6&63|128]+l[a&63|128]);return e}function k(f){for(var e="",g=f.length,d,a,b,c=0;c<g;)d=f.charCodeAt(c++),128>d?e+=l[d]:(a=f.charCodeAt(c++),d&32?(b=f.charCodeAt(c++),e+=String.fromCharCode((d&15)<<12|(a&63)<<6|b&63)):e+=String.fromCharCode((d&31)<<6|a&63));return e}return g.namespace("basis.crypt.UTF16").extend({toBytes:function(f){for(var e=[],g=f.length,d=0;d<g;d++){var a=f.charCodeAt(d);
e.push(a&255,a>>8)}return e},fromBytes:function(f){for(var e="",g=f.length,d,a,b=0;b<g;)d=f[b++]||0,a=f[b++]||0,e+=String.fromCharCode(a<<8|d);return e},toUTF8:f,fromUTF8:k,toUTF8Bytes:function(g){return w.toBytes(f(g))},fromUTF8Bytes:function(f){return k(w.fromBytes(f))}})}(),w=function(){return g.namespace("basis.crypt.UTF8").extend({toBytes:function(f){for(var g=f.length,k=Array(g),e=0;e<g;e++)k[e]=f.charCodeAt(e);return k},fromBytes:function(f){for(var g=f.length,k="",e=0;e<g;e++)k+=l[f[e]];return k},
toUTF16:function(f){return q.fromUTF8(f)},fromUTF16:function(f){return q.toUTF8(f)},toUTF16Bytes:function(f){return q.toBytes(q.fromUTF8(f))},fromUTF16Bytes:function(f){return q.toUTF8(q.fromBytes(f))}})}(),t=function(){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),k={};f.forEach(function(f,e){k[f]=e});return g.namespace("basis.crypt.Base64").extend({encode:function(g,e){g.constructor!=Array&&(g=e?q.toUTF8Bytes(g):q.toBytes(g));for(var m=g.length,d=0,a="",b,c,
i,h,j,k;d<m;)b=g[d++],c=g[d++],i=g[d++],h=b>>2,b=(b&3)<<4|c>>4,j=(c&15)<<2|i>>6,k=i&63,void 0==c?j=k=64:void 0==i&&(k=64),a+=f[h]+f[b]+f[j]+f[k];return a},decode:function(f,e){for(var g=[],d,a,b,c,i,h=0,f=f.replace(/[^a-z0-9\+\/]/ig,""),j=f.length;h<j;)d=k[f.charAt(h++)],a=k[f.charAt(h++)],c=k[f.charAt(h++)],i=k[f.charAt(h++)],d=d<<2|a>>4,a=(a&15)<<4|c>>2,b=(c&3)<<6|i,g.push(d,a,b);(null==c||64==c)&&g.pop();(null==i||64==i)&&g.pop();return e?q.fromUTF8Bytes(g):q.fromBytes(g)}})}(),u=function(){function f(e){for(var f=
[],d=3;0<=d;d--)f.push(e>>8*d&255);return f}var g=[1518500249,1859775393,2400959708,3395469782],k=[function(e,f,d){return d^e&(f^d)},function(e,f,d){return e^f^d},function(e,f,d){return e&f|d&(e|f)},function(e,f,d){return f^e^d}];return function(e,m){e.constructor!=Array&&(e=m?q.toUTF8Bytes(e):q.toBytes(e));for(var d=e.length,a=[],b=0;b<d;b++)a[b>>2]|=e[b]<<(3-(b&3)<<3);a[d>>2]=d&3?a[d>>2]|Math.pow(2,(4-(d&3)<<3)-1):2147483648;a.push.apply(a,Array.create((14<(a.length&15)?30:14)-(a.length&15),0));
a.push(d>>>29);a.push(d<<3&4294967295);a.reverse();for(var d=[1732584193,4023233417,2562383102,271733878,3285377520],c=Array.from(d),i,h=a.length>>4,j=Array(80);h--;){for(b=0;16>b;b++)j[b]=a.pop();for(b=16;80>b;b++)j[b]=n(j[b-3]^j[b-8]^j[b-14]^j[b-16],1);for(b=0;80>b;b++)i=Math.floor(b/20),d[4]=n(d[0],5)+k[i](d[1],d[2],d[3])+d[4]+j[b]+g[i]&4294967295,d[1]=n(d[1],30),d.unshift(d.pop());for(b=0;5>b;b++)d[b]=c[b]=d[b]+c[b]&4294967295}return d.map(f).flatten()}}(),v=function(){function f(a){for(var c=
arguments,i=c.length,h=a&65535,j=a>>16,d=1;d<i;d++)var e=c[d],h=h+(e&65535),j=j+((e>>16)+(h>>16)),h=h&65535;return j<<16|h&65535}function g(a){for(var c=[],i=0;4>i;i++)c.push(a>>8*i&255);return c}var k=Math.pow(2,32),e,m=[],d=[],a=[function(a,c,i){return i^a&(c^i)},function(a,c,i){return c^i&(c^a)},function(a,c,i){return a^c^i},function(a,c,i){return c^(a|~i)}];return function(b,c){if(!e){e=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var i=
0;64>i;i++)switch(m[i]=Math.floor(Math.abs(Math.sin(i+1))*k),i>>4){case 0:d[i]=i;break;case 1:d[i]=5*i+1&15;break;case 2:d[i]=3*i+5&15;break;case 3:d[i]=7*i&15}}b.constructor!=Array&&(b=c?q.toUTF8Bytes(b):q.toBytes(b));for(var i=[],h=b.length,j=0;j<h;j++)i[j>>2]|=b[j]<<((j&3)<<3);i[h>>2]|=128<<((h&3)<<3);i.push.apply(i,Array((14<(i.length&15)?30:14)-(i.length&15)));i.push(h<<3&4294967295);i.push(h>>>29);for(var h=[1732584193,4023233417,2562383102,271733878],p=Array.from(h),l=i.length>>4;l--;){for(j=
0;64>j;j++)h[0]=f(n(f(h[0],a[j>>4](h[1],h[2],h[3]),i[d[j]],m[j]),e[j]),h[1]),h.unshift(h.pop());for(j=0;4>j;j++)h[j]=p[j]=f(h[j],p[j])}return h.map(g).flatten()}}(),s="",p={};Object.iterate({sha1:function(f){return u(this,f)},sha1hex:function(f){return o(u(this,f))},md5:function(f){return v(this,f)},md5hex:function(f){return o(v(this,f))},base64:function(f){return t.encode(this,f)},base64decode:function(f){return t.encode(this,f)},hex:function(){return o(this)}},function(f,g){p[f]=function(f){f=g.call(s,
f);return s=Object.extend("object"!=typeof f?Object(f):f,p)}});g.namespace("basis.crypt").extend({HEX:o,SHA1:u,MD5:v})})(basis);
(function(){function g(a,b){var h={},j;if(a&&a.length)j=h.inserted=a;if(b&&b.length)j=h.deleted=b;if(j)return h}function n(a,b){if(!a.length)return 0;var h,j,d,e=0,f=a.length-1;do if(h=e+f>>1,d=a[h].value||0,d===j?(d=a[h].object.eventObjectId,j=b.object.eventObjectId):j=b.value||0,j<d)f=h-1;else if(j>d)e=h+1;else return j==d?h:0;while(e<=f);return h+(d<j)}var k=basis.Class,o=Object.extend,l=Object.values,q=Function.$self,w=Function.$true,t=Function.$false,u=basis.EventObject.createEvent,v=basis.data.SUBSCRIPTION,
s=basis.data.DataObject,p=basis.data.KeyObjectMap,f=basis.data.AbstractDataset,x=basis.data.Dataset;v.add("SOURCE",{sourceChanged:function(a,b){this.remove(a,b);this.add(a,a.source)},sourcesChanged:function(a,b){var h;if(h=b.inserted)for(var j=h.length;0<j--;)this.add(a,h[j]);if(h=b.deleted)for(j=h.length;0<j--;)this.remove(a,h[j])}},function(a,b){for(var h=b.sources||[b.source],j=0,d;d=h[j++];)a(b,d)});v.add("MINUEND",{operandsChanged:function(a,b){this.minuend!==b&&(this.remove(a,b),this.add(a,
a.minuend))}},function(a,b){a(b,b.minuend)});v.add("SUBTRAHEND",{operandsChanged:function(a,b,h){this.subtrahend!==h&&(this.remove(a,h),this.add(a,a.subtrahend))}},function(a,b){a(b,b.subtrahend)});var r=k(f,{subscribeTo:v.SOURCE,event_sourcesChanged:u("sourcesChanged","dataset","delta"),sources:null,rule:function(a){return 0<a},listen:{source:{datasetChanged:function(a,b){var h=this.memberMap_,j={},d,e;if(b.inserted)for(var f=0;d=b.inserted[f];f++)e=d.eventObjectId,h[e]?h[e].count++:h[e]={count:1,
object:d},j[e]=h[e];if(b.deleted)for(f=0;d=b.deleted[f];f++)e=d.eventObjectId,j[e]=h[e],h[e].count--;this.applyRule(j)},destroy:function(a){this.removeSource(a)}}},init:function(a){f.prototype.init.call(this,a);a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){if("function"!=typeof a)a=r.UNION;if(this.rule!==a)this.rule=a,this.applyRule()},applyRule:function(a){var b=this.memberMap_,h=this.rule,j=this.sources.length,d=[],e=[],f,m,k;a||(a=b);for(var p in a)f=b[p],
m=j&&f.count&&h(f.count,j),m!=!!this.item_[p]&&(m?d:e).push(f.object),0==f.count&&delete b[p];(k=g(d,e))&&this.event_datasetChanged(this,k)},addSource:function(a){if(a instanceof f&&this.sources.add(a)){this.listen.source&&a.addHandler(this.listen.source,this);var b=this.memberMap_,h;for(h in a.item_)b[h]?b[h].count++:b[h]={count:1,object:a.item_[h]};this.applyRule();this.event_sourcesChanged(this,{inserted:[a]});return!0}},removeSource:function(a){if(this.sources.remove(a)){this.listen.source&&a.removeHandler(this.listen.source,
this);var b=this.memberMap_,h;for(h in a.item_)b[h].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[a]});return!0}},setSources:function(a){for(var b=Array.from(this.sources),h=0,j;j=a[h];h++)j instanceof f&&(b.remove(j)||this.addSource(j));b.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){f.prototype.destroy.call(this);this.sources=null}});r.UNION=r.prototype.rule;r.INTERSECTION=function(a,b){return a==
b};r.DIFFERENCE=function(a){return 1==a};r.MORE_THAN_ONE_INCLUDE=function(a,b){return 1==b||1<a};r.AT_LEAST_ONE_EXCLUDE=function(a,b){return 1==b||a<b};var e=function(a){return!this.has(a)},m=k(f,{subscribeTo:v.MINUEND+v.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:u("operandsChanged","dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(a,b){if(this.subtrahend){var h=g(b.inserted&&b.inserted.filter(e,this.subtrahend),b.deleted&&b.deleted.filter(this.has,
this));h&&this.event_datasetChanged(this,h)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(a,b){if(this.minuend){var h=g(b.deleted&&b.deleted.filter(e,this),b.inserted&&b.inserted.filter(this.has,this));h&&this.event_datasetChanged(this,h)}},destroy:function(){this.setOperands(this.minuend,null)}}},init:function(a){f.prototype.init.call(this,a);var a=this.minuend,b=this.subtrahend;this.subtrahend=this.minuend=null;(a||b)&&this.setOperands(a,b)},setOperands:function(a,
b){var h,j=!1;!1==a instanceof f&&(a=null);!1==b instanceof f&&(b=null);var d=this.minuend,e=this.subtrahend;if(d!==a){j=!0;this.minuend=a;var m=this.listen.minuend;m&&(d&&d.removeHandler(m,this),a&&a.addHandler(m,this))}if(e!==b&&(j=!0,this.subtrahend=b,m=this.listen.subtrahend))e&&e.removeHandler(m,this),b&&b.addHandler(m,this);if(!j)return!1;this.event_operandsChanged(this,d,e);if(!a||!b)this.itemCount&&this.event_datasetChanged(this,h={deleted:this.getItems()});else{var j=[],d=[],k;for(k in this.item_)(!a.item_[k]||
b.item_[k])&&j.push(this.item_[k]);for(k in a.item_)!this.item_[k]&&!b.item_[k]&&d.push(a.item_[k]);(h=g(d,j))&&this.event_datasetChanged(this,h)}return h},clear:function(){this.setOperands()}}),d={subscribeTo:v.SOURCE,source:null,sourceMap_:null,event_sourceChanged:u("sourceChanged","dataset","oldSource"),listen:{source:{destroy:function(){this.setSource()}}},init:function(a){this.sourceMap_={};f.prototype.init.call(this,a);if(a=this.source)this.source=null,this.setSource(a)},setSource:function(a){!1==
a instanceof f&&(a=null);if(this.source!==a){var b=this.source,h=this.listen.source;this.source=a;if(h){var j=h.datasetChanged;b&&(b.removeHandler(h,this),j&&j.call(this,b,{deleted:b.getItems()}));a&&(a.addHandler(h,this),j&&j.call(this,a,{inserted:a.getItems()}))}this.event_sourceChanged(this,b)}},clear:function(){this.setSource()},destroy:function(){f.prototype.destroy.call(this);this.sourceMap_=null}},a=k(f,d,{map:q,reduce:t,rule:w,addMemberRef:null,removeMemberRef:null,listen:{sourceObject:{update:function(a){var b=
this.map?this.map(a):object;if(!1==b instanceof s||this.reduce(b))b=null;var h=this.sourceMap_[a.eventObjectId],j=h.member;if(j!=b){var d=this.memberMap_,e,f,m;h.member=b;if(j)h=j.eventObjectId,this.removeMemberRef&&this.removeMemberRef(j,a),0==--d[h]&&(delete d[h],m=[j]);if(b)j=b.eventObjectId,this.addMemberRef&&this.addMemberRef(b,a),d[j]?d[j]++:(d[j]=1,f=[b]);(e=g(f,m))&&this.event_datasetChanged(this,e)}}},source:{datasetChanged:function(a,b){var h=this.sourceMap_,j=this.memberMap_,d=[],e=[],
f,m,k,p=this.listen.sourceObject;x.setAccumulateState(!0);if(b.inserted)for(var l=0;f=b.inserted[l];l++){k=this.map?this.map(f):f;if(!1==k instanceof s||this.reduce(k))k=null;p&&f.addHandler(p,this);h[f.eventObjectId]={sourceObject:f,member:k};if(k)m=k.eventObjectId,j[m]?j[m]++:(j[m]=1,d.push(k)),this.addMemberRef&&this.addMemberRef(k,f)}if(b.deleted)for(l=0;f=b.deleted[l];l++)if(m=f.eventObjectId,k=h[m].member,p&&f.removeHandler(p,this),delete h[m],k)m=k.eventObjectId,0==--j[m]&&(delete j[m],e.push(k)),
this.removeMemberRef&&this.removeMemberRef(k,f);x.setAccumulateState(!1);(b=g(d,e))&&this.event_datasetChanged(this,b)}}},setRule:function(a){"function"!=typeof a&&(a=w);if(this.rule!==a)return this.rule=a,this.applyRule()},setMap:function(a){"function"!=typeof a&&(a=q);if(this.map!==a)return this.map=a,this.applyRule()},setReduce:function(a){"function"!=typeof a&&(a=t);if(this.reduce!==a)return this.reduce=a,this.applyRule()},applyRule:function(){var a=this.sourceMap_,b=this.memberMap_,h,j,d,e,f,
m=[],k=[],p,l;for(l in a){f=a[l];e=f.sourceObject;h=f.member;j=this.map?this.map(e):e;if(!1==j instanceof s||this.reduce(j))j=null;if(h!=j){f.member=j;if(h)d=h.eventObjectId,this.removeMemberRef&&this.removeMemberRef(h,e),b[d]--;if(j)h=j.eventObjectId,this.addMemberRef&&this.addMemberRef(j,e),h in b?b[h]++:(b[h]=1,m.push(j))}}for(d in this.item_)0==b[d]&&(delete b[d],k.push(this.item_[d]));(p=g(m,k))&&this.event_datasetChanged(this,p);return p}}),u=k(a,{reduce:function(a){return!this.rule(a)}}),v=
k(a,{map:function(a){return this.keyMap.resolve(a)},subsetClass:f,keyMap:null,addMemberRef:function(a,b){a.event_datasetChanged(a,{inserted:[b]})},removeMemberRef:function(a,b){a.event_datasetChanged(a,{deleted:[b]})},init:function(b){if(!this.keyMap||!1==this.keyMap instanceof p)this.keyMap=new p(o({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));a.prototype.init.call(this,b)},getSubset:function(a,b){return this.keyMap.get(a,b)},destroy:function(){a.prototype.destroy.call(this);this.keyMap.destroy();
this.keyMap=null}}),b=k(f,d,{rule:w,index_:null,offset:0,limit:10,listen:{sourceObject:{update:function(a){var b=this.sourceMap_[a.eventObjectId],a=this.rule(a),h=this.index_;if(a!==b.value)h.splice(n(h,b),1),b.value=a,h.splice(n(h,b),0,b),this.applyRule()}},source:{datasetChanged:function(a,b){var h=this.sourceMap_,j=this.index_,d=this.listen.sourceObject,e,f;if(f=b.inserted)for(var g=0,m;m=f[g];g++)e={object:m,value:this.rule(m)},h[m.eventObjectId]=e,j.splice(n(j,e),0,e),d&&m.addHandler(d,this);
if(f=b.deleted)for(g=0;m=f[g];g++)e=h[m.eventObjectId],j.splice(n(j,e),1),d&&m.removeHandler(d,this);this.applyRule()}}},init:function(a){this.index_=[];d.init.call(this,a)},setRange:function(a,b){this.offset=a;this.limit=b;this.applyRule()},applyRule:function(){for(var a=Object.slice(this.item_),b=this.index_.slice(this.offset,this.offset+this.limit),h=[],j,d=0,e;e=b[d];d++){var f=e.object.eventObjectId;a[f]?delete a[f]:h.push(e.object)}(j=g(h,l(a)))&&this.event_datasetChanged(this,j)},destroy:function(){d.destroy.call(this);
this.index_=null}}),k=k(f,d,{rule:w,map:q,subsetClass:f,keyMap:null,listen:{sourceObject:{update:function(a,b){var h=this.sourceMap_,j=this.memberMap_,d=a.eventObjectId,e=h[d].list,h=h[d].list={},d=this.rule(a),f=[],m=[],k;if(Array.isArray(d))for(var p=0;p<d.length;p++)if(k=this.keyMap.resolve(d[p]))l=k.eventObjectId,h[l]=k,e[l]||(k.event_datasetChanged(k,{inserted:[a]}),j[l]?j[l]++:(f.push(k),j[l]=1));for(var l in e)h[l]||(k=e[l],k.event_datasetChanged(k,{deleted:[a]}),--j[l]||(delete j[l],m.push(k)));
(b=g(f,m))&&this.event_datasetChanged(this,b)}},source:{datasetChanged:function(a,b){var h=this.sourceMap_,j=this.memberMap_,d=this.listen.sourceObject,e,f,m,k=[],p=[];if(e=b.inserted)for(var l=0,z;z=e[l];l++){var r=this.rule(z),n={object:z,list:{}};h[z.eventObjectId]=n;if(Array.isArray(r))for(var o=0;o<r.length;o++)if(f=this.keyMap.resolve(r[o]))f.event_datasetChanged(f,{inserted:[z]}),m=f.eventObjectId,n.list[m]=f,j[m]?j[m]++:(k.push(f),j[m]=1);d&&z.addHandler(d,this)}if(e=b.deleted)for(l=0;z=e[l];l++){f=
z.eventObjectId;r=h[f].list;delete h[f];for(m in r)f=r[m],f.event_datasetChanged(f,{deleted:[z]}),--j[m]||(delete j[m],p.push(f));d&&z.removeHandler(d,this)}(b=g(k,p))&&this.event_datasetChanged(this,b)}}},init:function(a){if(!this.keyMap||!1==this.keyMap instanceof p)this.keyMap=new p(o({keyGetter:this.map,itemClass:this.subsetClass},this.keyMap));d.init.call(this,a)},destroy:function(){d.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:r,
Subtract:m,MapReduce:a,Subset:u,Split:v,Slice:b,Cloud:k})})(basis,this);
(function(g){function n(a,b){if(!a.length)return 0;var c,d,e=0,i=a.length-1;do if(c=e+i>>1,d=a[c]||0,b<d)i=c-1;else if(b>d)e=c+1;else return b==d?c:0;while(e<=i);return c+(d<b)}function k(a,b){var a=Function.getter(a),c=b.indexClassId+"_"+a.getterIdx_,d=m[c];if(!d)d=m[c]=this,this.indexClass=b,this.getter=a,this.key=c,this.createInstance=function(d){if(d instanceof v){var e=d.indexes&&d.indexes[c];if(!e)e=new b(a),e.addHandler(i,d),e.key=c;return e}};return d}function o(a,b,c){var d=a.indexCache_;
a.lock();if(b)for(var e=0,i;i=b[e++];){var f=a.valueGetter(i);d[i.eventObjectId]=f;a.add(i,f)}if(c)for(e=0;i=c[e++];)a.remove(i,d[i.eventObjectId]),delete d[i.eventObjectId];a.unlock()}var l=g.Class,q=g.TimeEventManager,w=g.data,t=w.KeyObjectMap,u=w.property.Property,v=w.AbstractDataset,s=w.dataset.MapReduce,p=l(u,{autoDestroy:!0,valueGetter:Function.$null,dataSource:null,init:function(a){u.prototype.init.call(this,this.value||0);this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},
upd:function(){}}),w=l(p,{add:function(a,b){this.value+=b},remove:function(a,b){this.value-=b},upd:function(a,b,c){this.set(this.value+b-c)}}),f=l(p,{sum_:0,count_:0,add:function(a,b){this.sum_+=b;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,b){this.sum_-=b;this.value=(this.count_-=1)?this.sum_/this.count_:0},upd:function(a,b,c){this.sum_+=b-c;this.set(this.sum_/this.count_)}}),x=l(p,{valueGetter:Function.$true,add:function(a,b){b&&(this.value+=1)},remove:function(a,b){b&&(this.value-=
1)},upd:function(a,b){this.set(this.value+(b?1:-1))}}),r=l(p,{init:function(a,b){this.stack=[];p.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(n(this.stack,b),0,b);this.value=this.stack[this.stack.length-1]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[this.stack.length-1]},upd:function(a,b,c){this.stack.splice(n(this.stack,c),1);this.stack.splice(n(this.stack,b),0,b);this.set(this.stack[this.stack.length-1])}}),e=l(p,{init:function(a,b){this.stack=[];p.prototype.init.call(this,
a,b)},add:function(a,b){this.stack.splice(n(this.stack,b),0,b);this.value=this.stack[0]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[0]},upd:function(a,b,c){this.stack.splice(n(this.stack,c),1);this.stack.splice(n(this.stack,b),0,b);this.set(this.stack[0])}}),m={},d=1,a=function(a){a.indexClassId=d++;return function(b){return new k(b,a)}},w=a(w),f=a(f),x=a(x),e=a(e),r=a(r),a=function(a){var b,c,d,e=a.eventObjectId,i;for(i in this.indexes)d=this.indexes[i],b=d.indexCache_[e],c=
d.valueGetter(a),c!==b&&(d.upd(a,c,b),d.indexCache_[e]=c)},b={update:a,datasetChanged:a},c={datasetChanged:function(a,c){if(c.inserted)for(var d=0;a=c.inserted[d++];)a.addHandler(b,this);if(c.deleted)for(d=0;a=c.deleted[d++];)a.removeHandler(b,this);for(var e in this.indexes)o(this.indexes[e],c.inserted,c.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},i={destroy:function(a){this.removeIndex(a)}};v.prototype.createIndex=function(a){if(!1!=a instanceof k){if(!this.indexes)this.indexes=
{},this.addHandler(c),c.datasetChanged.call(this,this,{inserted:this.getItems()});var b=a.key;this.indexes[b]||(a=a.createInstance(this),this.indexes[b]=a,o(a,this.getItems()));return this.indexes[b]}};v.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var b in this.indexes)return;this.removeHandler(c);delete this.indexes}};l=l(s,{calcs:null,indexes:null,indexes_:null,timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,
b){s.prototype.event_sourceChanged.call(this,a,b);var c,d;for(d in this.indexes_)c=this.indexes_[d],b&&(this.removeIndex(d),b.removeIndex(this.indexes[d])),this.source&&this.addIndex(d,this.source.createIndex(c))},listen:{sourceObject:{update:function(a,b){s.prototype.listen.sourceObject.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=!0;this.fireUpdate()}},index:{change:function(a){var b=this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=!0;b.fireUpdate()}},member:{subscribersChanged:function(a,
b){0<a.subscriberCount&&0==b&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,!0)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=b.eventObjectId;this.listen.member&&a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=!0;0<a.subscriberCount&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];this.listen.member&&a.removeHandler(this.listen.member,this)},init:function(a){this.indexUpdated=!1;this.indexesBind_=
{};this.memberSourceMap={};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||!1==this.keyMap instanceof t)this.keyMap=new t(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));s.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof k){if(this.indexes_[a])return;this.indexes_[a]=b;b=this.source&&this.source.createIndex(b)}if(b instanceof
p){this.indexValues[a]=b.value;this.indexes[a]=b;this.indexesBind_[a]={key:a,indexMap:this};var c=this.listen.index;c&&(b.addHandler(c,this.indexesBind_[a]),c.change&&c.change.call(this.indexesBind_[a],b.value))}}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.listen.index&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},addCalc:function(a,
b){this.calcs[a]=b;this.fireUpdate()},removeCalc:function(a){delete this.calcs[a]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=!0,q.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=!1},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=!1;var c={},d,e,i;for(i in this.calcs)if(d=this.calcs[i](b.sourceObject.data,this.indexValues,b.sourceObject),a.data[i]!==d&&(!isNaN(d)||!isNaN(a.data[i])))c[i]=d,e=!0;e&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,!0)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);
s.prototype.destroy.call(this)}});g.namespace("basis.data.index").extend({IndexConstructor:k,Index:p,Sum:w,Avg:f,Count:x,Max:r,Min:e,IndexMap:l})})(basis);
(function(g){function n(a){j[a]=j[a]||0;return a+j[a]++}function k(){var a=Array.from(arguments),b=a.pop();"function"!=typeof b&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],h=[],d=0,e;d<a.length;d++)e=a[d].quote('"'),c.push(e+" in delta"),h.push("data["+e+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+h.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
!0;return b}function o(){return k.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;0<b--;){if(null==arguments[b])return null;a.push(arguments[b])}return a.join("-")}))}var l=g.Class,q=g.Cleaner,w=Object.extend,t=Function.$self,u=Function.getter,v=g.data,s=g.EventObject,p=v.Dataset,f=v.dataset.Subset,x=v.dataset.Split,r=v.DataObject,e=v.STATE,m={},d={string:1,number:1},a=[],b=function(a){return isNaN(a)?null:Number(a)},c=function(a){return isNaN(a)?null:Number(a)},
i=function(a){return isNaN(a)?null:parseInt(a)},h=function(a){return null==a?null:""+a},j={},B=g.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,h){var d=a(c,h);return d!==h&&b[d]?h:d};this.calcWrapper=function(c,h){var d=a(c,h);if(d!==h&&b[d])throw"Duplicate value for index "+h+" => "+c;return d};q.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=this.index[a];if(b&&(!c||c===b))return this.index[a]=
b,!0},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],!0},destroy:function(){this.index=null}}),v=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},A=function(a,b){return function(c){if(!this.name)this.name=n(b);a.prototype.init.call(this,c)}},y=function(a){return function(b,c){p.setAccumulateState(!0);b=(b||[]).map(this.wrapper);p.setAccumulateState(!1);return a.prototype.sync.call(this,b,c)}},C=l(p,{wrapper:Function.$self,init:A(p,"EntitySet"),
sync:y(p),set:v(p,"set"),add:v(p,"add"),remove:v(p,"remove"),destroy:function(){p.prototype.destroy.call(this);delete this.wrapper}}),E=l(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),F=l(f,{init:A(f,"EntityCollection"),sync:y(f)});F.sourceHandler=f.sourceHandler;var G=l(x,{subsetClass:E,init:A(x,"EntityGrouping"),sync:y(x),getSubset:function(a,b){var c=x.prototype.getSubset.call(this,a,b);if(c)c.wrapper=this.wrapper;return c}}),z=function(a){if(this instanceof
z){var b=new D(a||t);return function(a,c){return null!=a?(c instanceof C||(c=b.createEntitySet()),c.set(a instanceof p?a.getItems():Array.from(a)),c):null}}};z.className="basis.entity.EntitySetWrapper";var D=l(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),I=function(a){if(this instanceof I){var b=function(a,b){if(null!=a){if(a===b||a.entityType===c)return a;var j,
f=c.idField;if(d[typeof a]){if(!f)return;j=a;a={};a[f]=j}else if(c.compositeKey)j=c.compositeKey(a,a);else if(f)j=a[f];else if(i&&(b=c.singleton,!b))return c.singleton=new e(a);null!=j&&h&&(b=h.get(j,c.entityClass));b&&b.entityType===c?b.update(a):b=new e(a);return b}return c.singleton},c=new M(a||{},b),h=c.index__,e=c.entityClass,i=c.isSingleton;w(b,{toString:function(){return this.typeName+"()"},entityType:c,type:b,typeName:c.name,index:h,reader:function(a){return c.reader(a)},get:function(a){return c.get(a)},
addField:function(a,b){c.addField(a,b)},all:c.all,createCollection:function(a,h,d){var e=c.collection_[a];return!e&&h?c.collection_[a]=new F({wrapper:b,source:d||c.all,rule:h}):e},getCollection:function(a){return c.collection_[a]},createGrouping:function(a,h,d){var e=c.grouping_[a];return!e&&h?c.grouping_[a]=new G({wrapper:b,source:d||c.all,rule:h}):e},getGrouping:function(a){return c.grouping_[a]},getSlot:function(a,b){return c.getSlot(a,b)}});return b}};I.className="basis.entity.EntityTypeWrapper";
var L=u("singleton"),H={};l(r,{});var M=l(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:!1,index__:null,slot_:null,init:function(b,c){this.name=b.name||n(this.name);this.index__=b.index;this.idFields={};a.push(this);this.isSingleton=b.isSingleton;this.wrapper=c;this.all=new E(Object.extend(b.all||{},{wrapper:c}));this.slot_={};if(b.extensible)this.extensible=!0;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(b.fields,this.addField,this);b.constrains&&
b.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=L;b.aliases&&Object.iterate(b.aliases,this.addAlias,this);this.collection_={};if(b.collections)for(var h in b.collections)this.collection_[h]=new F({name:h,wrapper:c,source:this.all,rule:b.collections[h]||Function.$true});this.grouping_={};if(b.groupings)for(h in b.groupings)this.grouping_[h]=new G({name:h,wrapper:c,source:this.all,rule:b.groupings[h]||Function.$true});this.entityClass=K(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:c,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(d[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||null==a)return null;for(var c in a){var h=c in this.aliases?this.aliases[c]:"";h&&h in this.fields&&(b[h]=this.fields[h].reader?this.fields[h].reader(a[c]):a[c])}return b},addAlias:function(a,b){b in this.fields&&!1==a in this.aliases&&(this.aliases[a]=b)},addField:function(a,
d){if(!this.all.itemCount){this.aliases[a]=a;"function"==typeof d&&(d={type:d});if("type"in d&&"function"!=typeof d.type)d.type=t;var e=d.type||t;if([b,c,i,h].has(e))d.id=!0;if(d.id){if(!this.index__)this.index__=new B(String);this.idFields[a]=!0;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=o.apply(null,Object.keys(this.idFields))):this.idField=a}d.calc?this.addCalcField(a,d.calc,void 0):this.fields[a]=e;this.defaults[a]="defValue"in d?d.defValue:e();this.getters["get_"+a]=
function(){return this.data[a]};H[a]||(H[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var h={args:b.args,wrapper:!c?b:function(a,h,d){return c(b(a,h,d))}},d=this.calcs.length,e=0,i=0;i<this.calcs.length;i++)b.args.has(this.calcs[i].key)&&(e=i+1);if(a){h.key=a;for(i=0;i<this.calcs.length;i++)if(this.calcs[i].args.has(a)){d=i;break}if(e>d)return;if(this.idField&&a==this.idField)this.compositeKey=b;this.fields[a]=function(a,
b){"undefined"!=typeof console&&console.log("Calculate fields are readonly");return b}}else d=e;this.calcs.splice(Math.min(d,e),0,h)}},get:function(a){a=this.getId(a);if(null!=a)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(d[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof r)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var c=
this.slot_[b];c||(d[typeof a]&&(c={},this.idField&&!this.compositeKey&&(c[this.idField]=a),a=c),c=this.slot_[b]=new r({delegate:this.get(b),data:a}));return c}}}),J=l(r,{init:s.prototype.init,event_rollbackUpdate:s.createEvent("rollbackUpdate")}),K=function(a,b,c,h,d,i,j){function f(b,c,h){var d=!1,e=a.calcs,i=b.__id__,j=b.data;try{if(e)for(var m=0,z;z=e[m++];){var p=z.key;if(p){var l=j[p];j[p]=z.wrapper(c,j,j[p]);j[p]!==l&&(c[p]=l,d=!0)}else z.wrapper(c,j)}if(a.compositeKey)b.__id__=a.compositeKey(c,
j,b.__id__);else if(k&&k in c)b.__id__=j[k];b.__id__!==i&&a.index__.calcWrapper(b.__id__)}catch(r){b.__id__=i;for(var n in c)b.data[n]=c[n];if(h)for(n in h)if(!b.modified)b.modified=h;d=!1}b.__id__!==i&&g(b,i,b.__id__);return d}function g(a,b,d){null!=b&&(c.remove(b,a),h[b]&&h[b].setDelegate());null!=d&&(c.add(d,a),h[d]&&h[d].setDelegate(a))}var k=a.idField;return l(J,j,{canHaveDelegate:!1,modified:null,isTarget:!0,extendConstructor_:!1,init:function(a){J.prototype.init.call(this);this.fieldHandlers_=
{};this.data={};this.root=this;this.target=this;var c,h={},e;for(e in d)e in a?(h[e]=i[e],c=d[e](a[e])):c=i[e],c&&c!==this&&c instanceof s&&c.addHandler(H[e],this)&&(this.fieldHandlers_[e]=!0),this.data[e]=c;f(this,h);b.event_datasetChanged(b,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(b,c,h,e){var i=d[b];if(!i){if(!a.extensible)return;i=t}var j,g=this.modified,c=i(c,this.data[b]),
i=this.data[b];if(c!==i&&(!c||!i||c.constructor!==Date||i.constructor!==Date||+c!==+i))a:{j={};if(b!=k)if(h){if(!g)this.modified=g={};if(!1===b in g)j.rollback={key:b,value:void 0},g[b]=i;else if(g[b]===c&&(j.rollback={key:b,value:c},delete g[b],!Object.keys(g).length))this.modified=null}else if(g&&b in g)if(g[b]!==c){j.rollback={key:b,value:g[b]};g[b]=c;break a}else return!1;this.data[b]=c;this.fieldHandlers_[b]&&(i.removeHandler(H[b],this),this.fieldHandlers_[b]=!1);c&&c!==this&&c instanceof s&&
c.addHandler(H[b],this)&&(this.fieldHandlers_[b]=!0);j.key=b;j.value=i;j.delta={};j.delta[b]=i}else if(!h&&g&&b in g&&(j={rollback:{key:b,value:g[b]}},delete g[b],!Object.keys(g).length))this.modified=null;if(!e&&j){var h=j.key,b=j.delta||{},m;if(j.rollback)m={},m[j.rollback.key]=j.rollback.value;f(this,b,m)&&(h=!0);if(h)this.event_update(this,b),j.delta=b;m&&this.event_rollbackUpdate(this,m)}return j||!1},update:function(a,b){if(a){var c,h={},d,e={},i,j;for(j in a)if(i=this.set(j,a[j],b,!0)){if(i.key)c=
!0,h[i.key]=i.value;if(i.rollback)d=!0,e[i.rollback.key]=i.rollback.value}f(this,h,e)&&(c=!0);c&&this.event_update(this,h);d&&this.event_rollbackUpdate(this,e)}return c?h:!1},reset:function(){this.update(i)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=e.PROCESSING){if(this.modified){var a=this.modified;
this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(e.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.data[a].removeHandler(H[a],this);this.fieldHandlers_=m;this.__id__&&g(this,this.__id__,null);r.prototype.destroy.call(this);b.event_datasetChanged(b,{deleted:[this]});this.data=m;this.modified=null}})};g.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof K},NumericId:b,NumberId:c,IntId:i,StringId:h,Index:B,CalculateField:k,
EntityType:I,Entity:K,BaseEntity:J,EntitySetType:z,EntitySet:C,ReadOnlyEntitySet:E,Collection:F,Grouping:G})})(basis);
(function(g){var n=g.Class,k=Object.extend,o=g.EventObject,l=o.createEvent;g.ua.Cookies.get("DEBUG_MODE");var q,w,t=!1,u={},v=Date.now,s=k(new o,{event_sessionOpen:l("sessionOpen"),event_sessionClose:l("sessionClose"),event_sessionFreeze:l("sessionFreeze"),event_sessionUnfreeze:l("sessionUnfreeze"),isOpened:function(){return!!q},getTimestamp:function(){if(q)return w},open:function(f,g){var l;u[f]||(u[f]=new p(f));l=u[f];q===l?t&&this.unfreeze():(this.close(),q=l,w=v(),g&&k(l.data,g),this.event_sessionOpen(this))},
close:function(){q&&(t&&this.unfreeze(),this.event_sessionClose(this),w=q=null)},freeze:function(){q&&!t&&(this.event_sessionFreeze(this),t=!0,w=null)},unfreeze:function(){q&&t&&(t=!1,w=v(),this.event_sessionUnfreeze(this))},storeData:function(f,g){if(q)return q.storeData(f,g);throw Error("No opened session");},getData:function(f){if(q)return q.getData(f);throw Error("No opened session");},destroy:function(){for(var f=Object.keys(u),g;g=f.pop();)u[g].destroy();o.prototype.destroy.call(this)}}),p=
n(o,{event_destroy:function(){q==this&&s.close();delete u[this.key]},extendConstructor_:!1,init:function(f){o.prototype.init.call(this);this.key=f;this.data={}},storeData:function(f,g){if(t)throw Error("Session is frozen");return this.data[f]=g},getData:function(f){if(t)throw Error("Session is frozen");return this.data[f]},destroy:function(){o.prototype.destroy.call(this);for(var f=Object.keys(this.data),g;g=f.pop();){var k=this.data[g];null!=k&&"function"==typeof k.destroy&&k.destroy();delete this.data[g]}}});
g.namespace("basis.session").extend({SessionManager:s})})(basis);
(function(g){function n(d){var a=g.EventObject.createEvent(d),b=[d];return function(){m.dispatch.apply(this,b.concat(arguments));a.apply(this,arguments)}}function k(d,a){var b={"JS-Framework":"Basis"};x.test(a.method)?(b["Content-Type"]=a.contentType+(a.encoding?";charset="+a.encoding:""),t.test("gecko")&&(b.Connection="close")):t.test("ie")&&(b["If-Modified-Since"]=(new Date(0)).toGMTString());Object.iterate(Object.extend(b,a.headers),function(a,b){null!=b&&this.setRequestHeader(a,b)},d)}function o(d){var a=
this.transport;if(a){if("number"!=typeof d)d=a.readyState;if(d!=this.prevReadyState_)if(this.prevReadyState_=d,this.event_readyStateChanged(d),4==d){v.remove(this,"timeoutAbort");var d=f.UNDEFINED,b;this.progress=!1;a.onreadystatechange=Function.$undef;if(this.aborted){var c=this.abortedByTimeout_;c&&this.event_timeout();this.event_abort(c)}else d=this.responseIsSuccess(),this.update({text:a.responseText,xml:a.responseXML}),d?(this.event_success(a),d=f.READY):(this.event_failure(a),d=f.ERROR,b=this.getRequestError(a)),
this.event_httpStatus(a,a.status);this.event_complete(a);this.setState(d,b)}else this.setState(f.PROCESSING)}}function l(d){v.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=!1;this.prevReadyState_=-1;if(t.test("gecko1.8.1-")&&d.asynchronous)this.transport=e();var a=this.transport;this.asynchronous?a.onreadystatechange=o.bind(this):o.call(this,0);a.open(d.method,d.location,d.asynchronous);this.progress=!0;this.abortedByTimeout_=this.aborted=!1;k(a,d);this.event_start();
if(this.aborted)o.call(this,4);else if(!this.aborted&&this.progress){this.requestStartTime=Date.now();v.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var b=d.postBody;if("POST"==d.method&&t.test("ie9-"))if("object"==typeof b&&"undefined"!=typeof b.documentElement&&"string"==typeof b.xml)b=b.xml;else if("string"==typeof b)b=b.replace(/\r/g,"");else if(null==b||""==b)b="[empty request]";a.send(b);return!0}}var q=g.Class,w=g.dom.event,t=g.ua,u=g.Cleaner,v=g.TimeEventManager,s=g.data,p=
s.DataObject,f=s.STATE,x=/POST/i,s=g.ua.Cookies.get("DEBUG_AJAX");(function(){for(var d=192;255>=d;d++)d.toHex(),String.fromCharCode(d+848),(d+848).toHex(),d.toHex()})();var r="native",e=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var d=window.ActiveXObject;if(d)for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;r=a[b];b++)try{if(new d(r))return function(){return new d(r)}}catch(c){}throw Error(r="Browser doesn't support for XMLHttpRequest!");
}(),m=function(){var d=[],a=[{handler:{start:function(){d.add(this)},complete:function(){d.remove(this)}}}];w.onUnload(function(){a.clear()});return{addHandler:function(b,c){for(var d=0,h;h=a[d];d++)if(h.handler===b&&h.thisObject===c)return!1;a.push({handler:b,thisObject:c});return!0},removeHandler:function(b,c){for(var d=0,h;h=a[d];d++)if(h.handler===b&&h.thisObject===c)return a.splice(d,1),!0;return!1},dispatch:function(b){if(a.length)for(var c=Array.prototype.slice.call(arguments,1),d,h,e=a.length-
1;d=a[e];e--)h=d.handler[b],"function"==typeof h&&h.apply(d.thisObject||this,c)},abort:function(){for(var a=Array.from(d),c=0;c<a.length;c++)a[c].abort();return a}}}(),q=q(p,{state:f.UNDEFINED,event_start:n("start"),event_readyStateChanged:n("readyStateChanged"),event_timeout:n("timeout"),event_abort:n("abort"),event_success:n("success"),event_failure:n("failure"),event_httpStatus:n("httpStatus"),event_complete:n("complete"),event_stateChanged:function(d,a){p.prototype.event_stateChanged.call(this,
d,a);for(var b=0;b<this.influence.length;b++)this.influence[b].setState(this.state,this.state.data)},influence:null,debug:s,progress:!1,aborted:!1,abortedByTimeout_:!1,abortCalled:!1,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:!0,method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(d){var a=this.influence;this.transport=e();this.requestHeaders={};this.influence=[];this.params={};a&&this.setInfluence.apply(this,a);u.add(this);p.prototype.init.call(this,
d);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var d=Array.from(arguments),a=0;a<d.length;a++)d[a].setState(this.state,this.state.data);this.influence.set(d)},clearInfluence:function(){this.influence.clear()},setParam:function(d,a){this.params[d]=a},setParams:function(d){this.clearParams();for(var a in d)this.setParam(a,d[a])},removeParam:function(d){delete this.params[d]},clearParams:function(){for(var d in this.params)delete this.params[d]},timeoutAbort:function(){this.abortedByTimeout_=
!0;this.abort()},abort:function(){this.aborted=!0;if(this.progress)v.remove(this,"timeoutAbort"),this.progress=!1,this.transport.abort(),this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==Function.$undef&&o.call(this,4)},request:function(d){var d=d||this.url,a=this.method.toUpperCase(),b,c;if(!this.transport)throw Error("Transport is not allowed");if(!d)throw Error("URL is not defined");this.abort();delete this.requestData_;this.update({responseText:"",responseXml:null});
this.abortedByTimeout_=this.aborted=this.progress=!1;b=Object.iterate(this.params,function(a,b){return null==b||b&&"function"==typeof b.toString&&null==b.toString()?null:a+"="+(""+b.toString()).replace(/[\%\=\&\<\>\s\+]/g,function(a){a=a.charCodeAt(0).toHex();return"%"+(2>a.length?"0":"")+a})}).filter(Function.$isNotNull).join("&");x.test(a)?c=this.postBody||b||"":b&&(d+=(-1==d.indexOf("?")?"?":"&")+b);this.requestData_={method:a,location:d,contentType:this.contentType,encoding:this.encoding,asynchronous:this.asynchronous,
headers:Object.extend({},this.requestHeaders),postBody:c};return l.call(this,this.requestData_)},repeat:function(){if(this.requestData_)return this.abort(),l.call(this,this.requestData_)},get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var d=this.transport.status;return void 0==d||0==d||200<=d&&300>this.transport.status}}catch(a){}return!1},getRequestError:function(d){return{code:"SERVER_ERROR",msg:d.responseText}},destroy:function(){this.destroy=
Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();p.prototype.destroy.call(this);delete this.transport;u.remove(this)}});g.namespace("basis.net.ajax").extend({Transport:q,TransportDispatcher:m,createEvent:n})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.net.ajax,l=g.xml,q=o.Transport,w=l.QName,t=l.addNamespace,u=l.XML2Object,v=l.Object2XML,s=l.createElementNS,p=l.NAMESPACE,f=n(null,{url:null,namespace:null,init:function(a,b){this.url=a;this.namespace=b},call:function(a,b){a=this.createMethodCall(a,b,!1);a.transport.abort();a.invoke(b.header,b.body,b.callback,b.mapping)},createMethodCall:function(a,b,c){return new x(this,new w(a,this.namespace),b,c)}}),x=n(null,{service:null,transport:null,method:null,envelope:null,
body:null,init:function(a,b,c,d){c=c||{};this.method=b;this.envelope=new e;this.url=a.url;this.transport=new r(b,c.callback);this.transport.requestHeaders={SOAPAction:b.namespace+(!/\/$/.test(b.namespace)?"/":"")+b};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return a.url}};c.mapping&&this.transport.setMapping(c.mapping);c.callback&&this.transport.setCallback(c.callback);if(d)this.body=c.body||{}},repeatCall:function(){this.transport.get()},
call:function(a){return this.invoke(null,a||this.body)},invoke:function(a,b,c,d){this.transport.abort();this.envelope.getBody(!0).setValue(this.method,b);a&&this.envelope.getHeader(!0).setValue(a,this.method.namespace);c&&this.transport.setCallback(c);d&&this.transport.setMapping(d);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),r=n(q,{callback:{},mapping:null,method:"POST",contentType:"text/xml",
encoding:"utf-8",event_success:function(a){var b=a.responseXML;if(void 0===b||void 0===b.documentElement)this.event_failure(this);else{var c=Array.from(arguments);b.xml&&DOMParser&&(b=(new DOMParser).parseFromString(b.xml,"text/xml"));this.responseEnvelope=new e(b.documentElement);c.push(this.getResponseData(),this.getRequestData());q.prototype.event_success.apply(this,c)}},event_failure:function(a){var b=Array.from(arguments),c=this.state.data||this.getRequestError(a);c.isSoapFailure&&this.event_soapfailure(a,
c.code,c.msg);b.push(c.code,c.msg);q.prototype.event_failure.apply(this,b)},event_soapfailure:o.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(a){return k.tag(a,"code")[0]},errorMessageGetter:function(a){return k.tag(a,"message")[0]},extendConstructor_:!1,init:function(a){q.prototype.init.call(this);this.soapMethod=a},setCallback:function(a){"object"==typeof a&&this.addHandler(a)},setMapping:function(a){this.mapping=a},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},
getResponseData:function(){var a=this.responseEnvelope&&this.responseEnvelope.getBody();if(a)return this.responseDataGetter(a.getValue(this.mapping))},getRequestError:function(a){var b,c,d=!1,a=a.responseXML;if(void 0!=a&&void 0!=a.documentElement)b=a.documentElement,d=this.errorCodeGetter(b),c=this.errorMessageGetter(b),this.responseEnvelope=new e(b),b=d?d.firstChild.nodeValue:"UNKNOWN_ERROR",c=c?c.firstChild.nodeValue:"Unknown error",console.log("SoapError:",b.quote("("),c),d=!0;return{code:b||
"TRANSPORT_ERROR",msg:c,isSoapFailure:d}}}),e=n(null,{header:null,body:null,init:function(a){if(!a)a=l.createDocument("http://schemas.xmlsoap.org/soap/envelope/","soap:Envelope").documentElement,t(a,"xsd",p.XMLShema),t(a,"xsi",p.XMLShemaInstance),l.XMLNS.BAD_SUPPORT&&t(a,"soap","http://schemas.xmlsoap.org/soap/envelope/");this.document=a.ownerDocument;this.element=a;this.body=this.getBody(!0)},getElementByName:function(a){return l.getElementsByTagNameNS(this.element,a,"http://schemas.xmlsoap.org/soap/envelope/")[0]},
getHeader:function(a){var b=this.header;if(!b){var c=this.getElementByName("Header");if(c||a)b=this.header=new m(c,this.document),c||this.element.insertBefore(b.element,this.element.firstChild)}return b},setHeaderSection:function(a,b){this.getHeader(!0).setSection(a,b)},getBody:function(a){var b=this.body;if(!b){var c=this.getElementByName("Body");if(c||a)b=this.body=new d(c,this.document),c||this.element.appendChild(b.element)}return b},destroy:function(){this.header&&(this.header.destroy(),delete this.header);
this.body&&(this.body.destroy(),delete this.body);delete this.element;delete this.document}}),m=n(null,{init:function(a,b){this.element=a||s(b,"Header","http://schemas.xmlsoap.org/soap/envelope/")},getValue:function(){return u(this.element)},setValue:function(a,b){k.clear(this.element);this.appendChild(a,b)},appendChild:function(a,b){if(a)for(var c in a){var d=this.element.appendChild(v(this.element.ownerDocument,c,b,a[c]));l.XMLNS.BAD_SUPPORT&&t(d,"",b)}},setSection:function(a,b){var c=l.getElementsByTagNameNS(this.element,
a,a.namespace)[0];c&&k.remove(c);this.appendChild(Function.wrapper(a)(b),a.namespace)}}),d=n(null,{init:function(a,b){this.element=a||s(b,"Body","http://schemas.xmlsoap.org/soap/envelope/")},getValue:function(a){return u(this.element,a)},setValue:function(a,b,c){k.clear(this.element);this.appendChild(a,b,c)},appendChild:function(a,b,c){b=v(this.element.ownerDocument,a,a.namespace,Function.$defined(b)?b:{});this.element.appendChild(b);l.XMLNS.BAD_SUPPORT&&t(b.element,"",a.namespace);c&&l.setAttributeNodeNS(b,
l.createAttributeNS(document,"encodingStyle","http://schemas.xmlsoap.org/soap/encoding/",c))}});g.namespace("basis.net.soap").extend({Service:f,ServiceCall:x,ServiceCallTransport:r,Envelope:e,EnvelopeHeader:m,EnvelopeBody:d})})(basis);
(function(g){var n=Function.getter,k=g.Class,o=g.dom,l=g.ui.Node,q=g.ui.Control,w=k(l,{captionGetter:n("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){l.prototype.event_select.call(this);o.focus(this.element)},event_disable:function(){l.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=!0},event_enable:function(){l.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=!1},init:function(g){l.prototype.init.call(this,g);this.setCaption(this.caption)},setCaption:function(g){this.caption=g;this.tmpl.captionText.nodeValue=this.captionGetter(this)}}),k=k(q,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:w,getButtonByName:function(g){return this.childNodes.search(g,
n("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(g){return g.groupId||-g.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});g.namespace("basis.ui.button").extend({Button:w,ButtonPanel:k})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.html.Template,l=Function.getter,q=g.EventObject.createEvent,w=g.data.STATE,t=g.ui.Node,u=new o('<div{element|content} class="Basis-Label-State"/>'),v=new o('<div{element|content} class="Basis-Label-Processing"/>'),s=new o('<div{element|content} class="Basis-Label-Error"/>'),p=n(t,{cascadeDestroy:!0,show_:!1,visible_:!1,visibilityGetter:Function.$false,insertPoint:k.INSERT_END,content:"[no text]",event_delegateChanged:function(a,c){(c?c.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:q("visibilityChanged"),init:function(a){var c=this.container;this.container=null;t.prototype.init.call(this,a);if(c)this.container=c;this.traceChanges_();return a},traceChanges_:function(){this.container&&this.visible_?this.container!=this.element.parentNode&&k.insert(this.container,this.tmpl.element,this.insertPoint):k.remove(this.element)},setContainer:function(a){if(this.container!=a)this.container=
a,this.traceChanges_()},setVisibility:function(a){if(this.visible_!=a)this.visible_=a,this.traceChanges_(),this.event_visibilityChanged(this.visible_)},destroy:function(){delete this.container;t.prototype.destroy.call(this)}}),f=n(p,{template:u,init:function(a){if(this.visibleStates&&!this.visibilityGetter){for(var c={},d,h=0;d=this.visibleStates[h++];)c[d]=!0;this.visibilityGetter=l(Function.$self,c)}p.prototype.init.call(this,a)}}),q=n(f,{event_delegateChanged:function(a,c){f.prototype.event_delegateChanged.call(this,
a,c);this.delegate&&this.event_stateChanged(this)},event_stateChanged:function(a,c){f.prototype.event_stateChanged.call(this,a,c);this.setVisibility(this.visibilityGetter(this.state,c))}}),x=n(q,{visibilityGetter:function(a){return a==w.PROCESSING},content:"Processing...",template:v}),s=n(q,{visibilityGetter:function(a){return a==w.ERROR},content:"Error",template:s}),r={stateChanged:function(a,c){this.setVisibility(this.visibilityGetter(a.state,c))}},e={dataSourceChanged:function(a,c){c&&c.removeHandler(r,
this);a.dataSource&&(a.dataSource.addHandler(r,this),r.stateChanged.call(this,a.dataSource,a.dataSource.state))}},u=n(f,{event_delegateChanged:function(a,c){f.prototype.event_delegateChanged.call(this,a,c);c&&c.removeHandler(e,this);this.delegate&&(this.delegate.addHandler(e,this),e.dataSourceChanged.call(this,this.delegate,c&&c.dataSource))},template:u}),v=n(u,{visibilityGetter:function(a){return a==w.PROCESSING},content:"Processing...",template:v}),m=function(){this.setVisibility(this.visibilityGetter(this.delegate?
this.delegate.childNodes.length:0,this.delegate))},d={stateChanged:function(a){this.setVisibility(this.visibilityGetter(a.itemCount,this.delegate))}},a={childNodesModified:m,dataSourceStateChanged:m,stateChanged:m,dataSourceChanged:function(a,c){c&&c.removeHandler(d,this);a.dataSource&&(a.dataSource.addHandler(d,this),d.stateChanged.call(this,a.dataSource,a.dataSource.state))}},o=n(p,{event_delegateChanged:function(b,c){p.prototype.event_delegateChanged.call(this,b,c);c&&c.removeHandler(a,this);this.delegate&&
(this.delegate.addHandler(a,this),a.dataSourceChanged.call(this,this.delegate));m.call(this)},template:new o('<div{element|content} class="Basis-CountLabel"/>')}),n=n(o,{visibilityGetter:function(a,c){var d=c.dataSource?c.dataSource.state:c.state;return!a&&d==w.READY},content:"Empty"});g.namespace("basis.ui.label").extend({NodeLabel:p,State:f,ObjectState:q,Processing:x,Error:s,DataSourceState:u,DataSourceProcessing:v,ChildCount:o,IsEmpty:n})})(basis);
(function(g){function n(e){"function"==typeof e.expand&&e.expand()}function k(e){"function"==typeof e.collapse&&e.collapse()}var o=g.Class,l=g.dom,q=g.dom.event,w=g.cssom.classList,t=Function.getter,u=g.EventObject.createEvent,v=g.ui.Container,s=g.ui.Control,p=g.ui.PartitionNode,f=g.ui.GroupingNode,x={expandAll:function(){l.axis(this,l.AXIS_DESCENDANT_OR_SELF,n)},collapseAll:function(){l.axis(this,l.AXIS_DESCENDANT_OR_SELF,k)},expand:Function(),collapse:Function(),toggle:Function()},p=o(p,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'}),
f=o(f,{childClass:p}),r=o(v,x,{canHaveChildren:!1,childFactory:null,event_collapse:u("collapse"),event_expand:u("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(e){e.titleText.nodeValue=""+this.titleGetter(this)||"[no title]"},action:{select:function(e){this.isDisabled()||this.select(q(e).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:t("data.title")}),t=o(r,{canHaveChildren:!0,childClass:r,localGroupingClass:f,event_expand:function(){r.prototype.event_expand.call(this);w(this.element).remove("collapsed")},event_collapse:function(){r.prototype.event_collapse.call(this);w(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:!0,collapsed:!1,init:function(e){r.prototype.init.call(this,e);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed)return this.collapsed=!1,this.event_expand(),!0},collapse:function(){if(!this.collapsed&&this.collapsable)return this.collapsed=!0,this.event_collapse(),!0},toggle:function(){this.collapsed?this.expand():this.collapse()}}),o=o(s,x,{childClass:r,localGroupingClass:f,template:'<ul class="Basis-Tree"/>'});g.namespace("basis.ui").extend({Tree:o});
g.namespace("basis.ui.tree").extend({Tree:o,Node:r,Folder:t,GroupingNode:f,PartitionNode:p})})(basis);
(function(){var g=basis.Class,n=basis.dom,k=basis.dom.event,o=basis.cssom,l=Function.getter,q=basis.cssom.classList,w=basis.Cleaner,t=basis.layout,u=basis.EventObject.createEvent,v=basis.ui.Node,s=basis.ui.Container,p=basis.ui.Control,f=basis.ui.PartitionNode,x=basis.ui.GroupingNode,r={VERTICAL:"V",HORIZONTAL:"H"},e={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},m={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},d={finish:function(){this.visible||(n.remove(this.element),this.event_cleanup(this))}},
u=g(s,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:u("beforeShow"),event_show:u("show"),event_hide:u("hide"),event_realign:u("realign"),event_cleanup:u("cleanup"),event_layoutChanged:u("layoutChanged","oldOrientation","oldDir")&&function(a,b){var c=(a+"-"+b.qw().slice(2,4).join("-")).toLowerCase(),d=(this.orientation+"-"+this.dir.qw().slice(2,
4).join("-")).toLowerCase();q(this.element).replace(c,d,this.cssLayoutPrefix)},visible:!1,autorotate:!1,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:r.VERTICAL,hideOnAnyClick:!0,hideOnKey:!1,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(a){s.prototype.init.call(this,a);this.cssRule=o.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,this.orientation);this.thread&&this.thread.addHandler(d,
this);w.add(this)},setLayout:function(a,b,c){var d=this.dir,e=this.orientation;if("string"==typeof a)this.dir=a.toUpperCase();if("string"==typeof b)this.orientation=b;if(d!=this.dir||e!=this.orientation)this.event_layoutChanged(e,d),c||this.realign()},flip:function(a){var b=this.dir.qw(),a=a==r.VERTICAL;b[0+a]=m[b[0+a]];b[2+a]=m[b[2+a]];this.setLayout(b.join(" "))},rotate:function(a){var b=this.dir.qw(),a=(a%4+4)%4,c=[];if(!a)return b;var d=b[0].charAt(0),i=b[1].charAt(0),f="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(d+
i)>>1,d=(f&252)+((f&3)+a&3)<<1;c.push(e["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(d)],e["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(d+1)]);d=b[2].charAt(0);i=b[3].charAt(0);f="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(d+i)>>1;a="C"!=d&&"C"!=i&&b[0]==b[2]!=(b[1]==b[3])?-a+4:a;d=(f&252)+((f&3)+a&3)<<1;c.push(e["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(d)],e["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(d+1)]);return c},isFitToViewport:function(a){if(this.visible&&this.relElement){var b=new t.Box(this.relElement,!1,this.element.offsetParent),c=
new t.Viewport(this.element.offsetParent),d=this.element.offsetWidth,e=this.element.offsetHeight,a=(""+(a||this.dir)).toUpperCase().qw(),i="CENTER"==a[0]?b.left+(b.width>>1):b[a[0].toLowerCase()],b="CENTER"==a[1]?b.top+(b.height>>1):b[a[1].toLowerCase()];return("LEFT"!=a[2])*(i<d>>("CENTER"==a[2]))||("RIGHT"!=a[2])*(c.width-i<d>>("CENTER"==a[2]))||("TOP"!=a[3])*(b<e>>("CENTER"==a[3]))||("BOTTOM"!=a[3])*(c.height-b<e>>("CENTER"==a[3]))?!1:{x:i,y:b}}},realign:function(){if(this.visible&&this.relElement){for(var a=
this.dir.qw(),b,c=0,d=a,e=a[2],i=a[3],f="number"==typeof this.autorotate||!this.autorotate.length?3:this.autorotate.length;this.autorotate&&c<=f;){if(b=this.isFitToViewport(d.join(" "))){e=d[2];i=d[3];this.setLayout(d.join(" "),null,!0);break}if(c==f)break;Array.isArray(this.autorotate)?(d=this.autorotate[c++],d="string"==typeof d?d.toUpperCase().split(" "):this.rotate(d)):d=this.rotate(++c*this.autorotate)}b||(b=new t.Box(this.relElement,!1,this.element.offsetParent),b={x:"CENTER"==a[0]?b.left+(b.width>>
1):b[a[0].toLowerCase()],y:"CENTER"==a[1]?b.top+(b.height>>1):b[a[1].toLowerCase()]});a=new t.Box(this.element.offsetParent);c={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(e){case "LEFT":c.left=b.x+"px";break;case "CENTER":c.left=Math.round(b.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":c.right=a.width-b.x+"px"}switch(i){case "TOP":c.top=b.y+"px";break;case "CENTER":c.top=Math.round(b.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":c.bottom=a.height-b.y+"px"}this.cssRule.setStyle(c);
this.event_realign()}},show:function(a,b,c){this.relElement=n.get(a)||this.relElement;this.setLayout(b||this.defaultDir,c);if(this.visible)this.realign();else if(this.relElement)q(this.element).remove("pre-transition"),n.visibility(this.element,!1),i.appendChild(this),this.event_beforeShow(),this.visible=!0,this.realign(),this.thread&&this.thread.start(1),n.visibility(this.element,!0),q(this.element).add("pre-transition"),this.event_show()},hide:function(){if(this.visible)n.parentOf(document.body,
this.element)&&(this.thread?this.thread.start(1):(n.remove(this.element),this.event_cleanup(this))),this.visible=!1,this.parentNode&&i.removeChild(this),this.event_hide()},hideAll:function(){i.clear()},destroy:function(){if(this.thread)this.thread.removeHandler(d,this),this.thread=null;this.hide();s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;w.remove(this)}}),a=g(u,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
b=g(s,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(a){this.click();k.kill(a)}},event_childNodesModified:function(a,b){q(this.element).bool("hasSubItems",this.hasChildNodes());s.prototype.event_childNodesModified.call(this,a,b)},groupId:0,caption:"[untitled]",captionGetter:l("caption"),handler:null,defaultHandler:function(a){this.parentNode&&this.parentNode.defaultHandler(a)},init:function(a){s.prototype.init.call(this,
a);this.setCaption(this.caption)},setCaption:function(a){this.caption=a;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){!this.isDisabled()&&!(this instanceof c)&&(this.handler?this.handler(this):this.defaultHandler(this))}});b.prototype.childClass=b;var c=g(b,{event_childNodesModified:v.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'}),v=g(f,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'}),
x=g(x,{childClass:v}),g=g(u,{childClass:b,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:x,localGrouping:l("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'}),i=new p({id:"Basis-PopupStack",handheldMode:!1,childClass:u,event_childNodesModified:function(a,b){if(b.deleted)for(var c=b.deleted.length-
1,d;d=b.deleted[c];c--)d.hide();if(b.inserted&&!b.deleted&&this.childNodes.length==b.inserted.length)q(this.element).add("IsNotEmpty"),document.body.className=document.body.className,k.addGlobalHandler("click",this.hideByClick,this),k.addGlobalHandler("keydown",this.hideByKey,this),k.addGlobalHandler("scroll",this.hideByScroll,this),k.addHandler(window,"resize",this.realignAll,this);this.lastChild?this.lastChild.select():(q(this.element).remove("IsNotEmpty"),document.body.className=document.body.className,
k.removeGlobalHandler("click",this.hideByClick,this),k.removeGlobalHandler("keydown",this.hideByKey,this),k.removeGlobalHandler("scroll",this.hideByScroll,this),k.removeHandler(window,"resize",this.realignAll,this));p.prototype.event_childNodesModified.call(this,a,b)},insertBefore:function(a,b){var c=document.documentElement.scrollTop,d=document.body.scrollTop;if(p.prototype.insertBefore.call(this,a,b)){a.documentST_=c;a.bodyST_=d;if(this.handheldMode)document.documentElement.scrollTop=0,document.body.scrollTop=
0;a.element.style.zIndex=basis.ui.Window?basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(a){if(a&&(a.hideOnAnyClick&&a.nextSibling&&this.removeChild(a.nextSibling),p.prototype.removeChild.call(this,a),this.handheldMode))document.documentElement.scrollTop=a.documentST_,document.body.scrollTop=a.bodyST_},realignAll:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(a){for(var a=
k.sender(a),b,c=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),d=0,e;e=c[d];d++){if(a===e.tmpl.closeButton||n.parentOf(e.tmpl.closeButton,a)){this.removeChild(e);return}b||(b=n.axis(a,n.AXIS_ANCESTOR_OR_SELF));if(b.has(e.element)||b.some(Array.prototype.has,e.ignoreClickFor)){this.removeChild(c[d-1]);return}}this.removeChild(c.pop())},hideByKey:function(a){var a=k.key(a),b=this.lastChild;if(b&&b.hideOnKey){var c=!1;"function"==typeof b.hideOnKey?c=b.hideOnKey(a):Array.isArray(b.hideOnKey)&&
(c=b.hideOnKey.has(a));c&&b.hide()}},hideByScroll:function(a){a=k.sender(a);if(!n.parentOf(a,this.element))for(var b=this.lastChild;b;){var c=b.previousSibling;b.relElement&&b.offsetParent!==a&&n.parentOf(a,b.relElement)&&b.hide();b=c}}});k.onLoad(function(){n.insert(document.body,i.element,n.INSERT_BEGIN);i.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:r,setHandheldMode:function(a){i.handheldMode=!!a},Popup:u,Balloon:a,Menu:g,MenuGroupControl:x,MenuPartitionNode:v,MenuItem:b,
MenuItemSet:c})})(basis);
(function(g){var n=g.Class,k=g.dom.event,o=g.dom,l=g.html.Template,q=g.cssom.classList,w=g.dom.wrapper,t=w.GroupingNode,u=w.PartitionNode,v=g.ui.Node,s=g.ui.Container,p=g.ui.Control,f=g.ui.PartitionNode,x=g.ui.GroupingNode,r=n(v,{template:new l('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(a){a.titleText.nodeValue=
this.titleGetter(this)}}),e=n(t,{event_ownerChanged:function(a,b){b&&o.remove(this.headerRow);if(this.owner&&this.owner.element){var d=this,e=this.owner.element;do o.insert(e,d.headerRow,o.INSERT_BEGIN);while(d=d.localGrouping)}t.prototype.event_ownerChanged.call(this,a,b)},childClass:{init:function(a){u.prototype.init.call(this,a);this.cell=new r({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(a,b){var d=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var e=
0,f;f=this.nodes[e];e++)d+=f.cell.element.colSpan;else d=this.nodes.length;this.cell.element.colSpan=d;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{});u.prototype.event_childNodesModified.call(this,a,b)},destroy:function(){u.prototype.destroy.call(this);this.cell.destroy()}},init:function(a){t.prototype.init.call(this,a);this.element=this.childNodesElement=this.headerRow=o.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(a,b){a=
t.prototype.insertBefore.call(this,a,b);o.insert(this.headerRow,a.cell.element,o.INSERT_BEFORE,a.nextSibling&&a.nextSibling.cell.element);return a},removeChild:function(a){o.remove(a.cell.element);t.prototype.removeChild.call(a)},destroy:function(){t.prototype.destroy.call(this);this.headerRow=null}});e.prototype.localGroupingClass=e;var w=n(v,{sorting:null,defaultOrder:!1,groupId:0,template:new l('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var a=this.parentNode&&this.parentNode.owner;a&&a.setLocalSorting(a.localSorting,!a.localSortingDesc)}else this.select()}},init:function(a){v.prototype.init.call(this,a);this.selectable=!!this.sorting;if(this.sorting)this.sorting=Function.getter(this.sorting),this.defaultOrder="desc"==this.defaultOrder,q(this.element).add("sortable")},select:function(){if(!this.selected)this.order=this.defaultOrder;v.prototype.select.call(this)}}),m=n(s,{childClass:w,localGroupingClass:e,
template:new l('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(a){var b=this.childNodes.search(a.localSorting,"sorting");b?(b.select(),b.order=a.localSortingDesc,q(this.tmpl.content).bool("sort-order-desc",b.order)):this.selection.clear()}}},init:function(a){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(a){(a=a.pick())&&
this.owner&&this.owner.setLocalSorting(a.sorting,a.order)}}};s.prototype.init.call(this,a);this.applyConfig_(this.structure)},applyConfig_:function(a){a&&this.setChildNodes(a.map(function(a){var b=a.header,c=Object.slice(a,["sorting","defaultOrder","groupId"]);c.content=(null==b||"object"!=typeof b?b:b.content)||String.Entity.nbsp;if("function"==typeof c.content)c.content=c.content.call(this);c.cssClassName=(b.cssClassName||"")+" "+(a.cssClassName||"");return c},this))}}),d=n(v,{colSpan:1,template:new l('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),
setColSpan:function(a){this.element.colSpan=this.colSpan=a||1}}),a=n(s,{childClass:d,childFactory:function(a){return new this.childClass(a)},template:new l('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(a){s.prototype.init.call(this,a);this.applyConfig_(this.structure);this.useFooter&&o.insert(this.container||this.owner.element,this.element,1)},applyConfig_:function(a){if(a){var b=null;this.clear();this.useFooter=!1;for(var h=0;h<a.length;h++){var e=
a[h],f;e.footer?(f=e.footer.content,"function"==typeof f&&(f=f.call(this)),this.useFooter=!0,f=this.appendChild({cssClassName:(e.cssClassName||"")+" "+(e.footer.cssClassName||""),content:f,template:e.footer.template||d.prototype.template})):b?b.setColSpan(b.colSpan+1):f=this.appendChild({});f&&(b=f)}}}}),b=n(v,{canHaveChildren:!1,repaintCount:0,getters:[],classNames:[],template:'<tr class="Basis-Table-Row" event-click="select"><\!--{cells}--\></tr>',action:{select:function(a){this.select(k(a).ctrlKey)}},
templateUpdate:function(){this.repaintCount+=1;for(var a=0,b;b=this.updaters[a];a++){var d=this.element.childNodes[b.cellIndex];b=b.getter.call(this,this,d);if(1<this.repaintCount)d.innerHTML="";if(!b||!Array.isArray(b))b=[b];for(var e=0;e<b.length;e++){var f=b[e];d.appendChild(f&&f.nodeType?f:o.createText(null!=f&&("string"!=typeof f||""!=f)?f:" "))}}}}),f=n(f,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><\!-- {childNodesHere} --\></tbody>',
action:{click:function(){q(this.element).toggle("collapsed")}}}),n=n(p,{canHaveChildren:!0,childClass:b,localGroupingClass:n(x,{childClass:f}),template:new l('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><\!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><\!-- {footerElement} --\></table>'),templateAction:function(a,b){p.prototype.templateAction.call(this,a,b)},init:function(b){this.applyConfig_(this.structure);p.prototype.init.call(this,
b);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new m(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new a(Object.extend({owner:this,structure:this.structure},this.footer));o.replace(this.tmpl.headerElement,this.header.element);!this.localSorting&&this.structure&&this.structure.search(!0,function(a){return a.sorting&&"autosorting"in a})&&(b=this.structure[Array.lastSearchIndex],this.setLocalSorting(b.sorting,"desc"==b.defaultOrder))},applyConfig_:function(a){if(a){var d=
[],e="";this.firstChild&&this.clear();for(var f=0;f<a.length;f++){var g=a[f],m=g.body||{};if("function"==typeof m||"string"==typeof m)m={content:m};var g=[g.cssClassName||"",m.cssClassName||""].join(" ").trim(),k=m.content,e=e+("<td"+(m.templateRef?m.templateRef.quote("{"):"")+(g?' class="'+g+'"':"")+">"+("string"==typeof k?m.content:"")+"</td>");"function"==typeof k&&d.push({cellIndex:f,getter:k})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new l(this.childClass.prototype.template.source.replace("<\!--{cells}--\>",
e)),updaters:d});if(this.rowBehaviour){var p=this.rowBehaviour;Object.keys(p).forEach(function(a){this.childClass.prototype[a]=function(){p[a].apply(this,arguments);b.prototype[a].apply(this,arguments)}},this)}}},loadData:function(a){this.setChildNodes(a.map(Function.wrapper("data")))},destroy:function(){p.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});g.namespace("basis.ui.table").extend({Table:n,Body:f,Header:m,HeaderCell:w,Row:b,Footer:a});
g.namespace("basis.ui").extend({Table:n})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.dom.event,l=g.cssom,q=g.TimeEventManager,w=g.ui.table.Table,t=g.layout.Box,u=g.layout.Viewport,v=g.ui.table,s=17;o.onLoad(function(){var g=k.createElement("");k.setStyle(g,{height:"100px",overflow:"scroll"});k.insert(document.body,g);s=(new t(g)).width-(new u(g)).width;l.cssRule(".ScrollBarWidthOwner").setStyle({width:s+"px"});k.remove(g)});n=n(w,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><\!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(g,
f){w.prototype.event_childNodesModified.call(this,g,f);q.add(this,"adjust",Date.now())},init:function(g){w.prototype.init.call(this,g);this.headerClone=new v.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=
this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=k.insert(this.element,k.createElement(".Basis-ScrollTable-ExpandHeaderCell",k.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new t(this.header.element);if(this.footer.useFooter)k.insert(this.tmpl.foot,this.footer.element),this.footerClone=new v.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,structure:this.structure},this.footerConfig)),this.originalCells=
this.originalCells.concat(this.footer.childNodes),this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes),k.setStyle(this.footerClone.element,{visibility:"hidden"}),this.footerBox=new t(this.footer.element),this.footerExpandCell=k.insert(this.element,k.createElement(".Basis-ScrollTable-ExpandFooterCell"));this.cellsAdjustmentInfo=[];for(var g=0,f,l;f=this.originalCells[g];g++)l=this.clonedCells[g],this.cellsAdjustmentInfo.push({element:l.element,boxChangeListener:f.element,contentSource:f.content,
contentDestination:l.content});this.tableBox=new t(this.tmpl.tableElement);this.lastScrollLeftPosition=0;o.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));o.addHandler(window,"resize",this.adjust.bind(this));this.sync();q.add(this,"adjust",Date.now())},onScroll:function(){var g=this.tmpl.scrollContainer.scrollLeft;if(g!=this.lastScrollLeftPosition)k.setStyleProperty(this.tmpl.headerFooterContainer,"left",-g+"px"),this.lastScrollLeftPosition=g},adjust:function(){this.onScroll();
this.tableBox.recalc();var g=this.tableBox.width||0;this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth?(k.setStyleProperty(this.tmpl.tableWrapperElement,"width",g+"px"),k.setStyleProperty(this.tmpl.headerFooterContainer,"width",g+s+"px")):(k.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%"),k.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%"));this.cellsAdjustmentInfo.forEach(this.adjustCell);g=Math.max(0,this.tmpl.tableWrapperElement.clientWidth-
this.tmpl.tableElement.offsetWidth+s);this.headerBox.recalc();var f=this.headerBox.height||0;l.setStyleProperty(this.element,"paddingTop",f+"px");l.setStyleProperty(this.tmpl.tableElement,"marginTop",-f+"px");l.setStyle(this.headerExpandCell,{width:g+"px",height:f+"px"});this.footer.useFooter&&(this.footerBox.recalc(),f=this.footerBox.height||0,l.setStyleProperty(this.element,"paddingBottom",f+"px"),l.setStyleProperty(this.tmpl.tableElement,"marginBottom",-f+"px"),l.setStyle(this.footerExpandCell,
{width:g+"px",height:f+"px"}))},sync:function(){this.adjust()},adjustCell:function(g){var f;f=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(g.element,null).width:g.element.clientWidth+"px";l.setStyleProperty(g.boxChangeListener,"width",f)}});g.namespace("basis.ui.scrolltable").extend({ScrollTable:n})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.dom.event,l=g.cssom,q=g.cssom.classList,w=g.Cleaner,t=g.EventObject.createEvent,u=g.dragdrop,v=g.ui.Node,s=g.ui.Container,p=g.ui.Control,f=g.ui.button.ButtonPanel,x=n(v,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(e){v.prototype.init.call(this,e);k.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});w.add(this)},capture:function(e,d){if(this.captureElement=
k.get(e||document.body))k.insert(this.captureElement,this.element),this.element.style.zIndex=d||1E3,k.show(this.element)},release:function(){if(this.captureElement)this.element.parentNode==this.captureElement&&k.remove(this.element),this.captureElement=null,k.hide(this.element)},destroy:function(){this.release();v.prototype.destroy.call(this);w.remove(this)}}),n=n(s,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><\!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(e){var d=o.key(e);d==o.KEY.ESCAPE?this.closeOnEscape&&this.close(0):d==o.KEY.ENTER&&"TEXTAREA"!=o.sender(e).tagName&&o.kill(e)}},event_beforeShow:t("beforeShow"),event_open:t("open"),event_close:t("close"),event_active:t("active"),closeOnEscape:!0,autocenter:!0,autocenter_:!1,modal:!1,closed:!0,moveable:!0,title:"[no title]",init:function(e){s.prototype.init.call(this,e);k.hide(this.element);e=this.tmpl.title.parentNode;
this.setTitle(this.title);this.cssRule=l.uniqueRule(this.element);if(this.moveable&&u)this.dde=new u.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||e,fixRight:!1,fixBottom:!1}),this.dde.addHandler({move:function(){this.autocenter=!1;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));k.setStyle(this.element,{top:"",left:""})}},this);var d=Array.from(this.buttons).map(function(a){return Object.complete({click:(a.click||
this.close).bind(this)},a)},this),a=Object.slice(this,["buttonOk","buttonCancel"]),b;for(b in a){var c=a[b];d.push({name:"buttonOk"==b?"ok":"cancel",caption:c.caption||c.title||c,click:(c.click||this.close).bind(this)})}if(d.length)this.buttonPanel=new f({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:d});if(!this.titleButton||!1!==this.titleButton.close)q(e).add("Basis-Window-Title-ButtonPlace-Close"),k.insert(e,k.createElement("SPAN.Basis-Window-Title-ButtonPlace",
k.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',k.createElement("SPAN","Close"))),k.INSERT_BEGIN);if(!1!==this.autocenter)this.autocenter=this.autocenter_=!0;this.thread&&this.thread.addHandler({finish:function(){this.closed&&k.remove(this.element)}},this);w.add(this)},setTitle:function(e){k.insert(k.clear(this.tmpl.title),e)},realign:function(){if(this.autocenter)this.element.style.margin="",this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",marginLeft:-this.element.offsetWidth/
2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})},activate:function(){this.select()},open:function(f){this.closed?(k.visibility(this.element,!1),k.show(this.element),e.appendChild(this),this.closed=!1,this.realign(),this.thread&&this.thread.start(!0),this.event_beforeShow(f),k.visibility(this.element,!0),this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select(),this.event_open(f),this.event_active(f)):this.realign()},close:function(f){if(!this.closed)this.thread?
this.thread.start(1):k.remove(this.element),e.removeChild(this),this.autocenter=this.autocenter_,this.closed=!0,this.event_close(f)},destroy:function(){this.dde&&(this.dde.destroy(),delete this.dde);s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;w.remove(this)}}),r=new x,e=new p({id:"Basis-WindowStack",childClass:n});e.addHandler({childNodesModified:function(){q(this.element).bool("IsNotEmpty",this.firstChild);var e=-1;if(this.lastChild){for(var d=0,a;a=this.childNodes[d];d++)a.element.style.zIndex=
2001+2*d,a.modal&&(e=d);this.lastChild.select()}-1!=e?r.capture(this.element,2E3+2*e):r.release()}});e.selection.addHandler({datasetChanged:function(){var f=this.pick(),d=e.lastChild;f?f.parentNode==e&&f!=d&&(e.insertBefore(f),e.event_childNodesModified({})):d&&this.add([d])}});o.onLoad(function(){k.insert(document.body,e.element,k.INSERT_BEGIN);for(var f=e.firstChild;f;f=f.nextSibling)f.realign()});g.namespace("basis.ui.window").extend({Window:n,Blocker:x,getWindowTopZIndex:function(){return 2*e.childNodes.length+
2001}})})(basis);
(function(g){function n(e){e.selection&&!e.selection.itemCount&&(e=e.childNodes.search(!1,"disabled"))&&e.select()}var k=g.Class,o=g.dom,l=Function.getter,q=g.cssom.classList,w=g.EventObject.createEvent,t=g.EventObject.event,u=g.ui.Node,v=g.ui.Container,s=g.ui.Control,w=k(s,{canHaveChildren:!0,childClass:u,event_childEnabled:w("childEnabled","document","node")&&function(e,f){this.selection&&!this.selection.itemCount&&child.select();t.childEnabled.call(this,e,f)},event_childDisabled:w("childDisabled","document",
"node")&&function(e,f){n(this);t.childDisabled.call(this,e,f)},event_childNodesModified:function(e,f){n(this);s.prototype.event_childNodesModified.call(this,e,f)},item:function(e){e=isNaN(e)?this.indexOf(e):parseInt(e);return e.between(0,this.childNodes.length-1)?this.childNodes[e]:null},indexOf:function(e){return e instanceof this.childClass?this.childNodes.indexOf(e):this.childNodes.search(e,"name")?Array.lastSearchIndex:-1}}),p=k(v,{canHaveChildren:!1,event_disable:function(){v.prototype.event_disable.call(this);
this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){v.prototype.event_enable.call(this);this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var e=this.tmpl.titleText,
f=this.titleGetter(this);e.nodeValue=null==f||""==""+f?"[no title]":f},action:{select:function(){this.isDisabled()||this.select()}},titleGetter:l("data.title"),groupId:0}),f=k(w,{childClass:p,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'}),l=k(v,{event_select:function(){q(this.element).remove("Basis-Page-Hidden");
v.prototype.event_select.call(this)},event_unselect:function(){q(this.element).add("Basis-Page-Hidden");v.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'}),x=k(w,{childClass:l,template:'<div class="Basis-PageControl"/>'}),u=k(p,{canHaveChildren:!0,childClass:u,event_select:function(){p.prototype.event_select.call(this);q(this.tmpl.pageElement).remove("Basis-Page-Hidden")},
event_unselect:function(){p.prototype.event_unselect.call(this);q(this.tmpl.pageElement).add("Basis-Page-Hidden")},template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',
destroy:function(){o.remove(this.tmpl.pageElement);p.prototype.destroy.call(this)}}),r=k(f,{childClass:u,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'}),k=k(f,{childClass:u,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',
insertBefore:function(e,g){if(e=f.prototype.insertBefore.call(this,e,g))return this.tmpl.pagesElement&&this.tmpl.pagesElement.insertBefore(e.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null),e},removeChild:function(e){if(e=f.prototype.removeChild.call(this,e))return this.tmpl.pagesElement&&e.element.appendChild(e.tmpl.pageElement),e},clear:function(e){this.childNodes.forEach(function(e){e.element.appendChild(e.tmpl.pageElement)});f.prototype.clear.call(this,e)}});g.namespace("basis.ui.tabs").extend({AbstractTabsControl:w,
TabControl:f,Tab:p,PageControl:x,Page:l,AccordionControl:r,TabSheetControl:k,TabSheet:u})})(basis);
(function(g){function n(a){return{hour:a.getHours(),day:a.getDate()-1,month:a.getMonth(),year:a.getFullYear()}}function k(a,b){var e={},f=d[a];if(f){var g=b.getFullYear(),m=b.getMonth(),k=b.getDate(),g=g-g%f[1],m=f[2]?m-m%f[2]:0,k=f[3]?k:1;e.periodStart=new Date(g,m,k);e.periodEnd=new Date(new Date(g+f[4],m+f[5],k+f[6])-1)}else e.periodStart=new Date(e.periodEnd=new Date(b));return e}var o=g.Class,l=g.dom,q=g.dom.event,w=Function.getter,t=g.cssom.classList,u=g.EventObject.createEvent,v=g.html.Template,
s=g.data.property.Property,p=g.ui.Node,f=g.ui.Container,x=g.ui.Control,r=function(a){var b=g.locale["ui.calendar"];return b?b[a]:a},e={};(function(){for(var a=32,b=2147483647;--a;)e[a]=b,b>>=1})();var m={century:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},decade:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},year:function(a){return a.periodStart.getFullYear()},quarter:function(a){return r("QUARTER").toLowerCase().format(1+a.periodStart.getMonth().base(3)/
3)},month:function(a){return r("MONTH").SHORT[a.periodStart.getMonth()].toLowerCase()},day:function(a){return a.periodStart.getDate()}},d={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},a=o(p,{canHaveChildren:!1,template:new v('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(a,b){"click"==a?this.document.templateAction(a,b,
this):p.prototype.templateAction.call(this,a,b)},templateUpdate:function(a,b,d){if(!b||"periodStart"in d||"periodEnd"in d)this.tmpl.title.nodeValue=this.titleGetter(this.data),this.parentNode&&(a=t(this.element),a.bool("before",this.data.periodStart<this.parentNode.data.periodStart),a.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd))},event_select:function(){p.prototype.event_select.call(this);l.focus(this.element)}}),b=o(f,{childClass:a,template:new v('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){f.prototype.event_select.call(this);t(this.tmpl.tabElement).add("selected")},event_unselect:function(){f.prototype.event_unselect.call(this);t(this.tmpl.tabElement).remove("selected")},event_update:function(a,b){f.prototype.event_update.call(this,a,b);var d=this.data,e;if("periodStart"in b||"periodEnd"in b){this.tmpl.titleText.nodeValue=this.getTitle(d.periodStart)||"-";this.firstChild||(e=[]);for(var g=k(this.nodePeriodName,(new Date(d.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(d.periodStart)||0))),l=0;l<this.nodeCount;l++)e?e.push({cssClassName:this.nodePeriodName,titleGetter:m[this.nodePeriodName],data:g}):this.childNodes[l].update(g),g=k(this.nodePeriodName,(new Date(g.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount));e&&this.setChildNodes(e);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(d.selectedDate)||"-";(e=this.getNodeByDate(d.selectedDate))?
e.select():d.selectedDate&&this.minDate<=d.selectedDate&&d.selectedDate<=this.maxDate?this.setViewDate(d.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:!0,isNextPeriodEnabled:!0,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(a){f.prototype.init.call(this,a);t(this.element).add("Basis-Calendar-Section-"+this.sectionName);q.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
!1))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(a){if(a&&this.data.periodStart<=a&&a<=this.data.periodEnd){a:{var b=this.childNodes;if(b.length){var d,e,f=0,g=b.length,m;do if(e=b[d=f+g>>1],a<(m=e.data.periodStart))g=d-1;else if(a>(e=e.data.periodEnd))f=d+1;else{a=a>=m&&a<=e?d:-1;break a}while(f<=g)}a=-1}if(-1!=a)return this.childNodes[a]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(k(this.periodName,new Date(+this.data.periodStart-1)))},nextPeriod:function(){this.isNextPeriodEnabled&&
this.update(k(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(a){this.update(k(this.periodName,a))},getInitOffset:Function.$null});b.Month=o(b,{sectionName:"Month",periodName:"month",template:new v(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+r("DAY").SHORT2.map(String.format,
'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:w("getDate()"),getTitle:function(a){return r("MONTH").FULL[a.getMonth()]+" "+a.getFullYear()},getInitOffset:function(a){return 1+((new Date(a)).set("day",1).getDay()+5)%7}});b.Year=o(b,{sectionName:"Year",periodName:"year",nodePeriodName:"month",nodePeriodUnit:"month",
getTabTitle:w("getMonth()",function(a){return r("MONTH").FULL[a]}),getTitle:w("getFullYear()")});b.YearDecade=o(b,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:w("getFullYear()"),getTitle:function(a){return a.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});b.Century=o(b,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",nodePeriodUnitCount:10,getTabTitle:function(a){if(a)return a=
a.getFullYear(),a-=a%10,a+"-"+(Number(a.toString().substr(-2))+9).lead(2)},getInitOffset:function(){return 1}});b.YearQuarters=o(b,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});b.Quarter=o(b,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(a){return[Math.floor(1+a.getMonth().base(3)/3),r("QUARTER").toLowerCase(),a.getFullYear()].join(" ")}});o=o(x,
{childClass:b,childFactory:Function(),template:new v(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
r("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:u("change"),event_childNodesModified:function(a,b){if(b.inserted)for(var d=0,e;e=b.inserted[d++];)e.setViewDate(this.date.value),e.update({selectedDate:this.selectedDate.value});x.prototype.event_childNodesModified.call(this,a,b);l.insert(l.clear(this.tmpl.sectionTabs),this.childNodes.map(w("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&this.firstChild.select()},
templateAction:function(b,d,e){x.prototype.templateAction.call(this,b,d);if(e instanceof a)b=e.data.periodStart,d=this.selection.pick(),this.selectedDate.set((new Date(this.selectedDate.value)).add(d.nodePeriodUnit,this.selectedDate.value.diff(d.nodePeriodUnit,b))),this.nextSection(!1);else if(!t(q.sender(d)).contains("disabled"))switch(b){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(!0)}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:!0,sections:["Month","Year","YearDecade"],init:function(a){this.todayDate=new s(new Date);this.selectedDate=new s(new Date(this.date||new Date));this.date=new s(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(a,b){this.constructor.prototype.event_datasetChanged.call(this,
a,b);var c=this.pick();c&&c.update({selectedDate:this.selectedDate.value})}};x.prototype.init.call(this,a);this.selectedDate.addHandler({change:function(a){for(var b=this.firstChild;b;b=b.nextSibling)b.update({selectedDate:a})}},this);this.todayDate.addLink(this.tmpl.todayText,null,w("toFormat('%D.%M.%Y')"));this.sections&&l.insert(this,this.sections.map(function(a){return new b[a]},this))},setSection:function(a){(a=this.childNodes.search("sectionName",a))&&a.select()},nextSection:function(a){var b=
this.selection.pick();(b=a?b.nextSibling:b.previousSibling)?(b.select(),b.setViewDate(this.selectedDate.value)):a||this.event_change()},selectDate:function(a){0!=a-this.date.value&&this.date.set(a)},getNextPeriod:function(a,b){if(!this.isNextPeriodEnabled(a,b))return!1;if(this.map){var d=b?1:-1,f=b?"start":"till",g=b?"till":"start",m=(new Date(a)).add("millisecond",d),l=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(l){var p=k("year",m);for(p.periodEnd.getFullYear()==m.getFullYear()&&
(p[f]=m);!this.isPeriodEnabled(p.periodStart,p.periodEnd);)p=k("year",m.add("year",d));for(p[g]=k("month",p[f])[g];!this.isPeriodEnabled(p.periodStart,p.periodEnd);)p=k("month",m.add("month",d));var r=n(p[f]),g=n(p[g]);if(l=l[g.year]&&l[g.year][g.month]){this.periodEnableByDefault&&(f=e[p.periodEnd.getMonthDayCount()],l=l&f^f);for(f=r.day;f!=g.day+d;f+=d)if(l>>f&1){m=new Date(r.year,r.month,f+1);break}}else return k("day",p[f])}}return k("day",m)},isNextPeriodEnabled:function(a,b){if(!b&&this.minDate&&
this.minDate>a||b&&this.maxDate&&this.maxDate<a)return!1;if(this.map)if(this.periodEnableByDefault){if(!b&&this.minDate)return this.isPeriodEnabled(this.minDate,a);if(b&&this.maxDate)return this.isPeriodEnabled(a,this.maxDate)}else{var d=b?1:-1,e=a.getFullYear(),f=(new Date(a)).add("millisecond",d),g=f.getFullYear(),m=Object.keys(this.map.enable).filter(function(a){return d*a>=d*g}),l=m.length;if(l)for(var m=m.sort(function(a,b){return d*(a>b)||-d*(a<b)}),p=0;p<l;p++){var n=k("year",new Date(m[p],
0));if(this.isPeriodEnabled(b&&m[p]==e?f:n.periodStart,!b&&m[p]==e?f:n.periodEnd))return!0}return!1}return!0},isPeriodEnabled:function(a,b){if(this.minDate&&this.minDate>b||this.maxDate&&this.maxDate<a)return!1;var d=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(d){var f=n(a),g=n(b),m,k,l,p=f.month,r=new Date(f.year,f.month),o=11-f.month,z=o+1+12*(g.year-f.year-1)+(g.month+1)-1;if(this.periodEnableByDefault){if(0==z)return!(m=d[f.year])||!(k=m[f.month])||(k^2147483647)>>f.day&
e[g.day-f.day+1];for(var q=0;q<=z;q++){if(!q||o==q%12)if(m=d[r.getFullYear()],!m)return!0;k=m[p=r.getMonth()];if(!k)return!0;l=e[r.getMonthDayCount()];if(q/z?1==q/z?(k&l^l)&e[g.day+1]:k&l^l:(k&l^l)>>f.day)return!0;r.setMonth(p+1)}}else{if(0==z)return(m=d[f.year])&&(k=m[f.month])&&k>>f.day&e[g.day-f.day+1];for(q=0;q<=z;q++){if(!q||o==q%12||!m)if(m=d[r.getFullYear()],!m){q+=12;r.setMonth(p+12);continue}if((k=m[p=r.getMonth()])&&(q/z?1==q/z?k&e[g.day+1]:k:k>>f.day))return!0;r.setMonth(p+1)}}return!1}return!0},
destroy:function(){x.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});g.namespace("basis.ui.calendar").extend({Calendar:o,CalendarSection:b})})(basis);
(function(g){function n(a,b){return new q(a.source.replace("<\!-- {fieldPlace} --\>",b))}var k=g.Class,o=g.dom.event,l=g.dom,q=g.html.Template,w=g.Cleaner,t=Object.complete,u=Function.getter,v=g.cssom.classList,s=g.data.property.Property,p=g.EventObject,f=g.dom.wrapper.Selection,x=g.ui.Control,r=g.ui.Node,e=g.ui.Container,m=g.ui.popup.Popup,d=p.createEvent,a=new q('<div{selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><\!-- {fieldPlace} --\></div></div>'),
b=r.subclass({canHaveChildren:!1,template:a,nextFieldOnEnter:!0,serializable:!0,event_select:function(){l.focus(this.tmpl.field,!0);r.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");r.prototype.event_disable.call(this)},event_input:d("input","event"),event_change:d("change","event"),event_keydown:d("keydown","event"),event_keypress:d("keypress",
"event"),event_keyup:d("keyup","event")&&function(a){this.nextFieldOnEnter&&([o.KEY.ENTER,o.KEY.CTRL_ENTER].has(o.key(a))?(o.cancelDefault(a),this.nextFieldFocus()):this.setValid());p.event.keyup.call(this,a)},event_focus:d("focus","event")&&function(a){this.valid&&this.setValid();p.event.focus.call(this,a)},event_blur:d("blur","event")&&function(a){this.validate(!0);p.event.blur.call(this,a)},init:function(a){r.prototype.init.call(this,a);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=
this.title||"";if(this.tmpl.field){o.addHandler(this.tmpl.field,"keydown",this.keydown,this);o.addHandler(this.tmpl.field,"keyup",this.keyup,this);o.addHandler(this.tmpl.field,"keypress",this.keypress,this);o.addHandler(this.tmpl.field,"blur",this.blur,this);o.addHandler(this.tmpl.field,"focus",this.focus,this);o.addHandler(this.tmpl.field,"change",this.change,this);o.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=
this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value)this.defaultValue=this.value,this.setDefaultValue()},setReadOnly:function(a){a?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},
setSample:function(a){if(this.tmpl.sampleContainer&&a)this.sampleElement?l.insert(l.clear(this.sampleElement),a):l.insert(this.tmpl.sampleContainer,this.sampleElement=l.createElement("SPAN.Basis-Field-Sample",a));else if(this.sampleElement)l.remove(this.sampleElement),this.sampleElement=null},getValue:function(){return this.tmpl.field.value},setValue:function(a){a=a||"";if(this.tmpl.field.value!=a)this.tmpl.field.value=a,this.event_change()},setMaxLength:function(a){this.maxLength=a},setMinLength:function(a){this.minLength=
a},attachValidator:function(a,b){this.validators.add(a)&&b&&this.validate()},detachValidator:function(a,b){this.validators.remove(a)&&b&&this.validate()},change:function(a){this.event_change(a)},input:function(a){this.event_input(a)},keydown:function(a){this.event_keydown(a)},keyup:function(a){this.event_keyup(a)},keypress:function(a){this.event_keypress(a)},blur:function(a){this.event_blur(a)},focus:function(a){this.event_focus(a)},select:function(){this.unselect();r.prototype.select.apply(this,
arguments)},setValid:function(a,b){var c=v(this.element);"boolean"==typeof a?(c.bool("invalid",!a),c.bool("valid",a),b?this.element.title=b:this.element.removeAttribute("title")):(c.remove("invalid"),c.remove("valid"),this.element.removeAttribute("title"));this.valid=a},validate:function(a){var b;this.setValid();for(var c=0;c<this.validators.length;c++)if(b=this.validators[c](this))return a||this.setValid(!1,b.message),b;""!=this.getValue()&&this.setValid(!0)},nextFieldFocus:function(){var a=l.axis(this,
l.AXIS_FOLLOWING_SIBLING).search(!0,"selectable");a?a.select():this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){o.clearHandlers(this.element);this.tmpl.field&&o.clearHandlers(this.tmpl.field);this.button&&(o.clearHandlers(this.button),delete this.button);this.validators.clear();r.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});b.create=function(a,c){a={radiogroup:"RadioGroup",checkgroup:"CheckGroup"}[a.toLowerCase()]||
a.capitalize();if(b[a])return new b[a](c);throw Error("Wrong field type `{0}`".format(a));};b.Hidden=b.subclass({selectable:!1,template:'<input{field} type="hidden" />'});b.Text=b.subclass({template:n(a,'<input{field} type="text" />'),init:function(a){b.prototype.init.call(this,a);this.minLength&&this.attachValidator(y.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(a){this.tmpl.field.setAttribute("maxlength",a,0);b.prototype.setMaxLength.call(this,
a)}});b.Password=b.Text.subclass({template:n(a,'<input{field} type="password" />')});b.File=b.subclass({template:n(a,'<input{field} type="file" />')});b.Textarea=b.subclass({nextFieldOnEnter:!1,template:n(a,"<textarea{field} />"),init:function(a){this.counter=l.createElement(".counter",b.LOCALE.Textarea.SYMBOLS_LEFT+": ",l.createText(0));b.prototype.init.call(this,a);this.minLength&&this.attachValidator(y.MinLength);this.maxLength&&this.attachValidator(y.MaxLength);o.addHandler(this.tmpl.field,"keyup",
this.updateCounter,this);o.addHandler(this.tmpl.field,"input",this.updateCounter,this);window.opera&&o.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=!0;this.contentEditable=!1})},updateCounter:function(){var a=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=0<=a?a:0},setValue:function(a){b.prototype.setValue.call(this,a);this.updateCounter()},setMaxLength:function(a){b.prototype.setMaxLength.call(this,a);a?(this.updateCounter(),l.insert(this.tmpl.sampleContainer,
this.counter)):l.remove(this.counter)},destroy:function(){delete this.counter;b.prototype.destroy.call(this)}});b.Checkbox=b.subclass({value:!1,template:'<div class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox" /><span>{titleText}</span></label></div></div>',invert:function(){this.setValue(!this.getValue())},setValue:function(a){var b=this.tmpl.field.checked;this.tmpl.field.checked=!!a;b!=this.tmpl.field.checked&&this.event_change()},
getValue:function(){return this.tmpl.field.checked}});b.Label=b.subclass({cssClassName:"Basis-Field-Label",template:n(a,"<label{field}>{fieldValueText}</label>"),valueGetter:Function.$self,event_change:function(){b.prototype.event_change.apply(this,arguments);this.tmpl.fieldValueText.nodeValue=this.valueGetter(this.getValue())}});var c=r.subclass({canHaveChildren:!1,titleGetter:function(a){return a.title||a.getValue()},valueGetter:u("value"),getTitle:function(){return this.titleGetter(this)},getValue:function(){return this.valueGetter(this)}}),
i={datasetChanged:function(){this.event_change()}},h=k(b,e,{childClass:c,template:b.prototype.template,multipleSelect:!1,init:function(a){this.selection=new f({multiple:!!this.multipleSelect});this.selection.addHandler(i,this);b.prototype.init.call(this,a);w.add(this)},getValue:function(){var a=this.selection.getItems().map(u("getValue()"));return!this.selection.multiple?a[0]:a},setValue:function(a){var b={};(this.multipleSelect?Array.from(a):[a]).forEach(function(a){b[a]=!0});for(var a=[],c=this.firstChild;c;c=
c.nextSibling)b[c.getValue()]&&a.push(c);this.selection.set(a)},destroy:function(){b.prototype.destroy.call(this);w.remove(this)}});h.Item=c;e=c.subclass({event_select:function(){this.tmpl.field.checked=!0;c.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=!1;c.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled",
"disabled");r.prototype.event_disable.call(this)},template:'<label class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>',templateUpdate:function(a,b,d){c.prototype.templateUpdate.call(this,a,b,d);a.field.value=this.getValue();a.titleText.nodeValue=this.getTitle()},action:{select:function(){this.isDisabled()||this.select()}}});b.RadioGroup=h.subclass({childClass:e,template:n(a,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),
childFactory:function(a){a=h.prototype.childFactory.call(this,a);if(this.name)a.tmpl.field.name=this.name;return a}});b.RadioGroup.Item=e;e=c.subclass({event_select:function(){this.tmpl.field.checked=!0;c.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=!1;c.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled",
"disabled");r.prototype.event_disable.call(this)},template:'<label event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>',templateUpdate:function(a,b,d){c.prototype.templateUpdate.call(this,a,b,d);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},action:{click:function(a){this.isDisabled()||(this.select(this.parentNode.multipleSelect),"INPUT"!=o.sender(a).tagName&&o.kill(a))}}});b.CheckGroup=h.subclass({childClass:e,multipleSelect:!0,
template:n(a,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});b.CheckGroup.Item=e;e=c.subclass({event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:"<option{field}>{titleText}</option>",templateUpdate:function(a,b,d){c.prototype.templateUpdate.call(this,a,b,d);a.field.value=this.getValue();a.field.text=this.getTitle()}});b.Select=h.subclass({childClass:e,template:n(a,"<select{field|childNodesElement} />"),
event_keyup:function(a,b){this.change();h.prototype.event_keyup.call(this,a,b)},setValue:function(a){(a=this.childNodes.search(a,"getValue()"))?this.selection.set([a]):this.selection.clear()}});b.Select.Item=e;var j={show:function(){v(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){v(this.tmpl.field).remove("Basis-DropdownList-Opened")}},e=c.subclass({template:'<div class="Basis-Combobox-Item" event-click="click">{titleText}</div>',templateUpdate:function(a,b,d){c.prototype.templateUpdate.call(this,
a,b,d);a.titleText.nodeValue=this.getTitle()},action:{click:function(a){this.isDisabled()||(this.select(),this.parentNode&&this.parentNode.hide(),o.kill(a))}}}),B={keyup:function(a){var b=o.key(a),c=this.selection.pick();switch(b){case o.KEY.DOWN:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=l.axis(c?c:this.firstChild,l.AXIS_FOLLOWING_SIBLING).search(!1,"disabled");break;case o.KEY.UP:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():
null;c=c?l.axis(c,l.AXIS_PRESCENDING_SIBLING).search(!1,"disabled"):this.firstChild}c&&(c.select(),l.focus(this.tmpl.field))},keydown:function(a){var b=o.key(a);b==o.KEY.DOWN||b==o.KEY.UP?o.kill(a):b==o.KEY.ENTER&&(this.popup.visible&&this.hide(),o.kill(a))}};b.Combobox=h.subclass({childClass:e,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();h.prototype.event_enable.call(this)},event_change:function(){h.prototype.event_change.call(this);var a=this.getValue();this.property&&
this.property.set(a);if(this.hidden)this.hidden.value=a;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:n(a,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><\!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent" />'),action:{click:function(a){this.isDisabled()||
this.popup.visible?this.hide():this.show({});o.kill(a)}},init:function(a){if(!g.ui.popup)throw Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:u("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};h.prototype.init.call(this,
a);this.satellite.captionItem.setDelegate(this.selection.pick());o.addHandlers(this.tmpl.field,B,this);if(this.name)l.insert(this.tmpl.field,this.hidden=l.createElement("INPUT[type=hidden][name={0}]".format((""+this.name).quote())));this.popup=new m(t({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,handler:j,handlerContext:this},this.popup));this.property&&this.property.addLink(this,this.setValue)},show:function(){this.popup.show(this.tmpl.field);
this.select()},hide:function(){this.popup.hide()},getTitle:function(){var a=this.selection.pick();return a&&a.getTitle()},getValue:function(){var a=this.selection.pick();return a&&a.getValue()},setValue:function(a){this.getValue()!=a&&((a=this.childNodes.search(a,"getValue()"))&&!a.isDisabled()?this.selection.set([a]):this.selection.clear())},destroy:function(){if(this.property)this.property.removeLink(this),this.property=null;this.popup.destroy();this.popup=null;h.prototype.destroy.call(this)}});
b.Combobox.Item=e;var A=k(null,{init:function(a,b){this.field=a;this.message=b}}),y={NO_LOCALE:"There is no locale for this error",RegExp:function(a){a.constructor!=RegExp&&(a=RegExp(a));return function(b){var c=b.getValue();if(""!=c&&!c.match(a))return new A(b,y.LOCALE.RegExp.WRONG_FORMAT||y.NO_LOCALE)}},Required:function(a){var b=a.getValue();if(Function.$isNull(b)||""==b)return new A(a,y.LOCALE.Required.MUST_BE_FILLED||y.NO_LOCALE)},Number:function(a){var b=a.getValue();if(isNaN(b))return new A(a,
y.LOCALE.Number.WRONG_FORMAT||y.NO_LOCALE)},Currency:function(a){var b=a.getValue();if(isNaN(b))return new A(a,y.LOCALE.Currency.WRONG_FORMAT||y.NO_LOCALE);if(0>=b)return new A(a,y.LOCALE.Currency.MUST_BE_GREATER_ZERO||y.NO_LOCALE)},Email:function(a){var b=a.getValue().trim();if(""!=b&&!b.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new A(a,y.LOCALE.Email.WRONG_FORMAT||y.NO_LOCALE)},Url:function(a){var b=a.getValue().trim();if(""!=b&&!b.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new A(a,
y.LOCALE.Url.WRONG_FORMAT||y.NO_LOCALE)},MinLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?b.length:(""+b).length)<a.minLength)return new A(a,(y.LOCALE.MinLength.MUST_BE_LONGER_THAN||y.NO_LOCALE).format(a.minLength))},MaxLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?b.length:(""+b).length)>a.maxLength)return new A(a,(y.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||y.NO_LOCALE).format(a.maxLength))}},k=x.subclass({canHaveChildren:!0,childClass:b,childFactory:function(a){return b.create(a.type||
"text",a)},onSubmit:Function.$false,event_reset:d("reset"),event_disable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_disable();x.prototype.event_disable.call(this)},event_enable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_enable();x.prototype.event_enable.call(this)},template:'<div class="Basis-FormContent" />',getFieldByName:function(a){return this.childNodes.search(a,"name")},getFieldById:function(a){return this.childNodes.search(a,"id")},
serialize:function(){for(var a={},b=this.firstChild;b;b=b.nextSibling)b.serializable&&b.name&&(a[b.name]=b.getValue());return a},setData:function(a,b){this.loadData(a,b)},loadData:function(a,b){for(var c=Object.keys(a),d=this.firstChild;d;d=d.nextSibling)-1!=c.indexOf(d.name)?d.setValue(a[d.name]):d.setDefaultValue(),d.setValid();b||this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.setDefaultValue();this.event_reset()},validate:function(){for(var a,
b=[],c=this.firstChild;c;c=c.nextSibling)(a=c.validate())&&b.push(a);return b.length?(b[0].field.select(),b):!0},submit:function(){if(!0===this.validate()&&this.onSubmit)this.onSubmit(this.serialize())}}),d=k.subclass({template:'<form{formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent" /></form>',method:"POST",init:function(a){this.selection=!1;x.prototype.init.call(this,a);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=
this.action;if(this.enctype)this.formElement.enctype=this.enctype;o.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(a){this.formElement.method=a?a.toUpperCase():"POST"},submit:function(){if(!0===this.validate()&&!this.onSubmit()){if("FORM"==this.tagName)return!1;this.formElement.submit()}return!0}}),C=s.subclass({matchFunction:function(a,b){if(!b){var c=a._original||this.textNodeGetter(a);Array.isArray(c)||
(c=[c]);a._original=c;for(var d=0,e=c.length;0<e--;){var h=c[e];if(h){var f=h.nodeValue.split(this.rx);if(1<f.length){if(!a._replaced)a._replaced={};l.replace(a._replaced[e]||h,a._replaced[e]=l.createElement("SPAN.matched",l.wrap(f,this.map)));d++}else a._replaced&&a._replaced[e]&&(l.replace(a._replaced[e],h),delete a._replaced[e])}}return 0<d}if(a._replaced){for(c in a._replaced)l.replace(a._replaced[c],a._original[c]);delete a._replaced;delete a._original}return!1},event_change:function(a,b){this.rx=
this.regexpGetter(a);s.prototype.event_change.call(this,a,b)},extendConstructor_:!0,init:function(){var a=this.startPoints||"";this.textNodeGetter=u(this.textNodeGetter||"tmpl.titleText");if("function"!=typeof this.regexpGetter)this.regexpGetter=function(b){return RegExp("("+a+")("+b.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||"SPAN.match"]=function(a,b){return 2==b%3};s.prototype.init.call(this,"",this.handlers,String.trim)}}),E={childNodesModified:function(a,b){b.inserted&&b.inserted.forEach(function(a){this.matchFunction(a,
""==this.value)},this)}},e=C.subclass({event_change:function(a,b){C.prototype.event_change.call(this,a,b);this.match()},init:function(a){C.prototype.init.call(this,a);this.node.addHandler(E,this)},match:function(){this.node.childNodes.forEach(function(a){this.matchFunction(a,""==this.value)},this)}}),F=C.subclass({event_change:function(a,b){C.prototype.event_change.call(this,a,b);this.node.setMatchFunction(a?this.matchFunction.bind(this):null)}}),G=b.Text.subclass({cssClassName:"Basis-MatchInput",
matchFilterClass:F,event_keyup:function(a){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_keyup.call(this,a)},event_change:function(a){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_change.call(this,a)},init:function(a){b.Text.prototype.init.call(this,a);this.matchFilter=new this.matchFilterClass(this.matchFilter)}});g.namespace("basis.ui.form").extend({createFieldTemplate:function(b){return n(a,b)},FormContent:k,Form:d,Field:b,Validator:y,ValidatorError:A,
RadioGroup:b.RadioGroup,CheckGroup:b.CheckGroup,Combobox:b.Combobox,ComplexField:h,Matcher:e,MatchFilter:F,MatchInput:G})})(basis);
(function(){function g(e,f){if(window[e])return window[e];for(var e=e.charAt(0).toUpperCase()+e.substr(1),d=0,a;a=v[d++];)if(window[a+e])return window[a+e];return f}var n=basis.Class,k=basis.dom,o=basis.EventObject,l=basis.dom.event,q=basis.cssom.classList,w=!1,t=!1,u;(function(){function e(d,a){for(var b;b=a.shift();)if("undefined"!=typeof d.style[b])return b;return!1}var f=k.createElement("");(u=e(f,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))&&(w=!0);if(w&&(e(f,["perspectiveProperty",
"WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style))t=!0})();var v=["webkit","moz","o","ms"],s=g("requestAnimationFrame",function(e){return window.setTimeout(e,15)}),p=g("cancelRequestAnimFrame",clearInterval),f=n(o,{minScrollDelta:0,preventScrollX:!1,preventScrollY:!1,scrollPropertyType:"style",event_start:o.createEvent("start","scrollerObject"),event_finish:o.createEvent("finish","scrollerObject"),event_startInertia:o.createEvent("startInertia",
"scrollerObject"),event_updatePosition:o.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(e){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=
this.lastMouseX=0;this.panningActive=this.processInertia=!1;o.prototype.init.call(this,e);this.targetElement&&(l.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),l.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);"scroll"==this.scrollPropertyType?(k.setStyle(this.targetElement,{overflow:"hidden"}),this.updateElementPosition=this.updatePosition_scrollTopLeft,this.calcDimentions=this.calcDimentions_scrollTopLeft):(k.setStyle(this.targetElement,
{position:"relative"}),this.updateElementPosition=w?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft,this.calcDimentions=this.calcDimentions_styleTopLeft);if(0==this.minScrollDelta)this.minScrollDeltaXReached=this.minScrollDeltaYReached=!0},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var e=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",f=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px",d={};d[u]="translate("+e+", "+f+")"+(t?" translateZ(0)":"");k.setStyle(this.targetElement,d)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;
this.scrollX=!this.preventScrollX&&0<this.maxPositionX;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&0<this.maxPositionY},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var e=this.targetElement.offsetParent;if(e)this.maxPositionX=this.targetElement.scrollWidth-e.offsetWidth,this.scrollX=!this.preventScrollX&&0<this.maxPositionX,this.maxPositionY=this.targetElement.scrollHeight-
e.offsetHeight,this.scrollY=!this.preventScrollY&&0<this.maxPositionY},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=!1},startUpdate:function(){if(!this.isUpdating)this.targetElement.offsetWidth&&
this.calcDimentions(),this.startViewportX=this.viewportX,this.startViewportY=this.viewportY,this.isUpdating=!0,this.updateFrameHandle=this.nextFrame(),this.startTime=this.lastUpdateTime=Date.now(),this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=!1,p(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(e){this.stopUpdate();this.panningActive=!0;this.lastMouseX=l.mouseX(e);this.lastMouseY=l.mouseY(e);
this.lastMotionUpdateTime=Date.now();l.addHandler(document,"mousemove",this.onMouseMove,this);l.addHandler(document,"touchmove",this.onMouseMove,this);l.addHandler(document,"mouseup",this.onMouseUp,this);l.addHandler(document,"touchend",this.onMouseUp,this);l.cancelDefault(e)},onMouseMove:function(e){(0==this.minScrollDelta||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var f=Date.now(),d=f-this.lastMotionUpdateTime;this.lastMotionUpdateTime=f;if(d){if(this.minScrollDeltaXReached||
!this.minScrollDeltaYReached)f=l.mouseX(e),d=this.lastMouseX-f,this.lastMouseX=f,this.viewportTargetX+=d;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)e=l.mouseY(e),f=this.lastMouseY-e,this.lastMouseY=e,this.viewportTargetY+=f;if(0<this.minScrollDelta&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=!0;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=
!0;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=!1;this.processInertia=!0;var e=Date.now()-this.lastMotionUpdateTime,e=Math.max(10,e);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,e/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,e/100)));l.removeHandler(document,
"mousemove",this.onMouseMove,this);l.removeHandler(document,"touchmove",this.onMouseMove,this);l.removeHandler(document,"mouseup",this.onMouseUp,this);l.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(e){e||(e=Date.now());var f=e-this.lastUpdateTime;this.lastUpdateTime=e;if(f){if(this.panningActive){var d;if(this.scrollX&&(d=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,d))this.currentVelocityX=Math.abs(d)/
f,this.currentDirectionX=0==d?0:0>d?-1:1;if(this.scrollY&&(d=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,d))this.currentVelocityY=Math.abs(d)/f,this.currentDirectionY=0==d?0:0>d?-1:1}else if(this.processInertia){if(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*f,this.currentVelocityX*=0.94,0.0010>this.currentVelocityX||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX))this.viewportTargetX=Math.min(this.maxPositionX,
Math.max(this.minPositionX,this.viewportTargetX)),this.currentVelocityX=0;if(this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*f,this.currentVelocityY*=0.94,0.0010>this.currentVelocityY||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY))this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY)),this.currentVelocityY=0;if(0==this.currentVelocityX&&0==this.currentVelocityY)this.processInertia=!1}f=d=0;this.scrollX&&
(d=this.viewportTargetX-this.viewportX,this.viewportX+=d*(this.panningActive||0<this.currentVelocityX?1:0.12));this.scrollY&&(f=this.viewportTargetY-this.viewportY,this.viewportY+=f*(this.panningActive||0<this.currentVelocityY?1:0.12));d=!this.scrollX||0.0010>this.currentVelocityX&&0.1>Math.abs(d);f=!this.scrollY||0.0010>this.currentVelocityY&&0.1>Math.abs(f);if(!this.panningActive&&d&&f){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();
this.event_updatePosition(this,e,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPosition:function(e,f){this.viewportX=e;this.viewportY=f;this.isUpdating?this.stopUpdate():(this.resetVariables(),this.updateElementPosition())},setTargetPosition:function(e,f){this.viewportTargetX=e||0;this.viewportTargetY=f||0;this.startUpdate();this.processInertia=!0},calcExpectedPosition:function(e){var f=
0,d="x"==e?this.currentVelocityX:this.currentVelocityY,a="x"==e?this.currentDirectionX:this.currentDirectionY,b="x"==e?this.viewportTargetX:this.viewportTargetY,c="x"==e?this.minPositionX:this.minPositionY,e="x"==e?this.maxPositionX:this.maxPositionY;if(d)for(var i=Math.log(0.0010/d)/Math.log(0.94),h=0;h<i;h++)f+=15*a*d,d*=0.94;return Math.max(c,Math.min(e,b+f))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),
x=n(o,{minScrollDelta:0,scrollX:!0,scrollY:!0,event_start:o.createEvent("start","scrollerObject"),event_finish:o.createEvent("finish","scrollerObject"),event_startInertia:o.createEvent("startInertia","scrollerObject"),event_updatePosition:o.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(e){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=
this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=!1;o.prototype.init.call(this,e);this.targetElement&&(l.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),l.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=w?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;
if(0==this.minScrollDelta)this.minScrollDeltaXReached=this.minScrollDeltaYReached=!0},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var e=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",f=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px";this.targetElement.style[u]="translate("+e+", "+f+")"+(t?" translateZ(0)":
"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=!1},startUpdate:function(){if(!this.isUpdating)this.isUpdating=!0,this.updateFrameHandle=this.nextFrame(),this.lastUpdateTime=Date.now(),this.event_start(this)},
stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=!1,p(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(e){this.stopUpdate();this.panningActive=!0;this.lastMouseX=l.mouseX(e);this.lastMouseY=l.mouseY(e);this.lastMotionUpdateTime=Date.now();l.addHandler(document,"mousemove",this.onMouseMove,this);l.addHandler(document,"touchmove",this.onMouseMove,this);l.addHandler(document,"mouseup",this.onMouseUp,this);l.addHandler(document,
"touchend",this.onMouseUp,this);l.cancelDefault(e)},onMouseMove:function(e){(0==this.minScrollDelta||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var f=Date.now(),d=f-this.lastMotionUpdateTime;this.lastMotionUpdateTime=f;if(d){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached)f=l.mouseX(e),d=this.lastMouseX-f,this.lastMouseX=f,this.viewportTargetX+=d;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)e=l.mouseY(e),f=this.lastMouseY-e,this.lastMouseY=
e,this.viewportTargetY+=f;if(0<this.minScrollDelta&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=!0;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=!0;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=
!1;this.processInertia=!0;var e=Date.now()-this.lastMotionUpdateTime,e=Math.max(10,e);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,e/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,e/100)));l.removeHandler(document,"mousemove",this.onMouseMove,this);l.removeHandler(document,"touchmove",this.onMouseMove,this);l.removeHandler(document,"mouseup",this.onMouseUp,this);l.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},
onUpdate:function(e){e||(e=Date.now());var f=e-this.lastUpdateTime;this.lastUpdateTime=e;if(f){if(this.panningActive){var d;if(this.scrollX&&(d=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,d))this.currentVelocityX=Math.abs(d)/f,this.currentDirectionX=0==d?0:0>d?-1:1;if(this.scrollY&&(d=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,d))this.currentVelocityY=Math.abs(d)/f,this.currentDirectionY=0==d?0:0>d?-1:
1}else this.processInertia&&(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*f,this.currentVelocityX*=0.94),this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*f,this.currentVelocityY*=0.94));f=d=0;this.scrollX&&(d=this.viewportTargetX-this.viewportX,this.viewportX+=d*(this.panningActive||0<this.currentVelocityX?1:0.12));this.scrollY&&(f=this.viewportTargetY-this.viewportY,this.viewportY+=f*(this.panningActive||0<this.currentVelocityY?
1:0.12));d=!this.scrollX||0.5>Math.abs(d);f=!this.scrollY||0.5>Math.abs(f);if(!this.panningActive&&d&&f){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,e,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPositionX:function(e,f){f?(this.viewportTargetX=e||0,
this.currentVelocityX=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetX=this.viewportX=e,this.updateElementPosition())},setPositionY:function(e,f){f?(this.viewportTargetY=e||0,this.currentVelocityY=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetY=this.viewportY=e,this.updateElementPosition())},calcExpectedPosition:function(e){var f=0,d="x"==e?this.currentVelocityX:this.currentVelocityY,a="x"==e?this.currentDirectionX:this.currentDirectionY,e="x"==e?this.viewportTargetX:this.viewportTargetY;
if(d)for(var b=Math.log(0.0010/d)/Math.log(0.94),c=0;c<b;c++)f+=15*a*d,d*=0.94;return e+f},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),r=n(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',init:function(e){basis.ui.Node.prototype.init.call(this,e);this.startProperty="horizontal"==this.type?
"left":"top";this.endProperty="horizontal"==this.type?"right":"bottom";q(this.element).add(this.type)},recalcSize:function(e){k.display(this.element,1>e);var f="horizontal"==this.type?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=f-f*e},updatePosition:function(e){var f=this.trackSize*e,e=this.trackSize-this.trackSize*e;0>f&&(f=0);0>e&&(e=0);var d={};d[this.startProperty]=f+"px";d[this.endProperty]=e+"px";k.setStyle(this.tmpl.trackElement,d)}}),n=n(basis.ui.Container,{useScrollbars:!0,
scrollX:!0,scrollY:!0,wheelDelta:40,event_realign:o.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(e){e=l.wheelDelta(e);this.scrollX?this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*e,!0):this.scrollY&&this.scroller.setPositionY(this.scroller.viewportTargetY-this.wheelDelta*e,!0)}},init:function(e){basis.ui.Node.prototype.init.call(this,
e);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;e=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new x(e);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=new r({type:"horizontal",container:this.element});
if(this.scrollY)this.vScrollbar=new r({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){q(this.element).add("scrollProcess")},finish:function(){q(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var e=this.scroller;e.panningActive||this.fixPosition();this.useScrollbars&&(this.scrollX&&this.hScrollbar.updatePosition(e.viewportX/this.maxPositionX),this.scrollY&&this.vScrollbar.updatePosition(e.viewportY/this.maxPositionY))},fixPosition:function(){var e=
this.scroller;if(this.scrollX&&(e.viewportX<this.minPositionX||e.viewportX>this.maxPositionX)){var f=Math.min(this.maxPositionX,Math.max(this.minPositionX,e.viewportX));e.setPositionX(f,!0)}if(this.scrollY&&(e.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))f=Math.min(this.maxPositionY,Math.max(this.minPositionY,e.viewportY)),e.setPositionY(f,!0)},realign:function(){this.calcDimentions();this.scrollUpdatePosition();this.event_realign()},calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var e=
this.element.offsetWidth,f=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,f-e)}if(this.scrollY){var d=this.element.offsetHeight,a=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,a-d)}this.useScrollbars&&(this.scrollX&&this.hScrollbar.recalcSize(e/f),this.scrollY&&this.vScrollbar.recalcSize(d/a))}},destroy:function(){this.scroller.destroy();basis.ui.Node.prototype.destroy.call(this)}});basis.namespace("basis.ui.scroller").extend({Scroller:f,Scroller2:x,ScrollPanel:n})})(basis);
(function(g){var n=g.Class,k=g.dom,o=g.dom.event,l=g.cssom,q=g.dom.wrapper,w=g.ui.Container,t=g.animation.Modificator,u=n(g.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(f){f.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),v=n(w,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:u}}}),s=!0,p=n(w,{behaviour:{click:function(f,g){g&&g.delegate.parentNode.scrollToNode(g.delegate)}},init:function(f){this.inherit(f);this.document=this;s&&o.addHandler(this.element,"mousewheel",function(f){try{this.owner.content.dispatchEvent(f)}catch(g){s=!1,o.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}}),n=n(q.Control,{childClass:v,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:!0,init:function(f){this.inherit(Object.complete({childNodes:null},f));var n=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new n({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;l.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new q.ChildNodesDataset(this);
this.header=new p({container:this.element,childClass:n,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new p({container:this.element,childClass:n,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});k.hide(this.header.element);k.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new g.Animation.Thread({duration:400,interval:15});var r=this;this.modificator=new t(this.thread,function(e){r.content.scrollTop=parseInt(e);
r.recalc()},0,0,!0);this.modificator.timeFunction=function(e){return Math.sin(Math.acos(1-e))};o.addHandler(this.content,"scroll",this.recalc,this);o.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",!0);f.childNodes&&this.setChildNodes(f.childNodes);this.timer_=setInterval(function(){r.recalc()},500)},scrollToNode:function(f){if(f&&f.parentNode===this)if(f=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[k.index(f)]),this.thread){var g=
this.content.scrollTop;this.modificator.setRange(g,g);this.thread.stop();this.modificator.setRange(g,f);this.thread.start()}else this.content.scrollTop=f},recalc:function(){var f=this.content,g=f.clientHeight,l=f.scrollHeight,f=f.scrollTop,e=g==l;if(this.clientHeight_!=g||this.scrollHeight_!=l){this.clientHeight_=g;this.scrollHeight_=l;var l=[],m=[];if(!e)for(var d=this.meterElement.offsetHeight,a=0,g=d*this.childNodes.length-g,b,c=0;b=this.childNodes[c];c++)b=b.element.offsetTop,l.push(b?b-a:l[c-
1]||0),m.push(b?b+g:m[c-1]||g),a+=d,g-=d;this.topPoints=l;this.bottomPoints=m;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=e)this.isFit=e,k.display(this.header.element,!e),k.display(this.footer.element,!e);if(!e&&this.scrollTop_!=f)if(this.scrollTop_=f,e)this.lastTopPoint=0,this.lastBottomPoint=this.childNodes.length;else{var i=this.topPoints.binarySearchPos(f),h=this.bottomPoints.binarySearchPos(f);if(this.lastTopPoint!=i)this.lastTopPoint=i,this.header.childNodes.forEach(function(a,
b){a.element.style.display=b>=i?"none":""});if(this.lastBottomPoint!=h)this.lastBottomPoint=h,this.footer.childNodes.forEach(function(a,b){a.element.style.display=b<h?"none":""})}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();o.removeHandler(this.content,"scroll",this.recalc,this);o.removeHandler(window,"resize",this.recalc,this);this.inherit()}});g.namespace("basis.ui.toc").extend({Control:n,
ControlItem:v,ControlItemHeader:u,ControlHeaderList:p})})(basis);
(function(g){var n=g.dom,k=g.dom.event,o=g.EventObject.createEvent,l=g.cssom.classList,q=g.dragdrop.DragDropElement,w=g.layout.Box,t=g.ui.Node,u=g.ui.Container,v=t.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(f){t.prototype.init.call(this,f);n.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&l(this.element).add("last");this.isRange&&l(this.element).add("range")}}),s=u.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:v,captionGetter:Function.$self,count:0,marks:null,init:function(f){u.prototype.init.call(this,f);this.apply()},apply:function(){var f=this.marks||[];if(0<this.count){var g=this;f.push.apply(f,Array.create(this.count,function(e){var f=this.closest((e+1)/g.count);return{pos:(f-this.min)/this.range_,caption:g.captionFormat(f),isLast:g.count==
e+1}},this.owner_))}var k=0,f=f.filter(Function.$isNotNull).sortAsObject("pos").map(function(e){var f=e.pos;e.width=e.pos-k;e.pos=k;k=f;return e},this);1!=k&&f.push({pos:k,width:1-k,isLast:!0});this.setChildNodes(f)}}),p={move:function(){var f=this.tmpl.scrollbar;this.setValue_((k.mouseX(event)-(new w(f)).left)/f.offsetWidth*this.count_)}},o=t.subclass({event_change:o("change"),captionFormat:function(f){return Math.round(Number(f))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(f){var g=this.tmpl.scrollbar;this.setValue_((k.mouseX(f)-(new w(g)).left)/g.offsetWidth*this.count_)},focus:function(){n.focus(this.element)},step:function(f){var g=k.wheelDelta(f);if(g)n.focus(this.element),0>g?this.stepDown():this.stepUp();else switch(k.key(f)){case k.KEY.DOWN:case k.KEY.LEFT:case 189:case 109:this.stepDown();break;case k.KEY.UP:case k.KEY.RIGHT:case 187:case 107:this.stepUp();break;case k.KEY.PAGEDOWN:this.stepDown(10);break;case k.KEY.PAGEUP:this.stepUp(10);
break;case k.KEY.HOME:this.setValue(this.min);break;case k.KEY.END:this.setValue(this.max)}}},satelliteConfig:{marks:{instanceOf:u.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:s})}},marks:"auto",init:function(f){var g=this.step,k=this.value;this.step=0;this.value=this.min;this.value_=0;t.prototype.init.call(this,f);this.setProperties(this.min,this.max,g);this.setValue(isNaN(k)?this.min:k);this.scrollbarDD=new q({element:this.tmpl.scrollTrumb,handler:p,handlerContext:this})},
setProperties:function(f,g,k){if(f>g)var e=f,f=g,g=e;k=k||1;f=f||0;if(this.min!=f||this.max!=g||this.step!=k)this.count_=Math.ceil((g-f)/k),this.step=k,this.min=f,this.max=this.min+this.count_*this.step,this.range_=this.max-this.min,this.tmpl.minValue.nodeValue=this.captionFormat(this.min),this.tmpl.maxValue.nodeValue=this.captionFormat(this.max),l(this.element).bool("NoMax",this.max==this.min),this.marks&&this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(e){"object"!=
typeof e&&(e={count:e});e=Object.extend({captionFormat:this.captionFormat,owner_:this},e);if("auto"==e.count)e.count=Math.min(this.count_,20);return e},this)),this.setValue(this.value||this.min)},closest:function(f){return this.normalize(this.min+this.range_*f.fit(0,1)+this.step/2)},normalize:function(f){if(f<this.min)f=this.min;else if(f>this.max)f=this.max;return this.min+Math.floor(1.0E-5+(f-this.min)/this.step)*this.step},stepUp:function(f){this.setValue_(this.value_+parseInt(f||1))},stepDown:function(f){this.setValue_(this.value_-
parseInt(f||1))},setValue_:function(f){f=Math.round(f).fit(0,this.count_);if(this.value_!=f){this.value_=f;var g=this.value;this.value=this.normalize(this.min+f*this.step);this.tmpl.scrollTrumb.style.left=(100*(f/this.count_)).toFixed(4)+"%";this.event_change(this,g)}},setValue:function(f){this.setValue_((f-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;t.prototype.destroy.call(this)}});Object.extend(o,{MarkLayer:s,Mark:v});g.namespace("basis.ui.slider").extend({Slider:o})})(basis);
(function(g){function n(g,k){if(window.getComputedStyle){var l=document.defaultView.getComputedStyle(g,null);if(l)return l.getPropertyValue(k)}else if(g.currentStyle)return g.currentStyle[k]}var k=g.dom,o=g.cssom.classList,l=g.dragdrop.DragDropElement,q=g.cssom.cssRule("IFRAME"),w={width:"deltaX",height:"deltaY"},t={width:{"-1":"w-resize",1:"e-resize"},height:{"-1":"n-resize",1:"s-resize"}},l=l.subclass(function(g){return{factor:NaN,property:"width",event_prepare:function(){w[this.property]?q.setProperty("pointerEvents",
"none"):("undefined"!=typeof console&&console.warn("Property to change `"+this.property+"` is unsupported"),this.stop())},event_start:function(k){g.event_start.call(this,k);k.delta=w[this.property];k.factor=this.factor;var l=this.element.parentNode,p=n(this.element,"float"),f=n(this.element,"position");if("deltaY"==k.delta){if(l=l.clientHeight-parseFloat(n(l,"padding-top"))-parseFloat(n(l,"padding-bottom")),k.offsetStart=this.element.offsetHeight,isNaN(k.factor))k.factor="static"!=f&&"auto"!=n(this.element,
"bottom")?-1:1}else if(l=l.clientWidth-parseFloat(n(l,"padding-left"))-parseFloat(n(l,"padding-right")),k.offsetStart=this.element.offsetWidth,isNaN(k.factor))k.factor="right"==p||"static"!=f&&"auto"!=n(this.element,"right")?-1:1;k.offsetStartInPercent=100/l;o(this.resizer).add("selected")},event_move:function(k){g.event_move.call(this,k);this.element.style[this.property]=k.offsetStartInPercent*(k.offsetStart+k.factor*k[k.delta])+"%"},event_over:function(k){g.event_over.call(this,k);o(this.resizer).remove("selected");
q.setProperty("pointerEvents","auto")},init:function(l){this.resizer=k.createElement(".Basis-Resizer");this.resizer.style.cursor=t[this.property][1];g.init.call(this,l)},setElement:function(l){var n=this.element;g.setElement.call(this,l,this.resizer);n!==this.element&&(n&&k.remove(this.resizer),this.element&&k.insert(this.element,this.resizer))}}});g.namespace("basis.ui.resizer").extend({Resizer:l})})(basis);
(function(g){function n(g){return(100*g).toFixed(4)+"%"}function k(g){var f=g.childNodes.search(g.activePage_,"data.pageNumber");f?f.select():g.selection.clear()}var o=g.dom.event,l=g.EventObject.createEvent,q=g.cssom.classList,w=g.layout.Box,t=g.dragdrop.DragDropElement,u=g.ui.Control,v=g.ui.Node.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
templateUpdate:function(g){var f=this.pageGetter(this);g.pageNumber.nodeValue=f+1;g.link.href=this.urlGetter(f)},action:{click:function(g){o.kill(g);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))}}),s={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(g){g=((this.initOffset+g.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(g*(this.pageCount_-this.pageSpan_)));
this.tmpl.scrollTrumb.style.left=n(g)},over:function(){this.setSpanStartPage(this.spanStartPage_)}},l=u.subclass({childClass:v,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(g,f){var k=this.tmpl.scrollbar,k=(o.mouseX(f)-(new w(k)).left)/k.offsetWidth;this.setSpanStartPage(Math.floor(k*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(g){(g=o.wheelDelta(g))&&this.setSpanStartPage(this.spanStartPage_+g)}},event_activePageChanged:l("activePageChanged"),event_pageCountChanged:l("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(g){u.prototype.init.call(this,g);this.setProperties(g.pageCount||0,
g.pageSpan);this.setActivePage(Math.max(g.activePage-1,0),!0);this.scrollbarDD=new t({element:this.tmpl.scrollTrumb,handler:s,handlerContext:this})},setProperties:function(g,f,k){g=g||1;f=Math.min(f||10,g);if(f!=this.pageSpan_)this.pageSpan_=f,this.setChildNodes(Array.create(f,function(e){return{data:{pageNumber:e}}}));if(this.pageCount_!=g){this.pageCount_=g;var l=1/g;this.tmpl.activePageMark.style.width=n(l/(1-l));this.tmpl.activePageMarkWrapper.style.width=n(1-l);this.event_pageCountChanged(this.pageCount_)}var l=
f/g,e=l/(1-l);this.tmpl.scrollTrumbWrapper.style.width=n(1-l);this.tmpl.scrollTrumb.style.width=n(e);q(this.element).bool("Basis-Paginator-WithNoScroll",f>=g);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(3==arguments.length?k:this.activePage_)},setActivePage:function(g,f){g=g.fit(0,this.pageCount_-1);if(g!=this.activePage_)this.activePage_=Number(g),k(this),this.event_activePageChanged(g);this.tmpl.activePageMark.style.left=n(g/Math.max(this.pageCount_-1,1));f&&this.spotlightPage(this.activePage_)},
spotlightPage:function(g){this.setSpanStartPage(g-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(g){g=g.fit(0,this.pageCount_-this.pageSpan_);if(g!=this.spanStartPage_){this.spanStartPage_=g;for(var f=this.childNodes.length;0<f--;)this.childNodes[f].update({pageNumber:g+f});k(this)}this.tmpl.scrollTrumb.style.left=n((g/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;u.prototype.destroy.call(this)}});g.namespace("basis.ui.paginator").extend({Paginator:l})})(basis);
(function(g){var n="basis.ui.pageslider",k=g.dom,o=g.Class,l=g.cssom.classList,n="basis.ui",o=o(g.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(k,l){g.ui.tabs.PageControl.event_childNodesModified.call(this,k,l);for(var n=0,o;o=this.childNodes[n];n++)g.cssom.setStyle(o.element,{left:100*n+"%"})},init:function(k){var n="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=g.cssom.cssRule("."+n+" > .Basis-Page");this.constructor.superClass_.prototype.init.call(this,
k);l(this.element).add(n);this.scroller=new g.ui.Scroller({targetElement:this.element,preventScrollY:!0,minScrollDelta:10,handler:{startInertia:function(g){var k=this.selection.pick();if(k){var l=k;0==g.currentDirectionX||1==g.currentDirectionX&&g.viewportX<k.element.offsetLeft||-1==g.currentDirectionX&&g.viewportX>k.element.offsetLeft?(g.minScrollDeltaXReached=!0,l=this.childNodes[Math.round(g.viewportX/k.element.offsetWidth)]):l=1==g.currentDirectionX?k.nextSibling:k.previousSibling;l||(l=k);l==
k?this.slideToPage(k):l.select()}g.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var g=this.pick();g&&g.parentNode.slideToPage(g)}});if(this.selection.itemCount){var o=this;setTimeout(function(){o.slideToPage(o.selection.pick())},0)}},slideToPage:function(g){this.scroller.setTargetPosition(g.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);k.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});g.namespace(n).extend({PageSlider:o})})(basis);
(function(g){var n=g.dom.wrapper.Node,k=g.ui.Node,o=n.subclass({draw:function(g){g.save();g.fillStyle="red";g.fillRect(10*this.data.value,10,30,30);g.restore()},update:function(){var g=n.prototype.update.apply(this,arguments);if(g)for(var k=this.parentNode;k;){if(k instanceof l){k.updateCount++;break}k=k.parentNode}return g}}),l=k.subclass({template:"<canvas{canvas}><div>Canvas doesn't support.</div></canvas>",childFactory:function(g){return new this.childClass(g)},childClass:o,drawCount:0,lastDrawUpdateCount:-1,
init:function(g){k.prototype.init.call(this,g);this.element.width=this.width;this.element.height=this.height;this.updateCount=0;if((g=this.tmpl.canvas)&&g.getContext)this.context=g.getContext("2d");this.updateTimer_=setInterval(this.draw.bind(this),1E3/60)},reset:function(){this.element.width=this.element.clientWidth;this.element.height=this.element.clientHeight},isNeedToDraw:function(){return this.context&&(this.updateCount!=this.lastDrawUpdateCount||this.element.width!=this.lastDrawWidth||this.element.height!=
this.lastDrawHeight)},draw:function(){if(!this.isNeedToDraw())return!1;this.lastDrawWidth=this.element.width;this.lastDrawHeight=this.element.height;this.lastDrawUpdateCount=this.updateCount;this.drawCount+=1;this.reset();this.drawFrame();return!0},drawFrame:function(){for(var g=this.firstChild;g;g=g.nextSibling)g.draw(this.context)},destroy:function(){clearInterval(this.updateTimer_);k.prototype.destroy.call(this)}});g.namespace("basis.ui.canvas").extend({Canvas:l,Shape:o})})(basis);
(function(g){function n(g,k){for(var n=function(g){function f(a,b,c,d){m!=b&&k.push(g.substring(m,b).replace(l,'<span class="token-keyword">$1</span>'));m=c+1;k.push('<span class="token-'+a+'">'+g.substring(b,c+1)+"</span>"+(d||""))}for(var k=[],n=g.toArray(),e,m=0,d=0;d<n.length;d++)if("'"==n[d])for(e=d;++d<n.length;){if("'"==n[d]){f("string",e,d);break}if("\n"==n[d])break;"\\"==n[d]&&(d++,"\n"==n[d]&&(f("string",e,d-1),e=d+1))}else if('"'==n[d])for(e=d;++d<n.length;){if('"'==n[d]){f("string",e,
d);break}if("\n"==n[d])break;"\\"==n[d]&&(d++,"\n"==n[d]&&(f("string",e,d-1),e=d))}else if("/"==n[d]){e=d;d++;if("/"==n[d]){for(;++d<n.length&&!("\n"==n[d]););f("comment",e,d-1)}if("*"==n[d])for(;++d<n.length;)if("*"==n[d]&&"/"==n[d+1]){f("comment",e,++d);break}else"\n"==n[d]&&(f("comment",e,d-1,"\n"),m=e=d+1)}k.push(g.substr(m).replace(l,'<span class="token-keyword">$1</span>'));return k}(function(g){g=g.trimRight().replace(/\r\n|\n\r|\r/g,"\n");k||(g=g.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));g=
g.replace(/\n[ \t]+/g,function(e){return e.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!k){for(var f=1E3,l=g.split(/\n+/),n=Number(null!=g.match(/^function/));n<l.length;n++){var e=l[n].match(/^\s*/);if(e[0].length<f)f=e[0].length;if(0==f)break}0<f&&(g=g.replace(RegExp("(^|\\n) {"+f+"}","g"),"$1"))}return g=g.replace(RegExp("(^|\\n)( +)","g"),function(e,d,a){return d+"\u00a0".repeat(a.length)})}(g).replace(/</g,"&lt;")).join("").split("\n"),o=(""+(n.length>>1)).length,v=[],s=0;s<n.length;s++)v.push('<div class="line '+
(s%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(s+1).lead(o)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(n[s]+"\r\n")+"</span></div>");return v.join("")}var k=g.Class,o=g.ui.Node,l=RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+")\\b","g"),k=k(o,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',
codeGetter:Function.getter("data.code"),normalize:!0,templateUpdate:function(){var g=this.codeGetter(this);if(g!=this.code_)this.code_=g,this.tmpl.codeElement.innerHTML=n(g,!this.normalize)}});g.namespace("basis.format.highlight").extend({highlight:n,SourceCodeNode:k})})(basis);
