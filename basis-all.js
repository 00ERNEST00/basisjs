/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(e){function j(a,f){for(var h in f)a[h]=f[h];return a}function g(a,f){for(var h in f)!1==h in a&&(a[h]=f[h]);return a}function n(a){return null==a||void 0==a}function m(a){return a}function o(a){var f={};a.names=function(a){return Object.slice(f,"string"==typeof a?a.qw():a)};a.extend=function(a){g(f,a);j(this,a);return this};return a}function w(a,f){for(var h=a.split("."),b=e,c,i,d;h.length;)if(c=h.shift(),i=(i?i+".":"")+c,b[c]||(b[c]=o((!h.length?f:null)||function(){},i),d&&(d.namespaces_[i]=
b[c])),b=b[c],!d&&(d=b,!d.namespaces_))d.namespaces_={};return k[a]=b}j(Object,{extend:j,complete:g,keys:function(a){var f=[],h;for(h in a)f.push(h);return f},values:function(a){var f=[],h;for(h in a)f.push(a[h]);return f},slice:function(a,f){var h={};if(!f)return j(h,a);for(var b=0,c;c=f[b++];)c in a&&(h[c]=a[c]);return h},splice:function(a,f){var h={};if(!f)return j(h,a);for(var b=0,c;c=f[b++];)c in a&&(h[c]=a[c],delete a[c]);return h},iterate:function(a,f,h){var b=[],c;for(c in a)b.push(f.call(h,
c,a[c]));return b},coalesce:function(){for(var a=arguments,f=0;f<a.length;f++)if(null!=a[f])return a[f]}});var t=function(){},u=function(){var a=1,f={},h={};a++;return function(b,c){var i,d;if(!c){if(b.getter)return b.getter;if("function"==typeof b)return b}if("function"!=typeof b)h[b]?i=h[b]:(i=new Function("object","return object != null ? object."+b+" : object"),i.path=b,i.getterIdx_=a++,h[b]=i);else if(i=b,!i.getterIdx_)i.getterIdx_=a++;d=i.getterIdx_;var z=f[d];if(z)if("undefined"==typeof c){if(z.nmg)return z.nmg}else for(d=
0;d<z.length;d++){if(z[d].modificator===c)return z[d].getter}else z=f[d]=[];var A=!0;switch(c&&typeof c){case "string":d=function(a){return c.format(i(a))};break;case "function":d=function(a){return c(i(a))};break;case "object":A=!1;d=function(a){return c[i(a)]};break;default:d=i.path?i:function(a){return i(a)}}if(A&&(z.push({getter:d,modificator:c}),"undefined"==typeof c))z.nmg=d;return d.getter=d}}();j(Function,{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:n,
$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:m,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},$null:function(){return null},$undef:t,getter:u,def:function(a,f,h){h=h||n;return function(b){b=a(b);return h(b)?f:b}},wrapper:function(a){return function(f){var h={};h[a]=f;return h}},lazyInit:function(a,f){var h=0,b;return function(){h++||(b=a.apply(f||this,arguments));
return b}},lazyInitAndRun:function(a,f,h){var b=0,c;return function(){b++||(c=a.call(h||this));f.apply(c,arguments);return c}},runOnce:function(a,f){var h=0;return function(){if(!h++)return a.apply(f||this,arguments)}}});g(Function.prototype,{bind:function(a){var f=this,h=Array.from(arguments,1);return h.length?function(){return f.apply(a,h.concat.apply(h,arguments))}:function(){return f.apply(a,arguments)}}});g(Array,{isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)}});
j(Array,{from:function(a,f){if(null!=a){var h=a.length;if("undefined"==typeof h)return[a];f||(f=0);if(0<h-f){for(var b=[],c=0,i=f;i<h;)b[c++]=a[i++];return b}}return[]},create:function(a,f,h){for(var b=[],c="function"==typeof f,i=0;i<a;i++)b[i]=c?f.call(h,i,b):f;return b}});g(Array.prototype,{indexOf:function(a,f){f=parseInt(f)||0;if(0>f)return-1;for(;f<this.length;f++)if(this[f]===a)return f;return-1},lastIndexOf:function(a,f){for(var h=this.length,f=parseInt(f),f=isNaN(f)||f>=h?h-1:(f+h)%h;0<=f;f--)if(this[f]===
a)return f;return-1},forEach:function(a,f){for(var h=0,b=this.length;h<b;h++)h in this&&a.call(f,this[h],h,this)},every:function(a,f){for(var b=0,c=this.length;b<c;b++)if(b in this&&!a.call(f,this[b],b,this))return!1;return!0},some:function(a,f){for(var b=0,c=this.length;b<c;b++)if(b in this&&a.call(f,this[b],b,this))return!0;return!1},filter:function(a,f){for(var b=[],c=0,d=this.length;c<d;c++)c in this&&a.call(f,this[c],c,this)&&b.push(this[c]);return b},map:function(a,f){for(var b=[],c=0,d=this.length;c<
d;c++)c in this&&(b[c]=a.call(f,this[c],c,this));return b},reduce:function(a,f){var b=this.length,c=arguments.length;if(0==b&&1==c)throw new TypeError;var d,i=0;1<c&&(d=f,i=1);for(c=0;c<b;c++)c in this&&(d=i++?a.call(null,d,this[c],c,this):this[c]);return d}});j(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[0<=a?a:this.length+a]},search:function(a,f,b){Array.lastSearchIndex=
-1;for(var f=Function.getter(f||m),b=parseInt(b)||0,c=this.length;b<c;b++)if(f(this[b])===a)return this[Array.lastSearchIndex=b]},lastSearch:function(a,f,b){Array.lastSearchIndex=-1;for(var f=Function.getter(f||m),c=this.length,b=isNaN(b)||null==b?c:parseInt(b),c=b>c?c:b;0<c--;)if(f(this[c])===a)return this[Array.lastSearchIndex=c]},binarySearchPos:function(a,f,b,c,d,i){if(!this.length)return c?-1:0;var f=Function.getter(f||m),b=!!b,p,d=isNaN(d)?0:d,z=isNaN(i)?this.length-1:i;do if(i=d+z>>1,p=f(this[i]),
b?a>p:a<p)z=i-1;else if(b?a<p:a>p)d=i+1;else return a==p?i:c?-1:0;while(d<=z);return c?-1:i+(p<a^b)},binarySearch:function(a,f){return this.binarySearchPos(a,f,!1,!0)},add:function(a){return-1==this.indexOf(a)&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return-1!=a&&!!this.splice(a,1)},has:function(a){return-1!=this.indexOf(a)},merge:function(a){return this.reduce(j,a||{})},sortAsObject:function(a,f,b){a=Function.getter(a);b=b?-1:1;return this.map(function(f,b){return{i:b,v:a(f)}}).sort(f||
function(a,f){return b*(a.v>f.v||-(a.v<f.v)||(a.i>f.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){if(this!==a)this.length=0,this.push.apply(this,a);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var y=Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);if(2>a.length)a[1]=this.length;return y.apply(this,a)}}var s={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",
nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};g(String,{toLowerCase:function(a){return(""+a).toLowerCase()},toUpperCase:function(a){return(""+a).toUpperCase()},trim:function(a){return(""+a).trim()},trimLeft:function(a){return(""+a).trimLeft()},trimRight:function(a){return(""+a).trimRight()},isEmpty:function(a){return null==a||""==""+a},isNotEmpty:function(a){return null!=a&&""!=""+a}});g(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,
"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});j(String.prototype,{toObject:function(a){try{return Function("return 0,"+this)()}catch(f){if(a)throw f;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],f=this.length,b=0;b<f;b++)a[b]=this.charAt(b);return a},repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,
"\\$&")},format:function(a){for(var f={},b=0;b<arguments.length;b++)f[b]=arguments[b];"object"==typeof a&&j(f,a);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(a,b,c,h,d){a=b in f?f[b]:d?"":a;return c&&!isNaN(a)?(a=Number(a),"."==c?a.toFixed(h):a.lead(h)):a})},quote:function(a,f){var a=a||'"',f=f||s[a]||a,b=(1==a.length?a:"")+(1==f.length?f:"");return a+(b?this.replace(RegExp("["+b.forRegExp()+"]","g"),"\\$&"):this)+f},capitalize:function(){return this.charAt(0).toUpperCase()+
this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,f){return f.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});String.format=String.prototype.format;if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length)String.prototype.split=function(a){if(""==a||a&&""==a.source)return this.toArray();var f=[],b=0,c;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));c=a.exec(this);)c[0]=
this.substring(b,c.index),f.push.apply(f,c),b=a.lastIndex;else for(;-1!=(c=this.indexOf(a,b));)f.push(this.substring(b,c)),b=c+a.length;f.push(this.substr(b));return f};if("2"!="12".substr(-1)){var q=String.prototype.substr;String.prototype.substr=function(a,f){return q.call(this,0>a?Math.max(0,this.length+a):a,f)}}j(Number.prototype,{fit:function(a,f){return!isNaN(a)&&this<a?Number(a):!isNaN(f)&&this>f?Number(f):this},between:function(a,f){return!isNaN(this)&&this>=a&&this<=f},quote:function(a,f){return(this+
"").quote(a,f)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return 0>this?-1:+(0<this)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,f){return(this+"").replace(/\d+/,function(b){return 1<(a-=b.length-1)?Array(a).join(f||0)+b:b})},group:function(a,b){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(d,l){return!l+(c.length-l)%(a||3)?d:(b||" ")+d})})},format:function(a,b,c,d,l){a=this.toFixed(a);if(b||l)a=
a.replace(/(\d+)(\.?)/,function(a,c,h){return(b?Number(c).group(3,b):c)+(h?l||h:"")});c&&(a=a.replace(/^-?/,"$&"+(c||"")));return a+(d||"")}});g(Date,{now:function(){return+new Date}});1900>(new Date).getYear()&&j(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&100>a?Number(a)+1900:a)}});var k={},r=function(){function a(a,b){for(var f=k[a],c=b?b.split(/\./):[];f&&c.length;)f=f[c.shift()];return f}var b=e.document?e.document.getElementsByTagName("SCRIPT"):
null,c=(b?b[b.length-1].src:module.filename).replace(/[^\/]+$/,""),d={},l;"function"==typeof require?l=function(a){return require(requirePath+a.replace(/\./g,"/"))}:(l=function(b,f){var z=b.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],A=b.substr(z.length?z.length+1:0),C=a(z,A),v=/^basis\./.test(z)?c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!k[z]||!C)if(/^https?:/.test(v)){if(d[b])throw"Attempt to load namespace, probably cycle require";d[b]=1;var v=v+
(f||"")+b.replace(/\./g,"/")+".js",g=new XMLHttpRequest;g.open("POST",v,!1);g.send(null);if(200==g.status){try{(new Function(g.responseText)).call(e)}catch(B){throw B;}l.sequence.push(b.replace(/\./g,"/")+".js")}else if(404==g.status&&A)r(z);else throw"!";}else throw"Path `"+b+"` can't be resolved";return C||a(z,A)},l.sequence=[]);return l}(),v=function(){function a(a){return"function"==typeof a&&a.basisClass_}var b=Function(),c=1,d={},l=function(){for(var a in{toString:1})return;return!0}();j(b,
{className:"basis.Class",extendConstructor_:!1,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=t}},create:function(i){"function"!=typeof i&&(i=b);var A=Function();A.prototype=i.prototype;for(var A=new A,l={className:i.className+"._SubClass_",basisClass_:!0,superClass_:i,extendConstructor_:!!i.extendConstructor_,__extend__:function(c){return c&&("object"==typeof c||
"function"==typeof c&&!a(c))&&c!==d?b.create.call(null,D,c):c},extend:b.extend,subclass:function(){return b.create.apply(null,[D].concat(Array.from(arguments)))},prototype:A},p=arguments,k=1;k<p.length;k++)l.extend("function"==typeof p[k]&&!a(p[k])?p[k](i.prototype):p[k]);var B={},D=l.extendConstructor_?function(a,b){this.eventObjectId=c++;var f,i;for(i in a)f=this[i],this[i]=f&&f.__extend__?f.__extend__(a[i]):a[i];this.init(b||B)}:function(){this.eventObjectId=c++;this.init.apply(this,arguments)};
A.constructor=D;for(var H in A)A[H]===d&&(A[H]=D);j(D,l);return D},extend:function(a){var b=this.prototype;if(a.prototype)a=a.prototype;for(var f in a){var c=a[f],h=b[f];"className"==f||"extendConstructor_"==f?this[f]=c:b[f]=h&&h.__extend__?h.__extend__(c):c}if(l&&a[f="toString"]!==Object.prototype[f])b[f]=a[f];return this}});var i=function(a,b){return{__extend__:function(a){var f=Function();f.prototype=this;f=new f;b(f,a);return f}}.__extend__(a)},p=function(a){return i(a,j)};return w("basis.Class",
b.create).extend({SELF:d,BaseClass:b,create:b.create,isClass:a,CustomExtendProperty:i,ExtensibleProperty:p,NestedExtProperty:function(a){return i(a,function(a,b){for(var f in b){var c=a[f];a[f]=c&&c.__extend__?c.__extend__(b[f]):p(b[f])}})}})}(),d=function(){function a(a){var d=c[a];d||(d=c[a]=function(){var c=this.handlers_,h,d;if(c&&c.length)for(var c=b.call(c),x=c.length;0<x--;)h=c[x],d=h.handler[a],"function"==typeof d&&d.apply(h.thisObject,arguments)});return d}var b=Array.prototype.slice,c=
{},d,l=v(null,{handlers_:null,event_destroy:d=a("destroy","object"),listen:v.NestedExtProperty(),extendConstructor_:!0,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,b){var f=this.handlers_;if(!f)f=this.handlers_=[];b||(b=this);for(var c=f.length,h;0<c--;)if(h=f[c],h.handler===a&&h.thisObject===b)return!1;return!!f.push({handler:a,thisObject:b||this})},removeHandler:function(a,b){var f=
this.handlers_;if(f){b||(b=this);for(var c=f.length,h;0<c--;)if(h=f[c],h.handler===a&&h.thisObject===b)return!!f.splice(c,1);return!1}},destroy:function(){if(this.handlers_)d.call(this,this),this.handlers_=null}});l.createEvent=a;l.event=c;return l}(),b=function(){var a=[];return{add:function(b){null!=b&&a.push(b)},remove:function(b){a.remove(b)}}}();(function(){function a(a){if(b){if(a.source!=e||a.data!=c)return;basis.dom.event.kill(a)}d.length&&(a=d.shift(),delete l[a.key],a.fn())}var b="function"==
typeof addEventListener&&"function"==typeof postMessage,c="zeroTimeoutMessage",d=[],l={},i=1;b&&e.addEventListener("message",a,!0);var p=setTimeout;e.setTimeout=function(A,k){var z;k?z=p.call(e,A,k):(z={key:"z"+i++,fn:"function"==typeof A?A:new Function(A)},l[z.key]=z,d.push(z),b?postMessage(c,"*"):z.timer=p.call(e,a,0),z=z.key);return z};var k=clearTimeout;e.clearTimeout=function(a){if(/z\d+/.test(a)){var b=l[a];b&&(clearTimeout(b.timer),d.remove(b),delete l[a])}else return k.call(e,a)}})();var c=
function(){function a(){if(!e)if(i.length){var a=Date.now(),b=Math.max(i[0].eventTime,a);b<k&&(clearTimeout(A),A=setTimeout(c,(k=b)-a))}else A=clearTimeout(A),k=d}function f(b,f){var c=b.eventObjectId,h=p[f]&&p[f][c];h&&(i.remove(h),delete p[f][c],a())}function c(){var b=Date.now(),b=i.binarySearchPos(b+15,l);e=!0;i.splice(0,b).forEach(function(a){delete p[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});e=!1;k=d;a()}var d=2E12,l=u("eventTime"),i=[],p={},k=d,A=null,e=!1;b.add({destroy:function(){e=
!0;clearTimeout(A);i.length=0;p=null}});return{add:function(b,c,h){var d=b.eventObjectId,A=p[c];A||(A=p[c]={});var x=A[d];if(x){if(isNaN(h))return f(b,c);if(x.eventTime==h)return;i.remove(x);x.eventTime=h}else{if(isNaN(h))return;x=A[d]={eventName:c,object:b,eventTime:h,callback:b[c]}}i.splice(i.binarySearchPos(h,l),0,x);a()},remove:f}}();w("basis").extend({namespace:w,platformFeature:{},EventObject:d,TimeEventManager:c,Cleaner:b,require:r});e.basis.locale={}})(this);
(function(e,j){function g(d){for(var b=1E6,d=(""+d).split("."),c=0,a=0;4>c&&c<d.length;c++,b/=100)a+=d[c]*b;return a}function n(){for(var d=0;d<arguments.length;d++){var b=arguments[d].toLowerCase();if(b in o){if(o[b])return!0}else{var c=b.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(c){o[b]=!1;var a=c[1].toLowerCase(),f=g(c[3]),c=c[4]||"=";if(a=w[a])return o[b]=!f||"="==c&&a==f||"+"==c&&a>=f||"-"==c&&a<f}}}return!1}var m="basis.ua",o={},w={},t=j.navigator&&j.navigator.userAgent,u="unknown",y={MSIE:["Internet Explorer",
"msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},s;for(s in y)if(!("MSIE"==s&&j.opera)&&!("Safari"==s&&t.match(/chrome/i))&&!("AppleWebKit"==s&&t.match(/iphone/i))&&t.match(RegExp(s+".(\\d+(\\.\\d+)*)","i")))for(var q=y[s],k=j.opera&&"function"==
typeof j.opera.version?j.opera.version():RegExp.$1,r=g(k),u=q[0]+" "+k,k=0;k<q.length;k++)w[q[k].toLowerCase()]=r;e.platformFeature.datauri=!1;t="undefined"!=typeof Image?new Image:{};t.onload=function(){e.platformFeature.datauri=!0};t.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(n("IE7-"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(v){}m=e.namespace(m);m.toString=function(){return u};return m.extend({testImage:t,prettyName:u,test:n,
is:function(d){return n(d)},Cookies:{set:function(d,b,c,a){document.cookie=d+"="+(null==b?"":escape(b))+";path="+(a||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)+(c?";expires="+(new Date(Date.now()+1E3*c)).toGMTString():"")},get:function(d){return(d=document.cookie.match(RegExp("(^|;)\\s*"+d+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(d[2])},remove:function(d,b){document.cookie=d+"=;expires="+(new Date(0)).toGMTString()+";path="+(b||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)}}})})(basis,
this);
(function(e,j){function g(a,b,f){if(null!=b)return a.insertBefore(h(b)?b:w(b),f||null)}function n(a){return u("",a.cloneNode(!0)).innerHTML}function m(a){return h(a)||a&&a.nodeType?a:"string"==typeof a?k.getElementById(a):null}function o(f,h,i){var l,p=[],i="string"==typeof i?getter(i):i||Function.$true;h&26&&i(f)&&p.push(f);switch(h){case 1:case 2:for(l=f;(l=l[d])&&l!==f.document;)i(l)&&p.push(l);break;case 64:for(l=f[b];l;)i(l)&&p.push(l),l=l[c];break;case 4:case 8:f[b]&&(h=new x(f),h.nodes(i,p));
break;case 128:h=new x(f,i);for(h.cursor_=f[c]||f[d];l=h.next();)p.push(l);break;case 256:for(l=f;l=l[c];)i(l)&&p.push(l);break;case 32:i(f[d])&&p.push(f[d]);break;case 512:h=new x(f,i,x.BACKWARD);for(h.cursor_=f[a]||f[d];l=h.next();)p.push(l);break;case 1024:for(l=f;l=l[a];)i(l)&&p.push(l)}return p}function w(a){return k.createTextNode(null!=a?a:"")}function t(){for(var a=k.createDocumentFragment(),b=arguments.length,f=t.array=[],c=0;c<b;c++)f.push(g(a,arguments[c]));return a}function u(a,b){var f=
void 0!=a&&"string"!=typeof a,c=(f?a.description:a)||"",h="div",d=c.match(/^([a-z0-9\_\-]+)(.*)$/i);d&&(h=d[1],c=d[2]);if(""!=c){for(var l=[],x={},v;d=z.exec(c);){if(d[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+c+"\n\nProblem place:\n> "+c.substr(0,d.index)+"--\>"+c.substr(d.index)+"<--");v=d[1]||d[2]||d[3];d[1]?x.id=v:d[2]?l.push(v):"class"!=v&&(x[v]=d[4]?q(d[5],d[6],d[7]):v)}i&&x.name&&/^(input|textarea|select)$/i.test(h)&&(h="<"+h+" name="+x.name+">")}c=
k.createElement(h);if(x){if(x.style&&p)c.style.cssText=x.style;for(var r in x)c.setAttribute(r,x[r],0)}if(l&&l.length)c.className=l.join(" ");1<arguments.length&&g(c,t.apply(0,Array.from(arguments,1).flatten()));if(f&&(a.css&&e.cssom&&e.cssom.setStyle(c,a.css),e.dom.event))for(var j in a)"function"==typeof a[j]?e.dom.event.addHandler(c,j,a[j],c):a[j]instanceof e.dom.event.Handler&&e.dom.event.addHandler(c,j,a[j].handler,a[j].thisObject);return c}function y(a,b){return a[d]?a[d].replaceChild(b,a):
a}function s(a){if(k.selection){var b=k.selection.createRange();0!=b.compareEndPoints("StartToEnd",b)&&b.collapse(a);return b.getBookmark().charCodeAt(2)-2}}var q=Object.coalesce,k=j.document,r=e.Class,v=k.createElement("div"),d="parentNode",b="firstChild",c="nextSibling",a="previousSibling",f;f="function"==typeof v.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)}:function(a,b){return a==b?0:a.document!=b.document?33:a.sourceIndex>b.sourceIndex?2|8*b.contains(childA):4|16*
a.contains(childB)};var h;if("undefined"!=typeof Node){if(h=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else h=function(a){return a&&a.ownerDocument===k};var x=r(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,b,f){this.setRoot(a);this.setDirection(f);if("function"==typeof b)this.filter=b},setDirection:function(f){Object.extend(this,f?{a:"lastChild",b:a,c:c,d:b}:{a:b,b:c,c:a,d:"lastChild"})},
setRoot:function(a){this.root_=a||k;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,b){var f;b||(b=[]);for(this.reset();f=this.next(a);)b.push(f);return b},next:function(a){var a=a||this.filter,b=this.cursor_||this.root_;do for(var f=b[this.a];!f;){if(b===this.root_)return this.cursor_=null;(f=b[this.b])||(b=b[d])}while(!a(b=f));return this.cursor_=b},prev:function(a){var a=a||
this.filter,b=this.cursor_,f=this.c,c=this.d;do{var h=b?b[f]:this.root_[c];if(h){for(;h[c];)h=h[c];b=h}else b&&(b=b[d]);if(!b||b===this.root_){b=null;break}}while(!a(b));return this.cursor_=b},destroy:function(){this.cursor_=this.root_=null}});x.BACKWARD=!0;var l="textContent innerText nodeValue".qw(),i=function(){var a=k.createElement("input");a.name="a";return!/name/.test(n(a))}(),p;v.setAttribute("style","color: red");p="red"!==v.style.color;var z=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return e.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:x,outerHTML:n,textContent:function(a){for(var b=0,f;f=l[b++];)if(null!=a[f])return a[f];return o(a,4,function(a){return 3==a.nodeType}).map(getter("nodeValue")).join("")},get:m,tag:function(a,b){a=m(a)||k;return"*"==b&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(b||"*"))},axis:o,findAncestor:function(a,b,f){for(;a&&a!==f;){if(b(a))return a;a=a.parentNode}},createElement:u,createText:w,createFragment:t,insert:function(a,
f,i,d){a=m(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(i){case void 0:case "end":d=null;break;case "begin":d=a[b];break;case "before":break;case "after":d=d[c];break;default:d=Number(i).between(0,a.childNodes.length)?a.childNodes[i]:null}i=!h(a);if(!f||!Array.isArray(f))i=i?f&&a.insertBefore(f,d):g(a,f,d);else if(i)for(var i=[],l=0,D=f.length;l<D;l++)i[l]=a.insertBefore(f[l],d);else a.insertBefore(t.apply(0,f),d),i=t.array;return i},remove:function(a){return a[d]?
a[d].removeChild(a):a},replace:y,swap:function(a,b){if(a===b||f(a,b)&25)return!1;y(a,v);y(b,a);y(v,b);return!0},clone:function(a,b){var f=a.cloneNode(!b);f.attachEvent&&o(f,8).forEach(Event.clearHandlers);return f},clear:function(a){for(a=m(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,b,f){var c=[],f=Function.getter(f||Function.$self),h;for(h in b)for(var i=0;i<a.length;i++){var d=f(a[i]);c[i]=b[h](a[i],i,d)?u(h,d):a[i]}return c},setAttribute:function(a,b,f){null==f?a.removeAttribute(b):
a.setAttribute(b,f)},parentOf:function(a,b){return a.contains(b)},isInside:function(a,b){return a==b||b.contains(a)},focus:function(a,b){try{a=m(a),a.focus(),b&&a.select&&a.select()}catch(f){}},setSelectionRange:function(a,b,f){3>arguments.length&&(f=b);if(a.setSelectionRange)a.setSelectionRange(b,f);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0);c.moveStart("character",b);c.moveEnd("character",f-b);c.select()}},getSelectionStart:function(a){return"undefined"!=typeof a.selectionStart?
a.selectionStart:s(!0)},getSelectionEnd:function(a){return"undefined"!=typeof a.selectionEnd?a.selectionEnd:s(!1)}})})(basis,this);
(function(e,j){function g(a){return a||j.event}function n(a){return"string"==typeof a?q.get(a):a}function m(a){a=g(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function o(a){a=g(a);a.preventDefault?a.preventDefault():a.returnValue=!1}function w(a){var b=Array.from(d[a.type]);if(b)for(var c=b.length;0<c--;){var x=b[c];x.handler.call(x.thisObject,a)}}function t(a,f,c,d){a=n(a);if(!a)throw Error("Event.addHandler: can't attach event listener to undefined");if("function"!=typeof c)throw Error("Event.addHandler: handler must be a function");
a[r]||(a[r]={});var l={handler:c,thisObject:d},i=a[r],p=i[f];if(p){for(a=0;f=p[a];a++)if(f.handler===c&&f.thisObject===d)return;p.push(l)}else p=i[f]=[l],p.fireEvent=function(a){a=g(a);if(b&&a&&"undefined"==typeof a.returnValue){w(a);if(!0===a.cancelBubble)return;if("undefined"==typeof a.returnValue)a.returnValue=!0}for(var f=0,c;c=p[f++];)c.handler.call(c.thisObject,a)},a.addEventListener?a.addEventListener(f,p.fireEvent,!1):a.attachEvent("on"+f,p.fireEvent)}function u(a,b,c,d){var a=n(a),l=a[r];
if(l&&(l=l[b]))for(var i=0,p;p=l[i];i++)if(p.handler===c&&p.thisObject===d){l.splice(i,1);l.length||y(a,b);break}}function y(a,b){var a=n(a),c=a[r];if(c)if("string"!=typeof b)for(b in c)y(a,b);else{var d=c[b];d&&(a.removeEventListener?a.removeEventListener(b,d.fireEvent,!1):a.detachEvent("on"+b,d.fireEvent),delete c[b])}}var s=j.document,q=e.dom,k=Function.$null,r="__basisEvents",v={mousewheel:["mousewheel","DOMMouseScroll"]},d={},b=!s.addEventListener,c=function(){function a(){b++||setTimeout(function(){for(var a=
0;a<c.length;a++)c[a].callback.call(c[a].thisObject)},10)}var b=!1,c=[];if(e.ua.is("ie7-"))(function(){var b="_"+Date.now();s.write('<script id="'+b+'" defer src="//:"><\/script>');n(b).onreadystatechange=function(){"complete"==this.readyState&&(q.remove(this),a())}})();else if(e.ua.is("safari525-"))var d=setInterval(function(){/loaded|complete/.test(s.readyState)&&(clearInterval(d),a())},15);else t(s,"DOMContentLoaded",a,!1);t(s,"load",a,!1);t(j,"load",a,!1);return function(a,i){b||c.push({callback:a,
thisObject:i})}}();return e.namespace("basis.dom.event",g).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return v[a]||[a]},Handler:function(a,b){this.handler=a;this.thisObject=b},sender:function(a){a=g(a);return a.target||a.srcElement},cancelBubble:m,
cancelDefault:o,kill:function(a,b){(b=n(b))?t(b,a,Event.kill):(o(a),m(a))},key:function(a){a=g(a);return a.keyCode||a.which||0},charCode:function(a){a=g(a);return a.charCode||a.keyCode||0},mouseButton:function(a,b){a=g(a);return"number"==typeof a.which?a.which==b.VALUE:a.button&b.BIT},mouseX:function(a){a=g(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(s.documentElement.scrollLeft||s.body.scrollLeft)},mouseY:function(a){a=g(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(s.documentElement.scrollTop||s.body.scrollTop)},wheelDelta:function(a){a=g(a);return"wheelDelta"in a?a.wheelDelta/120:"DOMMouseScroll"==a.type?-a.detail/3:0},addGlobalHandler:function(a,b,c){var x=d[a];if(x)for(a=x.length;0<a--;){var l=x[a];if(l.handler===b&&l.thisObject===c)return}else s.addEventListener?s.addEventListener(a,w,!0):t(s,a,k),x=d[a]=[];x.push({handler:b,thisObject:c})},removeGlobalHandler:function(a,b,c){var x=d[a];if(x)for(var l=0,i;i=x[l];l++)if(i.handler===
b&&i.thisObject===c){x.splice(l,1);x.length||(delete d[a],s.removeEventListener?s.removeEventListener(a,w,!0):u(s,a,k));break}},addHandler:t,addHandlers:function(a,b,c){var a=n(a),d;for(d in b)t(a,d,b[d],c)},removeHandler:u,clearHandlers:y,fireEvent:function(a,b){var a=n(a),c=a[r];c&&c[b]&&c[b].fireEvent()},onLoad:c,onUnload:function(a,b){t(j,"unload",a,b)}})})(basis,this);
(function(){function e(b,c,a){for(var f=1,h;c;)c&1&&(h=s[f],a&f?(b.addHandler(h.handler,h.context),h.action(h.context.add,b)):(b.removeHandler(h.handler,h.context),h.action(h.context.remove,b))),c>>=1,f<<=1}function j(b){return Array.isArray(b)?b.map(j):{data:b}}var g=basis.Class,n=basis.EventObject,m=Object.values,o=Function.$self,w=n.createEvent,t=n.event,u={},y=[],s={},q=1,k={NONE:0,MASK:0,regType:function(b,c,a){s[q]={handler:c,action:a,context:{add:function(a,c){if(c){var d=k[b]+"_"+a.eventObjectId;
if(!c.subscribers_)c.subscribers_={};if(!c.subscribers_[d]){var l=c.subscriberCount;c.subscribers_[d]=a;c.subscriberCount+=1;c.event_subscribersChanged(c,l)}}},remove:function(a,c){if(c){var d=k[b]+"_"+a.eventObjectId;if(c.subscribers_[d]){var l=c.subscriberCount;delete c.subscribers_[d];c.subscriberCount-=1;c.event_subscribersChanged(c,l)}}}}};k[b]=q;k.MASK|=q;q<<=1}};k.regType("DELEGATE",{delegateChanged:function(b,c){this.remove(b,c);this.add(b,b.delegate)}},function(b,c){b(c,c.delegate)});k.regType("TARGET",
{targetChanged:function(b,c){this.remove(b,c);this.add(b,b.target)}},function(b,c){b(c,c.target)});var r=g(n,{state:"ready",data:null,canHaveDelegate:!0,delegate:null,root:null,cascadeDestroy:!1,isTarget:!1,target:null,active:!1,subscribeTo:k.DELEGATE+k.TARGET,subscriberCount:0,subscribers_:null,event_update:w("update","object","delta"),event_stateChanged:w("stateChanged","object","oldState"),event_delegateChanged:w("delegateChanged","object","oldDelegate"),event_rootChanged:w("rootChanged","object",
"oldRoot"),event_targetChanged:w("targetChanged","object","oldTarget")&&function(b,c){var a=this.listen.target;a&&(c&&c.removeHandler(a,this),this.target&&this.target.addHandler(a,this));t.targetChanged.call(this,b,c)},event_subscribersChanged:w("subscribersChanged","object"),event_activeChanged:w("activeChanged","object"),listen:{delegate:{update:function(b,c){this.data=b.data;this.event_update(this,c)},stateChanged:function(b,c){this.state=b.state;this.event_stateChanged(this,c)},targetChanged:function(b,
c){this.target=b.target;this.event_targetChanged(this,c)},rootChanged:function(b,c){this.data=b.data;this.event_rootChanged(this,c)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(b){n.prototype.init.call(this,b);if(b=this.delegate)this.delegate=null,this.data=b.data,this.state=b.state,this.setDelegate(b);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&e(this,this.subscribeTo,k.MASK)},isConnected:function(b){if(b instanceof
r){for(;b&&b!==this&&b!==b.delegate;)b=b.delegate;return b===this}return!1},getRootDelegate:function(){for(var b=this;b.delegate&&b.delegate!==b;)b=b.delegate;return b},setDelegate:function(b){if(this.canHaveDelegate&&b&&b instanceof r){if(b.delegate&&this.isConnected(b))return!1}else b=null;if(this.delegate!==b){var c=this.state,a=this.data,f=this.delegate,h=this.target,d=this.root,l={};f&&f.removeHandler(this.listen.delegate,this);if(b){this.delegate=b;this.root=b.root;this.data=b.data;this.state=
b.state;this.target=b.target;b.addHandler(this.listen.delegate,this);for(var i in b.data)!1===i in a&&(l[i]=void 0);for(i in a)a[i]!==b.data[i]&&(l[i]=a[i])}else for(i in this.target=this.delegate=null,this.root=this,this.data={},a)this.data[i]=a[i];this.event_delegateChanged(this,f);this.root!==d&&this.event_rootChanged(this,d);this.target!==h&&this.event_targetChanged(this,h);if(b){for(i in l){this.event_update(this,l);break}c!==this.state&&(""+c!=this.state||c.data!==this.state.data)&&this.event_stateChanged(this,
c)}return!0}return!1},setState:function(b,c){var a=this.target||this.getRootDelegate();if(a!==this)return a.setState(b,c);return this.state!=""+b||this.state.data!=c?(a=this.state,this.state=Object(""+b),this.state.data=c,this.event_stateChanged(this,a),!0):!1},deprecate:function(){"processing"!=this.state&&this.setState("deprecated")},update:function(b){var c=this.target||this.getRootDelegate();if(c!==this)return c.update(b);if(b){var c={},a=0,f;for(f in b)this.data[f]!==b[f]&&(a++,c[f]=this.data[f],
this.data[f]=b[f]);if(a)return this.event_update(this,c),c}return!1},setActive:function(b){b=!!b;return this.active!=b?(this.active=b,this.event_activeChanged(this),e(this,this.subscribeTo,k.MASK*b),!0):!1},setSubscription:function(b){var b=b&k.MASK,c=this.subscribeTo^b;return c?(this.subscribeTo=b,this.active&&e(this,c,b),!0):!1},destroy:function(){this.active&&e(this,this.subscribeTo,0);this.delegate&&this.setDelegate();n.prototype.destroy.call(this);this.data=u;this.state="undefined";this.target=
this.root=null}}),o=g(null,{itemClass:r,keyGetter:o,map_:null,extendConstructor_:!0,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(b){return this.get(this.keyGetter(b),b)},create:function(b){var c={};b instanceof r?c.delegate=b:c.data={id:b,title:b};return new this.itemClass(c)},get:function(b,c){var a=b instanceof r?b.eventObjectId:b,f=this.map_[a];!f&&c&&(f=this.map_[a]=this.create(b,c),f.addHandler({destroy:function(){delete this.map_[a]}},this));return f},destroy:function(){basis.Cleaner.remove(this);
for(var b=m(this.map_),c=0,a;a=b[c++];)a.destroy()}}),v=g(r,{state:"undefined",itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:w("datasetChanged","dataset","delta")&&function(b,c){var a,f=0,h=0,d;if(a=c.inserted)for(;d=a[f];)this.item_[d.eventObjectId]=d,f++;if(a=c.deleted)for(;d=a[h];)delete this.item_[d.eventObjectId],h++;this.itemCount+=f-h;this.cache_=null;t.datasetChanged.call(this,b,c)},init:function(b){r.prototype.init.call(this,b);this.memberMap_={};this.item_={}},
has:function(b){return!(!b||!this.item_[b.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=m(this.item_);return this.cache_},pick:function(){for(var b in this.item_)return this.item_[b];return null},top:function(b){var c=[];if(b)for(var a in this.item_)if(c.push(this.item_[a])>=b)break;return c},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();r.prototype.destroy.call(this);this.cache_=y;this.itemCount=0;this.item_=
this.memberMap_=null}}),d=g(v,{listen:{item:{destroy:function(b){this.memberMap_[b.eventObjectId]&&this.remove([b])}}},init:function(b){v.prototype.init.call(this,b);if(b=this.items)this.set(b),this.items=null},add:function(b){for(var c,a=this.memberMap_,f=[],h=0;h<b.length;h++){var d=b[h];if(d instanceof r){var l=d.eventObjectId;a[l]||(a[l]=d,d.addHandler(this.listen.item,this),f.push(d))}}f.length&&this.event_datasetChanged(this,c={inserted:f});return c},remove:function(b){for(var c,a=this.memberMap_,
f=[],h=0;h<b.length;h++){var d=b[h];if(d instanceof r){var l=d.eventObjectId;a[l]&&(d.removeHandler(this.listen.item,this),delete a[l],f.push(d))}}f.length&&this.event_datasetChanged(this,c={deleted:f});return c},set:function(b){if(!this.itemCount)return this.add(b);if(!b.length)return this.clear();for(var c=this.memberMap_,a={},f=[],h=[],d,l,i,p=0;p<b.length;p++)if(d=b[p],d instanceof r)l=d.eventObjectId,a[l]=d,c[l]||(c[l]=d,d.addHandler(this.listen.item,this),h.push(d));for(l in c)a[l]||(d=c[l],
d.removeHandler(this.listen.item,this),delete c[l],f.push(d));var k;var b={},e;if(h&&h.length)e=b.inserted=h;if(f&&f.length)e=b.deleted=f;e&&(k=b);(i=k)&&this.event_datasetChanged(this,i);return i},sync:function(b,c){if(b){d.setAccumulateState(!0);for(var a=this.memberMap_,f,h,x={},l=[],i,p=0;p<b.length;p++)if(f=b[p],f instanceof r)h=f.eventObjectId,x[h]=f,a[h]||l.push(f);for(h in this.item_)x[h]||this.item_[h].destroy();c&&l.length&&(i=this.add(l));d.setAccumulateState(!1);return i}},clear:function(){var b,
c=this.getItems();if(c.length){for(b=c.length;0<b--;)c[b].removeHandler(this.listen.item,this);this.event_datasetChanged(this,b={deleted:c});this.memberMap_={}}return b}});d.setAccumulateState=function(){function b(a){var b=a.dataset;h.call(b,b,a)}function c(a,c){var f=a.eventObjectId,d=c.inserted,l=c.deleted,x=i[f];if(d&&l)return x&&(delete i[f],b(x)),h.call(a,a,c);if(x){var k=x[d?"inserted":"deleted"];if(k)return k.push.apply(k,d||l);b(x)}i[f]=c;c.dataset=a}function a(){d=1;setAccumulateState(!1)}
var f=v.prototype,h=f.event_datasetChanged,d=0,l,i={};return function(p){if(p){if(0==d)f.event_datasetChanged=c,l=setTimeout(a,0);d++}else if(d-=0<d,0==d)clearTimeout(l),f.event_datasetChanged=h,p=i,i={},m(p).forEach(b)}}();basis.namespace("basis.data",j).extend({STATE:{UNDEFINED:"undefined",READY:"ready",PROCESSING:"processing",ERROR:"error",DEPRECATED:"deprecated"},Subscription:k,Object:r,DataObject:r,KeyObjectMap:o,AbstractDataset:v,Dataset:d})})(basis,this);
(function(e,j){function g(a,c,x,l){for(var c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),i=d(),p,k=0;k<c.length;k++)k%2?(p=c[k].split(/\|/),a.getters[p[0]]=x+"childNodes["+l+"]",p=1<p.length?p[1]:p[0]):p=c[k].length?c[k]:null,null!=p&&(v&&(i.lastChild&&i.appendChild(t.createComment("")),l++),i.appendChild(b(p)),l++);return i}function n(a){return function(b){if(!b||!("click"==b.type&&3==b.which)){var c=e.dom.event.sender(b),d,i;do if(d=c.getAttributeNode&&c.getAttributeNode(a))break;while(c=c.parentNode);
if(c&&d){do if(i=c.basisObjectId)if((i=q[i])&&i.templateAction){c=d.nodeValue.qw();d=0;for(var p;p=c[d++];)i.templateAction(p,e.dom.event(b));break}while(c=c.parentNode)}}}}function m(a,b,c){b=b.trim();if(!b)return"";for(var d="",i;i=r.exec(b);){var p=i[2],k=i[4]||i[5]||p;i[3]&&(a.getters[i[3]]=c+'.getAttributeNode("'+p+'")');if(i=p.match(/^event-([a-z]+)/i)){var v=i[1];if(!s[v]){s[v]=!0;i=0;for(var v=e.dom.event.browserEvents(v),g;g=v[i++];)e.dom.event.addGlobalHandler(g,n(p))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,b){var a=e.dom.event(a),c=this,f;do if(f=c.basisObjectId)if((f=q[f])&&f.templateAction){for(var c=b.qw(),h=0,d;d=c[h++];)f.templateAction(d,e.dom.event(a));break}while(c=c.parentNode)}}d+="class"==p?k.trim().replace(/^(.)|\s+/g,".$1"):"["+p+(k?"="+k.quote('"'):"")+"]"}return d}function o(a,b){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;b||(b=".");for(var c=d(),l,i=0,p,e=a.stack;p=k.exec(a.str);){l=RegExp.leftContext;a.str=a.str.substr(l.length+p[0].length);if(l.length)c.appendChild(g(a,
l,b,i)),i=c.childNodes.length;if(p[5]){if(p[5]==e[e.length-1])return e.pop(),c;throw"Wrong end tag";}if(p[6])p[7]&&(a.getters[p[7]]=b+"childNodes["+i+"]"),c.appendChild(t.createComment(p[6]));else{l=p[1];var v=p[2],r=!!p[4],j=b+"childNodes["+i+"]";p=u.createElement(l+m(a,p[3],j));v&&(a.getters[v]=j);r||(e.push(l),p.appendChild(o(a,j+".")));c.appendChild(p)}i++}a.str.length&&c.appendChild(g(a,a.str,b,i));if(e.length)throw"No end tag for "+e.reverse();return c}function w(a){if(!this.proto){a=this.source;
if("function"==typeof a)this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},b=o(a),a=Object.iterate(a.getters,function(a,c){for(var f=a.split(/\|/).map(String.format,"obj_.{0}"),d=c.split(/(\.?childNodes\[(\d+)\])/),i=b,l=0;l<d.length;l+=3){var D=d[l+2];if(!D)break;d[l+2]="";i=i.childNodes[D];i.previousSibling?i.nextSibling||(d[l+1]=".lastChild"):d[l+1]=".firstChild"}return{name:f[0],alias:f.join("="),path:"dom_"+d.join("")}}).sortAsObject("path"),c=0;c<a.length;c++)for(var d=
RegExp("^"+a[c].path.forRegExp()),i=c+1,p;p=a[i++];)p.path=p.path.replace(d,a[c].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,b){obj_=a||{};dom_=proto_.cloneNode(!0);_code_();if(b&&obj_.element){var c=obj_.element.basisObjectId=map_.seed++;map_[c]=b}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(b,q);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(q)}}var t=j.document,u=e.dom,y=e.Class,s={},q={seed:1},k=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,r=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;u.createFragment();var v=1==u.createElement("","a","b").cloneNode(!0).childNodes.length,d=u.createFragment,b=
u.createText,c=y(null,{__extend__:function(a){return a instanceof c?a:new c(a)},init:function(a){this.source=a},createInstance:function(a,b){w.call(this);return this.createInstance(a,b)},clearInstance:function(){w.call(this)}}),a=t.createElement("DIV");return e.namespace("basis.html").extend({Template:c,escape:function(a){return u.createElement("DIV",u.createText(a)).innerHTML},unescape:function(b){a.innerHTML=b;return a.firstChild.nodeValue},string2Html:function(b){a.innerHTML=b;return u.createFragment.apply(null,
Array.from(a.childNodes))}})})(basis,this);
(function(e){function j(a){return a.sortingValue||0}function g(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return+(a>b)||-(a<b)}function n(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return-(a>b)||+(a<b)}function m(a){return a.childNodes.sort(a.localSortingDesc?n:g)}function o(a,b){var c=b.length-1;a.childNodes=b;a.firstChild=b[0]||null;a.lastChild=b[c]||null;for(var f=c;c=b[f];f--)c.nextSibling=b[f+1]||null,c.previousSibling=b[f-1]||null,a.insertBefore(c,c.nextSibling)}function w(a,b){var c=a.childFactory||
a.document&&a.document.childFactory,f,b=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},b);if(c&&(f=c.call(a,b),f instanceof a.childClass))return f;if(!f)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(f&&f.constructor&&f.constructor.className)+")";}function t(){return e.ui.apply(this,arguments)}var u=e.Class,y=e.dom,s=e.data,q=s.Subscription,k=s.DataObject,
r=s.AbstractDataset,v=s.Dataset,d=y.AXIS_DESCENDANT,b=y.AXIS_DESCENDANT_OR_SELF,c=Function.getter,a=Object.complete,f=y.axis,s=e.EventObject.createEvent,h=e.EventObject.event;q.regType("DATASOURCE",{dataSourceChanged:function(a,b){this.remove(a,b);this.add(a,a.dataSource)}},function(a,b){a(b,b.dataSource)});var x=u.ExtensibleProperty(),l={ownerChanged:function(){},destroy:function(a){y.replace(a.element,this)}},i=function(){var a=this.key,b=this.config,c=this.owner,f="function"!=typeof b.existsIf||
b.existsIf(c),d=c.satellite[a];if(f){var f="delegate"in b,h="dataSource"in b,i="function"==typeof b.delegate?b.delegate(c):null,x="function"==typeof b.dataSource?b.dataSource(c):null;if(d)f&&d.setDelegate(i),h&&d.setDataSource(x);else{var p=c.tmpl[b.replace||a],d={owner:c};if(f)d.delegate=i;if(h)d.dataSource=x;b.config&&Object.complete(d,"function"==typeof b.config?b.config(c):b.config);d=new b.instanceOf(d);c.satellite[a]=d;p&&d instanceof e.ui.Node&&d.element&&(y.replace(p,d.element),d.addHandler(l,
p))}}else if(d)d.destroy(),d.owner=null,delete c.satellite[a]},p=u.CustomExtendProperty({update:!0},function(a,b){for(var c in b)a[c]=b[c]?i:null}),z=u(k,{event_update:function(a,b){k.prototype.event_update.call(this,a,b);var c=this.parentNode;c&&(c.matchFunction&&(this.match(),this.match(c.matchFunction)),c.insertBefore(this,this.nextSibling))},event_childNodesModified:s("childNodesModified","node","delta"),event_dataSourceChanged:s("dataSourceChanged","node","oldDataSource"),event_localGroupingChanged:s("localGroupingChanged",
"node","oldGroupingNode"),event_localSortingChanged:s("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:s("ownerChanged","node","oldOwner"),event_satellitesChanged:s("satellitesChanged","node","delta"),subscribeTo:k.prototype.subscribeTo+q.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:!1,nodeType:"DOMWrapperNode",canHaveChildren:!1,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:!0,document:null,parentNode:null,
nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:!1,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:x,satellite:null,owner:null,init:function(a){var b=this.dataSource,c=this.childNodes,f=this.localGrouping;if(b)this.dataSource=null;k.prototype.init.call(this,a);if(f)this.localGrouping=null,this.setLocalGrouping(f);if(this.canHaveChildren)this.childNodes=[],b?(this.dataSource=null,this.setDataSource(b)):c&&this.setChildNodes(c);
else{if(c)this.childNodes=null;if(b)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==x)for(var d in this.satelliteConfig)if(a=this.satelliteConfig[d],u.isClass(a)&&(a={instanceOf:a}),"object"==typeof a){b={key:d,owner:this,config:a};a=a.hook?p.__extend__(a.hook):p;for(d in a)if(a[d]===i){this.addHandler(a,b);break}i.call(b)}if(d=this.owner)this.owner=null,this.setOwner(d)},appendChild:function(){},insertBefore:function(){},removeChild:function(){},replaceChild:function(){},
clear:function(){},hasChildNodes:function(){return 0<this.childNodes.length},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||!1==a instanceof z)a=null;if(this.owner!==a){var b=this.owner;b&&b.removeHandler(this.listen.owner,this);(this.owner=a)&&a.addHandler(this.listen.owner,this);this.event_ownerChanged(this,b)}},destroy:function(){k.prototype.destroy.call(this);this.dataSource?this.setDataSource():this.firstChild&&
this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var b=this.satellite[a];b.destroy();b.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),A=u(z,{autoDestroyIfEmpty:!1,nodes:null,first:null,last:null,init:function(a){this.nodes=[];z.prototype.init.call(this,
a)},insert:function(a,b){var c=this.nodes,f=b?c.indexOf(b):-1;-1==f?(c.push(a),this.last=a):c.splice(f,0,a);this.first=c[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var b=this.nodes;if(b.remove(a))this.first=b[0]||null,this.last=b[b.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=this.nodes,b=a.length;0<b--;)a[b].groupNode=
null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){z.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),C={canHaveChildren:!0,childClass:z,childFactory:null,listen:{dataSource:{datasetChanged:function(a,b){var c={},f=[];if(b.deleted)if(c.deleted=f,this.childNodes.length==b.deleted.length){f.push.apply(f,this.childNodes);var d=this.dataSource;this.dataSource=null;this.clear(!0);
this.dataSource=d;this.colMap_={}}else for(var d=0,h;h=b.deleted[d];d++){h=h.eventObjectId;var i=this.colMap_[h];delete this.colMap_[h];i.canHaveDelegate=!0;this.removeChild(i);f.push(i)}if(b.inserted){c.inserted=[];for(d=0;h=b.inserted[d];d++)i=w(this,{cascadeDestroy:!1,delegate:h}),i.canHaveDelegate=!1,this.colMap_[h.eventObjectId]=i,c.inserted.push(i),this.firstChild&&this.insertBefore(i)}this.firstChild?this.event_childNodesModified(this,c):this.setChildNodes(c.inserted);if(this.destroyDataSourceMember&&
f.length)for(d=0;h=f[d];d++)h.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,b){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var c=this;do if(c==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(c=c.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";
!1==a instanceof this.childClass&&(a=w(this,a instanceof k?{delegate:a}:a));var h=a.parentNode===this,i=a.groupNode,l=this.localGrouping,x=this.localSorting,p,e=this.childNodes,v,B,r=null,c=-1,A=!1,g;if(h)g=a.nextSibling,B=a.previousSibling;if(x&&(b=null,p=this.localSortingDesc,v=x(a)||0,h))if(v===a.sortingValue)A=!0;else if((!g||(p?g.sortingValue<=v:g.sortingValue>=v))&&(!B||(p?B.sortingValue>=v:B.sortingValue<=v)))a.sortingValue=v,A=!0;if(l){r=l.getGroupNode(a);B=r.nodes;if(i===r&&(A||h&&g===b))return a;
x?A?c=g&&g.groupNode===r?B.indexOf(g):B.length:(c=B.binarySearchPos(v,j,p),a.sortingValue=v):c=b&&b.groupNode===r?B.indexOf(b):B.length;if(c<B.length)b=B[c];else if(r.last)b=r.last.nextSibling;else{c=r;for(b=null;(c=c.nextSibling)&&!(b=c.first););}if(a===b||h&&a.nextSibling===b)return i!==r&&(i&&i.remove(a),r.insert(a)),a;c=-1}else if(x){if(A)return a;c=e.binarySearchPos(v,j,p);b=e[c];a.sortingValue=v;if(a===b||h&&g===b)return a}else{if(b&&b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
if(h){if(g===b)return a;if(a===b)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}h?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=null,a.nextSibling=null,-1==c?e.remove(a):(p=e.indexOf(a),e.splice(p,1),p<c&&c--),i&&(i.remove(a),i=null)):a.parentNode&&a.parentNode.removeChild(a);i!=r&&r.insert(a,b);if(b){-1==
c&&(c=e.indexOf(b));if(-1==c)throw"basis.dom.wrapper: Node was not found";a.nextSibling=b;e.splice(c,0,a)}else c=e.length,e.push(a),b={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=b.previousSibling;0==c?this.firstChild=a:b.previousSibling.nextSibling=a;b.previousSibling=a;var z=!1,q=!1,m=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)z=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==m)a.contextSelection=
m,q=!a.selection,a.selected&&m.add([a]);a.firstChild&&(z||q)&&f(a,d).forEach(function(a){if(z&&!a.document)a.document=z;if(q&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=m});h||(a.match&&a.match(this.matchFunction),a.autoDelegateParent&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,{inserted:[a]}));return a},removeChild:function(a){if(null==a||a.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(!1==a instanceof this.childClass)throw"basis.dom.wrapper: Child node has wrong class";
if(this.dataSource&&this.dataSource.has(a))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(a),1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.document===this.document&&f(a,b).forEach(function(a){if(a.document==
this.document)a.document=null},this);if(a.contextSelection){for(var c=a.contextSelection,d=a,h=[];d;){if(d.contextSelection===c)d.selected&&h.push(d),d.contextSelection=null;if(!d.selection&&d.firstChild)d=d.firstChild;else if(d.nextSibling)d=d.nextSibling;else for(;d=d.parentNode;)if(d.nextSibling){d=d.nextSibling;break}}c.remove(h)}a.groupNode&&a.groupNode.remove(a);this.dataSource||this.event_childNodesModified(this,{deleted:[a]});a.autoDelegateParent&&a.setDelegate();return a},replaceChild:function(a,
b){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(null==b||b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,b);return this.removeChild(b)},clear:function(a){if(this.dataSource)this.setDataSource();else if(this.firstChild){var b=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:b});for(var c=b.length;0<c--;){var d=b[c];d.parentNode=
null;d.groupNode=null;a?((d.selection||d.document)&&f(d,y.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),d.nextSibling=null,d.previousSibling=null,d.autoDelegateParent&&d.setDelegate()):d.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(c=a.length-1;b=a[c];c--)b.clear()}}},setChildNodes:function(a,b){this.dataSource||this.clear(!!b);
if(a&&(!1=="length"in a&&(a=[a]),a.length)){var c=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var f=0,d=a.length;f<d;f++)this.insertBefore(a[f]);this.event_childNodesModified=c;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.canHaveChildren||!1==a instanceof r)a=null;if(this.dataSource!==a){var b=this.dataSource;if(b)this.colMap_=this.dataSource=null,b.removeHandler(this.listen.dataSource,this),b.itemCount&&
this.clear();if(a)this.dataSource=a,this.colMap_={},a.addHandler(this.listen.dataSource,this),a.itemCount&&this.listen.dataSource.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_dataSourceChanged(this,b)}},setLocalGrouping:function(a){if("function"==typeof a||"string"==typeof a)a={groupGetter:c(a)};!1==a instanceof E&&(a=null!=a&&"object"==typeof a?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var b=this.localGrouping,f;if(this.localGrouping){if(!a&&
(this.localGrouping=null,this.firstChild)){f=this.localSorting?m(this):this.childNodes;for(var d=f.length;0<d--;)f[d].groupNode=null;o(this,f)}b.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){f=this.localSorting?m(this):this.childNodes;for(d=0;a=f[d];d++)a.groupNode=this.localGrouping.getGroupNode(a);for(d=0;a=f[d];d++)a.groupNode.nodes.push(a);f.length=0;for(d=this.localGrouping.nullGroup;d;d=d.nextSibling)a=d.nodes,d.first=a[0]||null,d.last=a[a.length-1]||null,f.push.apply(f,
a),d.event_childNodesModified(d,{inserted:a});o(this,f)}this.event_localGroupingChanged(this,b)}},setLocalSorting:function(a,b){a&&(a=c(a));if(this.localSorting!=a||this.localSortingDesc!=!!b){var f=this.localSorting,d=this.localSortingDesc;this.localSortingDesc=!!b;this.localSorting=a||null;if(a&&this.firstChild){var h=[],i;for(i=this.firstChild;i;i=i.nextSibling)i.sortingValue=a(i)||0;if(this.localGrouping)for(var l=this.localGrouping.nullGroup;l;l=l.nextSibling)i=l.nodes=m({childNodes:l.nodes,
localSortingDesc:this.localSortingDesc}),l.first=i[0]||null,l.last=i[i.length-1]||null,h.push.apply(h,i);else h=m(this);o(this,h)}this.event_localSortingChanged(this,f,d)}},setMatchFunction:function(a){if(this.matchFunction!=a){this.matchFunction=a;for(var b=this.lastChild;b;b=b.previousSibling)b.match(a)}}},q=u(z,{event_enable:s("enable","node"),event_disable:s("disable","node"),event_select:s("select","node"),event_unselect:s("unselect","node"),event_match:s("match","node"),event_unmatch:s("unmatch",
"node"),selectable:!0,selected:!1,selection:null,contextSelection:null,matchFunction:null,matched:!0,disabled:!1,init:function(a){if(this.selection&&!1==this.selection instanceof r)this.selection=new B(this.selection);z.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=!1,this.select(!0)},setSelection:function(a){if(this.selection==a)return!1;var b=this.selection;f(this,d,function(c){if(c.contextSelection==b)c.selected&&b&&b.remove([c]),c.contextSelection=
a});this.selection=a;return!0},hasOwnSelection:function(){return!!this.selection},select:function(a){var b=this.selected,c=this.contextSelection;if(c)a?b?c.remove([this]):c.add([this]):this.selectable&&c.set([this]);else if(!b&&this.selectable&&!this.isDisabled())this.selected=!0,this.event_select(this);return this.selected!=b},unselect:function(){var a=this.selected;if(a){var b=this.contextSelection;b?b.remove([this]):(this.selected=!1,this.event_unselect(this))}return this.selected!=a},enable:function(){if(this.disabled)this.disabled=
!1,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=!0,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!y.findAncestor(this,c("disabled"))},match:function(a){if("function"!=typeof a)if(this.matched){if(this.underMatch_)this.underMatch_(this,!0),this.underMatch_=null}else this.matched=!0,this.event_match(this);else if(a(this)){if(this.underMatch_=a,!this.matched)this.matched=!0,this.event_match(this)}else if(this.underMatch_=
null,this.matched)this.matched=!1,this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();z.prototype.destroy.call(this)}}),F=u(q,C,{}),E=u(z,C,{event_childNodesModified:function(a,b){h.childNodesModified.call(this,a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var c=this.owner,f=Array.from(this.nullGroup.nodes),d=f.length;0<d--;)c.insertBefore(f[d],
f[d].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,!0);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);h.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:!0,autoDestroyEmptyGroups:!0,titleGetter:c("data.title"),groupGetter:Function.$undef,childClass:A,childFactory:function(b){return new this.childClass(a(b,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?
!1:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new A({autoDestroyIfEmpty:!1});z.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),b=a instanceof k,c=this.map_[b?a.eventObjectId:a];!c&&!this.dataSource&&(c=this.appendChild(b?{delegate:a}:{data:{id:a,title:a}}));return c||this.nullGroup},insertBefore:function(a,b){a=C.insertBefore.call(this,a,b);if(!1=="groupId_"in a)a.groupId_=a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=
a;if(a.first){var c=this.owner,f=c.childNodes,d=a.first,h=a.last,i,l,p;for(i=a;(i=i.previousSibling)&&!(p=i.last););if(!p)p=this.nullGroup.last;for(i=a;(i=i.nextSibling)&&!(l=i.first););if(d.previousSibling!==p||h.nextSibling!==l){if(d.previousSibling)d.previousSibling.nextSibling=h.nextSibling;if(h.nextSibling)h.nextSibling.previousSibling=d.previousSibling;i=f.splice(f.indexOf(d),a.nodes.length);var x=f.indexOf(l);i.unshift(-1!=x?x:f.length,0);f.splice.apply(f,i);d.previousSibling=p;h.nextSibling=
l;if(p)p.nextSibling=d;if(l)l.previousSibling=h;c.firstChild=f[0];c.lastChild=f[f.length-1]}}return a},removeChild:function(a){C.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){C.clear.call(this);this.map_={}},destroy:function(){this.setOwner();z.prototype.destroy.call(this);this.map_=null}});z.prototype.localGroupingClass=E;var s=u(r,{autoDestroy:!0,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,b){var c=this.memberMap_,f={},d=0,h=0,i=b.inserted,
l=b.deleted;if(i&&i.length)for(f.inserted=i;a=i[d];)c[a.eventObjectId]=a,d++;if(l&&l.length)for(f.deleted=l;a=l[h];)delete c[a.eventObjectId],h++;(d||h)&&this.event_datasetChanged(this,f)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:s("sourceNodeChanged")&&function(a,b){h.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:!1,init:function(a,b){r.prototype.init.call(this,b);a&&this.setSourceNode(a)},
setSourceNode:function(a){!1==a instanceof z&&(a=null);if(a!==this.sourceNode){var b=this.sourceNode;b&&(b.removeHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,b,{deleted:b.childNodes}));a&&(a.addHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,a,{inserted:a.childNodes}));this.sourceNode=a;this.event_sourceNodeChanged(this,b)}},destroy:function(){this.setSourceNode();r.prototype.destroy.call(this)}}),B=u(v,{multiple:!1,
event_datasetChanged:function(a,b){v.prototype.event_datasetChanged.call(this,a,b);if(b.inserted)for(var c=0,f;f=b.inserted[c];c++)if(!f.selected)f.selected=!0,f.event_select();if(b.deleted)for(c=0;f=b.deleted[c];c++)if(f.selected)f.selected=!1,f.event_unselect()},add:function(a){if(!this.multiple){if(this.itemCount)return this.set(a);a.splice(1)}for(var b=[],c=0,f;f=a[c];c++)f.contextSelection==this&&f.selectable&&b.push(f);return v.prototype.add.call(this,b)},set:function(a){for(var b=[],c=0,f;f=
a[c];c++)f.contextSelection==this&&f.selectable&&b.push(f);this.multiple||a.splice(1);return v.prototype.set.call(this,b)}});e.namespace("basis.dom.wrapper",t).extend({AbstractNode:z,InteractiveNode:q,Node:F,GroupingNode:E,PartitionNode:A,simpleTemplate:t,ChildNodesDataset:s,Selection:B})})(basis);
(function(e,j){function g(a,b){return o(b,!0).getRule(a,!0)}function n(a,b){var c=a.match(/^([^{]+)\{(.*)\}\s*$/);if(c){for(var f=c[1].trim().split(/\s*,\s*/),d=0;d<f.length;d++)this.addRule(f[d],c[2]||null,b++);return b-1}}function m(a,b){var c=d.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:b?"alternate ":"",url:a.quote('"')}));d.tag(null,"HEAD")[0].appendChild(c);c=c.sheet||c.styleSheet;try{if(!c.cssRules)c.cssRules=c.rules}catch(f){}if(!c.insertRule)c.insertRule=
n;if(!c.deleteRule)c.deleteRule=c.removeRule;return c}function o(a,b){a||(a="DefaultGenericStyleSheet");h[a]||b&&(h[a]=new i(m()));return h[a]}function w(a,b,c,f){for(var f=f||{},b=b.qw(),d=0,h;h=b[d];d++)if("undefined"!=typeof l.style[h]){c&&(e.platformFeature["css-"+a]=h);x[a]={key:h,getter:f[h]};break}}function t(a,b){var c=x[a];if(a=c?c.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:c&&c.getter?c.getter(b):b}}function u(a,b,c){if("function"==typeof a.setProperty)return a.setProperty(b,
c);if(b=t(b,c))return a.style[b.key]=b.value}function y(a,b){for(var c in b)u(a,c,b[c]);return a}function s(a,b){return u(a,"display","string"==typeof b?b:b?"":"none")}function q(a,b){return u(a,"visibility",b?"":"hidden")}function k(a){return F[a]||(F[a]=RegExp("\\s*\\b"+a+"\\b"))}function r(a,b){var c=(b?"g":"s")+a;return B[c]||(B[c]=RegExp((b?"":"\\s*")+"\\b"+a+".*\\b"))}var v=j.document,d=e.dom,b=e.dom.event,c=e.Class,a=/\s*!important/i,f=1,h={},x={},l=d.createElement("DIV");w("opacity","opacity MozOpacity KhtmlOpacity filter",
!0,{fitler:function(a){return"alpha(opacity:"+parseInt(100*a)+")"}});w("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",!0);w("float","cssFloat styleFloat");var i=c(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,b){if(!this.map_[a]&&b){for(var c=this.styleSheet,f=this.rules.length,d=c.insertRule(a+"{}",f),h=f;h<=d;h++)this.rules.push(new p(c.cssRules[h]));this.map_[a]=f!=d?new z(this.rules.splice(f)):this.rules[f]}return this.map_[a]},
deleteRule:function(a){var b=this.map_[a];if(b){for(var b=b.rules||[b],c=0;c<b.length;c++){var f=this.rules.indexOf(b[c]);this.stylesheet.deleteRule(f);this.rules.splice(f,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),p=c(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(b,c){var f,d=!!a.test(c),h=this.rule.style;if(d||h.getPropertyPriority&&"important"==h.getPropertyPriority(b)){if(c=c.replace(a,""),f=t(b,c)){var i=
f.key;h.setProperty?(d||h.removeProperty(i),h.setProperty(i,f.value,d?"important":"")):h.cssText=h.cssText.replace(RegExp(h[i]?i+"\\s*:\\s*"+h[i]+"(\\s*!important)?\\s*;?":"^","i"),i+": "+f.value+(d?" !important":"")+";")}}else u(this.rule,b,c)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),z=c(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});["setProperty","setStyle",
"clear"].forEach(function(a){z.prototype[a]=function(){for(var b,c=0;b=this.rules[c];c++)b[a].apply(b,arguments)}});var A={};["em","ex","px","%"].forEach(function(a){A["%"==a?"percent":a]=function(b){return 0==b||isNaN(b)?"0":b+a}});var C,F={},E=c(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,b,c){c=c||"";"undefined"!=typeof a&&this.remove(c+a);"undefined"!=typeof b&&this.add(c+
b)},bool:function(a,b){b?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(k(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(k(a))||(this.element.className+=" "+a)},remove:function(a){var b=this.element.className,a=b.replace(k(a),"");if(a!=b)this.element.className=a},toggle:function(a){var b=this.contains(a);b?this.remove(a):this.add(a);return!b}}),B={},D=c(null,
{delim:"-",init:function(a,b){this.classList=b;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(r(this.prefix,!0))},set:function(a){var b=this.items(),a="undefined"!=typeof a?this.prefix+a:"",c=this.classList;if(b)if(1==b.length){if(b[0]===a)return;c.remove(b[0])}else this.clear();a&&c.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});j.DOMTokenList&&v.documentElement.classList?(c=E.prototype,Object.extend(j.DOMTokenList.prototype,{set:c.set,replace:c.replace,bool:c.bool,clear:function(){for(var a=this.length;0<a--;)this.remove(this[a])},setPrefixToken:c.setPrefixToken}),C=function(a){return("string"==typeof a?d.get(a):a).classList}):C=function(a){return new E("string"==typeof a?d.get(a):a)};b.onLoad(function(){C(v.body).bool("opacity-not-support",!e.platformFeature["css-opacity"])});d.extend({setStyleProperty:u,
setStyle:y,display:s,show:function(a){return s(a,1)},hide:function(a){return s(a)},visibility:q,visible:function(a){return q(a,1)},invisible:function(a){return q(a)}});return e.namespace("basis.cssom").extend({setStyleProperty:u,setStyle:y,classList:function(a,b){return b?new D(b,C(a)):C(a)},uniqueRule:function(a){var b="genericRule-"+f++;a&&C(a).add(b);a=g("."+b);a.token=b;return a},cssRule:g,getStyleSheet:o,addStyleSheet:m,CssStyleSheetWrapper:i,CssRuleWrapper:p,CssRuleWrapperSet:z}).extend(A)})(basis,
this);
(function(e){function j(b){return!(b%400&&(!(b%100)||b%4))}function g(b,c){return 1==b?28+j(c):w[b]}function n(b,c){return c.replace(r,function(a,c){return q[c](b)})}function m(b,c,a,f,d,x,l){return new Date(b,c-1,a,f||0,d||0,x||0,l||0)}var o=Function.getter,w=[31,28,31,30,31,30,31,31,30,31,30,31],t={day:864E5,hour:36E5,minute:6E4,second:1E3},u="year month day hour minute second millisecond".qw(),y={},s={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(b,c){y[b]=o("get"+c+"()");s[b]=new Function("d,v","d.set"+c+"(v)")});var q={y:o("getFullYear().toString().substr(2)"),Y:o("getFullYear()"),d:o("getDate()"),D:o("getDate()","{0:02}"),m:o("getMonth() + 1"),M:o("getMonth() + 1","{0:02}"),h:o("getHours()"),H:o("getHours()","{0:02}"),i:o("getHours() % 12 || 12","{0:02}"),p:o("getHours() > 12",{"true":"pm","false":"am"}),P:o("getHours() > 12",{"true":"PM","false":"AM"}),I:o("getMinutes()","{0:02}"),s:o("getSeconds()"),
S:o("getSeconds()","{0:02}"),z:o("getMilliseconds()"),Z:o("getMilliseconds()","{0:03}")},k=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,r=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return j(this.getFullYear())},getMonthDayCount:function(){return g(this.getMonth(),this.getFullYear())},add:function(b,c){var a=y[b];if(!a)throw Error("Unknown date part: "+b);var f;if("year"==b||"month"==b)f=this.getDate(),28<f&&this.setDate(1);s[b](this,a(this)+
c);28<f&&(a=this.getMonthDayCount(),f>a&&this.setDate(a));return this},diff:function(b,c){if("year"==b||"month"==b){var a=0<Number(this)-Number(c)?-1:1,f=0<a?this:c,d=0<a?c:this,x=f.getFullYear(),x=d.getFullYear()-x;if("year"==b)return a*x;f=f.getMonth();d=d.getMonth();return a*(x?(1<x?12*(x-1):0)+(11-f)+(d+1):d-f)}a=Math.floor((c-this)/t[b]);return a+Number(0!=y[b](new Date(c-a*t[b]))-y[b](this))},set:function(b,c){var a=s[b];if(!a)throw Error("Unknown date part: "+b);var f;if("year"==b||"month"==
b)f=this.getDate(),28<f&&this.setDate(1);a(this,c);28<f&&(a=this.getMonthDayCount(),f>a&&this.setDate(a));return this},get:function(b){if(y[b])return y[b](this);throw Error("Unknown date part: "+b);},toISODateString:function(){return n(this,"%Y-%M-%D")},toISOTimeString:function(){return n(this,"%H:%I:%S.%Z")},fromDate:function(b){b instanceof Date&&(this.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),this.setTime(b.getTime()));return this},toFormat:function(b){return n(this,b)}});var v=Date.prototype.toISOString;
if(v&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return v.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(b){var c=(""+b).match(k);if(!c)throw Error("Value of date isn't in ISO format: "+b);c[2]-=1;for(var b=0,a;a=u[b];b++)this.set(a,c[b+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,toODBCTime:Date.prototype.toISOTimeString,
toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var d=/\D/;Date.fromISOString=function(b){return b?m.apply(null,(""+b).split(d)):null};Date.timer=function(b){var c=b||new Date;c.measure=function(a){return a?((new Date-c)/1E3).toFixed(3):new Date-c};return c};e.namespace("basis.date").extend({isLeapYear:j,getMonthDayCount:g,format:n})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.html.Template,m=e.cssom.classList,o=Function.getter,w=e.Cleaner,t=e.dom.wrapper.Node,u=e.dom.wrapper.PartitionNode,y=e.dom.wrapper.GroupingNode,s=j.ExtensibleProperty(),q=function(k){return{template:new n("<div/>"),action:s,cssClassName:null,event_update:function(e,d){k.event_update.call(this,e,d);this.templateUpdate(this.tmpl,"update",d)},event_select:function(e){k.event_select.call(this,e);m(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(e){k.event_unselect.call(this,e);m(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(e){k.event_disable.call(this,e);m(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(e){k.event_enable.call(this,e);m(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(e){k.event_match.call(this,e);g.display(this.element,!0)},event_unmatch:function(e){k.event_unmatch.call(this,e);g.display(this.element,
!1)},init:function(e){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&g.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=g.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;k.init.call(this,e);if(this.id)this.element.id=
this.id;if(e=this.cssClassName){"string"==typeof e&&(e={element:e});for(var d in e){var b=this.tmpl[d];if(b)for(var b=m(b),c=(""+e[d]).qw(),a=0,f;f=c[a++];)b.add(f)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&g.insert(this.container,this.element)},templateAction:function(k,d){var b=this.action[k];b&&b.call(this,d)},templateUpdate:function(){},destroy:function(){var e=this.element;k.destroy.call(this);e&&e.parentNode&&e.parentNode.removeChild(e);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},t=j(t,q,{}),o=j(u,q,{titleGetter:o("data.title"),templateUpdate:function(k){if(k.titleText)k.titleText.nodeValue=""+this.titleGetter(this)}}),q=function(k){return{insertBefore:function(e,d){var e=k.insertBefore.call(this,e,d),b=e.groupNode||this,c=e.nextSibling,b=b.childNodesElement||b.element||this.childNodesElement||this.element,a=e.element,c=(c&&c.element.parentNode==b?c.element:null)||b.insertPoint||null;(a.parentNode!==b||a.nextSibling!==
c)&&b.insertBefore(a,c);return e},removeChild:function(e){k.removeChild.call(this,e);var d=e.element,b=d.parentNode;b&&b.removeChild(d);return e},clear:function(e){if(e)for(var d=this.firstChild;d;){var b=d.element;b.parentNode&&b.parentNode.removeChild(b);d=d.nextSibling}k.clear.call(this,e)},setChildNodes:function(e,d){var b=g.createFragment(),c=this.localGrouping||this,a=c.childNodesElement||c.element;c.childNodesElement=b;k.setChildNodes.call(this,e,d);a.insertBefore(b,a.insertPoint||null);c.childNodesElement=
a}}},u=j(y,q,{childClass:o,localGroupingClass:j.SELF,event_ownerChanged:function(k,e){var d=this,b=this.owner,c=null;b&&(c=b.tmpl&&b.tmpl.groupsElement||b.childNodesElement||b.element,c.appendChild(this.nullElement));do d.element=d.childNodesElement=c;while(d=d.localGrouping);y.prototype.event_ownerChanged.call(this,k,e)},init:function(k){this.element=this.childNodesElement=this.nullElement=g.createFragment();y.prototype.init.call(this,k)}}),k=j(t,q,{childClass:t,childFactory:function(k){return new this.childClass(k)},
localGroupingClass:u}),j=j(k,{selection:{},init:function(e){this.document=this;k.prototype.init.call(this,e);w.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;k.prototype.destroy.call(this);w.remove(this)}}),q=function(k,e){for(var d=k.match(/\{(this_[^\}]+)\}/g)||[],b=[],c=0;c<d.length;c++){var a=d[c].match(/\{(this_[^\|\}]+)\}/)[1];b.push("this.tmpl."+a+".nodeValue = "+a.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(b,c,d){a.templateUpdate.call(this,b,c,d);_code_()}},config_)}.toString().replace("_code_()",b.join(";\n")))(new n(k),e)};e.namespace("basis.ui",q).extend({simpleTemplate:q,Node:t,Container:k,PartitionNode:o,GroupingNode:u,Control:j})})(basis);
(function(e,j){function g(a,b){if(i)try{return parseFloat(w.getComputedStyle(a,null)[b])}catch(c){return 0}else return 0}function n(a,b){if(i)return g(a,"height");q.setStyle(b,{borderTop:a.currentStyle.borderTopWidth+" solid red",borderBottom:a.currentStyle.borderBottomWidth+" solid red",paddingTop:a.currentStyle.paddingTop,paddingBottom:a.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"});return a.offsetHeight-b.offsetHeight}function m(a,b){if(l)k(a).add("Basis-Layout-OnResizeElement"),
a.onresize=b;else{var c=u.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});u.insert(a,c);c.onload=function(){(c.contentWindow.onresize=b)()}}}for(var o=j.document,w=o.defaultView,t=e.Class,u=e.dom,y=e.ua,s=Object.extend,q=e.cssom,k=e.cssom.classList,r=e.ui.Container,v=y.test("IE"),d=y.test("IE7+"),b=!1,c=u.createElement(""),a=["","-webkit-"],f=0;f<a.length;f++)try{var h=a[f]+"box";c.style.display=
h;if(c.style.display==h){b=a[f];break}}catch(x){}var l="undefined"!=typeof c.onresize,i=w&&w.getComputedStyle,c=function(){return u.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};c.className="basis.Layout.Helper";var p={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:!1},z=t(null,{init:function(a,b,c){this.reset();this.setElement(a,b,c)},setElement:function(a,b,c){this.element=u.get(a);
this.offsetElement=c;b||this.recalc(this.offsetElement)},copy:function(a){"top,left,bottom,right,height,width,defined".split(",").forEach(function(b){this[b]=a[b]},this)},reset:function(){s(this,p)},set:function(a,b){if(this.defined){switch(a.toLowerCase()){case "left":this.left=b;this.right=this.left+this.width;break;case "right":this.right=b;this.left=this.right-this.width;break;case "width":this.width=b;this.right=this.left+this.width;break;case "top":this.top=b;this.bottom=this.top+this.height;
break;case "bottom":this.bottom=b;this.top=this.bottom-this.height;break;case "height":this.height=b,this.bottom=this.top+this.height}(0>=this.width||0>=this.height)&&this.reset()}return this},recalc:function(a){this.reset();var b=this.element;if(b){var c=b,f=o.documentElement;if(b.getBoundingClientRect)c=b.getBoundingClientRect(),this.top=c.top,this.left=c.left,v&&(d?(this.top+=f.scrollTop-f.clientTop,this.left+=f.scrollLeft-f.clientLeft):b!=o.body&&(this.top-=o.body.clientTop-o.body.scrollTop,this.left-=
o.body.clientLeft-o.body.scrollLeft)),a&&(a=new z(a),this.top-=a.top,this.left-=a.left,a.destroy());else if(o.getBoxObjectFor){var h=o.getBoxObjectFor(f),c=o.getBoxObjectFor(b);this.top=c.screenY-h.screenY;this.left=c.screenX-h.screenX;if(y.test("FF1.5-")){if(c=b.offsetParent)this.top-=c.scrollTop,this.left-=c.scrollLeft;c!=o.body&&(this.top+=f.scrollTop,this.left+=f.scrollLeft)}if(y.test("FF2+")){if(this.top&&(c=f.scrollTop,2<c)){for(var h=0,i=Math.floor(Math.log(c)/Math.LN2);0<=i;i-=3)h+=1<<i;c>
h&&(this.top-=1)}this.left&&(this.left-=1<f.scrollLeft)}a&&(a=new z(a),this.top-=a.top,this.left-=a.left,a.destroy())}else if(b!=a){this.top=b.offsetTop;this.left=b.offsetLeft;this.top-=o.body.clientTop-o.body.scrollTop;for(this.left-=o.body.clientLeft-o.body.scrollLeft;(c=c.offsetParent)&&c!=a;)this.top+=c.offsetTop+c.clientTop-c.scrollTop,this.left+=c.offsetLeft+c.clientLeft-c.scrollLeft}else this.top=this.left=0;this.width=b.offsetWidth;this.height=b.offsetHeight;this.bottom=this.top+this.height;
this.right=this.left+this.width;this.defined=!0}return this.defined},intersection:function(a){if(!this.defined)return!1;!1==a instanceof z&&(a=new z(a));return a.defined&&a.right>this.left&&a.left<this.right&&a.bottom>this.top&&a.top<this.bottom},inside:function(a){if(!this.defined)return!1;!1==a instanceof z&&(a=new z(a));return a.defined&&a.left>=this.left&&a.right<=this.right&&a.bottom>=this.bottom&&a.top<=this.top},point:function(a){if(!this.defined)return!1;var b=a.left||a.x||0,a=a.top||a.y||
0;return b>=this.left&&b<this.right&&a>=this.top&&a<this.bottom},power:function(a){if(!this.defined)return!1;if(a=u.get(a)||this.element)return u.setStyle(a,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"}),!0},destroy:function(){delete this.element}}),a=t(z,{init:function(a,b,c){this.setBoxes(a,b,c)},setBoxes:function(a,b,c){this.boxA=a instanceof z?a:new z(a,!0);this.boxB=b instanceof z?b:new z(b,!0);c||this.recalc()},recalc:function(){this.reset();if(!this.boxA.recalc()||
!this.boxB.recalc())return!1;if(this.boxA.intersection(this.boxB))this.top=Math.max(this.boxA.top,this.boxB.top),this.left=Math.max(this.boxA.left,this.boxB.left),this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom),this.right=Math.min(this.boxA.right,this.boxB.right),this.width=this.right-this.left,this.height=this.bottom-this.top,0>=this.width||0>=this.height?this.reset():this.defined=!0;return this.defined}}),f=t(z,{recalc:function(){this.reset();var a=this.element;if(a){var b=a;this.width=
a.clientWidth;this.height=a.clientHeight;if(a.getBoundingClientRect){var c=a.getBoundingClientRect();this.top=c.top;for(this.left=c.left;b=b.offsetParent;)this.top-=b.scrollTop,this.left-=b.scrollLeft}else if(o.getBoxObjectFor){c=o.getBoxObjectFor(a);this.top=c.y;for(this.left=c.x;b=b.offsetParent;)this.top-=b.scrollTop,this.left-=b.scrollLeft}else c=new z(a),this.top=c.top+a.clientTop,this.left=c.left+a.clientLeft;this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=!0}return this.defined}});
q.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});h=q.cssRule(".Basis-VerticalPanelStack");h.setStyle({overflow:"hidden"});!1!==b&&(h.setProperty("display",b+"box"),h.setProperty(b+"box-orient","vertical"));h=t(r,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(a){r.prototype.init.call(this,a);this.flex?!1!==b&&q.setStyleProperty(this.element,b+"box-flex",this.flex):!1===b&&m(this.element,function(){this.parentNode&&this.parentNode.realign()}.bind(this))}});t=t(r,
{childClass:h,template:'<div class="Basis-VerticalPanelStack">'+(b?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(a){this.cssRule=q.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");r.prototype.init.call(this,a);!1===b&&(this.realign(),m(this.childNodesElement,function(){this.realign()}.bind(this)))},insertBefore:function(a,b){if(a=r.prototype.insertBefore.call(this,a,b))return a.flex&&
this.cssRule&&k(a.element).add(this.ruleClassName),this.realign(),a},removeChild:function(a){if(r.prototype.removeChild.call(this,a))return a.flex&&this.cssRule&&k(a.element).remove(this.ruleClassName),this.realign(),a},realign:function(){if(!1===b){var a=this.element,c=this.lastChild.element,f=this.tmpl.ruller,d=(new z(c,!1,a)).bottom-g(a,"paddingTop")-g(a,"borderTopWidth")||0,a=n(a,f);if(i)d+=g(c,"marginBottom");else{var h=f.offsetHeight;f.style.height=c.currentStyle.marginBottom;d+=f.offsetHeight-
h}if(d=a-d){for(a=c=0;h=this.childNodes[a];a++)h.flex&&(c++,d+=n(h.element,f));c&&this.cssRule.setProperty("height",Math.max(0,d/c)+"px")}}}});e.namespace("basis.layout").extend({Box:z,Intersection:a,Viewport:f,VerticalPanel:h,VerticalPanelStack:t,Helper:c,addBlockResizeHandler:m})})(basis,this);
(function(e){var j=e.Class,g=e.dom.event,n=e.dom,m=Function.getter,o=e.cssom.classList,w=g.addGlobalHandler,t=g.removeGlobalHandler,u=e.EventObject,y=u.createEvent,s=e.layout,q=e.ua,k=e.ua.is("IE9-"),r,v={start:function(b){r&&v.over();r={dde:this,run:!1,event:{initX:g.mouseX(b),initY:g.mouseY(b),deltaX:0,deltaY:0}};w("mousemove",v.move,r);w("mouseup",v.over,r);w("mousedown",v.over,r);g.cancelDefault(b);this.event_prepare(r.event)},move:function(b){var c=r.dde;if(!r.run)r.run=!0,c.draging=!0,c.event_start(r.event);
if(c.axisX)r.event.deltaX=c.axisXproxy(g.mouseX(b)-r.event.initX);if(c.axisY)r.event.deltaY=c.axisYproxy(g.mouseY(b)-r.event.initY);c.event_move(r.event)},over:function(b){var c=r.dde;t("mousemove",v.move,r);t("mouseup",v.over,r);t("mousedown",v.over,r);c.draging=!1;r.run&&c.event_over(r.event);r=null;g.kill(b)}},d=j(u,{containerGetter:m("element"),element:null,trigger:null,baseElement:null,fixTop:!0,fixRight:!0,fixBottom:!0,fixLeft:!0,axisX:!0,axisY:!0,axisXproxy:Function.$self,axisYproxy:Function.$self,
event_prepare:y("prepare"),event_start:y("start"),event_move:y("move"),event_over:y("over"),init:function(b){u.prototype.init.call(this,b);var b=this.element,c=this.trigger;this.trigger=this.element=null;this.setElement(b,c);this.setBase(this.baseElement);e.Cleaner.add(this)},setElement:function(b,c){b=b&&n.get(b);c=c&&n.get(c)||b;if(this.trigger!=c&&(this.trigger&&(g.removeHandler(this.trigger,"mousedown",v.start,this),k&&g.removeHandler(this.trigger,"selectstart",v.start,this)),this.trigger=c))g.addHandler(this.trigger,
"mousedown",v.start,this),k&&g.addHandler(this.trigger,"selectstart",v.start,this);if(this.element!=b)this.element&&o(this.element).remove("Basis-Dragable"),(this.element=b)&&o(this.element).add("Basis-Dragable")},setBase:function(b){this.baseElement=n.get(b)||(q.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(r&&r.dde==this)},start:function(b){this.isDraging()||v.start.call(this,b)},stop:function(){this.isDraging()&&v.over()},destroy:function(){e.Cleaner.remove(this);
this.stop();u.prototype.destroy.call(this);this.setElement();this.setBase()}}),j=j(d,{event_start:function(b){var c=this.containerGetter(this,b.initX,b.initY);if(c){var a=new s.Box(c),f=new s.Viewport(this.baseElement);o(c).add("Basis-DragDrop-DragElement");b.element=c;b.box=a;b.viewport=f}d.prototype.event_start.call(this,b)},event_move:function(b){if(b.element){if(this.axisX){var c=b.box.left+b.deltaX;this.fixLeft&&0>c?c=0:this.fixRight&&c+b.box.width>b.viewport.width&&(c=b.viewport.width-b.box.width);
b.element.style.left=c+"px"}if(this.axisY)c=b.box.top+b.deltaY,this.fixTop&&0>c?c=0:this.fixBottom&&c+b.box.height>b.viewport.height&&(c=b.viewport.height-b.box.height),b.element.style.top=c+"px";d.prototype.event_move.call(this,b)}},event_over:function(b){b.element&&(o(b.element).remove("Basis-DragDrop-DragElement"),d.prototype.event_over.call(this,b))}});e.namespace("basis.dragdrop").extend({DragDropElement:d,MoveableElement:j})})(basis);
(function(){function e(a){if(a instanceof d)return a.set;a=a.nodeType;if(!1==isNaN(a))return 1==a?v:"nodeValue"}var j=basis.Class,g=basis.dom,n=basis.Cleaner,m=Function.getter,o=basis.cssom.classList,w=basis.EventObject,t=basis.TimeEventManager,u=w.createEvent,y=basis.data,s=y.DataObject,q=y.STATE,k=j(s,{event_change:u("change"),locked:!1,lockValue_:null,extendConstructor_:!1,updateCount:0,init:function(a,b,c){s.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy="function"==typeof c?c:
Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,b){var c=this.value,d=this.proxy?this.proxy(a):d,l=!1;if(d!==c)this.value=d,l=!0,this.updateCount+=1;!this.locked&&(l||b)&&this.event_change(d,c);return l},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=!0},unlock:function(){if(this.locked)this.locked=!1,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,b){return this.set(a,b)},reset:function(){this.set(this.initValue)},
destroy:function(){s.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),r={destroy:function(a){this.removeLink(a)}},v=function(a){g.insert(g.clear(this),a)},d=j(k,{links_:null,event_change:function(a,b){k.prototype.event_change.call(this,a,b);if(this.links_.length&&!n.globalDestroy)for(var c=0,d;d=this.links_[c++];)this.power_(d,b)},init:function(a,b,c){k.prototype.init.call(this,a,b,c);this.links_=[];n.add(this)},addLink:function(a,b,
c){if("object"!=typeof a&&!1==a instanceof Object)throw Error("basis.data.property: Link to undefined object ignored");null==b&&(b=e(a));"function"!=typeof c&&(c=m(Function.$self,c));b={object:a,format:c,field:b,isEventObject:a instanceof w};this.links_.push(b);b.isEventObject&&a.addHandler(r,this);this.power_(b);return a},addLinkShortcut:function(a,b,c){return this.addLink(a,d.shortcut[b],c)},removeLink:function(a,b){if(null!=this.links_){var c=2>arguments.length;!c&&null==b&&(b=e(a));for(var d=
0,l=0,i;i=this.links_[l];l++)i.object===a&&(c||b==i.field)?i.isEventObject&&i.object.removeHandler(r,this):this.links_[d++]=i;this.links_.length=d}},clear:function(){for(var a=0,b;b=this.links_[a];a++)b.isEventObject&&b.object.removeHandler(r,this);this.links_.clear()},power_:function(a,b){var c=a.field;if(null!=c){var d=a.format(this.value),l=a.object;"function"==typeof c?c.call(l,d,2>arguments.length?d:a.format(b)):l[c]=d}},destroy:function(){this.clear();k.prototype.destroy.call(this);this.links_=
null;n.remove(this)}});d.shortcut={className:function(a,b){o(this).replace(b,a)},show:function(a){g.display(this,!!a)},hide:function(a){g.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var b=[q.READY,q.DEPRECATED,q.UNDEFINED,q.ERROR,q.PROCESSING],c={stateChanged:function(){this.fire(!1,!0)},update:function(){this.fire(!0)},change:function(){this.fire(!0)},destroy:function(a){this.remove(a)}},j=j(d,{calculateValue:function(){return this.value+1},objects:[],
timer_:null,valueChanged_:!1,stateChanged_:!0,state:q.UNDEFINED,extendConstructor_:!0,init:function(){var a=this.handler;delete this.handler;d.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();n.add(this)},add:function(){for(var a=0,b=arguments.length;a<b;a++){var d=arguments[a];if(d instanceof s)this.objects.add(d)&&
d.addHandler(c,this);else throw Error("basis.data.property: Instance of DataObject required");}this.fire(!0,!0)},remove:function(a){this.objects.remove(a)&&a.removeHandler(c,this);this.fire(!0,!0)},clear:function(){for(var a=0,b;b=this.objects[a];a++)b.removeHandler(c,this);this.objects.clear();this.fire(!0,!0)},fire:function(a,b){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=
!0,t.add(this,"update",Date.now())},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},update:function(){delete this.timer_;t.remove(this,"update");if(!n.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var a=this.objects.length;if(a){for(var c=-2,d,k=0;k<a;k++){var l=this.objects[k],i=b.indexOf(""+l.state);i>c&&(d=l,c=i)}d&&this.setState(d.state,d.state.data)}else this.setState(q.UNDEFINED)}this.stateChanged_=this.valueChanged_=!1},destroy:function(){this.lock();
this.clear();t.remove(this,"update");d.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:j,AbstractProperty:k,Property:d,PropertySet:j})})();
(function(e){function j(e,g){var j=Date.now()-e;return j>=g?1:j/g}var g=e.Class,n=e.dom,m=e.data.property.Property,o=e.EventObject.createEvent,w=g(m,{duration:1E3,interval:50,startTime:0,timer:null,started:!1,event_start:o("start"),event_finish:o("finish"),event_invert:o("invert"),event_change:function(e,g){0==e&&this.event_start();m.prototype.event_change.call(this,e,g);1==e&&this.event_finish()},extendConstructor_:!0,init:function(e){this.run=this.run.bind(this);m.prototype.init.call(this,e)},start:function(e){this.started?
e&&this.invert():(this.startTime=Date.now(),this.started=!0,this.run())},run:function(){clearTimeout(this.timer);if(this.started){var e=j(this.startTime,this.duration);1<=e?this.stop():(this.set(e),this.timer=setTimeout(this.run,this.interval))}},invert:function(){this.event_invert();if(this.started){var e=j(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-e);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started)this.started=!1,this.set(1)},destroy:function(){this.stop();
this.clear();m.prototype.destroy.call()}}),t=g(null,{thread:null,setter:Function.$null,notRevert:!1,timeFunction:Function.$self,init:function(e,g,j,q,k){this.thread=e instanceof w?e:new w(e);this.setRange(j,q);this.setter=g;this.notInvert=k;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(k){this.setter(this.start+this.range*this.timeFunction(k))},finish:function(){this.notInvert||(this.start+=this.range,this.range*=-1)},destroy:this.destroy},
this)},setRange:function(e,g){this.start=e;this.range=g-e},destroy:function(){delete this.thread}});e.namespace("basis.animation").extend({Thread:w,Modificator:t,FX:{CSS:{FadeIn:function(e,g){return new t(e,function(e){n.setStyle(g,{opacity:e})},0,1)},FadeOut:function(e,g){return new t(e,function(e){n.setStyle(g,{opacity:e})},1,0)}}}})})(basis);
(function(e){function j(a,b,d){return d?c?a.createElementNS(d,b):a.createNode(1,b,d):a.createElement(b)}function g(a,b,d,e){a=d?c?a.createAttributeNS(d,b):a.createNode(2,b,d):a.createAttribute(b);a.nodeValue=e;return a}function n(a,b){return a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b)}function m(a,b,c){n(a,g(a.ownerDocument,d.PREFIX+(b?":"+b:""),d.NAMESPACE,c))}function o(a,b){return a.createTextNode(""+b)}function w(a,b){var c=a.nodeType,d=a.attributes,l=a.firstChild;if(l){if(l.nodeType!=
q&&l===a.lastChild)return l.nodeValue}else{var i=d&&d[0];if(c==q){if(!i)return"";if(1==d.length&&(i.baseName||i.localName)==v&&i.namespaceURI==r)return null}else if(!i)return null}var c={},i=[],e=0,k,g,j;if(l){do e=i.push(l);while(l=l.nextSibling)}if(d)for(l=0;j=d[l];l++)i.push(j);b||(b={});for(var l=0,m;m=i[l];l++){d=m.nodeName;k=l<e;j=b[d];if(k)k=w(m,b);else{if("xmlns"==d)continue;k=m.nodeValue}for(;j;)if(j.storeName&&(k[j.storeName]=d),j.rename)d=j.rename,j=b[d];else{j.format&&(k=j.format(k));
!c[d]&&j.forceArray&&(k=[k]);break}d in c?(g=c[d])&&g.push?g.push(k):c[d]=[g,k]:c[d]=k}return c}function t(a,b,c,e){if("@"==(""+b).charAt(0))return null==e?e:g(a,b.substr(1),"",""+e);b=j(a,b.toString(),e&&e.xmlns||b.namespace||c);if("undefined"==typeof e||null===e)n(b,g(a,v,r,"true"));else if("string"==typeof e||"number"==typeof e||"function"==typeof e||"boolean"==typeof e||e.constructor===Date||e.constructor===RegExp)b.appendChild(o(a,e));else{c=e.xmlns||c;e.xmlns&&d.BAD_SUPPORT&&m(b,"",c);for(var l in e){var i=
e[l];if(!("xmlns"==l||"function"==typeof i))if(i&&Array.isArray(i))for(var p=0;p<i.length;p++)b.appendChild(t(a,l,c,i[p]));else i&&"object"==typeof i&&i.toString!==Object.prototype.toString&&(i=i.toString()),(i=t(a,l,c,i))&&(i.nodeType==k?n(b,i):b.appendChild(i))}}return b}var u=e.dom,y=e.Class,s=e.ua,q=u.ELEMENT_NODE,k=u.ATTRIBUTE_NODE,y=y(null,{init:function(a,b,c){this.localpart=a;this.namespace=b||"";this.prefix=c||""},toString:function(){return this.prefix?this.prefix+":"+this.localpart:this.localpart}}),
r="http://www.w3.org/2001/XMLSchema-instance",v="nil",d={PREFIX:"xmlns",NAMESPACE:"http://www.w3.org/2000/xmlns/",BAD_SUPPORT:s.test("webkit528.16-")||s.test("opera9-")},b="native",c=!0,s=function(){var a=document.implementation;if(a&&a.createDocument)return function(b,c){var f=a.createDocument(b,c,null);if(f.charset&&f.charset!=document.charset)f.charset=document.charset;return f};if(window.ActiveXObject)for(var f=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],d=0;d<f.length;d++)try{if(new ActiveXObject(f[d]))return b=
f[d],c=!1,function(a,c){var f=new ActiveXObject(b);f.documentElement=j(f,c,a);return f}}catch(e){}throw Error("Browser doesn't support for XML document!");}();e.namespace("basis.xml").extend({NAMESPACE:{XMLShema:"http://www.w3.org/2001/XMLSchema",XMLShemaInstance:r,Namespace:"http://www.w3.org/2000/xmlns/"},XMLNS:d,QName:y,getElementsByTagNameNS:function(a,b,c){if(a.getElementsByTagNameNS)return a.getElementsByTagNameNS(c,b);var d=[];a.ownerDocument.setProperty("SelectionNamespaces",'xmlns:x="'+c+
'"');for(var a=a.selectNodes("//x:"+b),b=0,l;l=a[b++];)l.namespaceURI==c&&d.push(l);return d},addNamespace:m,createDocument:s,createElementNS:j,createAttributeNS:g,setAttributeNodeNS:n,createText:o,createCDATA:function(a,b){return a.createCDATASection(b)},XML2Object:w,XML2String:function(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if("string"==typeof a.xml)return a.xml;if(a.nodeType==u.DOCUMENT_NODE)a=a.documentElement;return u.outerHTML(a)},Object2XML:t})})(basis);
(function(e){function j(e,g){return e<<g|e>>>32-g}function g(e){var g=[];do g.push((e&15).toString(16)),e>>=4;while(e);g.length&1&&g.push("0");return g.reverse().join("")}function n(e){if("number"==typeof e)return g(e);var j=[],j=Array.isArray(e)?e.map(n):(""+e).toArray().map(function(e){return g(e.charCodeAt(0))});return j.join("")}e.namespace("basis.crypt",function(e){s=e||"";return q});var m=Array.create(255,function(e){return String.fromCharCode(e)}),o=function(){function k(e){for(var d="",b=
e.length,c=0;c<b;c++)var a=e.charCodeAt(c),d=128>a?d+m[a]:2048>a?d+(m[a>>6|192]+m[a&63|128]):d+(m[a>>12|224]+m[a>>6&63|128]+m[a&63|128]);return d}function g(e){for(var d="",b=e.length,c,a,f,h=0;h<b;)c=e.charCodeAt(h++),128>c?d+=m[c]:(a=e.charCodeAt(h++),c&32?(f=e.charCodeAt(h++),d+=String.fromCharCode((c&15)<<12|(a&63)<<6|f&63)):d+=String.fromCharCode((c&31)<<6|a&63));return d}return e.namespace("basis.crypt.UTF16").extend({toBytes:function(e){for(var d=[],b=e.length,c=0;c<b;c++){var a=e.charCodeAt(c);
d.push(a&255,a>>8)}return d},fromBytes:function(e){for(var d="",b=e.length,c,a,f=0;f<b;)c=e[f++]||0,a=e[f++]||0,d+=String.fromCharCode(a<<8|c);return d},toUTF8:k,fromUTF8:g,toUTF8Bytes:function(e){return w.toBytes(k(e))},fromUTF8Bytes:function(e){return g(w.fromBytes(e))}})}(),w=function(){return e.namespace("basis.crypt.UTF8").extend({toBytes:function(e){for(var g=e.length,j=Array(g),d=0;d<g;d++)j[d]=e.charCodeAt(d);return j},fromBytes:function(e){for(var g=e.length,j="",d=0;d<g;d++)j+=m[e[d]];return j},
toUTF16:function(e){return o.fromUTF8(e)},fromUTF16:function(e){return o.toUTF8(e)},toUTF16Bytes:function(e){return o.toBytes(o.fromUTF8(e))},fromUTF16Bytes:function(e){return o.toUTF8(o.fromBytes(e))}})}(),t=function(){var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),g={};k.forEach(function(e,d){g[e]=d});return e.namespace("basis.crypt.Base64").extend({encode:function(e,d){e.constructor!=Array&&(e=d?o.toUTF8Bytes(e):o.toBytes(e));for(var b=e.length,c=0,a="",f,h,
x,l,i,p;c<b;)f=e[c++],h=e[c++],x=e[c++],l=f>>2,f=(f&3)<<4|h>>4,i=(h&15)<<2|x>>6,p=x&63,void 0==h?i=p=64:void 0==x&&(p=64),a+=k[l]+k[f]+k[i]+k[p];return a},decode:function(e,d){for(var b=[],c,a,f,h,k,l=0,e=e.replace(/[^a-z0-9\+\/]/ig,""),i=e.length;l<i;)c=g[e.charAt(l++)],a=g[e.charAt(l++)],h=g[e.charAt(l++)],k=g[e.charAt(l++)],c=c<<2|a>>4,a=(a&15)<<4|h>>2,f=(h&3)<<6|k,b.push(c,a,f);(null==h||64==h)&&b.pop();(null==k||64==k)&&b.pop();return d?o.fromUTF8Bytes(b):o.fromBytes(b)}})}(),u=function(){function e(d){for(var b=
[],c=3;0<=c;c--)b.push(d>>8*c&255);return b}var g=[1518500249,1859775393,2400959708,3395469782],q=[function(d,b,c){return c^d&(b^c)},function(d,b,c){return d^b^c},function(d,b,c){return d&b|c&(d|b)},function(d,b,c){return b^d^c}];return function(d,b){d.constructor!=Array&&(d=b?o.toUTF8Bytes(d):o.toBytes(d));for(var c=d.length,a=[],f=0;f<c;f++)a[f>>2]|=d[f]<<(3-(f&3)<<3);a[c>>2]=c&3?a[c>>2]|Math.pow(2,(4-(c&3)<<3)-1):2147483648;a.push.apply(a,Array.create((14<(a.length&15)?30:14)-(a.length&15),0));
a.push(c>>>29);a.push(c<<3&4294967295);a.reverse();for(var c=[1732584193,4023233417,2562383102,271733878,3285377520],h=Array.from(c),x,l=a.length>>4,i=Array(80);l--;){for(f=0;16>f;f++)i[f]=a.pop();for(f=16;80>f;f++)i[f]=j(i[f-3]^i[f-8]^i[f-14]^i[f-16],1);for(f=0;80>f;f++)x=Math.floor(f/20),c[4]=j(c[0],5)+q[x](c[1],c[2],c[3])+c[4]+i[f]+g[x]&4294967295,c[1]=j(c[1],30),c.unshift(c.pop());for(f=0;5>f;f++)c[f]=h[f]=c[f]+h[f]&4294967295}return c.map(e).flatten()}}(),y=function(){function e(a){for(var b=
arguments,c=b.length,d=a&65535,i=a>>16,k=1;k<c;k++)var g=b[k],d=d+(g&65535),i=i+((g>>16)+(d>>16)),d=d&65535;return i<<16|d&65535}function g(a){for(var b=[],c=0;4>c;c++)b.push(a>>8*c&255);return b}var q=Math.pow(2,32),d,b=[],c=[],a=[function(a,b,c){return c^a&(b^c)},function(a,b,c){return b^c&(b^a)},function(a,b,c){return a^b^c},function(a,b,c){return b^(a|~c)}];return function(f,h){if(!d){d=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var x=
0;64>x;x++)switch(b[x]=Math.floor(Math.abs(Math.sin(x+1))*q),x>>4){case 0:c[x]=x;break;case 1:c[x]=5*x+1&15;break;case 2:c[x]=3*x+5&15;break;case 3:c[x]=7*x&15}}f.constructor!=Array&&(f=h?o.toUTF8Bytes(f):o.toBytes(f));for(var x=[],l=f.length,i=0;i<l;i++)x[i>>2]|=f[i]<<((i&3)<<3);x[l>>2]|=128<<((l&3)<<3);x.push.apply(x,Array((14<(x.length&15)?30:14)-(x.length&15)));x.push(l<<3&4294967295);x.push(l>>>29);for(var l=[1732584193,4023233417,2562383102,271733878],p=Array.from(l),z=x.length>>4;z--;){for(i=
0;64>i;i++)l[0]=e(j(e(l[0],a[i>>4](l[1],l[2],l[3]),x[c[i]],b[i]),d[i]),l[1]),l.unshift(l.pop());for(i=0;4>i;i++)l[i]=p[i]=e(l[i],p[i])}return l.map(g).flatten()}}(),s="",q={};Object.iterate({sha1:function(e){return u(this,e)},sha1hex:function(e){return n(u(this,e))},md5:function(e){return y(this,e)},md5hex:function(e){return n(y(this,e))},base64:function(e){return t.encode(this,e)},base64decode:function(e){return t.encode(this,e)},hex:function(){return n(this)}},function(e,g){q[e]=function(e){e=g.call(s,
e);return s=Object.extend("object"!=typeof e?Object(e):e,q)}});e.namespace("basis.crypt").extend({HEX:n,SHA1:u,MD5:y})})(basis);
(function(){function e(b,c){var a={},f;if(b&&b.length)f=a.inserted=b;if(c&&c.length)f=a.deleted=c;if(f)return a}var j=basis.Class,g=Object.extend,n=Function.$self,m=Function.$true,o=Function.$false,w=basis.EventObject.createEvent,t=basis.data.Subscription,u=basis.data.DataObject,y=basis.data.KeyObjectMap,s=basis.data.AbstractDataset,q=basis.data.Dataset;Subscription.regType("SOURCE",{sourceChanged:function(b,c){this.remove(b,c);this.add(b,b.source)},sourcesChanged:function(b,c){var a;if(a=c.inserted)for(var f=
a.length;0<f--;)this.add(b,a[f]);if(a=c.deleted)for(f=a.length;0<f--;)this.remove(b,a[f])}},function(b,c){for(var a=c.sources||[c.source],f=0,d;d=a[f++];)b(c,d)});var k=j(s,{subscribeTo:t.SOURCE,event_sourcesChanged:w("sourcesChanged","dataset","delta"),sources:null,rule:function(b){return 0<b},listen:{source:{datasetChanged:function(b,c){var a=this.memberMap_,f={},d,e;if(c.inserted)for(var l=0;d=c.inserted[l];l++)e=d.eventObjectId,a[e]?a[e].count++:a[e]={count:1,object:d},f[e]=a[e];if(c.deleted)for(l=
0;d=c.deleted[l];l++)e=d.eventObjectId,f[e]=a[e],a[e].count--;this.applyRule(f)},destroy:function(b){this.removeSource(b)}}},init:function(b){s.prototype.init.call(this,b);b=this.sources;this.sources=[];b&&b.forEach(this.addSource,this)},setRule:function(b){if("function"!=typeof b)b=k.UNION;if(this.rule!==b)this.rule=b,this.applyRule()},applyRule:function(b){var c=this.memberMap_,a=this.rule,d=this.sources.length,h=[],k=[],l,i,p;b||(b=c);for(var g in b)l=c[g],i=d&&l.count&&a(l.count,d),i!=!!this.item_[g]&&
(i?h:k).push(l.object),0==l.count&&delete c[g];(p=e(h,k))&&this.event_datasetChanged(this,p)},addSource:function(b){if(b instanceof s&&this.sources.add(b)){b.addHandler(this.listen.source,this);var c=this.memberMap_,a;for(a in b.item_)c[a]?c[a].count++:c[a]={count:1,object:b.item_[a]};this.applyRule();this.event_sourcesChanged(this,{inserted:[b]});return!0}},removeSource:function(b){if(this.sources.remove(b)){b.removeHandler(this.listen.source,this);var c=this.memberMap_,a;for(a in b.item_)c[a].count--;
this.applyRule();this.event_sourcesChanged(this,{deleted:[b]});return!0}},setSources:function(b){for(var c=Array.from(this.sources),a=0,d;d=b[a];a++)d instanceof s&&(c.remove(d)||this.addSource(d));c.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){s.prototype.destroy.call(this);this.sources=null}});k.UNION=k.prototype.rule;k.INTERSECTION=function(b,c){return b==c};k.DIFFERENCE=function(b){return 1==b};k.MORE_THAN_ONE_INCLUDE=
function(b,c){return 1==c||1<b};k.AT_LEAST_ONE_EXCLUDE=function(b,c){return 1==c||b<c};var r=function(b){return!this.has(b)};t.regType("MINUEND",{operandsChanged:function(b,c){this.minuend!==c&&(this.remove(b,c),this.add(b,b.minuend))}},function(b,c){b(c,c.minuend)});t.regType("SUBTRAHEND",{operandsChanged:function(b,c,a){this.subtrahend!==a&&(this.remove(b,a),this.add(b,b.subtrahend))}},function(b,c){b(c,c.subtrahend)});var v=j(s,{subscribeTo:t.MINUEND+t.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:w("operandsChanged",
"dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(b,c){if(this.subtrahend){var a=e(c.inserted&&c.inserted.filter(r,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(b,c){if(this.minuend){var a=e(c.deleted&&c.deleted.filter(r,this),c.inserted&&c.inserted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(this.minuend,
null)}}},init:function(b){s.prototype.init.call(this,b);var b=this.minuend,c=this.subtrahend;this.subtrahend=this.minuend=null;(b||c)&&this.setOperands(b,c)},setOperands:function(b,c){var a,d=!1;!1==b instanceof s&&(b=null);!1==c instanceof s&&(c=null);var h=this.minuend,k=this.subtrahend;if(h!==b)d=!0,h&&h.removeHandler(this.listen.minuend,this),(this.minuend=b)&&b.addHandler(this.listen.minuend,this);if(k!==c)d=!0,k&&k.removeHandler(this.listen.subtrahend,this),(this.subtrahend=c)&&c.addHandler(this.listen.subtrahend,
this);if(!d)return!1;this.event_operandsChanged(this,h,k);if(!b||!c)this.itemCount&&this.event_datasetChanged(this,a={deleted:this.getItems()});else{var d=[],h=[],l;for(l in this.item_)(!b.item_[l]||c.item_[l])&&d.push(this.item_[l]);for(l in b.item_)!this.item_[l]&&!c.item_[l]&&h.push(b.item_[l]);(a=e(h,d))&&this.event_datasetChanged(this,a)}return a},clear:function(){this.setOperands()}}),d=j(s,{subscribeTo:t.SOURCE,source:null,event_sourceChanged:w("sourceChanged","dataset","oldSource"),map:n,
reduce:o,rule:o,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:{update:function(b){var c=this.map?this.map(b):b;if(!1==c instanceof u||this.reduce(c))c=null;var a=this.sourceMap_[b.eventObjectId],d=a.member;if(d!=c){var h=this.memberMap_,k,l,i;a.member=c;if(d)a=d.eventObjectId,this.removeMemberRef&&this.removeMemberRef(d,b),0==--h[a]&&(delete h[a],i=[d]);if(c)d=c.eventObjectId,this.addMemberRef&&this.addMemberRef(c,b),h[d]?h[d]++:(h[d]=1,l=[c]);(k=e(l,i))&&this.event_datasetChanged(this,
k)}}},source:{datasetChanged:function(b,c){var a=this.sourceMap_,d=this.memberMap_,h=[],k=[],l,i,p;q.setAccumulateState(!0);if(c.inserted)for(var g=0;l=c.inserted[g];g++){p=this.map?this.map(l):l;if(!1==p instanceof u||this.reduce(p))p=null;l.addHandler(this.listen.sourceObject,this);a[l.eventObjectId]={sourceObject:l,member:p};if(p)i=p.eventObjectId,d[i]?d[i]++:(d[i]=1,h.push(p)),this.addMemberRef&&this.addMemberRef(p,l)}if(c.deleted)for(g=0;l=c.deleted[g];g++)if(i=l.eventObjectId,p=a[i].member,
l.removeHandler(this.listen.sourceObject,this),delete a[i],p)i=p.eventObjectId,0==--d[i]&&(delete d[i],k.push(p)),this.removeMemberRef&&this.removeMemberRef(p,l);q.setAccumulateState(!1);(c=e(h,k))&&this.event_datasetChanged(this,c)},destroy:function(){this.setSource()}}},init:function(b){s.prototype.init.call(this,b);this.sourceMap_={};if(b=this.source)this.source=null,this.setSource(b)},setRule:function(b){"function"!=typeof b&&(b=m);if(this.rule!==b)return this.rule=b,this.applyRule()},setMap:function(b){"function"!=
typeof b&&(b=n);if(this.map!==b)return this.map=b,this.applyRule()},setSource:function(b){!1==b instanceof s&&(b=null);if(this.source!==b){var c=this.source;c&&(c.removeHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,c,{deleted:c.getItems()}));if(this.source=b)b.addHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,b,{inserted:b.getItems()});this.event_sourceChanged(this,c)}},applyRule:function(){var b=this.sourceMap_,c=this.memberMap_,a,d,h,
k,l,i=[],p=[],g,j;for(j in b){l=b[j];k=l.sourceObject;a=l.member;d=this.map?this.map(k):k;if(!1==d instanceof u||this.reduce(d))d=null;if(a!=d){l.member=d;if(a)h=a.eventObjectId,this.removeMemberRef&&this.removeMemberRef(a,k),c[h]--;if(d)a=d.eventObjectId,this.addMemberRef&&this.addMemberRef(d,k),a in c?c[a]++:(c[a]=1,i.push(d))}}for(h in this.item_)0==c[h]&&(delete c[h],p.push(this.item_[h]));(g=e(i,p))&&this.event_datasetChanged(this,g);return g},clear:function(){this.setSource()},destroy:function(){s.prototype.destroy.call(this);
this.sourceMap_=null}}),o=j(d,{reduce:function(b){return!this.rule(b)},rule:m}),j=j(d,{map:function(b){return this.keyMap.resolve(b)},rule:m,subsetClass:s,keyMap:null,addMemberRef:function(b,c){b.event_datasetChanged(b,{inserted:[c]})},removeMemberRef:function(b,c){b.event_datasetChanged(b,{deleted:[c]})},init:function(b){if(!this.keyMap||!1==this.keyMap instanceof y)this.keyMap=new y(g({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));d.prototype.init.call(this,b)},getSubset:function(b,
c){return this.keyMap.get(b,c)},destroy:function(){d.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:k,Subtract:v,MapReduce:d,Subset:o,Split:j})})(basis,this);
(function(e){function j(a,b){if(!a.length)return 0;var c,d,f=0,h=a.length-1;do if(c=f+h>>1,d=a[c]||0,b<d)h=c-1;else if(b>d)f=c+1;else return b==d?c:0;while(f<=h);return c+(d<b)}function g(a,b){if(!a.length)return 0;var c,d,f,h=0,e=a.length-1;do if(c=h+e>>1,f=a[c].value||0,f===d?(f=a[c].object.eventObjectId,d=b.object.eventObjectId):d=b.value||0,d<f)e=c-1;else if(d>f)h=c+1;else return d==f?c:0;while(h<=e);return c+(f<d)}function n(){for(var a=Object.slice(this.item_),b=this.index_.slice(this.offset,
this.offset+this.limit),c=[],d,f=0,h;h=b[f];f++){var e=h.object.eventObjectId;a[e]?delete a[e]:c.push(h.object)}(d=getDelta(c,values(a)))&&q.prototype.event_datasetChanged.call(this,this,d)}function m(a,b){var a=Function.getter(a),c=b+"_"+a.getterIdx_,d=v[c];if(!d)d=v[c]=this,this.indexType=b,this.indexClass=r[b],this.getter=a,this.key=c,this.createInstance=function(a){if(a instanceof q){var b=a.indexes&&a.indexes[this.key];if(!b)b=new this.indexClass(this.getter),b.addHandler(l,a),b.key=this.key;
return b}};return d}function o(a,b,c){var d=a.indexCache_;a.lock();if(b)for(var f=0,h;h=b[f++];){var e=a.valueGetter(h);d[h.eventObjectId]=e;a.add(h,e)}if(c)for(f=0;h=c[f++];)a.remove(h,d[h.eventObjectId]),delete d[h.eventObjectId];a.unlock()}var w=e.Class,t=e.TimeEventManager,u=e.data,y=u.KeyObjectMap,s=u.property.Property,q=u.AbstractDataset,k=u.dataset.MapReduce,u=w(q,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(a,b){var c;if(c=b.inserted)for(var d=0;d<
c.length;d++){var f=c[d],f={value:this.valueGetter(f),object:f},h=g(this.index_,f);this.index_.splice(h,0,f)}if(c=b.deleted)for(d=0;d<c.length;d++)f=c[d],f={value:this.valueGetter(f),object:f},h=g(this.index_,f),this.index_.splice(h,1);n.call(this)},init:function(a){this.index_=[];q.prototype.init.call(this,a)},setRange:function(a,b){this.offset=a;this.limit=b;n.call(this)}}),r=w(s,{autoDestroy:!0,valueGetter:Function.$null,dataSource:null,init:function(a){s.prototype.init.call(this,this.value||0);
this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},upd:function(){}});r.Sum=w(r,{add:function(a,b){this.value+=b},remove:function(a,b){this.value-=b},upd:function(a,b,c){this.set(this.value+b-c)}});r.Avg=w(r,{sum_:0,count_:0,add:function(a,b){this.sum_+=b;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,b){this.sum_-=b;this.value=(this.count_-=1)?this.sum_/this.count_:0},upd:function(a,b,c){this.sum_+=b-c;this.set(this.sum_/this.count_)}});r.Count=w(r,{valueGetter:Function.$true,
add:function(a,b){b&&(this.value+=1)},remove:function(a,b){b&&(this.value-=1)},upd:function(a,b){this.set(this.value+(b?1:-1))}});r.Max=w(r,{init:function(a,b){this.stack=[];r.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(j(this.stack,b),0,b);this.value=this.stack[this.stack.length-1]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[this.stack.length-1]},upd:function(a,b,c){this.stack.splice(j(this.stack,c),1);this.stack.splice(j(this.stack,b),0,b);this.set(this.stack[this.stack.length-
1])}});r.Min=w(r,{init:function(a,b){this.stack=[];r.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(j(this.stack,b),0,b);this.value=this.stack[0]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[0]},upd:function(a,b,c){this.stack.splice(j(this.stack,c),1);this.stack.splice(j(this.stack,b),0,b);this.set(this.stack[0])}});var v={},d=function(a){return function(b){return new m(b,a)}},b=d("Sum"),c=d("Avg"),a=d("Count"),f=d("Min"),d=d("Max"),h={update:function(a){var b,
c,d,f=a.eventObjectId,h;for(h in this.indexes)d=this.indexes[h],b=d.indexCache_[f],c=d.valueGetter(a),c!==b&&(d.upd(a,c,b),d.indexCache_[f]=c)}},x={datasetChanged:function(a,b){if(b.inserted)for(var c=0;a=b.inserted[c++];)a.addHandler(h,this);if(b.deleted)for(c=0;a=b.deleted[c++];)a.removeHandler(h,this);for(var d in this.indexes)o(this.indexes[d],b.inserted,b.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},l={destroy:function(a){this.removeIndex(a)}};q.prototype.createIndex=
function(a){if(!1!=a instanceof m){if(!this.indexes)this.indexes={},this.addHandler(x),x.datasetChanged.call(this,this,{inserted:this.getItems()});var b=a.key;this.indexes[b]||(a=a.createInstance(this),this.indexes[b]=a,o(a,this.getItems()));return this.indexes[b]}};q.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var b in this.indexes)return;this.removeHandler(x);delete this.indexes}};w=w(k,{calcs:null,indexes:null,indexes_:null,
timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,b){k.prototype.event_sourceChanged.call(this,a,b);var c,d;for(d in this.indexes_)c=this.indexes_[d],b&&(this.removeIndex(d),b.removeIndex(this.indexes[d])),this.source&&this.addIndex(d,this.source.createIndex(c))},listen:{sourceObject:{update:function(a,b){k.prototype.listen.sourceObject.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=!0;this.fireUpdate()}},index:{change:function(a){var b=
this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=!0;b.fireUpdate()}},member:{subscribersChanged:function(a,b){0<a.subscriberCount&&0==b&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,!0)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=b.eventObjectId;a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=!0;0<a.subscriberCount&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];a.removeHandler(this.listen.member,
this)},init:function(a){this.indexUpdated=!1;this.indexesBind_={};this.memberSourceMap={};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||!1==this.keyMap instanceof y)this.keyMap=new y(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));k.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof m){if(this.indexes_[a])return;this.indexes_[a]=
b;b=this.source&&this.source.createIndex(b)}if(b instanceof r)this.indexValues[a]=b.value,this.indexes[a]=b,this.indexesBind_[a]={key:a,indexMap:this},b.addHandler(this.listen.index,this.indexesBind_[a]),this.listen.index.change.call(this.indexesBind_[a],b.value)}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},
addCalc:function(a,b){this.calcs[a]=b;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=!0,t.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=!1},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=!1;var c={},d,f,h;for(h in this.calcs)if(d=this.calcs[h](b.sourceObject.data,this.indexValues),a.data[h]!==d&&(!isNaN(d)||!isNaN(a.data[h])))c[h]=d,f=!0;f&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,!0)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);k.prototype.destroy.call(this)}});
e.namespace("basis.data.index").extend({IndexedDataset:u,IndexConstructor:m,Index:r,Sum:b,Avg:c,Count:a,Max:d,Min:f,IndexMap:w})})(basis);
(function(e){function j(a){i[a]=i[a]||0;return a+i[a]++}function g(){var a=Array.from(arguments),b=a.pop();"function"!=typeof b&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],d=[],f=0,h;f<a.length;f++)h=a[f].quote('"'),c.push(h+" in delta"),d.push("data["+h+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+d.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
!0;return b}function n(){return g.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;0<b--;){if(null==arguments[b])return null;a.push(arguments[b])}return a.join("-")}))}var m=e.Class,o=e.Cleaner,w=Object.extend,t=Function.$self,u=Function.getter,y=e.data,s=e.EventObject,q=y.Dataset,k=y.dataset.Subset,r=y.dataset.Split,v=y.DataObject,d=y.STATE,b={},c={string:1,number:1},a=[],f=function(a){return isNaN(a)?null:Number(a)},h=function(a){return isNaN(a)?null:Number(a)},
x=function(a){return isNaN(a)?null:parseInt(a)},l=function(a){return null==a?null:""+a},i={},p=e.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,d){var f=a(c,d);return f!==d&&b[f]?d:f};this.calcWrapper=function(c,d){var f=a(c,d);if(f!==d&&b[f])throw"Duplicate value for index "+d+" => "+c;return f};o.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=this.index[a];if(b&&(!c||c===b))return this.index[a]=
b,!0},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],!0},destroy:function(){this.index=null}}),y=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},z=function(a,b){return function(c){if(!this.name)this.name=j(b);a.prototype.init.call(this,c)}},A=function(a){return function(b,c){q.setAccumulateState(!0);b=(b||[]).map(this.wrapper);q.setAccumulateState(!1);return a.prototype.sync.call(this,b,c)}},C=m(q,{wrapper:Function.$self,init:z(q,"EntitySet"),
sync:A(q),set:y(q,"set"),add:y(q,"add"),remove:y(q,"remove"),destroy:function(){q.prototype.destroy.call(this);delete this.wrapper}}),F=m(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),E=m(k,{init:z(k,"EntityCollection"),sync:A(k)});E.sourceHandler=k.sourceHandler;var B=m(r,{subsetClass:F,init:z(r,"EntityGrouping"),sync:A(r),getSubset:function(a,b){var c=r.prototype.getSubset.call(this,a,b);if(c)c.wrapper=this.wrapper;return c}}),D=function(a){if(this instanceof
D){var b=new H(a||t);return function(a,c){return null!=a?(c instanceof C||(c=b.createEntitySet()),c.set(a instanceof q?a.getItems():Array.from(a)),c):null}}};D.className="basis.entity.EntitySetWrapper";var H=m(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),I=function(a){if(this instanceof I){var b=function(a,b){if(null!=a){if(a===b||a.entityType===d)return a;var i,
l=d.idField;if(c[typeof a]){if(!l)return;i=a;a={};a[l]=i}else if(d.compositeKey)i=d.compositeKey(a,a);else if(l)i=a[l];else if(e&&(b=d.singleton,!b))return d.singleton=new h(a);null!=i&&f&&(b=f.get(i,d.entityClass));b&&b.entityType===d?b.update(a):b=new h(a);return b}return d.singleton},d=new M(a||{},b),f=d.index__,h=d.entityClass,e=d.isSingleton;w(b,{toString:function(){return this.typeName+"()"},entityType:d,type:b,typeName:d.name,index:f,reader:function(a){return d.reader(a)},get:function(a){return d.get(a)},
addField:function(a,b){d.addField(a,b)},all:d.all,createCollection:function(a,c,f){var h=d.collection_[a];return!h&&c?d.collection_[a]=new E({wrapper:b,source:f||d.all,rule:c}):h},getCollection:function(a){return d.collection_[a]},createGrouping:function(a,c,f){var h=d.grouping_[a];return!h&&c?d.grouping_[a]=new B({wrapper:b,source:f||d.all,rule:c}):h},getGrouping:function(a){return d.grouping_[a]},getSlot:function(a,b){return d.getSlot(a,b)}});return b}};I.className="basis.entity.EntityTypeWrapper";
var L=u("singleton"),G={};m(v,{});var M=m(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:!1,index__:null,slot_:null,init:function(b,c){this.name=b.name||j(this.name);this.index__=b.index;this.idFields={};a.push(this);this.isSingleton=b.isSingleton;this.wrapper=c;this.all=new F(Object.extend(b.all||{},{wrapper:c}));this.slot_={};if(b.extensible)this.extensible=!0;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(b.fields,this.addField,this);b.constrains&&
b.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=L;b.aliases&&Object.iterate(b.aliases,this.addAlias,this);this.collection_={};if(b.collections)for(var d in b.collections)this.collection_[d]=new E({name:d,wrapper:c,source:this.all,rule:b.collections[d]||Function.$true});this.grouping_={};if(b.groupings)for(d in b.groupings)this.grouping_[d]=new B({name:d,wrapper:c,source:this.all,rule:b.groupings[d]||Function.$true});this.entityClass=K(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:c,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(c[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||null==a)return null;for(var d in a){var f=d in this.aliases?this.aliases[d]:"";f&&f in this.fields&&(b[f]=this.fields[f].reader?this.fields[f].reader(a[d]):a[d])}return b},addAlias:function(a,b){b in this.fields&&!1==a in this.aliases&&(this.aliases[a]=b)},addField:function(a,
b){if(!this.all.itemCount){this.aliases[a]=a;"function"==typeof b&&(b={type:b});if("type"in b&&"function"!=typeof b.type)b.type=t;var c=b.type||t;if([f,h,x,l].has(c))b.id=!0;if(b.id){if(!this.index__)this.index__=new p(String);this.idFields[a]=!0;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=n.apply(null,Object.keys(this.idFields))):this.idField=a}b.calc?this.addCalcField(a,b.calc,void 0):this.fields[a]=c;this.defaults[a]="defValue"in b?b.defValue:c();this.getters["get_"+a]=
function(){return this.data[a]};G[a]||(G[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var d={args:b.args,wrapper:!c?b:function(a,d,f){return c(b(a,d,f))}},f=this.calcs.length,h=0,e=0;e<this.calcs.length;e++)b.args.has(this.calcs[e].key)&&(h=e+1);if(a){d.key=a;for(e=0;e<this.calcs.length;e++)if(this.calcs[e].args.has(a)){f=e;break}if(h>f)return;if(this.idField&&a==this.idField)this.compositeKey=b;this.fields[a]=function(a,
b){"undefined"!=typeof console&&console.log("Calculate fields are readonly");return b}}else f=h;this.calcs.splice(Math.min(f,h),0,d)}},get:function(a){a=this.getId(a);if(null!=a)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(c[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof v)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var d=
this.slot_[b];d||(c[typeof a]&&(d={},this.idField&&!this.compositeKey&&(d[this.idField]=a),a=d),d=this.slot_[b]=new v({delegate:this.get(b),data:a}));return d}}}),J=m(v,{init:s.prototype.init,event_rollbackUpdate:s.createEvent("rollbackUpdate")}),K=function(a,c,f,h,e,i,l){function k(b,c,d){var f=!1,h=a.calcs,e=b.__id__,i=b.data;try{if(h)for(var l=0,x;x=h[l++];){var p=x.key;if(p){var j=i[p];i[p]=x.wrapper(c,i,i[p]);i[p]!==j&&(c[p]=j,f=!0)}else x.wrapper(c,i)}if(a.compositeKey)b.__id__=a.compositeKey(c,
i,b.__id__);else if(B&&B in c)b.__id__=i[B];b.__id__!==e&&a.index__.calcWrapper(b.__id__)}catch(q){b.__id__=e;for(var m in c)b.data[m]=c[m];if(d)for(m in d)if(!b.modified)b.modified=d;f=!1}b.__id__!==e&&g(b,e,b.__id__);return f}function g(a,b,c){null!=b&&(f.remove(b,a),h[b]&&h[b].setDelegate());null!=c&&(f.add(c,a),h[c]&&h[c].setDelegate(a))}var B=a.idField;return m(J,l,{canHaveDelegate:!1,modified:null,isTarget:!0,extendConstructor_:!1,init:function(a){J.prototype.init.call(this);this.fieldHandlers_=
{};this.data={};this.root=this;this.target=this;var b,d={},f;for(f in e)f in a?(d[f]=i[f],b=e[f](a[f])):b=i[f],b&&b!==this&&b instanceof s&&b.addHandler(G[f],this)&&(this.fieldHandlers_[f]=!0),this.data[f]=b;k(this,d);c.event_datasetChanged(c,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(b,c,d,f){var h=e[b];if(!h){if(!a.extensible)return;h=t}var i,l=this.modified,c=h(c,this.data[b]),
h=this.data[b];if(c!==h&&(!c||!h||c.constructor!==Date||h.constructor!==Date||+c!==+h))a:{i={};if(b!=B)if(d){if(!l)this.modified=l={};if(!1===b in l)i.rollback={key:b,value:void 0},l[b]=h;else if(l[b]===c&&(i.rollback={key:b,value:c},delete l[b],!Object.keys(l).length))this.modified=null}else if(l&&b in l)if(l[b]!==c){i.rollback={key:b,value:l[b]};l[b]=c;break a}else return!1;this.data[b]=c;this.fieldHandlers_[b]&&(h.removeHandler(G[b],this),this.fieldHandlers_[b]=!1);c&&c!==this&&c instanceof s&&
c.addHandler(G[b],this)&&(this.fieldHandlers_[b]=!0);i.key=b;i.value=h;i.delta={};i.delta[b]=h}else if(!d&&l&&b in l&&(i={rollback:{key:b,value:l[b]}},delete l[b],!Object.keys(l).length))this.modified=null;if(!f&&i){var d=i.key,b=i.delta||{},g;if(i.rollback)g={},g[i.rollback.key]=i.rollback.value;k(this,b,g)&&(d=!0);if(d)this.event_update(this,b),i.delta=b;g&&this.event_rollbackUpdate(this,g)}return i||!1},update:function(a,b){if(a){var c,d={},f,h={},e,i;for(i in a)if(e=this.set(i,a[i],b,!0)){if(e.key)c=
!0,d[e.key]=e.value;if(e.rollback)f=!0,h[e.rollback.key]=e.rollback.value}k(this,d,h)&&(c=!0);c&&this.event_update(this,d);f&&this.event_rollbackUpdate(this,h)}return c?d:!1},reset:function(){this.update(i)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=d.PROCESSING){if(this.modified){var a=this.modified;
this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(d.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.data[a].removeHandler(G[a],this);this.fieldHandlers_=b;this.__id__&&g(this,this.__id__,null);v.prototype.destroy.call(this);c.event_datasetChanged(c,{deleted:[this]});this.data=b;this.modified=null}})};e.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof K},NumericId:f,NumberId:h,IntId:x,StringId:l,Index:p,CalculateField:g,
EntityType:I,Entity:K,BaseEntity:J,EntitySetType:D,EntitySet:C,ReadOnlyEntitySet:F,Collection:E,Grouping:B})})(basis);
(function(e){var j=e.Class,g=Object.extend,n=e.EventObject,m=n.createEvent;e.ua.Cookies.get("DEBUG_MODE");var o,w,t=!1,u={},y=Date.now,s=g(new n,{event_sessionOpen:m("sessionOpen"),event_sessionClose:m("sessionClose"),event_sessionFreeze:m("sessionFreeze"),event_sessionUnfreeze:m("sessionUnfreeze"),isOpened:function(){return!!o},getTimestamp:function(){if(o)return w},open:function(e,j){var m;u[e]||(u[e]=new q(e));m=u[e];o===m?t&&this.unfreeze():(this.close(),o=m,w=y(),j&&g(m.data,j),this.event_sessionOpen(this))},
close:function(){o&&(t&&this.unfreeze(),this.event_sessionClose(this),w=o=null)},freeze:function(){o&&!t&&(this.event_sessionFreeze(this),t=!0,w=null)},unfreeze:function(){o&&t&&(t=!1,w=y(),this.event_sessionUnfreeze(this))},storeData:function(e,g){if(o)return o.storeData(e,g);throw Error("No opened session");},getData:function(e){if(o)return o.getData(e);throw Error("No opened session");},destroy:function(){for(var e=Object.keys(u),g;g=e.pop();)u[g].destroy();n.prototype.destroy.call(this)}}),q=
j(n,{event_destroy:function(){o==this&&s.close();delete u[this.key]},extendConstructor_:!1,init:function(e){n.prototype.init.call(this);this.key=e;this.data={}},storeData:function(e,g){if(t)throw Error("Session is frozen");return this.data[e]=g},getData:function(e){if(t)throw Error("Session is frozen");return this.data[e]},destroy:function(){n.prototype.destroy.call(this);for(var e=Object.keys(this.data),g;g=e.pop();){var j=this.data[g];null!=j&&"function"==typeof j.destroy&&j.destroy();delete this.data[g]}}});
e.namespace("basis.session").extend({SessionManager:s})})(basis);
(function(e){function j(c){var a=e.EventObject.createEvent(c),d=[c];return function(){b.dispatch.apply(this,d.concat(arguments));a.apply(this,arguments)}}function g(b,a){var d={"JS-Framework":"Basis"};r.test(a.method)?(d["Content-Type"]=a.contentType+(a.encoding?";charset="+a.encoding:""),t.test("gecko")&&(d.Connection="close")):t.test("ie")&&(d["If-Modified-Since"]=(new Date(0)).toGMTString());Object.iterate(Object.extend(d,a.headers),function(a,b){null!=b&&this.setRequestHeader(a,b)},b)}function n(b){var a=
this.transport;if(a){if("number"!=typeof b)b=a.readyState;if(b!=this.prevReadyState_)if(this.prevReadyState_=b,this.event_readyStateChanged(b),4==b){y.remove(this,"timeoutAbort");var b=k.UNDEFINED,d;this.progress=!1;a.onreadystatechange=Function.$undef;if(this.aborted){var h=this.abortedByTimeout_;h&&this.event_timeout();this.event_abort(h)}else b=this.responseIsSuccess(),this.update({text:a.responseText,xml:a.responseXML}),b?(this.event_success(a),b=k.READY):(this.event_failure(a),b=k.ERROR,d=this.getRequestError(a)),
this.event_httpStatus(a,a.status);this.event_complete(a);this.setState(b,d)}else this.setState(k.PROCESSING)}}function m(b){y.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=!1;this.prevReadyState_=-1;if(t.test("gecko1.8.1-")&&b.asynchronous)this.transport=d();var a=this.transport;this.asynchronous?a.onreadystatechange=n.bind(this):n.call(this,0);a.open(b.method,b.location,b.asynchronous);this.progress=!0;this.abortedByTimeout_=this.aborted=!1;g(a,b);this.event_start();
if(this.aborted)n.call(this,4);else if(!this.aborted&&this.progress){this.requestStartTime=Date.now();y.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var f=b.postBody;if("POST"==b.method&&t.test("ie9-"))if("object"==typeof f&&"undefined"!=typeof f.documentElement&&"string"==typeof f.xml)f=f.xml;else if("string"==typeof f)f=f.replace(/\r/g,"");else if(null==f||""==f)f="[empty request]";a.send(f);return!0}}var o=e.Class,w=e.dom.event,t=e.ua,u=e.Cleaner,y=e.TimeEventManager,s=e.data,q=
s.DataObject,k=s.STATE,r=/POST/i,s=e.ua.Cookies.get("DEBUG_AJAX");(function(){for(var b=192;255>=b;b++)b.toHex(),String.fromCharCode(b+848),(b+848).toHex(),b.toHex()})();var v="native",d=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var b=window.ActiveXObject;if(b)for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],d=0;v=a[d];d++)try{if(new b(v))return function(){return new b(v)}}catch(h){}throw Error(v="Browser doesn't support for XMLHttpRequest!");
}(),b=function(){var b=[],a=[{handler:{start:function(){b.add(this)},complete:function(){b.remove(this)}}}];w.onUnload(function(){a.clear()});return{addHandler:function(b,c){for(var d=0,e;e=a[d];d++)if(e.handler===b&&e.thisObject===c)return!1;a.push({handler:b,thisObject:c});return!0},removeHandler:function(b,c){for(var d=0,e;e=a[d];d++)if(e.handler===b&&e.thisObject===c)return a.splice(d,1),!0;return!1},dispatch:function(b){if(a.length)for(var c=Array.prototype.slice.call(arguments,1),d,e,i=a.length-
1;d=a[i];i--)e=d.handler[b],"function"==typeof e&&e.apply(d.thisObject||this,c)},abort:function(){for(var a=Array.from(b),d=0;d<a.length;d++)a[d].abort();return a}}}(),o=o(q,{state:k.UNDEFINED,event_start:j("start"),event_readyStateChanged:j("readyStateChanged"),event_timeout:j("timeout"),event_abort:j("abort"),event_success:j("success"),event_failure:j("failure"),event_httpStatus:j("httpStatus"),event_complete:j("complete"),event_stateChanged:function(b,a){q.prototype.event_stateChanged.call(this,
b,a);for(var d=0;d<this.influence.length;d++)this.influence[d].setState(this.state,this.state.data)},influence:null,debug:s,progress:!1,aborted:!1,abortedByTimeout_:!1,abortCalled:!1,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:!0,method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(b){var a=this.influence;this.transport=d();this.requestHeaders={};this.influence=[];this.params={};a&&this.setInfluence.apply(this,a);u.add(this);q.prototype.init.call(this,
b);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var b=Array.from(arguments),a=0;a<b.length;a++)b[a].setState(this.state,this.state.data);this.influence.set(b)},clearInfluence:function(){this.influence.clear()},setParam:function(b,a){this.params[b]=a},setParams:function(b){this.clearParams();for(var a in b)this.setParam(a,b[a])},removeParam:function(b){delete this.params[b]},clearParams:function(){for(var b in this.params)delete this.params[b]},timeoutAbort:function(){this.abortedByTimeout_=
!0;this.abort()},abort:function(){this.aborted=!0;if(this.progress)y.remove(this,"timeoutAbort"),this.progress=!1,this.transport.abort(),this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==Function.$undef&&n.call(this,4)},request:function(b){var b=b||this.url,a=this.method.toUpperCase(),d,h;if(!this.transport)throw Error("Transport is not allowed");if(!b)throw Error("URL is not defined");this.abort();delete this.requestData_;this.update({responseText:"",responseXml:null});
this.abortedByTimeout_=this.aborted=this.progress=!1;d=Object.iterate(this.params,function(a,b){return null==b||b&&"function"==typeof b.toString&&null==b.toString()?null:a+"="+(""+b.toString()).replace(/[\%\=\&\<\>\s\+]/g,function(a){a=a.charCodeAt(0).toHex();return"%"+(2>a.length?"0":"")+a})}).filter(Function.$isNotNull).join("&");r.test(a)?h=this.postBody||d||"":d&&(b+=(-1==b.indexOf("?")?"?":"&")+d);this.requestData_={method:a,location:b,contentType:this.contentType,encoding:this.encoding,asynchronous:this.asynchronous,
headers:Object.extend({},this.requestHeaders),postBody:h};return m.call(this,this.requestData_)},repeat:function(){if(this.requestData_)return this.abort(),m.call(this,this.requestData_)},get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var b=this.transport.status;return void 0==b||0==b||200<=b&&300>this.transport.status}}catch(a){}return!1},getRequestError:function(b){return{code:"SERVER_ERROR",msg:b.responseText}},destroy:function(){this.destroy=
Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();q.prototype.destroy.call(this);delete this.transport;u.remove(this)}});e.namespace("basis.net.ajax").extend({Transport:o,TransportDispatcher:b,createEvent:j})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.net.ajax,m=e.xml,o=n.Transport,w=m.QName,t=m.addNamespace,u=m.XML2Object,y=m.Object2XML,s=m.createElementNS,q=m.NAMESPACE,k=j(null,{url:null,namespace:null,init:function(a,b){this.url=a;this.namespace=b},call:function(a,b){a=this.createMethodCall(a,b,!1);a.transport.abort();a.invoke(b.header,b.body,b.callback,b.mapping)},createMethodCall:function(a,b,c){return new r(this,new w(a,this.namespace),b,c)}}),r=j(null,{service:null,transport:null,method:null,envelope:null,
body:null,init:function(a,b,c,e){c=c||{};this.method=b;this.envelope=new d;this.url=a.url;this.transport=new v(b,c.callback);this.transport.requestHeaders={SOAPAction:b.namespace+(!/\/$/.test(b.namespace)?"/":"")+b};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return a.url}};c.mapping&&this.transport.setMapping(c.mapping);c.callback&&this.transport.setCallback(c.callback);if(e)this.body=c.body||{}},repeatCall:function(){this.transport.get()},
call:function(a){return this.invoke(null,a||this.body)},invoke:function(a,b,c,d){this.transport.abort();this.envelope.getBody(!0).setValue(this.method,b);a&&this.envelope.getHeader(!0).setValue(a,this.method.namespace);c&&this.transport.setCallback(c);d&&this.transport.setMapping(d);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),v=j(o,{callback:{},mapping:null,method:"POST",contentType:"text/xml",
encoding:"utf-8",event_success:function(a){var b=a.responseXML;if(void 0===b||void 0===b.documentElement)this.event_failure(this);else{var c=Array.from(arguments);b.xml&&DOMParser&&(b=(new DOMParser).parseFromString(b.xml,"text/xml"));this.responseEnvelope=new d(b.documentElement);c.push(this.getResponseData(),this.getRequestData());o.prototype.event_success.apply(this,c)}},event_failure:function(a){var b=Array.from(arguments),c=this.state.data||this.getRequestError(a);c.isSoapFailure&&this.event_soapfailure(a,
c.code,c.msg);b.push(c.code,c.msg);o.prototype.event_failure.apply(this,b)},event_soapfailure:n.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(a){return g.tag(a,"code")[0]},errorMessageGetter:function(a){return g.tag(a,"message")[0]},extendConstructor_:!1,init:function(a){o.prototype.init.call(this);this.soapMethod=a},setCallback:function(a){"object"==typeof a&&this.addHandler(a)},setMapping:function(a){this.mapping=a},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},
getResponseData:function(){var a=this.responseEnvelope&&this.responseEnvelope.getBody();if(a)return this.responseDataGetter(a.getValue(this.mapping))},getRequestError:function(a){var b,c,e=!1,a=a.responseXML;if(void 0!=a&&void 0!=a.documentElement)b=a.documentElement,e=this.errorCodeGetter(b),c=this.errorMessageGetter(b),this.responseEnvelope=new d(b),b=e?e.firstChild.nodeValue:"UNKNOWN_ERROR",c=c?c.firstChild.nodeValue:"Unknown error",console.log("SoapError:",b.quote("("),c),e=!0;return{code:b||
"TRANSPORT_ERROR",msg:c,isSoapFailure:e}}}),d=j(null,{header:null,body:null,init:function(a){if(!a)a=m.createDocument("http://schemas.xmlsoap.org/soap/envelope/","soap:Envelope").documentElement,t(a,"xsd",q.XMLShema),t(a,"xsi",q.XMLShemaInstance),m.XMLNS.BAD_SUPPORT&&t(a,"soap","http://schemas.xmlsoap.org/soap/envelope/");this.document=a.ownerDocument;this.element=a;this.body=this.getBody(!0)},getElementByName:function(a){return m.getElementsByTagNameNS(this.element,a,"http://schemas.xmlsoap.org/soap/envelope/")[0]},
getHeader:function(a){var c=this.header;if(!c){var d=this.getElementByName("Header");if(d||a)c=this.header=new b(d,this.document),d||this.element.insertBefore(c.element,this.element.firstChild)}return c},setHeaderSection:function(a,b){this.getHeader(!0).setSection(a,b)},getBody:function(a){var b=this.body;if(!b){var d=this.getElementByName("Body");if(d||a)b=this.body=new c(d,this.document),d||this.element.appendChild(b.element)}return b},destroy:function(){this.header&&(this.header.destroy(),delete this.header);
this.body&&(this.body.destroy(),delete this.body);delete this.element;delete this.document}}),b=j(null,{init:function(a,b){this.element=a||s(b,"Header","http://schemas.xmlsoap.org/soap/envelope/")},getValue:function(){return u(this.element)},setValue:function(a,b){g.clear(this.element);this.appendChild(a,b)},appendChild:function(a,b){if(a)for(var c in a){var d=this.element.appendChild(y(this.element.ownerDocument,c,b,a[c]));m.XMLNS.BAD_SUPPORT&&t(d,"",b)}},setSection:function(a,b){var c=m.getElementsByTagNameNS(this.element,
a,a.namespace)[0];c&&g.remove(c);this.appendChild(Function.wrapper(a)(b),a.namespace)}}),c=j(null,{init:function(a,b){this.element=a||s(b,"Body","http://schemas.xmlsoap.org/soap/envelope/")},getValue:function(a){return u(this.element,a)},setValue:function(a,b,c){g.clear(this.element);this.appendChild(a,b,c)},appendChild:function(a,b,c){b=y(this.element.ownerDocument,a,a.namespace,Function.$defined(b)?b:{});this.element.appendChild(b);m.XMLNS.BAD_SUPPORT&&t(b.element,"",a.namespace);c&&m.setAttributeNodeNS(b,
m.createAttributeNS(document,"encodingStyle","http://schemas.xmlsoap.org/soap/encoding/",c))}});e.namespace("basis.net.soap").extend({Service:k,ServiceCall:r,ServiceCallTransport:v,Envelope:d,EnvelopeHeader:b,EnvelopeBody:c})})(basis);
(function(e){var j=Function.getter,g=e.Class,n=e.dom,m=e.ui.Node,o=e.ui.Control,w=g(m,{captionGetter:j("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){m.prototype.event_select.call(this);n.focus(this.element)},event_disable:function(){m.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=!0},event_enable:function(){m.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=!1},init:function(e){m.prototype.init.call(this,e);this.setCaption(this.caption)},setCaption:function(e){this.caption=e;this.tmpl.captionText.nodeValue=this.captionGetter(this)}}),g=g(o,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:w,getButtonByName:function(e){return this.childNodes.search(e,
j("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(e){return e.groupId||-e.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});e.namespace("basis.ui.button").extend({Button:w,ButtonPanel:g})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.html.Template,m=Function.getter,o=e.EventObject.createEvent,w=e.data.STATE,t=e.ui.Node,u=new n('<div{element|content} class="Basis-Label-State"/>'),y=new n('<div{element|content} class="Basis-Label-Processing"/>'),s=new n('<div{element|content} class="Basis-Label-Error"/>'),q=j(t,{cascadeDestroy:!0,show_:!1,visible_:!1,visibilityGetter:Function.$false,insertPoint:g.INSERT_END,content:"[no text]",event_delegateChanged:function(a,b){(b?b.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:o("visibilityChanged"),init:function(a){var b=this.container;this.container=null;t.prototype.init.call(this,a);if(b)this.container=b;this.traceChanges_();return a},traceChanges_:function(){this.container&&this.visible_?this.container!=this.element.parentNode&&g.insert(this.container,this.tmpl.element,this.insertPoint):g.remove(this.element)},setContainer:function(a){if(this.container!=a)this.container=
a,this.traceChanges_()},setVisibility:function(a){if(this.visible_!=a)this.visible_=a,this.traceChanges_(),this.event_visibilityChanged(this.visible_)},destroy:function(){delete this.container;t.prototype.destroy.call(this)}}),k=j(q,{template:u,init:function(a){if(this.visibleStates&&!this.visibilityGetter){for(var b={},c,d=0;c=this.visibleStates[d++];)b[c]=!0;this.visibilityGetter=m(Function.$self,b)}q.prototype.init.call(this,a)}}),o=j(k,{event_delegateChanged:function(a,b){k.prototype.event_delegateChanged.call(this,
a,b);this.delegate&&this.event_stateChanged(this)},event_stateChanged:function(a,b){k.prototype.event_stateChanged.call(this,a,b);this.setVisibility(this.visibilityGetter(this.state,b))}}),r=j(o,{visibilityGetter:function(a){return a==w.PROCESSING},content:"Processing...",template:y}),s=j(o,{visibilityGetter:function(a){return a==w.ERROR},content:"Error",template:s}),v={stateChanged:function(a,b){this.setVisibility(this.visibilityGetter(a.state,b))}},d={dataSourceChanged:function(a,b){b&&b.removeHandler(v,
this);a.dataSource&&(a.dataSource.addHandler(v,this),v.stateChanged.call(this,a.dataSource,a.dataSource.state))}},u=j(k,{event_delegateChanged:function(a,b){k.prototype.event_delegateChanged.call(this,a,b);b&&b.removeHandler(d,this);this.delegate&&(this.delegate.addHandler(d,this),d.dataSourceChanged.call(this,this.delegate,b&&b.dataSource))},template:u}),y=j(u,{visibilityGetter:function(a){return a==w.PROCESSING},content:"Processing...",template:y}),b=function(){this.setVisibility(this.visibilityGetter(this.delegate?
this.delegate.childNodes.length:0,this.delegate))},c={stateChanged:function(a){this.setVisibility(this.visibilityGetter(a.itemCount,this.delegate))}},a={childNodesModified:b,dataSourceStateChanged:b,stateChanged:b,dataSourceChanged:function(a,b){b&&b.removeHandler(c,this);a.dataSource&&(a.dataSource.addHandler(c,this),c.stateChanged.call(this,a.dataSource,a.dataSource.state))}},n=j(q,{event_delegateChanged:function(c,d){q.prototype.event_delegateChanged.call(this,c,d);d&&d.removeHandler(a,this);this.delegate&&
(this.delegate.addHandler(a,this),a.dataSourceChanged.call(this,this.delegate));b.call(this)},template:new n('<div{element|content} class="Basis-CountLabel"/>')}),j=j(n,{visibilityGetter:function(a,b){var c=b.dataSource?b.dataSource.state:b.state;return!a&&c==w.READY},content:"Empty"});e.namespace("basis.ui.label").extend({NodeLabel:q,State:k,ObjectState:o,Processing:r,Error:s,DataSourceState:u,DataSourceProcessing:y,ChildCount:n,IsEmpty:j})})(basis);
(function(e){function j(d){"function"==typeof d.expand&&d.expand()}function g(d){"function"==typeof d.collapse&&d.collapse()}var n=e.Class,m=e.dom,o=e.dom.event,w=e.cssom.classList,t=Function.getter,u=e.EventObject.createEvent,y=e.ui.Container,s=e.ui.Control,q=e.ui.PartitionNode,k=e.ui.GroupingNode,r={expandAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,j)},collapseAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,g)},expand:Function(),collapse:Function(),toggle:Function()},q=n(q,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'}),
k=n(k,{childClass:q}),v=n(y,r,{canHaveChildren:!1,childFactory:null,event_collapse:u("collapse"),event_expand:u("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(d){d.titleText.nodeValue=""+this.titleGetter(this)||"[no title]"},action:{select:function(d){this.isDisabled()||this.select(o(d).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:t("data.title")}),t=n(v,{canHaveChildren:!0,childClass:v,localGroupingClass:k,event_expand:function(){v.prototype.event_expand.call(this);w(this.element).remove("collapsed")},event_collapse:function(){v.prototype.event_collapse.call(this);w(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:!0,collapsed:!1,init:function(d){v.prototype.init.call(this,d);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed)return this.collapsed=!1,this.event_expand(),!0},collapse:function(){if(!this.collapsed&&this.collapsable)return this.collapsed=!0,this.event_collapse(),!0},toggle:function(){this.collapsed?this.expand():this.collapse()}}),n=n(s,r,{childClass:v,localGroupingClass:k,template:'<ul class="Basis-Tree"/>'});e.namespace("basis.ui").extend({Tree:n});
e.namespace("basis.ui.tree").extend({Tree:n,Node:v,Folder:t,GroupingNode:k,PartitionNode:q})})(basis);
(function(){var e=basis.Class,j=basis.dom,g=basis.dom.event,n=basis.cssom,m=Function.getter,o=basis.cssom.classList,w=basis.Cleaner,t=basis.layout,u=basis.EventObject.createEvent,y=basis.ui.Node,s=basis.ui.Container,q=basis.ui.Control,k=basis.ui.PartitionNode,r=basis.ui.GroupingNode,v={VERTICAL:"V",HORIZONTAL:"H"},d={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},b={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},c={finish:function(){this.visible||(j.remove(this.element),this.event_cleanup(this))}},
u=e(s,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:u("beforeShow"),event_show:u("show"),event_hide:u("hide"),event_realign:u("realign"),event_cleanup:u("cleanup"),event_layoutChanged:u("layoutChanged","oldOrientation","oldDir")&&function(a,b){var c=(a+"-"+b.qw().slice(2,4).join("-")).toLowerCase(),d=(this.orientation+"-"+this.dir.qw().slice(2,
4).join("-")).toLowerCase();o(this.element).replace(c,d,this.cssLayoutPrefix)},visible:!1,autorotate:!1,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:v.VERTICAL,hideOnAnyClick:!0,hideOnKey:!1,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(a){s.prototype.init.call(this,a);this.cssRule=n.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,this.orientation);this.thread&&this.thread.addHandler(c,
this);w.add(this)},setLayout:function(a,b,c){var d=this.dir,f=this.orientation;if("string"==typeof a)this.dir=a.toUpperCase();if("string"==typeof b)this.orientation=b;if(d!=this.dir||f!=this.orientation)this.event_layoutChanged(f,d),c||this.realign()},flip:function(a){var c=this.dir.qw(),a=a==v.VERTICAL;c[0+a]=b[c[0+a]];c[2+a]=b[c[2+a]];this.setLayout(c.join(" "))},rotate:function(a){var b=this.dir.qw(),a=(a%4+4)%4,c=[];if(!a)return b;var f=b[0].charAt(0),e=b[1].charAt(0),h="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(f+
e)>>1,f=(h&252)+((h&3)+a&3)<<1;c.push(d["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(f)],d["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(f+1)]);f=b[2].charAt(0);e=b[3].charAt(0);h="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(f+e)>>1;a="C"!=f&&"C"!=e&&b[0]==b[2]!=(b[1]==b[3])?-a+4:a;f=(h&252)+((h&3)+a&3)<<1;c.push(d["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(f)],d["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(f+1)]);return c},isFitToViewport:function(a){if(this.visible&&this.relElement){var b=new t.Box(this.relElement,!1,this.element.offsetParent),c=
new t.Viewport(this.element.offsetParent),d=this.element.offsetWidth,f=this.element.offsetHeight,a=(""+(a||this.dir)).toUpperCase().qw(),e="CENTER"==a[0]?b.left+(b.width>>1):b[a[0].toLowerCase()],b="CENTER"==a[1]?b.top+(b.height>>1):b[a[1].toLowerCase()];return("LEFT"!=a[2])*(e<d>>("CENTER"==a[2]))||("RIGHT"!=a[2])*(c.width-e<d>>("CENTER"==a[2]))||("TOP"!=a[3])*(b<f>>("CENTER"==a[3]))||("BOTTOM"!=a[3])*(c.height-b<f>>("CENTER"==a[3]))?!1:{x:e,y:b}}},realign:function(){if(this.visible&&this.relElement){for(var a=
this.dir.qw(),b,c=0,d=a,f=a[2],e=a[3],h="number"==typeof this.autorotate||!this.autorotate.length?3:this.autorotate.length;this.autorotate&&c<=h;){if(b=this.isFitToViewport(d.join(" "))){f=d[2];e=d[3];this.setLayout(d.join(" "),null,!0);break}if(c==h)break;Array.isArray(this.autorotate)?(d=this.autorotate[c++],d="string"==typeof d?d.toUpperCase().split(" "):this.rotate(d)):d=this.rotate(++c*this.autorotate)}b||(b=new t.Box(this.relElement,!1,this.element.offsetParent),b={x:"CENTER"==a[0]?b.left+(b.width>>
1):b[a[0].toLowerCase()],y:"CENTER"==a[1]?b.top+(b.height>>1):b[a[1].toLowerCase()]});a=new t.Box(this.element.offsetParent);c={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(f){case "LEFT":c.left=b.x+"px";break;case "CENTER":c.left=Math.round(b.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":c.right=a.width-b.x+"px"}switch(e){case "TOP":c.top=b.y+"px";break;case "CENTER":c.top=Math.round(b.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":c.bottom=a.height-b.y+"px"}this.cssRule.setStyle(c);
this.event_realign()}},show:function(a,b,c){this.relElement=j.get(a)||this.relElement;this.setLayout(b||this.defaultDir,c);if(this.visible)this.realign();else if(this.relElement)o(this.element).remove("pre-transition"),j.visibility(this.element,!1),x.appendChild(this),this.event_beforeShow(),this.visible=!0,this.realign(),this.thread&&this.thread.start(1),j.visibility(this.element,!0),o(this.element).add("pre-transition"),this.event_show()},hide:function(){if(this.visible)j.parentOf(document.body,
this.element)&&(this.thread?this.thread.start(1):(j.remove(this.element),this.event_cleanup(this))),this.visible=!1,this.parentNode&&x.removeChild(this),this.event_hide()},hideAll:function(){x.clear()},destroy:function(){if(this.thread)this.thread.removeHandler(c,this),this.thread=null;this.hide();s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;w.remove(this)}}),a=e(u,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
f=e(s,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(a){this.click();g.kill(a)}},event_childNodesModified:function(a,b){o(this.element).bool("hasSubItems",this.hasChildNodes());s.prototype.event_childNodesModified.call(this,a,b)},groupId:0,caption:"[untitled]",captionGetter:m("caption"),handler:null,defaultHandler:function(a){this.parentNode&&this.parentNode.defaultHandler(a)},init:function(a){s.prototype.init.call(this,
a);this.setCaption(this.caption)},setCaption:function(a){this.caption=a;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){!this.isDisabled()&&!(this instanceof h)&&(this.handler?this.handler(this):this.defaultHandler(this))}});f.prototype.childClass=f;var h=e(f,{event_childNodesModified:y.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'}),y=e(k,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'}),
r=e(r,{childClass:y}),e=e(u,{childClass:f,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:r,localGrouping:m("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'}),x=new q({id:"Basis-PopupStack",handheldMode:!1,childClass:u,event_childNodesModified:function(a,b){if(b.deleted)for(var c=b.deleted.length-
1,d;d=b.deleted[c];c--)d.hide();if(b.inserted&&!b.deleted&&this.childNodes.length==b.inserted.length)o(this.element).add("IsNotEmpty"),document.body.className=document.body.className,g.addGlobalHandler("click",this.hideByClick,this),g.addGlobalHandler("keydown",this.hideByKey,this),g.addGlobalHandler("scroll",this.hideByScroll,this),g.addHandler(window,"resize",this.realignAll,this);this.lastChild?this.lastChild.select():(o(this.element).remove("IsNotEmpty"),document.body.className=document.body.className,
g.removeGlobalHandler("click",this.hideByClick,this),g.removeGlobalHandler("keydown",this.hideByKey,this),g.removeGlobalHandler("scroll",this.hideByScroll,this),g.removeHandler(window,"resize",this.realignAll,this));q.prototype.event_childNodesModified.call(this,a,b)},insertBefore:function(a,b){var c=document.documentElement.scrollTop,d=document.body.scrollTop;if(q.prototype.insertBefore.call(this,a,b)){a.documentST_=c;a.bodyST_=d;if(this.handheldMode)document.documentElement.scrollTop=0,document.body.scrollTop=
0;a.element.style.zIndex=basis.ui.Window?basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(a){if(a&&(a.hideOnAnyClick&&a.nextSibling&&this.removeChild(a.nextSibling),q.prototype.removeChild.call(this,a),this.handheldMode))document.documentElement.scrollTop=a.documentST_,document.body.scrollTop=a.bodyST_},realignAll:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(a){for(var a=
g.sender(a),b,c=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),d=0,f;f=c[d];d++){if(a===f.tmpl.closeButton||j.parentOf(f.tmpl.closeButton,a)){this.removeChild(f);return}b||(b=j.axis(a,j.AXIS_ANCESTOR_OR_SELF));if(b.has(f.element)||b.some(Array.prototype.has,f.ignoreClickFor)){this.removeChild(c[d-1]);return}}this.removeChild(c.pop())},hideByKey:function(a){var a=g.key(a),b=this.lastChild;if(b&&b.hideOnKey){var c=!1;"function"==typeof b.hideOnKey?c=b.hideOnKey(a):Array.isArray(b.hideOnKey)&&
(c=b.hideOnKey.has(a));c&&b.hide()}},hideByScroll:function(a){a=g.sender(a);if(!j.parentOf(a,this.element))for(var b=this.lastChild;b;){var c=b.previousSibling;b.relElement&&b.offsetParent!==a&&j.parentOf(a,b.relElement)&&b.hide();b=c}}});g.onLoad(function(){j.insert(document.body,x.element,j.INSERT_BEGIN);x.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:v,setHandheldMode:function(a){x.handheldMode=!!a},Popup:u,Balloon:a,Menu:e,MenuGroupControl:r,MenuPartitionNode:y,MenuItem:f,
MenuItemSet:h})})(basis);
(function(e){var j=e.Class,g=e.dom.event,n=e.dom,m=e.html.Template,o=e.cssom.classList,w=e.dom.wrapper,t=w.GroupingNode,u=w.PartitionNode,y=e.ui.Node,s=e.ui.Container,q=e.ui.Control,k=e.ui.PartitionNode,r=e.ui.GroupingNode,v=j(y,{template:new m('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(a){a.titleText.nodeValue=
this.titleGetter(this)}}),d=j(t,{event_ownerChanged:function(a,b){b&&n.remove(this.headerRow);if(this.owner&&this.owner.element){var c=this,d=this.owner.element;do n.insert(d,c.headerRow,n.INSERT_BEGIN);while(c=c.localGrouping)}t.prototype.event_ownerChanged.call(this,a,b)},childClass:{init:function(a){u.prototype.init.call(this,a);this.cell=new v({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(a,b){var c=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var d=
0,f;f=this.nodes[d];d++)c+=f.cell.element.colSpan;else c=this.nodes.length;this.cell.element.colSpan=c;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{});u.prototype.event_childNodesModified.call(this,a,b)},destroy:function(){u.prototype.destroy.call(this);this.cell.destroy()}},init:function(a){t.prototype.init.call(this,a);this.element=this.childNodesElement=this.headerRow=n.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(a,b){a=
t.prototype.insertBefore.call(this,a,b);n.insert(this.headerRow,a.cell.element,n.INSERT_BEFORE,a.nextSibling&&a.nextSibling.cell.element);return a},removeChild:function(a){n.remove(a.cell.element);t.prototype.removeChild.call(a)},destroy:function(){t.prototype.destroy.call(this);this.headerRow=null}});d.prototype.localGroupingClass=d;var w=j(y,{sorting:null,defaultOrder:!1,groupId:0,template:new m('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var a=this.parentNode&&this.parentNode.owner;a&&a.setLocalSorting(a.localSorting,!a.localSortingDesc)}else this.select()}},init:function(a){y.prototype.init.call(this,a);this.selectable=!!this.sorting;if(this.sorting)this.sorting=Function.getter(this.sorting),this.defaultOrder="desc"==this.defaultOrder,o(this.element).add("sortable")},select:function(){if(!this.selected)this.order=this.defaultOrder;y.prototype.select.call(this)}}),b=j(s,{childClass:w,localGroupingClass:d,
template:new m('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(a){var b=this.childNodes.search(a.localSorting,"sorting");b?(b.select(),b.order=a.localSortingDesc,o(this.tmpl.content).bool("sort-order-desc",b.order)):this.selection.clear()}}},init:function(a){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(a){(a=a.pick())&&
this.owner&&this.owner.setLocalSorting(a.sorting,a.order)}}};s.prototype.init.call(this,a);this.applyConfig_(this.structure)},applyConfig_:function(a){a&&this.setChildNodes(a.map(function(a){var b=a.header,c=Object.slice(a,["sorting","defaultOrder","groupId"]);c.content=(null==b||"object"!=typeof b?b:b.content)||String.Entity.nbsp;if("function"==typeof c.content)c.content=c.content.call(this);c.cssClassName=(b.cssClassName||"")+" "+(a.cssClassName||"");return c},this))}}),c=j(y,{colSpan:1,template:new m('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),
setColSpan:function(a){this.element.colSpan=this.colSpan=a||1}}),a=j(s,{childClass:c,childFactory:function(a){return new this.childClass(a)},template:new m('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(a){s.prototype.init.call(this,a);this.applyConfig_(this.structure);this.useFooter&&n.insert(this.container||this.owner.element,this.element,1)},applyConfig_:function(a){if(a){var b=null;this.clear();this.useFooter=!1;for(var d=0;d<a.length;d++){var f=
a[d],e;f.footer?(e=f.footer.content,"function"==typeof e&&(e=e.call(this)),this.useFooter=!0,e=this.appendChild({cssClassName:(f.cssClassName||"")+" "+(f.footer.cssClassName||""),content:e,template:f.footer.template||c.prototype.template})):b?b.setColSpan(b.colSpan+1):e=this.appendChild({});e&&(b=e)}}}}),f=j(y,{canHaveChildren:!1,repaintCount:0,getters:[],classNames:[],template:'<tr class="Basis-Table-Row" event-click="select"><\!--{cells}--\></tr>',action:{select:function(a){this.select(g(a).ctrlKey)}},
templateUpdate:function(){this.repaintCount+=1;for(var a=0,b;b=this.updaters[a];a++){var c=this.element.childNodes[b.cellIndex];b=b.getter.call(this,this,c);if(1<this.repaintCount)c.innerHTML="";if(!b||!Array.isArray(b))b=[b];for(var d=0;d<b.length;d++){var f=b[d];c.appendChild(f&&f.nodeType?f:n.createText(null!=f&&("string"!=typeof f||""!=f)?f:" "))}}}}),k=j(k,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><\!-- {childNodesHere} --\></tbody>',
action:{click:function(){o(this.element).toggle("collapsed")}}}),j=j(q,{canHaveChildren:!0,childClass:f,localGroupingClass:j(r,{childClass:k}),template:new m('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><\!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><\!-- {footerElement} --\></table>'),templateAction:function(a,b){q.prototype.templateAction.call(this,a,b)},init:function(c){this.applyConfig_(this.structure);q.prototype.init.call(this,
c);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new b(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new a(Object.extend({owner:this,structure:this.structure},this.footer));n.replace(this.tmpl.headerElement,this.header.element);!this.localSorting&&this.structure&&this.structure.search(!0,function(a){return a.sorting&&"autosorting"in a})&&(c=this.structure[Array.lastSearchIndex],this.setLocalSorting(c.sorting,"desc"==c.defaultOrder))},applyConfig_:function(a){if(a){var b=
[],c="";this.firstChild&&this.clear();for(var d=0;d<a.length;d++){var e=a[d],k=e.body||{};if("function"==typeof k||"string"==typeof k)k={content:k};var e=[e.cssClassName||"",k.cssClassName||""].join(" ").trim(),g=k.content,c=c+("<td"+(k.templateRef?k.templateRef.quote("{"):"")+(e?' class="'+e+'"':"")+">"+("string"==typeof g?k.content:"")+"</td>");"function"==typeof g&&b.push({cellIndex:d,getter:g})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new m(this.childClass.prototype.template.source.replace("<\!--{cells}--\>",
c)),updaters:b});if(this.rowBehaviour){var j=this.rowBehaviour;Object.keys(j).forEach(function(a){this.childClass.prototype[a]=function(){j[a].apply(this,arguments);f.prototype[a].apply(this,arguments)}},this)}}},loadData:function(a){this.setChildNodes(a.map(Function.wrapper("data")))},destroy:function(){q.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});e.namespace("basis.ui.table").extend({Table:j,Body:k,Header:b,HeaderCell:w,Row:f,Footer:a});
e.namespace("basis.ui").extend({Table:j})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.dom.event,m=e.cssom,o=e.TimeEventManager,w=e.ui.table.Table,t=e.layout.Box,u=e.layout.Viewport,y=e.ui.table,s=17;n.onLoad(function(){var e=g.createElement("");g.setStyle(e,{height:"100px",overflow:"scroll"});g.insert(document.body,e);s=(new t(e)).width-(new u(e)).width;m.cssRule(".ScrollBarWidthOwner").setStyle({width:s+"px"});g.remove(e)});j=j(w,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><\!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(e,
k){w.prototype.event_childNodesModified.call(this,e,k);o.add(this,"adjust",Date.now())},init:function(e){w.prototype.init.call(this,e);this.headerClone=new y.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=
this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=g.insert(this.element,g.createElement(".Basis-ScrollTable-ExpandHeaderCell",g.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new t(this.header.element);if(this.footer.useFooter)g.insert(this.tmpl.foot,this.footer.element),this.footerClone=new y.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,structure:this.structure},this.footerConfig)),this.originalCells=
this.originalCells.concat(this.footer.childNodes),this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes),g.setStyle(this.footerClone.element,{visibility:"hidden"}),this.footerBox=new t(this.footer.element),this.footerExpandCell=g.insert(this.element,g.createElement(".Basis-ScrollTable-ExpandFooterCell"));this.cellsAdjustmentInfo=[];for(var e=0,k,j;k=this.originalCells[e];e++)j=this.clonedCells[e],this.cellsAdjustmentInfo.push({element:j.element,boxChangeListener:k.element,contentSource:k.content,
contentDestination:j.content});this.tableBox=new t(this.tmpl.tableElement);this.lastScrollLeftPosition=0;n.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));n.addHandler(window,"resize",this.adjust.bind(this));this.sync();o.add(this,"adjust",Date.now())},onScroll:function(){var e=this.tmpl.scrollContainer.scrollLeft;if(e!=this.lastScrollLeftPosition)g.setStyleProperty(this.tmpl.headerFooterContainer,"left",-e+"px"),this.lastScrollLeftPosition=e},adjust:function(){this.onScroll();
this.tableBox.recalc();var e=this.tableBox.width||0;this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth?(g.setStyleProperty(this.tmpl.tableWrapperElement,"width",e+"px"),g.setStyleProperty(this.tmpl.headerFooterContainer,"width",e+s+"px")):(g.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%"),g.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%"));this.cellsAdjustmentInfo.forEach(this.adjustCell);e=Math.max(0,this.tmpl.tableWrapperElement.clientWidth-
this.tmpl.tableElement.offsetWidth+s);this.headerBox.recalc();var k=this.headerBox.height||0;m.setStyleProperty(this.element,"paddingTop",k+"px");m.setStyleProperty(this.tmpl.tableElement,"marginTop",-k+"px");m.setStyle(this.headerExpandCell,{width:e+"px",height:k+"px"});this.footer.useFooter&&(this.footerBox.recalc(),k=this.footerBox.height||0,m.setStyleProperty(this.element,"paddingBottom",k+"px"),m.setStyleProperty(this.tmpl.tableElement,"marginBottom",-k+"px"),m.setStyle(this.footerExpandCell,
{width:e+"px",height:k+"px"}))},sync:function(){this.adjust()},adjustCell:function(e){var k;k=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e.element,null).width:e.element.clientWidth+"px";m.setStyleProperty(e.boxChangeListener,"width",k)}});e.namespace("basis.ui.scrolltable").extend({ScrollTable:j})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.dom.event,m=e.cssom,o=e.cssom.classList,w=e.Cleaner,t=e.EventObject.createEvent,u=e.dragdrop,y=e.ui.Node,s=e.ui.Container,q=e.ui.Control,k=e.ui.button.ButtonPanel,r=j(y,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(b){y.prototype.init.call(this,b);g.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});w.add(this)},capture:function(b,c){if(this.captureElement=
g.get(b||document.body))g.insert(this.captureElement,this.element),this.element.style.zIndex=c||1E3,g.show(this.element)},release:function(){if(this.captureElement)this.element.parentNode==this.captureElement&&g.remove(this.element),this.captureElement=null,g.hide(this.element)},destroy:function(){this.release();y.prototype.destroy.call(this);w.remove(this)}}),j=j(s,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><\!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(b){var c=n.key(b);c==n.KEY.ESCAPE?this.closeOnEscape&&this.close(0):c==n.KEY.ENTER&&"TEXTAREA"!=n.sender(b).tagName&&n.kill(b)}},event_beforeShow:t("beforeShow"),event_open:t("open"),event_close:t("close"),event_active:t("active"),closeOnEscape:!0,autocenter:!0,autocenter_:!1,modal:!1,closed:!0,moveable:!0,title:"[no title]",init:function(b){s.prototype.init.call(this,b);g.hide(this.element);b=this.tmpl.title.parentNode;
this.setTitle(this.title);this.cssRule=m.uniqueRule(this.element);if(this.moveable&&u)this.dde=new u.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||b,fixRight:!1,fixBottom:!1}),this.dde.addHandler({move:function(){this.autocenter=!1;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));g.setStyle(this.element,{top:"",left:""})}},this);var c=Array.from(this.buttons).map(function(a){return Object.complete({click:(a.click||
this.close).bind(this)},a)},this),a=Object.slice(this,["buttonOk","buttonCancel"]),d;for(d in a){var e=a[d];c.push({name:"buttonOk"==d?"ok":"cancel",caption:e.caption||e.title||e,click:(e.click||this.close).bind(this)})}if(c.length)this.buttonPanel=new k({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:c});if(!this.titleButton||!1!==this.titleButton.close)o(b).add("Basis-Window-Title-ButtonPlace-Close"),g.insert(b,g.createElement("SPAN.Basis-Window-Title-ButtonPlace",
g.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',g.createElement("SPAN","Close"))),g.INSERT_BEGIN);if(!1!==this.autocenter)this.autocenter=this.autocenter_=!0;this.thread&&this.thread.addHandler({finish:function(){this.closed&&g.remove(this.element)}},this);w.add(this)},setTitle:function(b){g.insert(g.clear(this.tmpl.title),b)},realign:function(){if(this.autocenter)this.element.style.margin="",this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",marginLeft:-this.element.offsetWidth/
2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})},activate:function(){this.select()},open:function(b){this.closed?(g.visibility(this.element,!1),g.show(this.element),d.appendChild(this),this.closed=!1,this.realign(),this.thread&&this.thread.start(!0),this.event_beforeShow(b),g.visibility(this.element,!0),this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select(),this.event_open(b),this.event_active(b)):this.realign()},close:function(b){if(!this.closed)this.thread?
this.thread.start(1):g.remove(this.element),d.removeChild(this),this.autocenter=this.autocenter_,this.closed=!0,this.event_close(b)},destroy:function(){this.dde&&(this.dde.destroy(),delete this.dde);s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;w.remove(this)}}),v=new r,d=new q({id:"Basis-WindowStack",childClass:j});d.addHandler({childNodesModified:function(){o(this.element).bool("IsNotEmpty",this.firstChild);var b=-1;if(this.lastChild){for(var c=0,a;a=this.childNodes[c];c++)a.element.style.zIndex=
2001+2*c,a.modal&&(b=c);this.lastChild.select()}-1!=b?v.capture(this.element,2E3+2*b):v.release()}});d.selection.addHandler({datasetChanged:function(){var b=this.pick(),c=d.lastChild;b?b.parentNode==d&&b!=c&&(d.insertBefore(b),d.event_childNodesModified({})):c&&this.add([c])}});n.onLoad(function(){g.insert(document.body,d.element,g.INSERT_BEGIN);for(var b=d.firstChild;b;b=b.nextSibling)b.realign()});e.namespace("basis.ui.window").extend({Window:j,Blocker:r,getWindowTopZIndex:function(){return 2*d.childNodes.length+
2001}})})(basis);
(function(e){function j(d){d.selection&&!d.selection.itemCount&&(d=d.childNodes.search(!1,"disabled"))&&d.select()}var g=e.Class,n=e.dom,m=Function.getter,o=e.cssom.classList,w=e.EventObject.createEvent,t=e.EventObject.event,u=e.ui.Node,y=e.ui.Container,s=e.ui.Control,w=g(s,{canHaveChildren:!0,childClass:u,event_childEnabled:w("childEnabled","document","node")&&function(d,b){this.selection&&!this.selection.itemCount&&child.select();t.childEnabled.call(this,d,b)},event_childDisabled:w("childDisabled","document",
"node")&&function(d,b){j(this);t.childDisabled.call(this,d,b)},event_childNodesModified:function(d,b){j(this);s.prototype.event_childNodesModified.call(this,d,b)},item:function(d){d=isNaN(d)?this.indexOf(d):parseInt(d);return d.between(0,this.childNodes.length-1)?this.childNodes[d]:null},indexOf:function(d){return d instanceof this.childClass?this.childNodes.indexOf(d):this.childNodes.search(d,"name")?Array.lastSearchIndex:-1}}),q=g(y,{canHaveChildren:!1,event_disable:function(){y.prototype.event_disable.call(this);
this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){y.prototype.event_enable.call(this);this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var d=this.tmpl.titleText,
b=this.titleGetter(this);d.nodeValue=null==b||""==""+b?"[no title]":b},action:{select:function(){this.isDisabled()||this.select()}},titleGetter:m("data.title"),groupId:0}),k=g(w,{childClass:q,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'}),m=g(y,{event_select:function(){o(this.element).remove("Basis-Page-Hidden");
y.prototype.event_select.call(this)},event_unselect:function(){o(this.element).add("Basis-Page-Hidden");y.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'}),r=g(w,{childClass:m,template:'<div class="Basis-PageControl"/>'}),u=g(q,{canHaveChildren:!0,childClass:u,event_select:function(){q.prototype.event_select.call(this);o(this.tmpl.pageElement).remove("Basis-Page-Hidden")},
event_unselect:function(){q.prototype.event_unselect.call(this);o(this.tmpl.pageElement).add("Basis-Page-Hidden")},template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',
destroy:function(){n.remove(this.tmpl.pageElement);q.prototype.destroy.call(this)}}),v=g(k,{childClass:u,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'}),g=g(k,{childClass:u,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',
insertBefore:function(d,b){if(d=k.prototype.insertBefore.call(this,d,b))return this.tmpl.pagesElement&&this.tmpl.pagesElement.insertBefore(d.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null),d},removeChild:function(d){if(d=k.prototype.removeChild.call(this,d))return this.tmpl.pagesElement&&d.element.appendChild(d.tmpl.pageElement),d},clear:function(d){this.childNodes.forEach(function(b){b.element.appendChild(b.tmpl.pageElement)});k.prototype.clear.call(this,d)}});e.namespace("basis.ui.tabs").extend({AbstractTabsControl:w,
TabControl:k,Tab:q,PageControl:r,Page:m,AccordionControl:v,TabSheetControl:g,TabSheet:u})})(basis);
(function(e){function j(a){return{hour:a.getHours(),day:a.getDate()-1,month:a.getMonth(),year:a.getFullYear()}}function g(a,b){var d={},f=c[a];if(f){var e=b.getFullYear(),k=b.getMonth(),g=b.getDate(),e=e-e%f[1],k=f[2]?k-k%f[2]:0,g=f[3]?g:1;d.periodStart=new Date(e,k,g);d.periodEnd=new Date(new Date(e+f[4],k+f[5],g+f[6])-1)}else d.periodStart=new Date(d.periodEnd=new Date(b));return d}var n=e.Class,m=e.dom,o=e.dom.event,w=Function.getter,t=e.cssom.classList,u=e.EventObject.createEvent,y=e.html.Template,
s=e.data.property.Property,q=e.ui.Node,k=e.ui.Container,r=e.ui.Control,v=function(a){var b=e.locale["ui.calendar"];return b?b[a]:a},d={};(function(){for(var a=32,b=2147483647;--a;)d[a]=b,b>>=1})();var b={century:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},decade:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},year:function(a){return a.periodStart.getFullYear()},quarter:function(a){return v("QUARTER").toLowerCase().format(1+a.periodStart.getMonth().base(3)/
3)},month:function(a){return v("MONTH").SHORT[a.periodStart.getMonth()].toLowerCase()},day:function(a){return a.periodStart.getDate()}},c={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},a=n(q,{canHaveChildren:!1,template:new y('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(a,b){"click"==a?this.document.templateAction(a,b,
this):q.prototype.templateAction.call(this,a,b)},templateUpdate:function(a,b,c){if(!b||"periodStart"in c||"periodEnd"in c)this.tmpl.title.nodeValue=this.titleGetter(this.data),this.parentNode&&(a=t(this.element),a.bool("before",this.data.periodStart<this.parentNode.data.periodStart),a.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd))},event_select:function(){q.prototype.event_select.call(this);m.focus(this.element)}}),f=n(k,{childClass:a,template:new y('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){k.prototype.event_select.call(this);t(this.tmpl.tabElement).add("selected")},event_unselect:function(){k.prototype.event_unselect.call(this);t(this.tmpl.tabElement).remove("selected")},event_update:function(a,c){k.prototype.event_update.call(this,a,c);var d=this.data,f;if("periodStart"in c||"periodEnd"in c){this.tmpl.titleText.nodeValue=this.getTitle(d.periodStart)||"-";this.firstChild||(f=[]);for(var e=g(this.nodePeriodName,(new Date(d.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(d.periodStart)||0))),j=0;j<this.nodeCount;j++)f?f.push({cssClassName:this.nodePeriodName,titleGetter:b[this.nodePeriodName],data:e}):this.childNodes[j].update(e),e=g(this.nodePeriodName,(new Date(e.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount));f&&this.setChildNodes(f);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(d.selectedDate)||"-";(f=this.getNodeByDate(d.selectedDate))?
f.select():d.selectedDate&&this.minDate<=d.selectedDate&&d.selectedDate<=this.maxDate?this.setViewDate(d.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:!0,isNextPeriodEnabled:!0,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(a){k.prototype.init.call(this,a);t(this.element).add("Basis-Calendar-Section-"+this.sectionName);o.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
!1))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(a){if(a&&this.data.periodStart<=a&&a<=this.data.periodEnd){a:{var b=this.childNodes;if(b.length){var c,d,f=0,e=b.length,k;do if(d=b[c=f+e>>1],a<(k=d.data.periodStart))e=c-1;else if(a>(d=d.data.periodEnd))f=c+1;else{a=a>=k&&a<=d?c:-1;break a}while(f<=e)}a=-1}if(-1!=a)return this.childNodes[a]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(g(this.periodName,new Date(+this.data.periodStart-1)))},nextPeriod:function(){this.isNextPeriodEnabled&&
this.update(g(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(a){this.update(g(this.periodName,a))},getInitOffset:Function.$null});f.Month=n(f,{sectionName:"Month",periodName:"month",template:new y(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+v("DAY").SHORT2.map(String.format,
'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:w("getDate()"),getTitle:function(a){return v("MONTH").FULL[a.getMonth()]+" "+a.getFullYear()},getInitOffset:function(a){return 1+((new Date(a)).set("day",1).getDay()+5)%7}});f.Year=n(f,{sectionName:"Year",periodName:"year",nodePeriodName:"month",nodePeriodUnit:"month",
getTabTitle:w("getMonth()",function(a){return v("MONTH").FULL[a]}),getTitle:w("getFullYear()")});f.YearDecade=n(f,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:w("getFullYear()"),getTitle:function(a){return a.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});f.Century=n(f,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",nodePeriodUnitCount:10,getTabTitle:function(a){if(a)return a=
a.getFullYear(),a-=a%10,a+"-"+(Number(a.toString().substr(-2))+9).lead(2)},getInitOffset:function(){return 1}});f.YearQuarters=n(f,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});f.Quarter=n(f,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(a){return[Math.floor(1+a.getMonth().base(3)/3),v("QUARTER").toLowerCase(),a.getFullYear()].join(" ")}});n=n(r,
{childClass:f,childFactory:Function(),template:new y(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
v("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:u("change"),event_childNodesModified:function(a,b){if(b.inserted)for(var c=0,d;d=b.inserted[c++];)d.setViewDate(this.date.value),d.update({selectedDate:this.selectedDate.value});r.prototype.event_childNodesModified.call(this,a,b);m.insert(m.clear(this.tmpl.sectionTabs),this.childNodes.map(w("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&this.firstChild.select()},
templateAction:function(b,c,d){r.prototype.templateAction.call(this,b,c);if(d instanceof a)b=d.data.periodStart,c=this.selection.pick(),this.selectedDate.set((new Date(this.selectedDate.value)).add(c.nodePeriodUnit,this.selectedDate.value.diff(c.nodePeriodUnit,b))),this.nextSection(!1);else if(!t(o.sender(c)).contains("disabled"))switch(b){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(!0)}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:!0,sections:["Month","Year","YearDecade"],init:function(a){this.todayDate=new s(new Date);this.selectedDate=new s(new Date(this.date||new Date));this.date=new s(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(a,b){this.constructor.prototype.event_datasetChanged.call(this,
a,b);var c=this.pick();c&&c.update({selectedDate:this.selectedDate.value})}};r.prototype.init.call(this,a);this.selectedDate.addHandler({change:function(a){for(var b=this.firstChild;b;b=b.nextSibling)b.update({selectedDate:a})}},this);this.todayDate.addLink(this.tmpl.todayText,null,w("toFormat('%D.%M.%Y')"));this.sections&&m.insert(this,this.sections.map(function(a){return new f[a]},this))},setSection:function(a){(a=this.childNodes.search("sectionName",a))&&a.select()},nextSection:function(a){var b=
this.selection.pick();(b=a?b.nextSibling:b.previousSibling)?(b.select(),b.setViewDate(this.selectedDate.value)):a||this.event_change()},selectDate:function(a){0!=a-this.date.value&&this.date.set(a)},getNextPeriod:function(a,b){if(!this.isNextPeriodEnabled(a,b))return!1;if(this.map){var c=b?1:-1,f=b?"start":"till",e=b?"till":"start",k=(new Date(a)).add("millisecond",c),m=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(m){var q=g("year",k);for(q.periodEnd.getFullYear()==k.getFullYear()&&
(q[f]=k);!this.isPeriodEnabled(q.periodStart,q.periodEnd);)q=g("year",k.add("year",c));for(q[e]=g("month",q[f])[e];!this.isPeriodEnabled(q.periodStart,q.periodEnd);)q=g("month",k.add("month",c));var o=j(q[f]),e=j(q[e]);if(m=m[e.year]&&m[e.year][e.month]){this.periodEnableByDefault&&(f=d[q.periodEnd.getMonthDayCount()],m=m&f^f);for(f=o.day;f!=e.day+c;f+=c)if(m>>f&1){k=new Date(o.year,o.month,f+1);break}}else return g("day",q[f])}}return g("day",k)},isNextPeriodEnabled:function(a,b){if(!b&&this.minDate&&
this.minDate>a||b&&this.maxDate&&this.maxDate<a)return!1;if(this.map)if(this.periodEnableByDefault){if(!b&&this.minDate)return this.isPeriodEnabled(this.minDate,a);if(b&&this.maxDate)return this.isPeriodEnabled(a,this.maxDate)}else{var c=b?1:-1,d=a.getFullYear(),f=(new Date(a)).add("millisecond",c),e=f.getFullYear(),k=Object.keys(this.map.enable).filter(function(a){return c*a>=c*e}),j=k.length;if(j)for(var k=k.sort(function(a,b){return c*(a>b)||-c*(a<b)}),m=0;m<j;m++){var q=g("year",new Date(k[m],
0));if(this.isPeriodEnabled(b&&k[m]==d?f:q.periodStart,!b&&k[m]==d?f:q.periodEnd))return!0}return!1}return!0},isPeriodEnabled:function(a,b){if(this.minDate&&this.minDate>b||this.maxDate&&this.maxDate<a)return!1;var c=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(c){var f=j(a),e=j(b),k,g,m,q=f.month,o=new Date(f.year,f.month),B=11-f.month,n=B+1+12*(e.year-f.year-1)+(e.month+1)-1;if(this.periodEnableByDefault){if(0==n)return!(k=c[f.year])||!(g=k[f.month])||(g^2147483647)>>f.day&
d[e.day-f.day+1];for(var r=0;r<=n;r++){if(!r||B==r%12)if(k=c[o.getFullYear()],!k)return!0;g=k[q=o.getMonth()];if(!g)return!0;m=d[o.getMonthDayCount()];if(r/n?1==r/n?(g&m^m)&d[e.day+1]:g&m^m:(g&m^m)>>f.day)return!0;o.setMonth(q+1)}}else{if(0==n)return(k=c[f.year])&&(g=k[f.month])&&g>>f.day&d[e.day-f.day+1];for(r=0;r<=n;r++){if(!r||B==r%12||!k)if(k=c[o.getFullYear()],!k){r+=12;o.setMonth(q+12);continue}if((g=k[q=o.getMonth()])&&(r/n?1==r/n?g&d[e.day+1]:g:g>>f.day))return!0;o.setMonth(q+1)}}return!1}return!0},
destroy:function(){r.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});e.namespace("basis.ui.calendar").extend({Calendar:n,CalendarSection:f})})(basis);
(function(e){function j(a,b){return new o(a.source.replace("<\!-- {fieldPlace} --\>",b))}var g=e.Class,n=e.dom.event,m=e.dom,o=e.html.Template,w=e.Cleaner,t=Object.complete,u=Function.getter,y=e.cssom.classList,s=e.data.property.Property,q=e.EventObject,k=e.dom.wrapper.Selection,r=e.ui.Control,v=e.ui.Node,d=e.ui.Container,b=q.createEvent,c=new o('<div{element|selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><\!-- {fieldPlace} --\></div></div>'),
a=g(v,{canHaveChildren:!1,template:c,nextFieldOnEnter:!0,serializable:!0,event_select:function(){m.focus(this.tmpl.field,!0);v.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");v.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");v.prototype.event_disable.call(this)},event_input:b("input"),event_change:b("change"),event_keydown:b("keydown"),event_keypress:b("keypress"),event_keyup:b("keyup")&&
function(a){if(this.nextFieldOnEnter){var b=n.key(a);b==n.KEY.ENTER||b==n.KEY.CTRL_ENTER?(n.cancelDefault(a),this.nextFieldFocus()):this.setValid()}q.event.keyup.call(this,a)},event_focus:b("focus")&&function(a){this.valid&&this.setValid();q.event.focus.call(this,a)},event_blur:b("blur")&&function(a){this.validate(!0);q.event.blur.call(this,a)},init:function(a){v.prototype.init.call(this,a);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=this.title||"";if(this.tmpl.field){n.addHandler(this.tmpl.field,
"keydown",this.keydown,this);n.addHandler(this.tmpl.field,"keyup",this.keyup,this);n.addHandler(this.tmpl.field,"keypress",this.keypress,this);n.addHandler(this.tmpl.field,"blur",this.blur,this);n.addHandler(this.tmpl.field,"focus",this.focus,this);n.addHandler(this.tmpl.field,"change",this.change,this);n.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);
this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value)this.defaultValue=this.value,this.setDefaultValue()},setReadOnly:function(a){a?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},setSample:function(a){if(this.tmpl.sampleContainer&&a)this.sampleElement?
m.insert(m.clear(this.sampleElement),a):m.insert(this.tmpl.sampleContainer,this.sampleElement=m.createElement("SPAN.Basis-Field-Sample",a));else if(this.sampleElement)m.remove(this.sampleElement),this.sampleElement=null},getValue:function(){return this.tmpl.field.value},setValue:function(a){a=a||"";if(this.tmpl.field.value!=a)this.tmpl.field.value=a,this.event_change()},setMaxLength:function(a){this.maxLength=a},setMinLength:function(a){this.minLength=a},attachValidator:function(a,b){this.validators.add(a)&&
b&&this.validate()},detachValidator:function(a,b){this.validators.remove(a)&&b&&this.validate()},change:function(a){this.event_change(a)},input:function(a){this.event_input(a)},keydown:function(a){this.event_keydown(a)},keyup:function(a){this.event_keyup(a)},keypress:function(a){this.event_keypress(a)},blur:function(a){this.event_blur(a)},focus:function(a){this.event_focus(a)},select:function(){this.unselect();v.prototype.select.apply(this,arguments)},setValid:function(a,b){var c=y(this.element);
"boolean"==typeof a?(c.bool("invalid",!a),c.bool("valid",a),b?this.element.title=b:this.element.removeAttribute("title")):(c.remove("invalid"),c.remove("valid"),this.element.removeAttribute("title"));this.valid=a},validate:function(a){var b;this.setValid();for(var c=0;c<this.validators.length;c++)if(b=this.validators[c](this))return a||this.setValid(!1,b.message),b;""!=this.getValue()&&this.setValid(!0)},nextFieldFocus:function(){var a=m.axis(this,m.AXIS_FOLLOWING_SIBLING).search(!0,"selectable");
a?a.select():this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){n.clearHandlers(this.element);this.tmpl.field&&n.clearHandlers(this.tmpl.field);this.button&&(n.clearHandlers(this.button),delete this.button);this.validators.clear();v.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});a.create=function(b,c){b={radiogroup:"RadioGroup",checkgroup:"CheckGroup"}[b.toLowerCase()]||b.capitalize();if(a[b])return new a[b](c);
throw Error("Wrong field type `{0}`".format(b));};a.Hidden=g(a,{selectable:!1,template:new o('<input{element|field} type="hidden"/>')});a.Text=g(a,{template:j(c,'<input{field} type="text"/>'),init:function(b){a.prototype.init.call(this,b);this.minLength&&this.attachValidator(z.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(b){this.tmpl.field.setAttribute("maxlength",b,0);a.prototype.setMaxLength.call(this,b)}});a.Password=g(a.Text,
{template:j(c,'<input{field} type="password"/>')});a.File=g(a,{template:j(c,'<input{field} type="file"/>')});a.Textarea=g(a,{nextFieldOnEnter:!1,template:j(c,"<textarea{field}/>"),init:function(b){this.counter=m.createElement(".counter",a.LOCALE.Textarea.SYMBOLS_LEFT+": ",m.createText(0));a.prototype.init.call(this,b);this.minLength&&this.attachValidator(z.MinLength);this.maxLength&&this.attachValidator(z.MaxLength);n.addHandler(this.tmpl.field,"keyup",this.updateCounter,this);n.addHandler(this.tmpl.field,
"input",this.updateCounter,this);window.opera&&n.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=!0;this.contentEditable=!1})},updateCounter:function(){var a=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=0<=a?a:0},setValue:function(b){a.prototype.setValue.call(this,b);this.updateCounter()},setMaxLength:function(b){a.prototype.setMaxLength.call(this,b);b?(this.updateCounter(),m.insert(this.tmpl.sampleContainer,this.counter)):m.remove(this.counter)},destroy:function(){delete this.counter;
a.prototype.destroy.call(this)}});a.Checkbox=g(a,{value:!1,template:new o('<div{element} class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox"/><span>{titleText}</span></label></div></div>'),invert:function(){this.setValue(!this.getValue())},setValue:function(a){var b=this.tmpl.field.checked;this.tmpl.field.checked=!!a;b!=this.tmpl.field.checked&&this.event_change()},getValue:function(){return this.tmpl.field.checked}});a.Label=g(a,
{cssClassName:"Basis-Field-Label",template:j(c,"<label{field}>{fieldValueText}</label>"),valueGetter:Function.$self,event_change:function(){a.prototype.event_change.apply(this,arguments);this.tmpl.fieldValueText.nodeValue=this.valueGetter(this.getValue())}});var f=g(v,{canHaveChildren:!1,titleGetter:function(a){return a.title||a.getValue()},valueGetter:u("value"),getTitle:function(){return this.titleGetter(this)},getValue:function(){return this.valueGetter(this)}}),h={datasetChanged:function(){this.event_change()}},
x=g(a,d,{childClass:f,template:a.prototype.template,multipleSelect:!1,init:function(b){this.selection=new k({multiple:!!this.multipleSelect});this.selection.addHandler(h,this);a.prototype.init.call(this,b);w.add(this)},getValue:function(){var a=this.selection.getItems().map(u("getValue()"));return!this.selection.multiple?a[0]:a},setValue:function(a){var b={};(this.multipleSelect?Array.from(a):[a]).forEach(function(a){b[a]=!0});for(var a=[],c=this.firstChild;c;c=c.nextSibling)b[c.getValue()]&&a.push(c);
this.selection.set(a)},destroy:function(){a.prototype.destroy.call(this);w.remove(this)}});x.Item=f;d=g(f,{event_select:function(){this.tmpl.field.checked=!0;f.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=!1;f.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");v.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");v.prototype.event_disable.call(this)},
template:new o('<label{element} class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,b,c){f.prototype.templateUpdate.call(this,a,b,c);a.field.value=this.getValue();a.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){"select"==a&&!this.isDisabled()&&this.select();f.prototype.templateAction.call(this,a,b)}});a.RadioGroup=g(x,{childClass:d,template:j(c,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),
childFactory:function(a){a=x.prototype.childFactory.call(this,a);if(this.name)a.tmpl.field.name=this.name;return a}});a.RadioGroup.Item=d;d=g(f,{event_select:function(){this.tmpl.field.checked=!0;f.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=!1;f.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");v.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");
v.prototype.event_disable.call(this)},template:new o('<label{element} event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,b,c){f.prototype.templateUpdate.call(this,a,b,c);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){"click"==a&&!this.isDisabled()&&(this.select(this.parentNode.multipleSelect),"INPUT"!=n.sender(b).tagName&&n.kill(b));f.prototype.templateAction.call(this,
a,b)}});a.CheckGroup=g(x,{childClass:d,multipleSelect:!0,template:j(c,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});a.CheckGroup.Item=d;d=g(f,{event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:new o("<option{element|field}>{titleText}</option>"),templateUpdate:function(a,b,c){f.prototype.templateUpdate.call(this,a,b,c);a.field.value=this.getValue();a.field.text=this.getTitle()}});
a.Select=g(x,{childClass:d,template:j(c,"<select{field|childNodesElement}/>"),event_keyup:function(a,b){this.change();x.prototype.event_keyup.call(this,a,b)},setValue:function(a){(a=this.childNodes.search(a,"getValue()"))?this.selection.set([a]):this.selection.clear()}});a.Select.Item=d;var l={show:function(){y(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){y(this.tmpl.field).remove("Basis-DropdownList-Opened")}},d=g(f,{template:new o('<div{element} class="Basis-Combobox-Item" event-click="click">{titleText}</div>'),
templateUpdate:function(a,b,c){f.prototype.templateUpdate.call(this,a,b,c);a.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){"click"==a&&!this.isDisabled()&&(this.select(),this.parentNode&&this.parentNode.hide(),n.kill(b));f.prototype.templateAction.call(this,a,b)}}),i={keyup:function(a){var b=n.key(a),c=this.selection.pick();switch(b){case n.KEY.DOWN:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=m.axis(c?c:this.firstChild,m.AXIS_FOLLOWING_SIBLING).search(!1,
"disabled");break;case n.KEY.UP:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=c?m.axis(c,m.AXIS_PRESCENDING_SIBLING).search(!1,"disabled"):this.firstChild}c&&(c.select(),m.focus(this.tmpl.field))},keydown:function(a){var b=n.key(a);b==n.KEY.DOWN||b==n.KEY.UP?n.kill(a):b==n.KEY.ENTER&&(this.popup.visible&&this.hide(),n.kill(a))}};a.Combobox=g(x,{childClass:d,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();x.prototype.event_enable.call(this)},
event_change:function(){x.prototype.event_change.call(this);var a=this.getValue();this.property&&this.property.set(a);if(this.hidden)this.hidden.value=a;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:j(c,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><\!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent"/>'),
templateAction:function(a,b){"click"==a&&(this.isDisabled()||this.popup.visible?this.hide():this.show({}),n.kill(b));x.prototype.templateAction.call(this,a,b)},init:function(a){if(!e.ui.popup)throw Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:Function.getter("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&
this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};x.prototype.init.call(this,a);this.satellite.captionItem.setDelegate(this.selection.pick());n.addHandlers(this.tmpl.field,i,this);if(this.name)m.insert(this.tmpl.field,this.hidden=m.createElement("INPUT[type=hidden][name={0}]".format((""+this.name).quote())));this.popup=new e.ui.popup.Popup(t({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,
handler:l,handlerContext:this},this.popup));this.property&&this.property.addLink(this,this.setValue)},show:function(){this.popup.show(this.tmpl.field);this.select()},hide:function(){this.popup.hide()},getTitle:function(){var a=this.selection.pick();return a&&a.getTitle()},getValue:function(){var a=this.selection.pick();return a&&a.getValue()},setValue:function(a){this.getValue()!=a&&((a=this.childNodes.search(a,"getValue()"))&&!a.isDisabled()?this.selection.set([a]):this.selection.clear())},destroy:function(){if(this.property)this.property.removeLink(this),
this.property=null;this.popup.destroy();this.popup=null;x.prototype.destroy.call(this)}});a.Combobox.Item=d;var p=g(null,{init:function(a,b){this.field=a;this.message=b}}),z={NO_LOCALE:"There is no locale for this error",RegExp:function(a){a.constructor!=RegExp&&(a=RegExp(a));return function(b){var c=b.getValue();if(""!=c&&!c.match(a))return new p(b,z.LOCALE.RegExp.WRONG_FORMAT||z.NO_LOCALE)}},Required:function(a){var b=a.getValue();if(Function.$isNull(b)||""==b)return new p(a,z.LOCALE.Required.MUST_BE_FILLED||
z.NO_LOCALE)},Number:function(a){var b=a.getValue();if(isNaN(b))return new p(a,z.LOCALE.Number.WRONG_FORMAT||z.NO_LOCALE)},Currency:function(a){var b=a.getValue();if(isNaN(b))return new p(a,z.LOCALE.Currency.WRONG_FORMAT||z.NO_LOCALE);if(0>=b)return new p(a,z.LOCALE.Currency.MUST_BE_GREATER_ZERO||z.NO_LOCALE)},Email:function(a){var b=a.getValue().trim();if(""!=b&&!b.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new p(a,z.LOCALE.Email.WRONG_FORMAT||z.NO_LOCALE)},
Url:function(a){var b=a.getValue().trim();if(""!=b&&!b.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new p(a,z.LOCALE.Url.WRONG_FORMAT||z.NO_LOCALE)},MinLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?b.length:(""+b).length)<a.minLength)return new p(a,(z.LOCALE.MinLength.MUST_BE_LONGER_THAN||z.NO_LOCALE).format(a.minLength))},MaxLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?
b.length:(""+b).length)>a.maxLength)return new p(a,(z.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||z.NO_LOCALE).format(a.maxLength))}},b=g(r,{canHaveChildren:!0,childClass:a,childFactory:function(b){return a.create(b.type||"text",b)},onSubmit:Function.$false,event_reset:b("reset"),event_disable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_disable();r.prototype.event_disable.call(this)},event_enable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_enable();
r.prototype.event_enable.call(this)},template:new o('<div{element} class="Basis-FormContent"/>'),getFieldByName:function(a){return this.childNodes.search(a,"name")},getFieldById:function(a){return this.childNodes.search(a,"id")},serialize:function(){for(var a={},b=this.firstChild;b;b=b.nextSibling)b.serializable&&b.name&&(a[b.name]=b.getValue());return a},setData:function(a,b){this.loadData(a,b)},loadData:function(a,b){for(var c=Object.keys(a),d=this.firstChild;d;d=d.nextSibling)-1!=c.indexOf(d.name)?
d.setValue(a[d.name]):d.setDefaultValue(),d.setValid();b||this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.setDefaultValue();this.event_reset()},validate:function(){for(var a,b=[],c=this.firstChild;c;c=c.nextSibling)(a=c.validate())&&b.push(a);return b.length?(b[0].field.select(),b):!0},submit:function(){if(!0===this.validate()&&this.onSubmit)this.onSubmit(this.serialize())}}),d=g(b,{template:new o('<form{element|formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent"/></form>'),
method:"POST",init:function(a){this.selection=!1;r.prototype.init.call(this,a);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=this.action;if(this.enctype)this.formElement.enctype=this.enctype;n.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(a){this.formElement.method=a?a.toUpperCase():"POST"},submit:function(){if(!0===this.validate()&&!this.onSubmit()){if("FORM"==
this.tagName)return!1;this.formElement.submit()}return!0}}),A=g(s,{matchFunction:function(a,b){if(!b){var c=a._m||this.textNodeGetter(a);c.constructor!=Array&&(c=[c]);for(var d=!1,f=0;f<c.length;f++){var e=c[f];if(e){var k=!1,h=e.nodeValue.split(this.rx);if(1<h.length){if(!a._x)a._x=[];if(!a._m)a._m=[];m.replace(a._x[f]||e,a._x[f]=m.createElement("SPAN.matched",m.wrap(h,this.map)));a._m[f]=e;k=d=!0}a._x&&a._x[f]&&!k&&(m.replace(a._x[f],a._m[f]),a._x[f]=a._m[f])}}return d}if(a._x){for(f=0;f<a._x.length;f++)a._x[f]&&
m.replace(a._x[f],a._m[f]);delete a._x;delete a._m}return!1},event_change:function(a){this.rx=this.regexpGetter(a);s.prototype.event_change.call(this,a)},extendConstructor_:!0,init:function(){var a=this.startPoints||"";this.textNodeGetter=u(this.textNodeGetter||"tmpl.titleText");if("function"!=typeof this.regexpGetter)this.regexpGetter=function(b){return RegExp("("+a+")("+b.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||"SPAN.match"]=function(a,b){return 2==b%3};s.prototype.init.call(this,
"",this.handlers,String.trim)}}),C={childNodesModified:function(a,b){if(b.inserted)for(var c=0,d;d=b.inserted[c];c++)this.matchFunction(d,""==this.value)}},F=g(A,{event_change:function(a){A.prototype.event_change.call(this,a);this.match()},init:function(a){A.prototype.init.call(this,a);this.node.addHandler(C,this)},match:function(){for(var a=this.node.firstChild;a;a=a.nextSibling)this.matchFunction(a,""==this.value)}}),E=g(A,{event_change:function(a){A.prototype.event_change.call(this,a);this.node.setMatchFunction(a?
this.matchFunction.bind(this):null)}}),g=g(a.Text,{cssClassName:"Basis-MatchInput",matchFilterClass:E,event_keyup:function(b){this.matchFilter.set(this.tmpl.field.value);a.Text.prototype.event_keyup.call(this,b)},event_change:function(b){this.matchFilter.set(this.tmpl.field.value);a.Text.prototype.event_change.call(this,b)},init:function(b){a.Text.prototype.init.call(this,b);this.matchFilter=new this.matchFilterClass(this.matchFilter)}});e.namespace("basis.ui.form").extend({createFieldTemplate:function(a){return j(c,
a)},FormContent:b,Form:d,Field:a,Validator:z,ValidatorError:p,RadioGroup:a.RadioGroup,CheckGroup:a.CheckGroup,Combobox:a.Combobox,ComplexField:x,Matcher:F,MatchFilter:E,MatchInput:g})})(basis);
(function(){function e(d,b){if(window[d])return window[d];for(var d=d.charAt(0).toUpperCase()+d.substr(1),c=0,a;a=y[c++];)if(window[a+d])return window[a+d];return b}var j=basis.Class,g=basis.dom,n=basis.EventObject,m=basis.dom.event,o=basis.cssom.classList,w=!1,t=!1,u;(function(){function d(b,a){for(var d;d=a.shift();)if("undefined"!=typeof b.style[d])return d;return!1}var b=g.createElement("");(u=d(b,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))&&(w=!0);if(w&&(d(b,["perspectiveProperty",
"WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style))t=!0})();var y=["webkit","moz","o","ms"],s=e("requestAnimationFrame",function(d){return window.setTimeout(d,15)}),q=e("cancelRequestAnimFrame",clearInterval),k=j(n,{minScrollDelta:0,preventScrollX:!1,preventScrollY:!1,scrollPropertyType:"style",event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),event_startInertia:n.createEvent("startInertia",
"scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(d){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=
this.lastMouseX=0;this.panningActive=this.processInertia=!1;n.prototype.init.call(this,d);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);"scroll"==this.scrollPropertyType?(g.setStyle(this.targetElement,{overflow:"hidden"}),this.updateElementPosition=this.updatePosition_scrollTopLeft,this.calcDimentions=this.calcDimentions_scrollTopLeft):(g.setStyle(this.targetElement,
{position:"relative"}),this.updateElementPosition=w?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft,this.calcDimentions=this.calcDimentions_styleTopLeft);if(0==this.minScrollDelta)this.minScrollDeltaXReached=this.minScrollDeltaYReached=!0},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var d=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",b=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px",c={};c[u]="translate("+d+", "+b+")"+(t?" translateZ(0)":"");g.setStyle(this.targetElement,c)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;
this.scrollX=!this.preventScrollX&&0<this.maxPositionX;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&0<this.maxPositionY},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var d=this.targetElement.offsetParent;if(d)this.maxPositionX=this.targetElement.scrollWidth-d.offsetWidth,this.scrollX=!this.preventScrollX&&0<this.maxPositionX,this.maxPositionY=this.targetElement.scrollHeight-
d.offsetHeight,this.scrollY=!this.preventScrollY&&0<this.maxPositionY},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=!1},startUpdate:function(){if(!this.isUpdating)this.targetElement.offsetWidth&&
this.calcDimentions(),this.startViewportX=this.viewportX,this.startViewportY=this.viewportY,this.isUpdating=!0,this.updateFrameHandle=this.nextFrame(),this.startTime=this.lastUpdateTime=Date.now(),this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=!1,q(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(d){this.stopUpdate();this.panningActive=!0;this.lastMouseX=m.mouseX(d);this.lastMouseY=m.mouseY(d);
this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,this);m.addHandler(document,"touchend",this.onMouseUp,this);m.cancelDefault(d)},onMouseMove:function(d){(0==this.minScrollDelta||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var b=Date.now(),c=b-this.lastMotionUpdateTime;this.lastMotionUpdateTime=b;if(c){if(this.minScrollDeltaXReached||
!this.minScrollDeltaYReached)b=m.mouseX(d),c=this.lastMouseX-b,this.lastMouseX=b,this.viewportTargetX+=c;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)d=m.mouseY(d),b=this.lastMouseY-d,this.lastMouseY=d,this.viewportTargetY+=b;if(0<this.minScrollDelta&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=!0;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=
!0;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=!1;this.processInertia=!0;var d=Date.now()-this.lastMotionUpdateTime,d=Math.max(10,d);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,d/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,d/100)));m.removeHandler(document,
"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(d){d||(d=Date.now());var b=d-this.lastUpdateTime;this.lastUpdateTime=d;if(b){if(this.panningActive){var c;if(this.scrollX&&(c=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,c))this.currentVelocityX=Math.abs(c)/
b,this.currentDirectionX=0==c?0:0>c?-1:1;if(this.scrollY&&(c=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,c))this.currentVelocityY=Math.abs(c)/b,this.currentDirectionY=0==c?0:0>c?-1:1}else if(this.processInertia){if(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*b,this.currentVelocityX*=0.94,0.0010>this.currentVelocityX||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX))this.viewportTargetX=Math.min(this.maxPositionX,
Math.max(this.minPositionX,this.viewportTargetX)),this.currentVelocityX=0;if(this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*b,this.currentVelocityY*=0.94,0.0010>this.currentVelocityY||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY))this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY)),this.currentVelocityY=0;if(0==this.currentVelocityX&&0==this.currentVelocityY)this.processInertia=!1}b=c=0;this.scrollX&&
(c=this.viewportTargetX-this.viewportX,this.viewportX+=c*(this.panningActive||0<this.currentVelocityX?1:0.12));this.scrollY&&(b=this.viewportTargetY-this.viewportY,this.viewportY+=b*(this.panningActive||0<this.currentVelocityY?1:0.12));c=!this.scrollX||0.0010>this.currentVelocityX&&0.1>Math.abs(c);b=!this.scrollY||0.0010>this.currentVelocityY&&0.1>Math.abs(b);if(!this.panningActive&&c&&b){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();
this.event_updatePosition(this,d,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPosition:function(d,b){this.viewportX=d;this.viewportY=b;this.isUpdating?this.stopUpdate():(this.resetVariables(),this.updateElementPosition())},setTargetPosition:function(d,b){this.viewportTargetX=d||0;this.viewportTargetY=b||0;this.startUpdate();this.processInertia=!0},calcExpectedPosition:function(d){var b=
0,c="x"==d?this.currentVelocityX:this.currentVelocityY,a="x"==d?this.currentDirectionX:this.currentDirectionY,f="x"==d?this.viewportTargetX:this.viewportTargetY,e="x"==d?this.minPositionX:this.minPositionY,d="x"==d?this.maxPositionX:this.maxPositionY;if(c)for(var k=Math.log(0.0010/c)/Math.log(0.94),g=0;g<k;g++)b+=15*a*c,c*=0.94;return Math.max(e,Math.min(d,f+b))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),
r=j(n,{minScrollDelta:0,scrollX:!0,scrollY:!0,event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),event_startInertia:n.createEvent("startInertia","scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(d){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=
this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=!1;n.prototype.init.call(this,d);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=w?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;
if(0==this.minScrollDelta)this.minScrollDeltaXReached=this.minScrollDeltaYReached=!0},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var d=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",b=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px";this.targetElement.style[u]="translate("+d+", "+b+")"+(t?" translateZ(0)":
"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=!1},startUpdate:function(){if(!this.isUpdating)this.isUpdating=!0,this.updateFrameHandle=this.nextFrame(),this.lastUpdateTime=Date.now(),this.event_start(this)},
stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=!1,q(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(d){this.stopUpdate();this.panningActive=!0;this.lastMouseX=m.mouseX(d);this.lastMouseY=m.mouseY(d);this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,this);m.addHandler(document,
"touchend",this.onMouseUp,this);m.cancelDefault(d)},onMouseMove:function(d){(0==this.minScrollDelta||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var b=Date.now(),c=b-this.lastMotionUpdateTime;this.lastMotionUpdateTime=b;if(c){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached)b=m.mouseX(d),c=this.lastMouseX-b,this.lastMouseX=b,this.viewportTargetX+=c;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)d=m.mouseY(d),b=this.lastMouseY-d,this.lastMouseY=
d,this.viewportTargetY+=b;if(0<this.minScrollDelta&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=!0;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=!0;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=
!1;this.processInertia=!0;var d=Date.now()-this.lastMotionUpdateTime,d=Math.max(10,d);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,d/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,d/100)));m.removeHandler(document,"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},
onUpdate:function(d){d||(d=Date.now());var b=d-this.lastUpdateTime;this.lastUpdateTime=d;if(b){if(this.panningActive){var c;if(this.scrollX&&(c=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,c))this.currentVelocityX=Math.abs(c)/b,this.currentDirectionX=0==c?0:0>c?-1:1;if(this.scrollY&&(c=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,c))this.currentVelocityY=Math.abs(c)/b,this.currentDirectionY=0==c?0:0>c?-1:
1}else this.processInertia&&(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*b,this.currentVelocityX*=0.94),this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*b,this.currentVelocityY*=0.94));b=c=0;this.scrollX&&(c=this.viewportTargetX-this.viewportX,this.viewportX+=c*(this.panningActive||0<this.currentVelocityX?1:0.12));this.scrollY&&(b=this.viewportTargetY-this.viewportY,this.viewportY+=b*(this.panningActive||0<this.currentVelocityY?
1:0.12));c=!this.scrollX||0.5>Math.abs(c);b=!this.scrollY||0.5>Math.abs(b);if(!this.panningActive&&c&&b){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,d,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPositionX:function(d,b){b?(this.viewportTargetX=d||0,
this.currentVelocityX=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetX=this.viewportX=d,this.updateElementPosition())},setPositionY:function(d,b){b?(this.viewportTargetY=d||0,this.currentVelocityY=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetY=this.viewportY=d,this.updateElementPosition())},calcExpectedPosition:function(d){var b=0,c="x"==d?this.currentVelocityX:this.currentVelocityY,a="x"==d?this.currentDirectionX:this.currentDirectionY,d="x"==d?this.viewportTargetX:this.viewportTargetY;
if(c)for(var f=Math.log(0.0010/c)/Math.log(0.94),e=0;e<f;e++)b+=15*a*c,c*=0.94;return d+b},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),v=j(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',init:function(d){basis.ui.Node.prototype.init.call(this,d);this.startProperty="horizontal"==this.type?
"left":"top";this.endProperty="horizontal"==this.type?"right":"bottom";o(this.element).add(this.type)},recalcSize:function(d){g.display(this.element,1>d);var b="horizontal"==this.type?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=b-b*d},updatePosition:function(d){var b=this.trackSize*d,d=this.trackSize-this.trackSize*d;0>b&&(b=0);0>d&&(d=0);var c={};c[this.startProperty]=b+"px";c[this.endProperty]=d+"px";g.setStyle(this.tmpl.trackElement,c)}}),j=j(basis.ui.Container,{useScrollbars:!0,
scrollX:!0,scrollY:!0,wheelDelta:40,event_realign:n.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(d){d=m.wheelDelta(d);this.scrollX?this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*d,!0):this.scrollY&&this.scroller.setPositionY(this.scroller.viewportTargetY-this.wheelDelta*d,!0)}},init:function(d){basis.ui.Node.prototype.init.call(this,
d);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;d=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new r(d);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=new v({type:"horizontal",container:this.element});
if(this.scrollY)this.vScrollbar=new v({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){o(this.element).add("scrollProcess")},finish:function(){o(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var d=this.scroller;d.panningActive||this.fixPosition();this.useScrollbars&&(this.scrollX&&this.hScrollbar.updatePosition(d.viewportX/this.maxPositionX),this.scrollY&&this.vScrollbar.updatePosition(d.viewportY/this.maxPositionY))},fixPosition:function(){var d=
this.scroller;if(this.scrollX&&(d.viewportX<this.minPositionX||d.viewportX>this.maxPositionX)){var b=Math.min(this.maxPositionX,Math.max(this.minPositionX,d.viewportX));d.setPositionX(b,!0)}if(this.scrollY&&(d.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))b=Math.min(this.maxPositionY,Math.max(this.minPositionY,d.viewportY)),d.setPositionY(b,!0)},realign:function(){this.calcDimentions();this.scrollUpdatePosition();this.event_realign()},calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var d=
this.element.offsetWidth,b=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,b-d)}if(this.scrollY){var c=this.element.offsetHeight,a=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,a-c)}this.useScrollbars&&(this.scrollX&&this.hScrollbar.recalcSize(d/b),this.scrollY&&this.vScrollbar.recalcSize(c/a))}},destroy:function(){this.scroller.destroy();basis.ui.Node.prototype.destroy.call(this)}});basis.namespace("basis.ui.scroller").extend({Scroller:k,Scroller2:r,ScrollPanel:j})})(basis);
(function(e){var j=e.Class,g=e.dom,n=e.dom.event,m=e.cssom,o=e.dom.wrapper,w=e.ui.Container,t=e.animation.Modificator,u=j(e.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(e){e.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),y=j(w,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:u}}}),s=!0,q=j(w,{behaviour:{click:function(e,g){g&&g.delegate.parentNode.scrollToNode(g.delegate)}},init:function(e){this.inherit(e);this.document=this;s&&n.addHandler(this.element,"mousewheel",function(e){try{this.owner.content.dispatchEvent(e)}catch(k){s=!1,n.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}}),j=j(o.Control,{childClass:y,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:!0,init:function(k){this.inherit(Object.complete({childNodes:null},k));var j=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new j({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;m.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new o.ChildNodesDataset(this);
this.header=new q({container:this.element,childClass:j,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new q({container:this.element,childClass:j,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});g.hide(this.header.element);g.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new e.Animation.Thread({duration:400,interval:15});var v=this;this.modificator=new t(this.thread,function(d){v.content.scrollTop=parseInt(d);
v.recalc()},0,0,!0);this.modificator.timeFunction=function(d){return Math.sin(Math.acos(1-d))};n.addHandler(this.content,"scroll",this.recalc,this);n.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",!0);k.childNodes&&this.setChildNodes(k.childNodes);this.timer_=setInterval(function(){v.recalc()},500)},scrollToNode:function(e){if(e&&e.parentNode===this)if(e=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[g.index(e)]),this.thread){var j=
this.content.scrollTop;this.modificator.setRange(j,j);this.thread.stop();this.modificator.setRange(j,e);this.thread.start()}else this.content.scrollTop=e},recalc:function(){var e=this.content,j=e.clientHeight,m=e.scrollHeight,e=e.scrollTop,d=j==m;if(this.clientHeight_!=j||this.scrollHeight_!=m){this.clientHeight_=j;this.scrollHeight_=m;var m=[],b=[];if(!d)for(var c=this.meterElement.offsetHeight,a=0,j=c*this.childNodes.length-j,f,h=0;f=this.childNodes[h];h++)f=f.element.offsetTop,m.push(f?f-a:m[h-
1]||0),b.push(f?f+j:b[h-1]||j),a+=c,j-=c;this.topPoints=m;this.bottomPoints=b;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=d)this.isFit=d,g.display(this.header.element,!d),g.display(this.footer.element,!d);if(!d&&this.scrollTop_!=e)if(this.scrollTop_=e,d)this.lastTopPoint=0,this.lastBottomPoint=this.childNodes.length;else{var q=this.topPoints.binarySearchPos(e),l=this.bottomPoints.binarySearchPos(e);if(this.lastTopPoint!=q)this.lastTopPoint=q,this.header.childNodes.forEach(function(a,
b){a.element.style.display=b>=q?"none":""});if(this.lastBottomPoint!=l)this.lastBottomPoint=l,this.footer.childNodes.forEach(function(a,b){a.element.style.display=b<l?"none":""})}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();n.removeHandler(this.content,"scroll",this.recalc,this);n.removeHandler(window,"resize",this.recalc,this);this.inherit()}});e.namespace("basis.ui.toc").extend({Control:j,
ControlItem:y,ControlItemHeader:u,ControlHeaderList:q})})(basis);
(function(e){var j=e.dom,g=e.dom.event,n=e.EventObject.createEvent,m=e.cssom.classList,o=e.dragdrop.DragDropElement,w=e.layout.Box,t=e.ui.Node,u=e.ui.Container,y=t.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(e){t.prototype.init.call(this,e);j.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&m(this.element).add("last");this.isRange&&m(this.element).add("range")}}),s=u.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:y,captionGetter:Function.$self,count:0,marks:null,init:function(e){u.prototype.init.call(this,e);this.apply()},apply:function(){var e=this.marks||[];if(0<this.count){var g=this;e.push.apply(e,Array.create(this.count,function(d){var b=this.closest((d+1)/g.count);return{pos:(b-this.min)/this.range_,caption:g.captionFormat(b),isLast:g.count==
d+1}},this.owner_))}var j=0,e=e.filter(Function.$isNotNull).sortAsObject("pos").map(function(d){var b=d.pos;d.width=d.pos-j;d.pos=j;j=b;return d},this);1!=j&&e.push({pos:j,width:1-j,isLast:!0});this.setChildNodes(e)}}),q={move:function(){var e=this.tmpl.scrollbar;this.setValue_((g.mouseX(event)-(new w(e)).left)/e.offsetWidth*this.count_)}},n=t.subclass({event_change:n("change"),captionFormat:function(e){return Math.round(Number(e))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(e){var j=this.tmpl.scrollbar;this.setValue_((g.mouseX(e)-(new w(j)).left)/j.offsetWidth*this.count_)},focus:function(){j.focus(this.element)},step:function(e){var m=g.wheelDelta(e);if(m)j.focus(this.element),0>m?this.stepDown():this.stepUp();else switch(g.key(e)){case g.KEY.DOWN:case g.KEY.LEFT:case 189:case 109:this.stepDown();break;case g.KEY.UP:case g.KEY.RIGHT:case 187:case 107:this.stepUp();break;case g.KEY.PAGEDOWN:this.stepDown(10);break;case g.KEY.PAGEUP:this.stepUp(10);
break;case g.KEY.HOME:this.setValue(this.min);break;case g.KEY.END:this.setValue(this.max)}}},satelliteConfig:{marks:{instanceOf:u.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:s})}},marks:"auto",init:function(e){var g=this.step,j=this.value;this.step=0;this.value=this.min;this.value_=0;t.prototype.init.call(this,e);this.setProperties(this.min,this.max,g);this.setValue(isNaN(j)?this.min:j);this.scrollbarDD=new o({element:this.tmpl.scrollTrumb,handler:q,handlerContext:this})},
setProperties:function(e,g,j){if(e>g)var d=e,e=g,g=d;j=j||1;e=e||0;if(this.min!=e||this.max!=g||this.step!=j)this.count_=Math.ceil((g-e)/j),this.step=j,this.min=e,this.max=this.min+this.count_*this.step,this.range_=this.max-this.min,this.tmpl.minValue.nodeValue=this.captionFormat(this.min),this.tmpl.maxValue.nodeValue=this.captionFormat(this.max),m(this.element).bool("NoMax",this.max==this.min),this.marks&&this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(b){"object"!=
typeof b&&(b={count:b});b=Object.extend({captionFormat:this.captionFormat,owner_:this},b);if("auto"==b.count)b.count=Math.min(this.count_,20);return b},this)),this.setValue(this.value||this.min)},closest:function(e){return this.normalize(this.min+this.range_*e.fit(0,1)+this.step/2)},normalize:function(e){if(e<this.min)e=this.min;else if(e>this.max)e=this.max;return this.min+Math.floor(1.0E-5+(e-this.min)/this.step)*this.step},stepUp:function(e){this.setValue_(this.value_+parseInt(e||1))},stepDown:function(e){this.setValue_(this.value_-
parseInt(e||1))},setValue_:function(e){e=Math.round(e).fit(0,this.count_);if(this.value_!=e){this.value_=e;var g=this.value;this.value=this.normalize(this.min+e*this.step);this.tmpl.scrollTrumb.style.left=(100*(e/this.count_)).toFixed(4)+"%";this.event_change(this,g)}},setValue:function(e){this.setValue_((e-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;t.prototype.destroy.call(this)}});Object.extend(n,{MarkLayer:s,Mark:y});e.namespace("basis.ui.slider").extend({Slider:n})})(basis);
(function(e){function j(e,g){if(window.getComputedStyle){var j=document.defaultView.getComputedStyle(e,null);if(j)return j.getPropertyValue(g)}else if(e.currentStyle)return e.currentStyle[g]}var g=e.dom,n=e.cssom.classList,m=e.dragdrop.DragDropElement,o=e.cssom.cssRule("IFRAME"),w={width:"deltaX",height:"deltaY"},t={width:{"-1":"w-resize",1:"e-resize"},height:{"-1":"n-resize",1:"s-resize"}},m=m.subclass(function(e){return{factor:NaN,property:"width",event_prepare:function(){w[this.property]?o.setProperty("pointerEvents",
"none"):("undefined"!=typeof console&&console.warn("Property to change `"+this.property+"` is unsupported"),this.stop())},event_start:function(g){e.event_start.call(this,g);g.delta=w[this.property];g.factor=this.factor;var m=this.element.parentNode,q=j(this.element,"float"),k=j(this.element,"position");if("deltaY"==g.delta){if(m=m.clientHeight-parseFloat(j(m,"padding-top"))-parseFloat(j(m,"padding-bottom")),g.offsetStart=this.element.offsetHeight,isNaN(g.factor))g.factor="static"!=k&&"auto"!=j(this.element,
"bottom")?-1:1}else if(m=m.clientWidth-parseFloat(j(m,"padding-left"))-parseFloat(j(m,"padding-right")),g.offsetStart=this.element.offsetWidth,isNaN(g.factor))g.factor="right"==q||"static"!=k&&"auto"!=j(this.element,"right")?-1:1;g.offsetStartInPercent=100/m;n(this.resizer).add("selected")},event_move:function(g){e.event_move.call(this,g);this.element.style[this.property]=g.offsetStartInPercent*(g.offsetStart+g.factor*g[g.delta])+"%"},event_over:function(g){e.event_over.call(this,g);n(this.resizer).remove("selected");
o.setProperty("pointerEvents","auto")},init:function(j){this.resizer=g.createElement(".Basis-Resizer");this.resizer.style.cursor=t[this.property][1];e.init.call(this,j)},setElement:function(j){var m=this.element;e.setElement.call(this,j,this.resizer);m!==this.element&&(m&&g.remove(this.resizer),this.element&&g.insert(this.element,this.resizer))}}});e.namespace("basis.ui.resizer").extend({Resizer:m})})(basis);
(function(e){function j(e){return(100*e).toFixed(4)+"%"}function g(e){var g=e.childNodes.search(e.activePage_,"data.pageNumber");g?g.select():e.selection.clear()}var n=e.dom.event,m=e.EventObject.createEvent,o=e.cssom.classList,w=e.layout.Box,t=e.dragdrop.DragDropElement,u=e.ui.Control,y=e.ui.Node.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
templateUpdate:function(e){var g=this.pageGetter(this);e.pageNumber.nodeValue=g+1;e.link.href=this.urlGetter(g)},action:{click:function(e){n.kill(e);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))}}),s={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(e){e=((this.initOffset+e.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(e*(this.pageCount_-this.pageSpan_)));
this.tmpl.scrollTrumb.style.left=j(e)},over:function(){this.setSpanStartPage(this.spanStartPage_)}},m=u.subclass({childClass:y,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(e,g){var j=this.tmpl.scrollbar,j=(n.mouseX(g)-(new w(j)).left)/j.offsetWidth;this.setSpanStartPage(Math.floor(j*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(e){(e=n.wheelDelta(e))&&this.setSpanStartPage(this.spanStartPage_+e)}},event_activePageChanged:m("activePageChanged"),event_pageCountChanged:m("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(e){u.prototype.init.call(this,e);this.setProperties(e.pageCount||0,
e.pageSpan);this.setActivePage(Math.max(e.activePage-1,0),!0);this.scrollbarDD=new t({element:this.tmpl.scrollTrumb,handler:s,handlerContext:this})},setProperties:function(e,g,m){e=e||1;g=Math.min(g||10,e);if(g!=this.pageSpan_)this.pageSpan_=g,this.setChildNodes(Array.create(g,function(b){return{data:{pageNumber:b}}}));if(this.pageCount_!=e){this.pageCount_=e;var n=1/e;this.tmpl.activePageMark.style.width=j(n/(1-n));this.tmpl.activePageMarkWrapper.style.width=j(1-n);this.event_pageCountChanged(this.pageCount_)}var n=
g/e,d=n/(1-n);this.tmpl.scrollTrumbWrapper.style.width=j(1-n);this.tmpl.scrollTrumb.style.width=j(d);o(this.element).bool("Basis-Paginator-WithNoScroll",g>=e);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(3==arguments.length?m:this.activePage_)},setActivePage:function(e,k){e=e.fit(0,this.pageCount_-1);if(e!=this.activePage_)this.activePage_=Number(e),g(this),this.event_activePageChanged(e);this.tmpl.activePageMark.style.left=j(e/Math.max(this.pageCount_-1,1));k&&this.spotlightPage(this.activePage_)},
spotlightPage:function(e){this.setSpanStartPage(e-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(e){e=e.fit(0,this.pageCount_-this.pageSpan_);if(e!=this.spanStartPage_){this.spanStartPage_=e;for(var k=this.childNodes.length;0<k--;)this.childNodes[k].update({pageNumber:e+k});g(this)}this.tmpl.scrollTrumb.style.left=j((e/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;u.prototype.destroy.call(this)}});e.namespace("basis.ui.paginator").extend({Paginator:m})})(basis);
(function(e){var j="basis.ui.pageslider",g=e.dom,n=e.Class,m=e.cssom.classList,j="basis.ui",n=n(e.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(g,j){e.ui.tabs.PageControl.event_childNodesModified.call(this,g,j);for(var m=0,n;n=this.childNodes[m];m++)e.cssom.setStyle(n.element,{left:100*m+"%"})},init:function(g){var j="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=e.cssom.cssRule("."+j+" > .Basis-Page");this.constructor.superClass_.prototype.init.call(this,
g);m(this.element).add(j);this.scroller=new e.ui.Scroller({targetElement:this.element,preventScrollY:!0,minScrollDelta:10,handler:{startInertia:function(e){var g=this.selection.pick();if(g){var j=g;0==e.currentDirectionX||1==e.currentDirectionX&&e.viewportX<g.element.offsetLeft||-1==e.currentDirectionX&&e.viewportX>g.element.offsetLeft?(e.minScrollDeltaXReached=!0,j=this.childNodes[Math.round(e.viewportX/g.element.offsetWidth)]):j=1==e.currentDirectionX?g.nextSibling:g.previousSibling;j||(j=g);j==
g?this.slideToPage(g):j.select()}e.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var e=this.pick();e&&e.parentNode.slideToPage(e)}});if(this.selection.itemCount){var n=this;setTimeout(function(){n.slideToPage(n.selection.pick())},0)}},slideToPage:function(e){this.scroller.setTargetPosition(e.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);g.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});e.namespace(j).extend({PageSlider:n})})(basis);
(function(e){var j=e.dom.wrapper.Node,g=e.ui.Node,n=j.subclass({draw:function(e){e.save();e.fillStyle="red";e.fillRect(10*this.data.value,10,30,30);e.restore()},update:function(){var e=j.prototype.update.apply(this,arguments);if(e)for(var g=this.parentNode;g;){if(g instanceof m){g.updateCount++;break}g=g.parentNode}return e}}),m=g.subclass({template:"<canvas{canvas}><div>Canvas doesn't support.</div></canvas>",childFactory:function(e){return new this.childClass(e)},childClass:n,drawCount:0,lastDrawUpdateCount:-1,
init:function(e){g.prototype.init.call(this,e);this.element.width=this.width;this.element.height=this.height;this.updateCount=0;if((e=this.tmpl.canvas)&&e.getContext)this.context=e.getContext("2d");this.updateTimer_=setInterval(this.draw.bind(this),1E3/60)},reset:function(){this.element.width=this.element.clientWidth;this.element.height=this.element.clientHeight},isNeedToDraw:function(){return this.context&&(this.updateCount!=this.lastDrawUpdateCount||this.element.width!=this.lastDrawWidth||this.element.height!=
this.lastDrawHeight)},draw:function(){if(!this.isNeedToDraw())return!1;this.lastDrawWidth=this.element.width;this.lastDrawHeight=this.element.height;this.lastDrawUpdateCount=this.updateCount;this.drawCount+=1;this.reset();this.drawFrame();return!0},drawFrame:function(){for(var e=this.firstChild;e;e=e.nextSibling)e.draw(this.context)},destroy:function(){clearInterval(this.updateTimer_);g.prototype.destroy.call(this)}});e.namespace("basis.ui.canvas").extend({Canvas:m,Shape:n})})(basis);
(function(e){function j(e,g){for(var j=function(e){function g(a,c,d,k){b!=c&&j.push(e.substring(b,c).replace(m,'<span class="token-keyword">$1</span>'));b=d+1;j.push('<span class="token-'+a+'">'+e.substring(c,d+1)+"</span>"+(k||""))}for(var j=[],n=e.toArray(),d,b=0,c=0;c<n.length;c++)if("'"==n[c])for(d=c;++c<n.length;){if("'"==n[c]){g("string",d,c);break}if("\n"==n[c])break;"\\"==n[c]&&(c++,"\n"==n[c]&&(g("string",d,c-1),d=c+1))}else if('"'==n[c])for(d=c;++c<n.length;){if('"'==n[c]){g("string",d,
c);break}if("\n"==n[c])break;"\\"==n[c]&&(c++,"\n"==n[c]&&(g("string",d,c-1),d=c))}else if("/"==n[c]){d=c;c++;if("/"==n[c]){for(;++c<n.length&&!("\n"==n[c]););g("comment",d,c-1)}if("*"==n[c])for(;++c<n.length;)if("*"==n[c]&&"/"==n[c+1]){g("comment",d,++c);break}else"\n"==n[c]&&(g("comment",d,c-1,"\n"),b=d=c+1)}j.push(e.substr(b).replace(m,'<span class="token-keyword">$1</span>'));return j}(function(e){e=e.trimRight().replace(/\r\n|\n\r|\r/g,"\n");g||(e=e.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));e=
e.replace(/\n[ \t]+/g,function(b){return b.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!g){for(var j=1E3,m=e.split(/\n+/),n=Number(null!=e.match(/^function/));n<m.length;n++){var d=m[n].match(/^\s*/);if(d[0].length<j)j=d[0].length;if(0==j)break}0<j&&(e=e.replace(RegExp("(^|\\n) {"+j+"}","g"),"$1"))}return e=e.replace(RegExp("(^|\\n)( +)","g"),function(b,c,a){return c+"\u00a0".repeat(a.length)})}(e).replace(/</g,"&lt;")).join("").split("\n"),n=(""+(j.length>>1)).length,y=[],s=0;s<j.length;s++)y.push('<div class="line '+
(s%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(s+1).lead(n)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(j[s]+"\r\n")+"</span></div>");return y.join("")}var g=e.Class,n=e.ui.Node,m=RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+")\\b","g"),g=g(n,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',
codeGetter:Function.getter("data.code"),normalize:!0,templateUpdate:function(){var e=this.codeGetter(this);if(e!=this.code_)this.code_=e,this.tmpl.codeElement.innerHTML=j(e,!this.normalize)}});e.namespace("basis.format.highlight").extend({highlight:j,SourceCodeNode:g})})(basis);
