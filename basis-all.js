/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(d){function l(b,k){for(var f in k)b[f]=k[f];return b}function g(b,k){for(var f in k)f in b==false&&(b[f]=k[f]);return b}function n(b){return b==null||b==void 0}function m(b){return b}function q(b){var k={};b.names=function(b){return Object.slice(k,typeof b=="string"?b.qw():b)};b.extend=function(b){g(k,b);l(this,b);return this};return b}function x(b,k){for(var f=b.split("."),a=d,c,h,o;f.length;)if(c=f.shift(),h=(h?h+".":"")+c,a[c]||(a[c]=q((!f.length?k:null)||function(){},h),o&&(o.namespaces_[h]=
a[c])),a=a[c],!o&&(o=a,!o.namespaces_))o.namespaces_={};return i[b]=a}l(Object,{extend:l,complete:g,keys:function(b){var a=[],f;for(f in b)a.push(f);return a},values:function(b){var a=[],f;for(f in b)a.push(b[f]);return a},slice:function(b,a){var f={};if(!a)return l(f,b);for(var c=0,t;t=a[c++];)t in b&&(f[t]=b[t]);return f},splice:function(b,a){var f={};if(!a)return l(f,b);for(var c=0,t;t=a[c++];)t in b&&(f[t]=b[t],delete b[t]);return f},iterate:function(b,a,f){var c=[],t;for(t in b)c.push(a.call(f,
t,b[t]));return c},coalesce:function(){for(var b=arguments,a=0;a<b.length;a++)if(b[a]!=null)return b[a]}});var u=function(){},v=function(){var b=1,a={},f={};b++;return function(c,t){var h,o;if(!t){if(c.getter)return c.getter;if(typeof c=="function")return c}if(typeof c!="function")f[c]?h=f[c]:(h=new Function("object","return object != null ? object."+c+" : object"),h.path=c,h.getterIdx_=b++,f[c]=h);else if(h=c,!h.getterIdx_)h.getterIdx_=b++;o=h.getterIdx_;var e=a[o];if(e)if(typeof t=="undefined"){if(e.nmg)return e.nmg}else for(o=
0;o<e.length;o++){if(e[o].modificator===t)return e[o].getter}else e=a[o]=[];var A=true;switch(t&&typeof t){case "string":o=function(b){return t.format(h(b))};break;case "function":o=function(b){return t(h(b))};break;case "object":A=false;o=function(b){return t[h(b)]};break;default:o=h.path?h:function(b){return h(b)}}if(A&&(e.push({getter:o,modificator:t}),typeof t=="undefined"))e.nmg=o;return o.getter=o}}();l(Function,{$undefined:function(b){return b==void 0},$defined:function(b){return b!=void 0},
$isNull:n,$isNotNull:function(b){return b!=null&&b!=void 0},$isSame:function(b){return b===this},$isNotSame:function(b){return b!==this},$self:m,$const:function(b){return function(){return b}},$false:function(){return false},$true:function(){return true},$null:function(){return null},$undef:u,getter:v,def:function(b,a,f){f=f||n;return function(c){c=b(c);return f(c)?a:c}},wrapper:function(b){return function(a){var f={};f[b]=a;return f}},lazyInit:function(b,a){var f=0,c;return function(){f++||(c=b.apply(a||
this,arguments));return c}},lazyInitAndRun:function(b,a,f){var c=0,t;return function(){c++||(t=b.call(f||this));a.apply(t,arguments);return t}},runOnce:function(b,a){var f=0;return function(){if(!f++)return b.apply(a||this,arguments)}}});g(Function.prototype,{bind:function(b){var a=this,f=Array.from(arguments,1);return f.length?function(){return a.apply(b,f.concat.apply(f,arguments))}:function(){return a.apply(b,arguments)}}});g(Array,{isArray:function(b){return Object.prototype.toString.call(b)===
"[object Array]"}});l(Array,{from:function(b,a){if(b!=null){var f=b.length;if(typeof f=="undefined")return[b];a||(a=0);if(f-a>0){for(var c=[],t=0,h=a;h<f;)c[t++]=b[h++];return c}}return[]},create:function(b,a,f){for(var c=[],t=typeof a=="function",h=0;h<b;h++)c[h]=t?a.call(f,h,c):a;return c}});g(Array.prototype,{indexOf:function(b,a){a=parseInt(a)||0;if(a<0)return-1;for(;a<this.length;a++)if(this[a]===b)return a;return-1},lastIndexOf:function(b,a){for(var f=this.length,a=parseInt(a),a=isNaN(a)||a>=
f?f-1:(a+f)%f;a>=0;a--)if(this[a]===b)return a;return-1},forEach:function(b,a){for(var f=0,c=this.length;f<c;f++)f in this&&b.call(a,this[f],f,this)},every:function(b,a){for(var f=0,c=this.length;f<c;f++)if(f in this&&!b.call(a,this[f],f,this))return false;return true},some:function(b,a){for(var f=0,c=this.length;f<c;f++)if(f in this&&b.call(a,this[f],f,this))return true;return false},filter:function(b,a){for(var f=[],c=0,t=this.length;c<t;c++)c in this&&b.call(a,this[c],c,this)&&f.push(this[c]);
return f},map:function(b,a){for(var f=[],c=0,t=this.length;c<t;c++)c in this&&(f[c]=b.call(a,this[c],c,this));return f},reduce:function(b,a){var f=this.length,c=arguments.length;if(f==0&&c==1)throw new TypeError;var t,h=0;c>1&&(t=a,h=1);for(c=0;c<f;c++)c in this&&(t=h++?b.call(null,t,this[c],c,this):this[c]);return t}});l(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(b){return Array.create(parseInt(b)||0,this).flatten()},item:function(b){b=parseInt(b||0);return this[b>=
0?b:this.length+b]},search:function(b,a,f){Array.lastSearchIndex=-1;for(var a=Function.getter(a||m),f=parseInt(f)||0,c=this.length;f<c;f++)if(a(this[f])===b)return this[Array.lastSearchIndex=f]},lastSearch:function(b,a,f){Array.lastSearchIndex=-1;for(var a=Function.getter(a||m),c=this.length,f=isNaN(f)||f==null?c:parseInt(f),c=f>c?c:f;c-- >0;)if(a(this[c])===b)return this[Array.lastSearchIndex=c]},binarySearchPos:function(b,a,f,c,t,h){if(!this.length)return c?-1:0;var a=Function.getter(a||m),f=!!f,
o,t=isNaN(t)?0:t,e=isNaN(h)?this.length-1:h;do if(h=t+e>>1,o=a(this[h]),f?b>o:b<o)e=h-1;else if(f?b<o:b>o)t=h+1;else return b==o?h:c?-1:0;while(t<=e);return c?-1:h+(o<b^f)},binarySearch:function(b,a){return this.binarySearchPos(b,a,false,true)},add:function(b){return this.indexOf(b)==-1&&!!this.push(b)},remove:function(b){b=this.indexOf(b);return b!=-1&&!!this.splice(b,1)},has:function(b){return this.indexOf(b)!=-1},merge:function(b){return this.reduce(l,b||{})},sortAsObject:function(b,a,f){b=Function.getter(b);
f=f?-1:1;return this.map(function(a,f){return{i:f,v:b(a)}}).sort(a||function(b,a){return f*(b.v>a.v||-(b.v<a.v)||(b.i>a.i?1:-1))}).map(function(b){return this[b.i]},this)},set:function(b){if(this!==b)this.length=0,this.push.apply(this,b);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var y=Array.prototype.splice;Array.prototype.splice=function(){var b=Array.from(arguments);if(b.length<2)b[1]=this.length;return y.apply(this,b)}}var s={"<":">","[":"]","(":")",
"{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};g(String,{toLowerCase:function(b){return String(b).toLowerCase()},toUpperCase:function(b){return String(b).toUpperCase()},trim:function(b){return String(b).trim()},trimLeft:function(b){return String(b).trimLeft()},trimRight:function(b){return String(b).trimRight()},isEmpty:function(b){return b==
null||String(b)==""},isNotEmpty:function(b){return b!=null&&String(b)!=""}});g(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});l(String.prototype,{toObject:function(b){try{return Function("return 0,"+this)()}catch(a){if(b)throw a;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var b=[],a=this.length,f=0;f<a;f++)b[f]=this.charAt(f);return b},
repeat:function(b){return Array(parseInt(b)+1||0).join(this)},qw:function(){var b=this.trim();return b?b.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,"\\$&")},format:function(b){for(var a={},f=0;f<arguments.length;f++)a[f]=arguments[f];typeof b=="object"&&l(a,b);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(b,f,c,o,e){b=f in a?a[f]:e?"":b;return c&&!isNaN(b)?(b=Number(b),c=="."?b.toFixed(o):b.lead(o)):b})},quote:function(b,
a){var b=b||'"',a=a||s[b]||b,f=(b.length==1?b:"")+(a.length==1?a:"");return b+(f?this.replace(RegExp("["+f.forRegExp()+"]","g"),"\\$&"):this)+a},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(b,a){return a.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(b){return"-"+b.toLowerCase()})}});String.format=String.prototype.format;if("|||".split(/\|/).length+"|||".split(/(\|)/).length!=
11)String.prototype.split=function(b){if(b==""||b&&b.source=="")return this.toArray();var a=[],f=0,c;if(b instanceof RegExp)for(b.global||(b=RegExp(b.source,/\/([mi]*)$/.exec(b)[1]+"g"));c=b.exec(this);)c[0]=this.substring(f,c.index),a.push.apply(a,c),f=b.lastIndex;else for(;(c=this.indexOf(b,f))!=-1;)a.push(this.substring(f,c)),f=c+b.length;a.push(this.substr(f));return a};if("12".substr(-1)!="2"){var p=String.prototype.substr;String.prototype.substr=function(b,a){return p.call(this,b<0?Math.max(0,
this.length+b):b,a)}}l(Number.prototype,{fit:function(b,a){return!isNaN(b)&&this<b?Number(b):!isNaN(a)&&this>a?Number(a):this},between:function(b,a){return!isNaN(this)&&this>=b&&this<=a},quote:function(b,a){return(this+"").quote(b,a)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(b){return!b||isNaN(b)?0:Math.floor(this/b)*b},lead:function(b,a){return(this+"").replace(/\d+/,function(f){return(b-=f.length-1)>1?Array(b).join(a||
0)+f:f})},group:function(b,a){return(this+"").replace(/\d+/,function(f){return f.replace(/\d/g,function(c,e){return!e+(f.length-e)%(b||3)?c:(a||" ")+c})})},format:function(b,a,f,c,e){b=this.toFixed(b);if(a||e)b=b.replace(/(\d+)(\.?)/,function(b,f,c){return(a?Number(f).group(3,a):f)+(c?e||c:"")});f&&(b=b.replace(/^-?/,"$&"+(f||"")));return b+(c||"")}});g(Date,{now:function(){return+new Date}});(new Date).getYear()<1900&&l(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(b){return this.setFullYear(!isNaN(b)&&
b<100?Number(b)+1900:b)}});var i={},r=function(){function b(b,a){for(var f=i[b],c=a?a.split(/\./):[];f&&c.length;)f=f[c.shift()];return f}var a=d.document?d.document.getElementsByTagName("SCRIPT"):null,f=(a?a[a.length-1].src:module.filename).replace(/[^\/]+$/,""),c={},e;typeof require=="function"?e=function(b){return require(requirePath+b.replace(/\./g,"/"))}:(e=function(a,k){var z=a.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],A=a.substr(z.length?z.length+1:0),C=b(z,A),w=/^basis\./.test(z)?
f:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!i[z]||!C)if(/^https?:/.test(w))if(c[a])throw"Attempt to load namespace, probably cycle require";else{c[a]=1;var w=w+(k||"")+a.replace(/\./g,"/")+".js",g=new XMLHttpRequest;g.open("POST",w,false);g.send(null);if(g.status==200){try{(new Function(g.responseText)).call(d)}catch(B){throw B;}e.sequence.push(a.replace(/\./g,"/")+".js")}else if(g.status==404&&A)r(z);else throw"!";}else throw"Path `"+a+"` can't be resolved";return C||
b(z,A)},e.sequence=[]);return e}(),w=function(){function b(a){return typeof a=="function"&&a.basisClass_}var a=Function(),f=1,c={},e=function(){for(var a in{toString:1})return;return true}();l(a,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=u}},create:function(h){typeof h!="function"&&(h=a);var A=Function();A.prototype=
h.prototype;for(var A=new A,o={className:h.className+"._SubClass_",basisClass_:true,superClass_:h,extendConstructor_:!!h.extendConstructor_,__extend__:function(f){return f&&(typeof f=="object"||typeof f=="function"&&!b(f))&&f!==c?a.create.call(null,D,f):f},extend:a.extend,subclass:function(){return a.create.apply(null,[D].concat(Array.from(arguments)))},prototype:A},e=arguments,t=1;t<e.length;t++)o.extend(typeof e[t]=="function"&&!b(e[t])?e[t](h.prototype):e[t]);var B={},D=o.extendConstructor_?function(a,
b){this.eventObjectId=f++;var c,h;for(h in a)c=this[h],this[h]=c&&c.__extend__?c.__extend__(a[h]):a[h];this.init(b||B)}:function(){this.eventObjectId=f++;this.init.apply(this,arguments)};A.constructor=D;for(var i in A)A[i]===c&&(A[i]=D);l(D,o);return D},extend:function(a){var b=this.prototype;if(a.prototype)a=a.prototype;for(var f in a){var c=a[f],h=b[f];f=="className"||f=="extendConstructor_"?this[f]=c:b[f]=h&&h.__extend__?h.__extend__(c):c}if(e&&a[f="toString"]!==Object.prototype[f])b[f]=a[f];return this}});
var h=function(a,b){return{__extend__:function(a){var f=Function();f.prototype=this;f=new f;b(f,a);return f}}.__extend__(a)},o=function(a){return h(a,l)};return x("basis.Class",a.create).extend({SELF:c,BaseClass:a,create:a.create,isClass:b,CustomExtendProperty:h,ExtensibleProperty:o,NestedExtProperty:function(a){return h(a,function(a,b){for(var f in b){var c=a[f];a[f]=c&&c.__extend__?c.__extend__(b[f]):o(b[f])}})}})}(),e=function(){function a(b){var j=f[b];j||(j=f[b]=function(){var a=this.handlers_,
f,j;if(a&&a.length)for(var a=c.call(a),e=a.length;e-- >0;)f=a[e],j=f.handler[b],typeof j=="function"&&j.apply(f.thisObject,arguments)});return j}var c=Array.prototype.slice,f={},j,e=w(null,{handlers_:null,event_destroy:j=a("destroy","object"),listen:w.NestedExtProperty(),extendConstructor_:true,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,b){var f=this.handlers_;if(!f)f=this.handlers_=
[];b||(b=this);for(var c=f.length,k;c-- >0;)if(k=f[c],k.handler===a&&k.thisObject===b)return false;return!!f.push({handler:a,thisObject:b||this})},removeHandler:function(a,b){var f=this.handlers_;if(f){b||(b=this);for(var c=f.length,k;c-- >0;)if(k=f[c],k.handler===a&&k.thisObject===b)return!!f.splice(c,1);return false}},destroy:function(){if(this.handlers_)j.call(this,this),this.handlers_=null}});e.createEvent=a;e.event=f;return e}(),a=function(){var a=[];return{add:function(c){c!=null&&a.push(c)},
remove:function(c){a.remove(c)}}}();(function(){function a(b){if(c){if(b.source!=d||b.data!=f)return;basis.dom.event.kill(b)}j.length&&(b=j.shift(),delete e[b.key],b.fn())}var c=typeof addEventListener=="function"&&typeof postMessage=="function",f="zeroTimeoutMessage",j=[],e={},h=1;c&&d.addEventListener("message",a,true);var o=setTimeout;d.setTimeout=function(A,i){var z;i?z=o.call(d,A,i):(z={key:"z"+h++,fn:typeof A=="function"?A:new Function(A)},e[z.key]=z,j.push(z),c?postMessage(f,"*"):z.timer=o.call(d,
a,0),z=z.key);return z};var i=clearTimeout;d.clearTimeout=function(a){if(/z\d+/.test(a)){var b=e[a];b&&(clearTimeout(b.timer),j.remove(b),delete e[a])}else return i.call(d,a)}})();var c=function(){function b(){if(!d)if(h.length){var a=Date.now(),b=Math.max(h[0].eventTime,a);b<i&&(clearTimeout(A),A=setTimeout(f,(i=b)-a))}else A=clearTimeout(A),i=j}function c(a,f){var k=a.eventObjectId,j=o[f]&&o[f][k];j&&(h.remove(j),delete o[f][k],b())}function f(){var a=Date.now(),a=h.binarySearchPos(a+15,e);d=true;
h.splice(0,a).forEach(function(a){delete o[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});d=false;i=j;b()}var j=2E12,e=v("eventTime"),h=[],o={},i=j,A=null,d=false;a.add({destroy:function(){d=true;clearTimeout(A);h.length=0;o=null}});return{add:function(a,f,j){var D=a.eventObjectId,A=o[f];A||(A=o[f]={});var i=A[D];if(i){if(isNaN(j))return c(a,f);if(i.eventTime==j)return;h.remove(i);i.eventTime=j}else{if(isNaN(j))return;i=A[D]={eventName:f,object:a,eventTime:j,callback:a[f]}}h.splice(h.binarySearchPos(j,
e),0,i);b()},remove:c}}();x("basis").extend({namespace:x,platformFeature:{},EventObject:e,TimeEventManager:c,Cleaner:a,require:r});d.basis.locale={}})(this);
(function(d,l){function g(e){for(var a=1E6,e=String(e).split("."),c=0,b=0;c<4&&c<e.length;c++,a/=100)b+=e[c]*a;return b}function n(){for(var e=0;e<arguments.length;e++){var a=arguments[e].toLowerCase();if(a in q){if(q[a])return true}else{var c=a.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(c){q[a]=false;var b=c[1].toLowerCase(),k=g(c[3]),c=c[4]||"=";if(b=x[b])return q[a]=!k||c=="="&&b==k||c=="+"&&b>=k||c=="-"&&b<k}}}return false}var m="basis.ua",q={},x={},u=l.navigator&&l.navigator.userAgent,v="unknown",
y={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},s;for(s in y)if(!(s=="MSIE"&&l.opera)&&!(s=="Safari"&&u.match(/chrome/i))&&!(s=="AppleWebKit"&&u.match(/iphone/i))&&u.match(RegExp(s+".(\\d+(\\.\\d+)*)","i")))for(var p=
y[s],i=l.opera&&typeof l.opera.version=="function"?l.opera.version():RegExp.$1,r=g(i),v=p[0]+" "+i,i=0;i<p.length;i++)x[p[i].toLowerCase()]=r;d.platformFeature.datauri=false;u=typeof Image!="undefined"?new Image:{};u.onload=function(){d.platformFeature.datauri=true};u.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(n("IE7-"))try{document.execCommand("BackgroundImageCache",false,true)}catch(w){}m=d.namespace(m);m.toString=function(){return v};return m.extend({testImage:u,
prettyName:v,test:n,is:function(e){return n(e)},Cookies:{set:function(e,a,c,b){document.cookie=e+"="+(a==null?"":escape(a))+";path="+(b||(location.pathname.indexOf("/")==0?"":"/")+location.pathname)+(c?";expires="+(new Date(Date.now()+c*1E3)).toGMTString():"")},get:function(e){return(e=document.cookie.match(RegExp("(^|;)\\s*"+e+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(e[2])},remove:function(e,a){document.cookie=e+"=;expires="+(new Date(0)).toGMTString()+";path="+(a||(location.pathname.indexOf("/")==
0?"":"/")+location.pathname)}}})})(basis,this);
(function(d,l){function g(a,b,c){if(b!=null)return a.insertBefore(f(b)?b:x(b),c||null)}function n(a){return v("",a.cloneNode(true)).innerHTML}function m(a){return f(a)||a&&a.nodeType?a:typeof a=="string"?i.getElementById(a):null}function q(f,h,k){var o,t=[],k=typeof k=="string"?getter(k):k||Function.$true;h&26&&k(f)&&t.push(f);switch(h){case 1:case 2:for(o=f;(o=o[e])&&o!==f.document;)k(o)&&t.push(o);break;case 64:for(o=f[a];o;)k(o)&&t.push(o),o=o[c];break;case 4:case 8:f[a]&&(h=new j(f),h.nodes(k,
t));break;case 128:h=new j(f,k);for(h.cursor_=f[c]||f[e];o=h.next();)t.push(o);break;case 256:for(o=f;o=o[c];)k(o)&&t.push(o);break;case 32:k(f[e])&&t.push(f[e]);break;case 512:h=new j(f,k,j.BACKWARD);for(h.cursor_=f[b]||f[e];o=h.next();)t.push(o);break;case 1024:for(o=f;o=o[b];)k(o)&&t.push(o)}return t}function x(a){return i.createTextNode(a!=null?a:"")}function u(){for(var a=i.createDocumentFragment(),b=arguments.length,f=u.array=[],c=0;c<b;c++)f.push(g(a,arguments[c]));return a}function v(a,b){var f=
a!=void 0&&typeof a!="string",c=(f?a.description:a)||"",k="div",j=c.match(/^([a-z0-9\_\-]+)(.*)$/i);j&&(k=j[1],c=j[2]);if(c!=""){for(var e=[],t={},w;j=z.exec(c);){if(j[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+c+"\n\nProblem place:\n> "+c.substr(0,j.index)+"--\>"+c.substr(j.index)+"<--");w=j[1]||j[2]||j[3];j[1]?t.id=w:j[2]?e.push(w):w!="class"&&(t[w]=j[4]?p(j[5],j[6],j[7]):w)}h&&t.name&&/^(input|textarea|select)$/i.test(k)&&(k="<"+k+" name="+t.name+">")}c=
i.createElement(k);if(t){if(t.style&&o)c.style.cssText=t.style;for(var r in t)c.setAttribute(r,t[r],0)}if(e&&e.length)c.className=e.join(" ");arguments.length>1&&g(c,u.apply(0,Array.from(arguments,1).flatten()));if(f&&(a.css&&d.cssom&&d.cssom.setStyle(c,a.css),d.dom.event))for(var l in a)typeof a[l]=="function"?d.dom.event.addHandler(c,l,a[l],c):a[l]instanceof d.dom.event.Handler&&d.dom.event.addHandler(c,l,a[l].handler,a[l].thisObject);return c}function y(a,b){return a[e]?a[e].replaceChild(b,a):
a}function s(a){if(i.selection){var b=i.selection.createRange();b.compareEndPoints("StartToEnd",b)!=0&&b.collapse(a);return b.getBookmark().charCodeAt(2)-2}}var p=Object.coalesce,i=l.document,r=d.Class,w=i.createElement("div"),e="parentNode",a="firstChild",c="nextSibling",b="previousSibling",k;k=typeof w.compareDocumentPosition=="function"?function(a,b){return a.compareDocumentPosition(b)}:function(a,b){return a==b?0:a.document!=b.document?33:a.sourceIndex>b.sourceIndex?2|8*b.contains(childA):4|16*
a.contains(childB)};var f;if(typeof Node!="undefined"){if(f=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else f=function(a){return a&&a.ownerDocument===i};var j=r(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,b,f){this.setRoot(a);this.setDirection(f);if(typeof b=="function")this.filter=b},setDirection:function(f){Object.extend(this,f?{a:"lastChild",b:b,c:c,d:a}:{a:a,b:c,c:b,d:"lastChild"})},
setRoot:function(a){this.root_=a||i;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,b){var f;b||(b=[]);for(this.reset();f=this.next(a);)b.push(f);return b},next:function(a){var a=a||this.filter,b=this.cursor_||this.root_;do for(var f=b[this.a];!f;){if(b===this.root_)return this.cursor_=null;(f=b[this.b])||(b=b[e])}while(!a(b=f));return this.cursor_=b},prev:function(a){var a=a||
this.filter,b=this.cursor_,f=this.c,c=this.d;do{var h=b?b[f]:this.root_[c];if(h){for(;h[c];)h=h[c];b=h}else b&&(b=b[e]);if(!b||b===this.root_){b=null;break}}while(!a(b));return this.cursor_=b},destroy:function(){this.cursor_=this.root_=null}});j.BACKWARD=true;var t="textContent innerText nodeValue".qw(),h=function(){var a=i.createElement("input");a.name="a";return!/name/.test(n(a))}(),o;w.setAttribute("style","color: red");o=w.style.color!=="red";var z=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return d.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:j,outerHTML:n,textContent:function(a){for(var b=0,f;f=t[b++];)if(a[f]!=null)return a[f];return q(a,4,function(a){return a.nodeType==3}).map(getter("nodeValue")).join("")},get:m,tag:function(a,b){a=m(a)||i;return b=="*"&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(b||"*"))},axis:q,findAncestor:function(a,b,f){for(;a&&a!==f;){if(b(a))return a;a=a.parentNode}},createElement:v,createText:x,createFragment:u,insert:function(b,
h,k,j){b=m(b);if(!b)throw Error("basis.dom.insert: destination node can't be null");switch(k){case void 0:case "end":j=null;break;case "begin":j=b[a];break;case "before":break;case "after":j=j[c];break;default:j=Number(k).between(0,b.childNodes.length)?b.childNodes[k]:null}k=!f(b);if(!h||!Array.isArray(h))k=k?h&&b.insertBefore(h,j):g(b,h,j);else if(k)for(var k=[],e=0,o=h.length;e<o;e++)k[e]=b.insertBefore(h[e],j);else b.insertBefore(u.apply(0,h),j),k=u.array;return k},remove:function(a){return a[e]?
a[e].removeChild(a):a},replace:y,swap:function(a,b){if(a===b||k(a,b)&25)return false;y(a,w);y(b,a);y(w,b);return true},clone:function(a,b){var f=a.cloneNode(!b);f.attachEvent&&q(f,8).forEach(Event.clearHandlers);return f},clear:function(a){for(a=m(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,b,f){var c=[],f=Function.getter(f||Function.$self),h;for(h in b)for(var k=0;k<a.length;k++){var j=f(a[k]);c[k]=b[h](a[k],k,j)?v(h,j):a[k]}return c},setAttribute:function(a,b,f){f==null?
a.removeAttribute(b):a.setAttribute(b,f)},parentOf:function(a,b){return a.contains(b)},isInside:function(a,b){return a==b||b.contains(a)},focus:function(a,b){try{a=m(a),a.focus(),b&&a.select&&a.select()}catch(f){}},setSelectionRange:function(a,b,f){arguments.length<3&&(f=b);if(a.setSelectionRange)a.setSelectionRange(b,f);else if(a.createTextRange){var c=a.createTextRange();c.collapse(true);c.moveStart("character",b);c.moveEnd("character",f-b);c.select()}},getSelectionStart:function(a){return typeof a.selectionStart!=
"undefined"?a.selectionStart:s(true)},getSelectionEnd:function(a){return typeof a.selectionEnd!="undefined"?a.selectionEnd:s(false)}})})(basis,this);
(function(d,l){function g(a){return a||l.event}function n(a){return typeof a=="string"?p.get(a):a}function m(a){a=g(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=true}function q(a){a=g(a);a.preventDefault?a.preventDefault():a.returnValue=false}function x(a){var c=Array.from(e[a.type]);if(c)for(var f=c.length;f-- >0;){var j=c[f];j.handler.call(j.thisObject,a)}}function u(b,c,f,j){b=n(b);if(!b)throw Error("Event.addHandler: can't attach event listener to undefined");if(typeof f!="function")throw Error("Event.addHandler: handler must be a function");
b[r]||(b[r]={});var e={handler:f,thisObject:j},h=b[r],o=h[c];if(o){for(b=0;c=o[b];b++)if(c.handler===f&&c.thisObject===j)return;o.push(e)}else o=h[c]=[e],o.fireEvent=function(b){b=g(b);if(a&&b&&typeof b.returnValue=="undefined"){x(b);if(b.cancelBubble===true)return;if(typeof b.returnValue=="undefined")b.returnValue=true}for(var f=0,c;c=o[f++];)c.handler.call(c.thisObject,b)},b.addEventListener?b.addEventListener(c,o.fireEvent,false):b.attachEvent("on"+c,o.fireEvent)}function v(a,c,f,j){var a=n(a),
e=a[r];if(e&&(e=e[c]))for(var h=0,o;o=e[h];h++)if(o.handler===f&&o.thisObject===j){e.splice(h,1);e.length||y(a,c);break}}function y(a,c){var a=n(a),f=a[r];if(f)if(typeof c!="string")for(c in f)y(a,c);else{var j=f[c];j&&(a.removeEventListener?a.removeEventListener(c,j.fireEvent,false):a.detachEvent("on"+c,j.fireEvent),delete f[c])}}var s=l.document,p=d.dom,i=Function.$null,r="__basisEvents",w={mousewheel:["mousewheel","DOMMouseScroll"]},e={},a=!s.addEventListener,c=function(){function a(){c++||setTimeout(function(){for(var a=
0;a<f.length;a++)f[a].callback.call(f[a].thisObject)},10)}var c=false,f=[];if(d.ua.is("ie7-"))(function(){var f="_"+Date.now();s.write('<script id="'+f+'" defer src="//:"><\/script>');n(f).onreadystatechange=function(){this.readyState=="complete"&&(p.remove(this),a())}})();else if(d.ua.is("safari525-"))var j=setInterval(function(){/loaded|complete/.test(s.readyState)&&(clearInterval(j),a())},15);else u(s,"DOMContentLoaded",a,false);u(s,"load",a,false);u(l,"load",a,false);return function(a,b){c||f.push({callback:a,
thisObject:b})}}();return d.namespace("basis.dom.event",g).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return w[a]||[a]},Handler:function(a,c){this.handler=a;this.thisObject=c},sender:function(a){a=g(a);return a.target||a.srcElement},cancelBubble:m,
cancelDefault:q,kill:function(a,c){(c=n(c))?u(c,a,Event.kill):(q(a),m(a))},key:function(a){a=g(a);return a.keyCode||a.which||0},charCode:function(a){a=g(a);return a.charCode||a.keyCode||0},mouseButton:function(a,c){a=g(a);return typeof a.which=="number"?a.which==c.VALUE:a.button&c.BIT},mouseX:function(a){a=g(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(s.documentElement.scrollLeft||s.body.scrollLeft)},mouseY:function(a){a=g(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(s.documentElement.scrollTop||s.body.scrollTop)},wheelDelta:function(a){a=g(a);return"wheelDelta"in a?a.wheelDelta/120:a.type=="DOMMouseScroll"?-a.detail/3:0},addGlobalHandler:function(a,c,f){var j=e[a];if(j)for(a=j.length;a-- >0;){var t=j[a];if(t.handler===c&&t.thisObject===f)return}else s.addEventListener?s.addEventListener(a,x,true):u(s,a,i),j=e[a]=[];j.push({handler:c,thisObject:f})},removeGlobalHandler:function(a,c,f){var j=e[a];if(j)for(var t=0,h;h=j[t];t++)if(h.handler===
c&&h.thisObject===f){j.splice(t,1);j.length||(delete e[a],s.removeEventListener?s.removeEventListener(a,x,true):v(s,a,i));break}},addHandler:u,addHandlers:function(a,c,f){var a=n(a),j;for(j in c)u(a,j,c[j],f)},removeHandler:v,clearHandlers:y,fireEvent:function(a,c){var a=n(a),f=a[r];f&&f[c]&&f[c].fireEvent()},onLoad:c,onUnload:function(a,c){u(l,"unload",a,c)}})})(basis,this);
(function(){function d(a,c,b){for(var k=1,f;c;)c&1&&(f=s[k],b&k?(a.addHandler(f.handler,f.context),f.action(f.context.add,a)):(a.removeHandler(f.handler,f.context),f.action(f.context.remove,a))),c>>=1,k<<=1}function l(a){return Array.isArray(a)?a.map(l):{data:a}}var g=basis.Class,n=basis.EventObject,m=Object.values,q=Function.$self,x=n.createEvent,u=n.event,v={},y=[],s={},p=1,i={NONE:0,MASK:0,add:function(a,c,b){s[p]={handler:c,action:b,context:{add:function(b,f){if(f){var c=i[a]+"_"+b.eventObjectId;
if(!f.subscribers_)f.subscribers_={};if(!f.subscribers_[c]){var e=f.subscriberCount;f.subscribers_[c]=b;f.subscriberCount+=1;f.event_subscribersChanged(f,e)}}},remove:function(b,f){if(f){var c=i[a]+"_"+b.eventObjectId;if(f.subscribers_[c]){var e=f.subscriberCount;delete f.subscribers_[c];f.subscriberCount-=1;f.event_subscribersChanged(f,e)}}}}};i[a]=p;i.MASK|=p;p<<=1}};i.add("DELEGATE",{delegateChanged:function(a,c){this.remove(a,c);this.add(a,a.delegate)}},function(a,c){a(c,c.delegate)});i.add("TARGET",
{targetChanged:function(a,c){this.remove(a,c);this.add(a,a.target)}},function(a,c){a(c,c.target)});var r=g(n,{state:"ready",data:null,canHaveDelegate:true,delegate:null,root:null,cascadeDestroy:false,isTarget:false,target:null,active:false,subscribeTo:i.DELEGATE+i.TARGET,subscriberCount:0,subscribers_:null,event_update:x("update","object","delta"),event_stateChanged:x("stateChanged","object","oldState"),event_delegateChanged:x("delegateChanged","object","oldDelegate"),event_rootChanged:x("rootChanged",
"object","oldRoot"),event_targetChanged:x("targetChanged","object","oldTarget")&&function(a,c){var b=this.listen.target;b&&(c&&c.removeHandler(b,this),this.target&&this.target.addHandler(b,this));u.targetChanged.call(this,a,c)},event_subscribersChanged:x("subscribersChanged","object"),event_activeChanged:x("activeChanged","object"),listen:{delegate:{update:function(a,c){this.data=a.data;this.event_update(this,c)},stateChanged:function(a,c){this.state=a.state;this.event_stateChanged(this,c)},targetChanged:function(a,
c){this.target=a.target;this.event_targetChanged(this,c)},rootChanged:function(a,c){this.data=a.data;this.event_rootChanged(this,c)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(a){n.prototype.init.call(this,a);if(a=this.delegate)this.delegate=null,this.data=a.data,this.state=a.state,this.setDelegate(a);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&d(this,this.subscribeTo,i.MASK)},isConnected:function(a){if(a instanceof
r){for(;a&&a!==this&&a!==a.delegate;)a=a.delegate;return a===this}return false},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},setDelegate:function(a){if(this.canHaveDelegate&&a&&a instanceof r){if(a.delegate&&this.isConnected(a))return false}else a=null;if(this.delegate!==a){var c=this.state,b=this.data,k=this.delegate,f=this.target,j=this.root,e={};k&&k.removeHandler(this.listen.delegate,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;
this.state=a.state;this.target=a.target;a.addHandler(this.listen.delegate,this);for(var h in a.data)h in b===false&&(e[h]=void 0);for(h in b)b[h]!==a.data[h]&&(e[h]=b[h])}else for(h in this.target=this.delegate=null,this.root=this,this.data={},b)this.data[h]=b[h];this.event_delegateChanged(this,k);this.root!==j&&this.event_rootChanged(this,j);this.target!==f&&this.event_targetChanged(this,f);if(a){for(h in e){this.event_update(this,e);break}c!==this.state&&(String(c)!=this.state||c.data!==this.state.data)&&
this.event_stateChanged(this,c)}return true}return false},setState:function(a,c){var b=this.target||this.getRootDelegate();if(b!==this)return b.setState(a,c);return this.state!=String(a)||this.state.data!=c?(b=this.state,this.state=Object(String(a)),this.state.data=c,this.event_stateChanged(this,b),true):false},deprecate:function(){this.state!="processing"&&this.setState("deprecated")},update:function(a){var c=this.target||this.getRootDelegate();if(c!==this)return c.update(a);if(a){var c={},b=0,k;
for(k in a)this.data[k]!==a[k]&&(b++,c[k]=this.data[k],this.data[k]=a[k]);if(b)return this.event_update(this,c),c}return false},setActive:function(a){a=!!a;return this.active!=a?(this.active=a,this.event_activeChanged(this),d(this,this.subscribeTo,i.MASK*a),true):false},setSubscription:function(a){a&=i.MASK;var c=this.subscribeTo^a;return c?(this.subscribeTo=a,this.active&&d(this,c,a),true):false},destroy:function(){this.active&&d(this,this.subscribeTo,0);this.delegate&&this.setDelegate();n.prototype.destroy.call(this);
this.data=v;this.state="undefined";this.target=this.root=null}}),q=g(null,{itemClass:r,keyGetter:q,map_:null,extendConstructor_:true,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a){var c={};a instanceof r?c.delegate=a:c.data={id:a,title:a};return new this.itemClass(c)},get:function(a,c){var b=a instanceof r?a.eventObjectId:a,k=this.map_[b];!k&&c&&(k=this.map_[b]=this.create(a,c),k.addHandler({destroy:function(){delete this.map_[b]}},
this));return k},destroy:function(){basis.Cleaner.remove(this);for(var a=m(this.map_),c=0,b;b=a[c++];)b.destroy()}}),w=g(r,{state:"undefined",itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:x("datasetChanged","dataset","delta")&&function(a,c){var b,k=0,f=0,j;if(b=c.inserted)for(;j=b[k];)this.item_[j.eventObjectId]=j,k++;if(b=c.deleted)for(;j=b[f];)delete this.item_[j.eventObjectId],f++;this.itemCount+=k-f;this.cache_=null;u.datasetChanged.call(this,a,c)},init:function(a){r.prototype.init.call(this,
a);this.memberMap_={};this.item_={}},has:function(a){return!(!a||!this.item_[a.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=m(this.item_);return this.cache_},pick:function(){for(var a in this.item_)return this.item_[a];return null},top:function(a){var c=[];if(a)for(var b in this.item_)if(c.push(this.item_[b])>=a)break;return c},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();r.prototype.destroy.call(this);
this.cache_=y;this.itemCount=0;this.item_=this.memberMap_=null}}),e=g(w,{listen:{item:{destroy:function(a){this.memberMap_[a.eventObjectId]&&this.remove([a])}}},init:function(a){w.prototype.init.call(this,a);if(a=this.items)this.set(a),this.items=null},add:function(a){for(var c,b=this.memberMap_,k=[],f=0;f<a.length;f++){var j=a[f];if(j instanceof r){var e=j.eventObjectId;b[e]||(b[e]=j,j.addHandler(this.listen.item,this),k.push(j))}}k.length&&this.event_datasetChanged(this,c={inserted:k});return c},
remove:function(a){for(var c,b=this.memberMap_,k=[],f=0;f<a.length;f++){var j=a[f];if(j instanceof r){var e=j.eventObjectId;b[e]&&(j.removeHandler(this.listen.item,this),delete b[e],k.push(j))}}k.length&&this.event_datasetChanged(this,c={deleted:k});return c},set:function(a){if(!this.itemCount)return this.add(a);if(!a.length)return this.clear();for(var c=this.memberMap_,b={},k=[],f=[],j,e,h,o=0;o<a.length;o++)if(j=a[o],j instanceof r)e=j.eventObjectId,b[e]=j,c[e]||(c[e]=j,j.addHandler(this.listen.item,
this),f.push(j));for(e in c)b[e]||(j=c[e],j.removeHandler(this.listen.item,this),delete c[e],k.push(j));var i;var a={},A;if(f&&f.length)A=a.inserted=f;if(k&&k.length)A=a.deleted=k;A&&(i=a);(h=i)&&this.event_datasetChanged(this,h);return h},sync:function(a,c){if(a){e.setAccumulateState(true);for(var b=this.memberMap_,k,f,j={},t=[],h,o=0;o<a.length;o++)if(k=a[o],k instanceof r)f=k.eventObjectId,j[f]=k,b[f]||t.push(k);for(f in this.item_)j[f]||this.item_[f].destroy();c&&t.length&&(h=this.add(t));e.setAccumulateState(false);
return h}},clear:function(){var a,c=this.getItems();if(c.length){for(a=c.length;a-- >0;)c[a].removeHandler(this.listen.item,this);this.event_datasetChanged(this,a={deleted:c});this.memberMap_={}}return a}});e.setAccumulateState=function(){function a(a){var b=a.dataset;f.call(b,b,a)}function c(b,c){var j=b.eventObjectId,k=c.inserted,e=c.deleted,t=h[j];if(k&&e)return t&&(delete h[j],a(t)),f.call(b,b,c);if(t){var i=t[k?"inserted":"deleted"];if(i)return i.push.apply(i,k||e);else a(t)}h[j]=c;c.dataset=
b}function b(){j=1;setAccumulateState(false)}var k=w.prototype,f=k.event_datasetChanged,j=0,e,h={};return function(o){if(o){if(j==0)k.event_datasetChanged=c,e=setTimeout(b,0);j++}else if(j-=j>0,j==0)clearTimeout(e),k.event_datasetChanged=f,o=h,h={},m(o).forEach(a)}}();basis.namespace("basis.data",l).extend({STATE:{UNDEFINED:"undefined",READY:"ready",PROCESSING:"processing",ERROR:"error",DEPRECATED:"deprecated"},SUBSCRIPTION:i,Object:r,DataObject:r,KeyObjectMap:q,AbstractDataset:w,Dataset:e})})(basis,
this);
(function(d,l){function g(b,f,c,t){for(var f=f.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),h=e(),o,i=0;i<f.length;i++)i%2?(o=f[i].split(/\|/),b.getters[o[0]]=c+"childNodes["+t+"]",o=o.length>1?o[1]:o[0]):o=f[i].length?f[i]:null,o!=null&&(w&&(h.lastChild&&h.appendChild(u.createComment("")),t++),h.appendChild(a(o)),t++);return h}function n(a){return function(f){if(!f||!(f.type=="click"&&f.which==3)){var b=d.dom.event.sender(f),c,h;do if(c=b.getAttributeNode&&b.getAttributeNode(a))break;while(b=b.parentNode);if(b&&
c){do if(h=b.basisObjectId)if((h=p[h])&&h.templateAction){b=c.nodeValue.qw();c=0;for(var e;e=b[c++];)h.templateAction(e,d.dom.event(f));break}while(b=b.parentNode)}}}}function m(a,f,b){f=f.trim();if(!f)return"";for(var c="",h;h=r.exec(f);){var e=h[2],i=h[4]||h[5]||e;h[3]&&(a.getters[h[3]]=b+'.getAttributeNode("'+e+'")');if(h=e.match(/^event-([a-z]+)/i)){var A=h[1];if(!s[A]){s[A]=true;h=0;for(var A=d.dom.event.browserEvents(A),w;w=A[h++];)d.dom.event.addGlobalHandler(w,n(e))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,f){var a=d.dom.event(a),b=this,c;do if(c=b.basisObjectId)if((c=p[c])&&c.templateAction){for(var b=f.qw(),h=0,e;e=b[h++];)c.templateAction(e,d.dom.event(a));break}while(b=b.parentNode)}}c+=e=="class"?i.trim().replace(/^(.)|\s+/g,".$1"):"["+e+(i?"="+i.quote('"'):"")+"]"}return c}function q(a,f){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;f||(f=".");for(var b=e(),c,h=0,o,d=a.stack;o=i.exec(a.str);){c=RegExp.leftContext;a.str=a.str.substr(c.length+o[0].length);if(c.length)b.appendChild(g(a,
c,f,h)),h=b.childNodes.length;if(o[5])if(o[5]==d[d.length-1])return d.pop(),b;else throw"Wrong end tag";if(o[6])o[7]&&(a.getters[o[7]]=f+"childNodes["+h+"]"),b.appendChild(u.createComment(o[6]));else{c=o[1];var A=o[2],w=!!o[4],r=f+"childNodes["+h+"]";o=v.createElement(c+m(a,o[3],r));A&&(a.getters[A]=r);w||(d.push(c),o.appendChild(q(a,r+".")));b.appendChild(o)}h++}a.str.length&&b.appendChild(g(a,a.str,f,h));if(d.length)throw"No end tag for "+d.reverse();return b}function x(a){if(!this.proto){a=this.source;
if(typeof a=="function")this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},f=q(a),a=Object.iterate(a.getters,function(a,b){for(var c=a.split(/\|/).map(String.format,"obj_.{0}"),h=b.split(/(\.?childNodes\[(\d+)\])/),e=f,j=0;j<h.length;j+=3){var k=h[j+2];if(!k)break;h[j+2]="";e=e.childNodes[k];e.previousSibling?e.nextSibling||(h[j+1]=".lastChild"):h[j+1]=".firstChild"}return{name:c[0],alias:c.join("="),path:"dom_"+h.join("")}}).sortAsObject("path"),b=0;b<a.length;b++)for(var c=
RegExp("^"+a[b].path.forRegExp()),h=b+1,e;e=a[h++];)e.path=e.path.replace(c,a[b].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,b){obj_=a||{};dom_=proto_.cloneNode(true);_code_();if(b&&obj_.element){var f=obj_.element.basisObjectId=map_.seed++;map_[f]=b}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(f,p);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(p)}}var u=l.document,v=d.dom,y=d.Class,s={},p={seed:1},i=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,r=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;v.createFragment();var w=v.createElement("","a","b").cloneNode(true).childNodes.length==1,e=v.createFragment,
a=v.createText,c=y(null,{__extend__:function(a){return a instanceof c?a:new c(a)},init:function(a){this.source=a},createInstance:function(a,b){x.call(this);return this.createInstance(a,b)},clearInstance:function(){x.call(this)}}),b=u.createElement("DIV");return d.namespace("basis.html").extend({Template:c,escape:function(a){return v.createElement("DIV",v.createText(a)).innerHTML},unescape:function(a){b.innerHTML=a;return b.firstChild.nodeValue},string2Html:function(a){b.innerHTML=a;return v.createFragment.apply(null,
Array.from(b.childNodes))}})})(basis,this);
(function(d){function l(a){return a.sortingValue||0}function g(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return+(a>b)||-(a<b)}function n(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return-(a>b)||+(a<b)}function m(a){return a.childNodes.sort(a.localSortingDesc?n:g)}function q(a,b){var f=b.length-1;a.childNodes=b;a.firstChild=b[0]||null;a.lastChild=b[f]||null;for(var c=f;f=b[c];c--)f.nextSibling=b[c+1]||null,f.previousSibling=b[c-1]||null,a.insertBefore(f,f.nextSibling)}function x(a,b){var f=a.childFactory||
a.document&&a.document.childFactory,c,b=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},b);if(f&&(c=f.call(a,b),c instanceof a.childClass))return c;if(!c)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(c&&c.constructor&&c.constructor.className)+")";}function u(){return d.ui.apply(this,arguments)}var v=d.Class,y=d.dom,s=d.data,p=s.SUBSCRIPTION,i=s.DataObject,
r=s.AbstractDataset,w=s.Dataset,e=y.AXIS_DESCENDANT,a=y.AXIS_DESCENDANT_OR_SELF,c=Function.getter,b=Object.complete,k=y.axis,s=d.EventObject.createEvent,f=d.EventObject.event;p.add("DATASOURCE",{dataSourceChanged:function(a,b){this.remove(a,b);this.add(a,a.dataSource)}},function(a,b){a(b,b.dataSource)});var j=v.ExtensibleProperty(),t={ownerChanged:function(){},destroy:function(a){y.replace(a.element,this)}},h=function(){var a=this.key,b=this.config,f=this.owner,c=typeof b.existsIf!="function"||b.existsIf(f),
h=f.satellite[a];if(c){var c="delegate"in b,e="dataSource"in b,j=typeof b.delegate=="function"?b.delegate(f):null,k=typeof b.dataSource=="function"?b.dataSource(f):null;if(h)c&&h.setDelegate(j),e&&h.setDataSource(k);else{var o=f.tmpl[b.replace||a],h={owner:f};if(c)h.delegate=j;if(e)h.dataSource=k;b.config&&Object.complete(h,typeof b.config=="function"?b.config(f):b.config);h=new b.instanceOf(h);f.satellite[a]=h;o&&h instanceof d.ui.Node&&h.element&&(y.replace(o,h.element),h.addHandler(t,o))}}else if(h)h.destroy(),
h.owner=null,delete f.satellite[a]},o=v.CustomExtendProperty({update:true},function(a,b){for(var f in b)a[f]=b[f]?h:null}),z=v(i,{event_update:function(a,b){i.prototype.event_update.call(this,a,b);var f=this.parentNode;f&&(f.matchFunction&&(this.match(),this.match(f.matchFunction)),f.insertBefore(this,this.nextSibling))},event_childNodesModified:s("childNodesModified","node","delta"),event_dataSourceChanged:s("dataSourceChanged","node","oldDataSource"),event_localGroupingChanged:s("localGroupingChanged",
"node","oldGroupingNode"),event_localSortingChanged:s("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:s("ownerChanged","node","oldOwner"),event_satellitesChanged:s("satellitesChanged","node","delta"),subscribeTo:i.prototype.subscribeTo+p.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:false,nodeType:"DOMWrapperNode",canHaveChildren:false,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:true,document:null,
parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:false,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:j,satellite:null,owner:null,init:function(a){var b=this.dataSource,f=this.childNodes,c=this.localGrouping;if(b)this.dataSource=null;i.prototype.init.call(this,a);if(c)this.localGrouping=null,this.setLocalGrouping(c);if(this.canHaveChildren)this.childNodes=[],b?(this.dataSource=null,this.setDataSource(b)):
f&&this.setChildNodes(f);else{if(f)this.childNodes=null;if(b)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==j)for(var e in this.satelliteConfig)if(a=this.satelliteConfig[e],v.isClass(a)&&(a={instanceOf:a}),typeof a=="object"){b={key:e,owner:this,config:a};a=a.hook?o.__extend__(a.hook):o;for(e in a)if(a[e]===h){this.addHandler(a,b);break}h.call(b)}if(e=this.owner)this.owner=null,this.setOwner(e)},appendChild:function(){},insertBefore:function(){},removeChild:function(){},
replaceChild:function(){},clear:function(){},hasChildNodes:function(){return this.childNodes.length>0},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||a instanceof z==false)a=null;if(this.owner!==a){var b=this.owner;b&&b.removeHandler(this.listen.owner,this);(this.owner=a)&&a.addHandler(this.listen.owner,this);this.event_ownerChanged(this,b)}},destroy:function(){i.prototype.destroy.call(this);this.dataSource?
this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var b=this.satellite[a];b.destroy();b.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),A=v(z,{autoDestroyIfEmpty:false,nodes:null,first:null,last:null,
init:function(a){this.nodes=[];z.prototype.init.call(this,a)},insert:function(a,b){var f=this.nodes,c=b?f.indexOf(b):-1;c==-1?(f.push(a),this.last=a):f.splice(c,0,a);this.first=f[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var b=this.nodes;if(b.remove(a))this.first=b[0]||null,this.last=b[b.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=
this.nodes,b=a.length;b-- >0;)a[b].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){z.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),C={canHaveChildren:true,childClass:z,childFactory:null,listen:{dataSource:{datasetChanged:function(a,b){var f={},c=[];if(b.deleted)if(f.deleted=c,this.childNodes.length==b.deleted.length){c.push.apply(c,this.childNodes);var h=this.dataSource;
this.dataSource=null;this.clear(true);this.dataSource=h;this.colMap_={}}else for(var h=0,e;e=b.deleted[h];h++){e=e.eventObjectId;var j=this.colMap_[e];delete this.colMap_[e];j.canHaveDelegate=true;this.removeChild(j);c.push(j)}if(b.inserted){f.inserted=[];for(h=0;e=b.inserted[h];h++)j=x(this,{cascadeDestroy:false,delegate:e}),j.canHaveDelegate=false,this.colMap_[e.eventObjectId]=j,f.inserted.push(j),this.firstChild&&this.insertBefore(j)}this.firstChild?this.event_childNodesModified(this,f):this.setChildNodes(f.inserted);
if(this.destroyDataSourceMember&&c.length)for(h=0;e=c[h];h++)e.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,b){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var f=this;do if(f==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(f=f.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";
a instanceof this.childClass==false&&(a=x(this,a instanceof i?{delegate:a}:a));var c=a.parentNode===this,h=a.groupNode,j=this.localGrouping,o=this.localSorting,t,d=this.childNodes,A,B,w=null,f=-1,r=false,g;if(c)g=a.nextSibling,B=a.previousSibling;if(o&&(b=null,t=this.localSortingDesc,A=o(a)||0,c))if(A===a.sortingValue)r=true;else if((!g||(t?g.sortingValue<=A:g.sortingValue>=A))&&(!B||(t?B.sortingValue>=A:B.sortingValue<=A)))a.sortingValue=A,r=true;if(j){w=j.getGroupNode(a);B=w.nodes;if(h===w&&(r||
c&&g===b))return a;o?r?f=g&&g.groupNode===w?B.indexOf(g):B.length:(f=B.binarySearchPos(A,l,t),a.sortingValue=A):f=b&&b.groupNode===w?B.indexOf(b):B.length;if(f<B.length)b=B[f];else if(w.last)b=w.last.nextSibling;else{f=w;for(b=null;f=f.nextSibling;)if(b=f.first)break}if(a===b||c&&a.nextSibling===b)return h!==w&&(h&&h.remove(a),w.insert(a)),a;f=-1}else if(o){if(r)return a;f=d.binarySearchPos(A,l,t);b=d[f];a.sortingValue=A;if(a===b||c&&g===b)return a}else{if(b&&b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
if(c){if(g===b)return a;if(a===b)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}c?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=null,a.nextSibling=null,f==-1?d.remove(a):(t=d.indexOf(a),d.splice(t,1),t<f&&f--),h&&(h.remove(a),h=null)):a.parentNode&&a.parentNode.removeChild(a);h!=w&&w.insert(a,b);if(b){f==
-1&&(f=d.indexOf(b));if(f==-1)throw"basis.dom.wrapper: Node was not found";a.nextSibling=b;d.splice(f,0,a)}else f=d.length,d.push(a),b={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=b.previousSibling;f==0?this.firstChild=a:b.previousSibling.nextSibling=a;b.previousSibling=a;var z=false,p=false,m=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)z=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==
m)a.contextSelection=m,p=!a.selection,a.selected&&m.add([a]);a.firstChild&&(z||p)&&k(a,e).forEach(function(a){if(z&&!a.document)a.document=z;if(p&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=m});c||(a.match&&a.match(this.matchFunction),a.autoDelegateParent&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,{inserted:[a]}));return a},removeChild:function(b){if(b==null||b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(b instanceof this.childClass==
false)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(b))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(b),1);b.parentNode=null;b.nextSibling?b.nextSibling.previousSibling=b.previousSibling:this.lastChild=b.previousSibling;b.previousSibling?b.previousSibling.nextSibling=b.nextSibling:this.firstChild=b.nextSibling;b.nextSibling=null;b.previousSibling=null;b.document===
this.document&&k(b,a).forEach(function(a){if(a.document==this.document)a.document=null},this);if(b.contextSelection){for(var f=b.contextSelection,c=b,h=[];c;){if(c.contextSelection===f)c.selected&&h.push(c),c.contextSelection=null;if(!c.selection&&c.firstChild)c=c.firstChild;else if(c.nextSibling)c=c.nextSibling;else for(;c=c.parentNode;)if(c.nextSibling){c=c.nextSibling;break}}f.remove(h)}b.groupNode&&b.groupNode.remove(b);this.dataSource||this.event_childNodesModified(this,{deleted:[b]});b.autoDelegateParent&&
b.setDelegate();return b},replaceChild:function(a,b){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(b==null||b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,b);return this.removeChild(b)},clear:function(a){if(this.dataSource)this.setDataSource();else if(this.firstChild){var b=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:b});for(var f=
b.length;f-- >0;){var c=b[f];c.parentNode=null;c.groupNode=null;a?((c.selection||c.document)&&k(c,y.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),c.nextSibling=null,c.previousSibling=null,c.autoDelegateParent&&c.setDelegate()):c.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(f=a.length-1;b=a[f];f--)b.clear()}}},setChildNodes:function(a,
b){this.dataSource||this.clear(!!b);if(a&&("length"in a==false&&(a=[a]),a.length)){var f=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var c=0,h=a.length;c<h;c++)this.insertBefore(a[c]);this.event_childNodesModified=f;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.canHaveChildren||a instanceof r==false)a=null;if(this.dataSource!==a){var b=this.dataSource;if(b)this.colMap_=this.dataSource=null,b.removeHandler(this.listen.dataSource,
this),b.itemCount&&this.clear();if(a)this.dataSource=a,this.colMap_={},a.addHandler(this.listen.dataSource,this),a.itemCount&&this.listen.dataSource.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_dataSourceChanged(this,b)}},setLocalGrouping:function(a){if(typeof a=="function"||typeof a=="string")a={groupGetter:c(a)};a instanceof F==false&&(a=a!=null&&typeof a=="object"?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var b=this.localGrouping,f;if(this.localGrouping){if(!a&&
(this.localGrouping=null,this.firstChild)){f=this.localSorting?m(this):this.childNodes;for(var h=f.length;h-- >0;)f[h].groupNode=null;q(this,f)}b.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){f=this.localSorting?m(this):this.childNodes;for(h=0;a=f[h];h++)a.groupNode=this.localGrouping.getGroupNode(a);for(h=0;a=f[h];h++)a.groupNode.nodes.push(a);f.length=0;for(h=this.localGrouping.nullGroup;h;h=h.nextSibling)a=h.nodes,h.first=a[0]||null,h.last=a[a.length-1]||null,f.push.apply(f,
a),h.event_childNodesModified(h,{inserted:a});q(this,f)}this.event_localGroupingChanged(this,b)}},setLocalSorting:function(a,b){a&&(a=c(a));if(this.localSorting!=a||this.localSortingDesc!=!!b){var f=this.localSorting,h=this.localSortingDesc;this.localSortingDesc=!!b;this.localSorting=a||null;if(a&&this.firstChild){var e=[],j;for(j=this.firstChild;j;j=j.nextSibling)j.sortingValue=a(j)||0;if(this.localGrouping)for(var k=this.localGrouping.nullGroup;k;k=k.nextSibling)j=k.nodes=m({childNodes:k.nodes,
localSortingDesc:this.localSortingDesc}),k.first=j[0]||null,k.last=j[j.length-1]||null,e.push.apply(e,j);else e=m(this);q(this,e)}this.event_localSortingChanged(this,f,h)}},setMatchFunction:function(a){if(this.matchFunction!=a){this.matchFunction=a;for(var b=this.lastChild;b;b=b.previousSibling)b.match(a)}}},p=v(z,{event_enable:s("enable","node"),event_disable:s("disable","node"),event_select:s("select","node"),event_unselect:s("unselect","node"),event_match:s("match","node"),event_unmatch:s("unmatch",
"node"),selectable:true,selected:false,selection:null,contextSelection:null,matchFunction:null,matched:true,disabled:false,init:function(a){if(this.selection&&this.selection instanceof r==false)this.selection=new B(this.selection);z.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=false,this.select(true)},setSelection:function(a){if(this.selection==a)return false;var b=this.selection;k(this,e,function(f){if(f.contextSelection==b)f.selected&&b&&b.remove([f]),
f.contextSelection=a});this.selection=a;return true},hasOwnSelection:function(){return!!this.selection},select:function(a){var b=this.selected,f=this.contextSelection;if(f)a?b?f.remove([this]):f.add([this]):this.selectable&&f.set([this]);else if(!b&&this.selectable&&!this.isDisabled())this.selected=true,this.event_select(this);return this.selected!=b},unselect:function(){var a=this.selected;if(a){var b=this.contextSelection;b?b.remove([this]):(this.selected=false,this.event_unselect(this))}return this.selected!=
a},enable:function(){if(this.disabled)this.disabled=false,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=true,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!y.findAncestor(this,c("disabled"))},match:function(a){if(typeof a!="function")if(this.matched){if(this.underMatch_)this.underMatch_(this,true),this.underMatch_=null}else this.matched=true,this.event_match(this);else if(a(this)){if(this.underMatch_=a,!this.matched)this.matched=
true,this.event_match(this)}else if(this.underMatch_=null,this.matched)this.matched=false,this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();z.prototype.destroy.call(this)}}),E=v(p,C,{}),F=v(z,C,{event_childNodesModified:function(a,b){f.childNodesModified.call(this,a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var c=this.owner,
h=Array.from(this.nullGroup.nodes),e=h.length;e-- >0;)c.insertBefore(h[e],h[e].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,true);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);f.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:true,autoDestroyEmptyGroups:true,titleGetter:c("data.title"),groupGetter:Function.$undef,childClass:A,childFactory:function(a){return new this.childClass(b(a,
{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?false:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new A({autoDestroyIfEmpty:false});z.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),b=a instanceof i,f=this.map_[b?a.eventObjectId:a];!f&&!this.dataSource&&(f=this.appendChild(b?{delegate:a}:{data:{id:a,title:a}}));return f||this.nullGroup},insertBefore:function(a,b){a=C.insertBefore.call(this,a,b);if("groupId_"in a==false)a.groupId_=
a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=a;if(a.first){var f=this.owner,c=f.childNodes,h=a.first,e=a.last,j,k,o;for(j=a;j=j.previousSibling;)if(o=j.last)break;if(!o)o=this.nullGroup.last;for(j=a;j=j.nextSibling;)if(k=j.first)break;if(h.previousSibling!==o||e.nextSibling!==k){if(h.previousSibling)h.previousSibling.nextSibling=e.nextSibling;if(e.nextSibling)e.nextSibling.previousSibling=h.previousSibling;j=c.splice(c.indexOf(h),a.nodes.length);var t=c.indexOf(k);j.unshift(t!=
-1?t:c.length,0);c.splice.apply(c,j);h.previousSibling=o;e.nextSibling=k;if(o)o.nextSibling=h;if(k)k.previousSibling=e;f.firstChild=c[0];f.lastChild=c[c.length-1]}}return a},removeChild:function(a){C.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){C.clear.call(this);this.map_={}},destroy:function(){this.setOwner();z.prototype.destroy.call(this);this.map_=null}});z.prototype.localGroupingClass=F;var s=v(r,{autoDestroy:true,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,
b){var f=this.memberMap_,c={},h=0,e=0,j=b.inserted,k=b.deleted;if(j&&j.length)for(c.inserted=j;a=j[h];)f[a.eventObjectId]=a,h++;if(k&&k.length)for(c.deleted=k;a=k[e];)delete f[a.eventObjectId],e++;(h||e)&&this.event_datasetChanged(this,c)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:s("sourceNodeChanged")&&function(a,b){f.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:false,init:function(a,
b){r.prototype.init.call(this,b);a&&this.setSourceNode(a)},setSourceNode:function(a){a instanceof z==false&&(a=null);if(a!==this.sourceNode){var b=this.sourceNode;b&&(b.removeHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,b,{deleted:b.childNodes}));a&&(a.addHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,a,{inserted:a.childNodes}));this.sourceNode=a;this.event_sourceNodeChanged(this,b)}},destroy:function(){this.setSourceNode();
r.prototype.destroy.call(this)}}),B=v(w,{multiple:false,event_datasetChanged:function(a,b){w.prototype.event_datasetChanged.call(this,a,b);if(b.inserted)for(var f=0,c;c=b.inserted[f];f++)if(!c.selected)c.selected=true,c.event_select();if(b.deleted)for(f=0;c=b.deleted[f];f++)if(c.selected)c.selected=false,c.event_unselect()},add:function(a){if(!this.multiple)if(this.itemCount)return this.set(a);else a.splice(1);for(var b=[],f=0,c;c=a[f];f++)c.contextSelection==this&&c.selectable&&b.push(c);return w.prototype.add.call(this,
b)},set:function(a){for(var b=[],f=0,c;c=a[f];f++)c.contextSelection==this&&c.selectable&&b.push(c);this.multiple||a.splice(1);return w.prototype.set.call(this,b)}});d.namespace("basis.dom.wrapper",u).extend({AbstractNode:z,InteractiveNode:p,Node:E,GroupingNode:F,PartitionNode:A,simpleTemplate:u,ChildNodesDataset:s,Selection:B})})(basis);
(function(d,l){function g(a,b){return q(b,true).getRule(a,true)}function n(a,b){var f=a.match(/^([^{]+)\{(.*)\}\s*$/);if(f){for(var c=f[1].trim().split(/\s*,\s*/),h=0;h<c.length;h++)this.addRule(c[h],f[2]||null,b++);return b-1}}function m(a,b){var f=e.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:b?"alternate ":"",url:a.quote('"')}));e.tag(null,"HEAD")[0].appendChild(f);f=f.sheet||f.styleSheet;try{if(!f.cssRules)f.cssRules=f.rules}catch(c){}if(!f.insertRule)f.insertRule=
n;if(!f.deleteRule)f.deleteRule=f.removeRule;return f}function q(a,b){a||(a="DefaultGenericStyleSheet");j[a]||b&&(j[a]=new o(m()));return j[a]}function x(a,b,f,c){for(var c=c||{},b=b.qw(),e=0,j;j=b[e];e++)if(typeof h.style[j]!="undefined"){f&&(d.platformFeature["css-"+a]=j);t[a]={key:j,getter:c[j]};break}}function u(a,b){var f=t[a];if(a=f?f.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:f&&f.getter?f.getter(b):b}}function v(a,b,f){if(typeof a.setProperty=="function")return a.setProperty(b,
f);if(b=u(b,f))return a.style[b.key]=b.value}function y(a,b){for(var f in b)v(a,f,b[f]);return a}function s(a,b){return v(a,"display",typeof b=="string"?b:b?"":"none")}function p(a,b){return v(a,"visibility",b?"":"hidden")}function i(a){return F[a]||(F[a]=RegExp("\\s*\\b"+a+"\\b"))}function r(a,b){var f=(b?"g":"s")+a;return D[f]||(D[f]=RegExp((b?"":"\\s*")+"\\b"+a+".*\\b"))}var w=l.document,e=d.dom,a=d.dom.event,c=d.Class,b=/\s*!important/i,k=String("important"),f=1,j={},t={},h=e.createElement("DIV");
x("opacity","opacity MozOpacity KhtmlOpacity filter",true,{fitler:function(a){return"alpha(opacity:"+parseInt(a*100)+")"}});x("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",true);x("float","cssFloat styleFloat");var o=c(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,b){if(!this.map_[a]&&b){for(var f=this.styleSheet,c=this.rules.length,h=f.insertRule(a+"{}",c),e=c;e<=h;e++)this.rules.push(new z(f.cssRules[e]));this.map_[a]=
c!=h?new A(this.rules.splice(c)):this.rules[c]}return this.map_[a]},deleteRule:function(a){var b=this.map_[a];if(b){for(var b=b.rules||[b],f=0;f<b.length;f++){var c=this.rules.indexOf(b[f]);this.stylesheet.deleteRule(c);this.rules.splice(c,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),z=c(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(a,f){var c,h=!!b.test(f),e=this.rule.style;if(h||e.getPropertyPriority&&e.getPropertyPriority(a)==
k){if(f=f.replace(b,""),c=u(a,f)){var j=c.key;e.setProperty?(h||e.removeProperty(j),e.setProperty(j,c.value,h?k:"")):e.cssText=e.cssText.replace(RegExp(e[j]?j+"\\s*:\\s*"+e[j]+"(\\s*!"+k+")?\\s*;?":"^","i"),j+": "+c.value+(h?" !"+k:"")+";")}}else v(this.rule,a,f)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),A=c(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});
["setProperty","setStyle","clear"].forEach(function(a){A.prototype[a]=function(){for(var b,f=0;b=this.rules[f];f++)b[a].apply(b,arguments)}});var C={};["em","ex","px","%"].forEach(function(a){C[a=="%"?"percent":a]=function(b){return b==0||isNaN(b)?"0":b+a}});var E,F={},B=c(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,b,f){f=f||"";typeof a!="undefined"&&this.remove(f+a);typeof b!=
"undefined"&&this.add(f+b)},bool:function(a,b){b?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(i(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(i(a))||(this.element.className+=" "+a)},remove:function(a){var b=this.element.className,a=b.replace(i(a),"");if(a!=b)this.element.className=a},toggle:function(a){var b=this.contains(a);b?this.remove(a):this.add(a);
return!b}}),D={},I=c(null,{delim:"-",init:function(a,b){this.classList=b;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(r(this.prefix,true))},set:function(a){var b=this.items(),a=typeof a!="undefined"?this.prefix+a:"",f=this.classList;if(b)if(b.length==1){if(b[0]===a)return;f.remove(b[0])}else this.clear();a&&f.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});l.DOMTokenList&&w.documentElement.classList?(c=B.prototype,Object.extend(l.DOMTokenList.prototype,{set:c.set,replace:c.replace,bool:c.bool,clear:function(){for(var a=this.length;a-- >0;)this.remove(this[a])},setPrefixToken:c.setPrefixToken}),E=function(a){return(typeof a=="string"?e.get(a):a).classList}):E=function(a){return new B(typeof a=="string"?e.get(a):a)};a.onLoad(function(){E(w.body).bool("opacity-not-support",!d.platformFeature["css-opacity"])});e.extend({setStyleProperty:v,
setStyle:y,display:s,show:function(a){return s(a,1)},hide:function(a){return s(a)},visibility:p,visible:function(a){return p(a,1)},invisible:function(a){return p(a)}});return d.namespace("basis.cssom").extend({setStyleProperty:v,setStyle:y,classList:function(a,b){return b?new I(b,E(a)):E(a)},uniqueRule:function(a){var b="genericRule-"+f++;a&&E(a).add(b);a=g("."+b);a.token=b;return a},cssRule:g,getStyleSheet:q,addStyleSheet:m,CssStyleSheetWrapper:o,CssRuleWrapper:z,CssRuleWrapperSet:A}).extend(C)})(basis,
this);
(function(d){function l(a){return!(a%400&&(!(a%100)||a%4))}function g(a,c){return a==1?28+l(c):x[a]}function n(a,c){return c.replace(r,function(b,c){return p[c](a)})}function m(a,c,b,e,f,j,t){return new Date(a,c-1,b,e||0,f||0,j||0,t||0)}var q=Function.getter,x=[31,28,31,30,31,30,31,31,30,31,30,31],u={day:864E5,hour:36E5,minute:6E4,second:1E3},v="year month day hour minute second millisecond".qw(),y={},s={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(a,c){y[a]=q("get"+c+"()");s[a]=new Function("d,v","d.set"+c+"(v)")});var p={y:q("getFullYear().toString().substr(2)"),Y:q("getFullYear()"),d:q("getDate()"),D:q("getDate()","{0:02}"),m:q("getMonth() + 1"),M:q("getMonth() + 1","{0:02}"),h:q("getHours()"),H:q("getHours()","{0:02}"),i:q("getHours() % 12 || 12","{0:02}"),p:q("getHours() > 12",{"true":"pm","false":"am"}),P:q("getHours() > 12",{"true":"PM","false":"AM"}),I:q("getMinutes()","{0:02}"),s:q("getSeconds()"),
S:q("getSeconds()","{0:02}"),z:q("getMilliseconds()"),Z:q("getMilliseconds()","{0:03}")},i=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,r=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return l(this.getFullYear())},getMonthDayCount:function(){return g(this.getMonth(),this.getFullYear())},add:function(a,c){var b=y[a];if(!b)throw Error("Unknown date part: "+a);var e;if(a=="year"||a=="month")e=this.getDate(),e>28&&this.setDate(1);s[a](this,b(this)+
c);e>28&&(b=this.getMonthDayCount(),e>b&&this.setDate(b));return this},diff:function(a,c){if(a=="year"||a=="month"){var b=Number(this)-Number(c)>0?-1:1,e=b>0?this:c,f=b>0?c:this,j=e.getFullYear(),j=f.getFullYear()-j;if(a=="year")return b*j;e=e.getMonth();f=f.getMonth();return b*(j?(j>1?(j-1)*12:0)+(11-e)+(f+1):f-e)}else return b=Math.floor((c-this)/u[a]),b+Number(y[a](new Date(c-b*u[a]))-y[a](this)!=0)},set:function(a,c){var b=s[a];if(!b)throw Error("Unknown date part: "+a);var e;if(a=="year"||a==
"month")e=this.getDate(),e>28&&this.setDate(1);b(this,c);e>28&&(b=this.getMonthDayCount(),e>b&&this.setDate(b));return this},get:function(a){if(y[a])return y[a](this);throw Error("Unknown date part: "+a);},toISODateString:function(){return n(this,"%Y-%M-%D")},toISOTimeString:function(){return n(this,"%H:%I:%S.%Z")},fromDate:function(a){a instanceof Date&&(this.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),this.setTime(a.getTime()));return this},toFormat:function(a){return n(this,a)}});var w=
Date.prototype.toISOString;if(w&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return w.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(a){var c=String(a).match(i);if(!c)throw Error("Value of date isn't in ISO format: "+a);c[2]-=1;for(var a=0,b;b=v[a];a++)this.set(b,c[a+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,
toODBCTime:Date.prototype.toISOTimeString,toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var e=/\D/;Date.fromISOString=function(a){return a?m.apply(null,String(a).split(e)):null};Date.timer=function(a){var c=a||new Date;c.measure=function(a){return a?((new Date-c)/1E3).toFixed(3):new Date-c};return c};d.namespace("basis.date").extend({isLeapYear:l,getMonthDayCount:g,format:n})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.html.Template,m=d.cssom.classList,q=Function.getter,x=d.Cleaner,u=d.dom.wrapper.Node,v=d.dom.wrapper.PartitionNode,y=d.dom.wrapper.GroupingNode,s=l.ExtensibleProperty(),p=function(i){return{template:new n("<div/>"),action:s,cssClassName:null,event_update:function(d,e){i.event_update.call(this,d,e);this.templateUpdate(this.tmpl,"update",e)},event_select:function(d){i.event_select.call(this,d);m(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(d){i.event_unselect.call(this,d);m(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(d){i.event_disable.call(this,d);m(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(d){i.event_enable.call(this,d);m(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(d){i.event_match.call(this,d);g.display(this.element,true)},event_unmatch:function(d){i.event_unmatch.call(this,d);g.display(this.element,
false)},init:function(d){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&g.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=g.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;i.init.call(this,d);if(this.id)this.element.id=
this.id;if(d=this.cssClassName){typeof d=="string"&&(d={element:d});for(var e in d){var a=this.tmpl[e];if(a)for(var a=m(a),c=String(d[e]).qw(),b=0,k;k=c[b++];)a.add(k)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&g.insert(this.container,this.element)},templateAction:function(i,e){var a=this.action[i];a&&a.call(this,e)},templateUpdate:function(){},destroy:function(){var d=this.element;i.destroy.call(this);d&&d.parentNode&&d.parentNode.removeChild(d);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},u=l(u,p,{}),q=l(v,p,{titleGetter:q("data.title"),templateUpdate:function(i){if(i.titleText)i.titleText.nodeValue=String(this.titleGetter(this))}}),p=function(i){return{insertBefore:function(d,e){var d=i.insertBefore.call(this,d,e),a=d.groupNode||this,c=d.nextSibling,a=a.childNodesElement||a.element||this.childNodesElement||this.element,b=d.element,c=(c&&c.element.parentNode==a?c.element:null)||a.insertPoint||null;(b.parentNode!==a||b.nextSibling!==
c)&&a.insertBefore(b,c);return d},removeChild:function(d){i.removeChild.call(this,d);var e=d.element,a=e.parentNode;a&&a.removeChild(e);return d},clear:function(d){if(d)for(var e=this.firstChild;e;){var a=e.element;a.parentNode&&a.parentNode.removeChild(a);e=e.nextSibling}i.clear.call(this,d)},setChildNodes:function(d,e){var a=g.createFragment(),c=this.localGrouping||this,b=c.childNodesElement||c.element;c.childNodesElement=a;i.setChildNodes.call(this,d,e);b.insertBefore(a,b.insertPoint||null);c.childNodesElement=
b}}},v=l(y,p,{childClass:q,localGroupingClass:l.SELF,event_ownerChanged:function(i,d){var e=this,a=this.owner,c=null;a&&(c=a.tmpl&&a.tmpl.groupsElement||a.childNodesElement||a.element,c.appendChild(this.nullElement));do e.element=e.childNodesElement=c;while(e=e.localGrouping);y.prototype.event_ownerChanged.call(this,i,d)},init:function(i){this.element=this.childNodesElement=this.nullElement=g.createFragment();y.prototype.init.call(this,i)}}),i=l(u,p,{childClass:u,childFactory:function(i){return new this.childClass(i)},
localGroupingClass:v}),l=l(i,{selection:{},init:function(d){this.document=this;i.prototype.init.call(this,d);x.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;i.prototype.destroy.call(this);x.remove(this)}}),p=function(i,d){for(var e=i.match(/\{(this_[^\}]+)\}/g)||[],a=[],c=0;c<e.length;c++){var b=e[c].match(/\{(this_[^\|\}]+)\}/)[1];a.push("this.tmpl."+b+".nodeValue = "+b.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(b,c,e){a.templateUpdate.call(this,b,c,e);_code_()}},config_)}.toString().replace("_code_()",a.join(";\n")))(new n(i),d)};d.namespace("basis.ui",p).extend({simpleTemplate:p,Node:u,Container:i,PartitionNode:q,GroupingNode:v,Control:l})})(basis);
(function(d,l){function g(a,b){if(h)try{return parseFloat(x.getComputedStyle(a,null)[b])}catch(f){return 0}else return 0}function n(a,b){return h?g(a,"height"):(p.setStyle(b,{borderTop:a.currentStyle.borderTopWidth+" solid red",borderBottom:a.currentStyle.borderBottomWidth+" solid red",paddingTop:a.currentStyle.paddingTop,paddingBottom:a.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"}),a.offsetHeight-b.offsetHeight)}function m(a,b){if(t)i(a).add("Basis-Layout-OnResizeElement"),
a.onresize=b;else{var f=v.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});v.insert(a,f);f.onload=function(){(f.contentWindow.onresize=b)()}}}for(var q=l.document,x=q.defaultView,u=d.Class,v=d.dom,y=d.ua,s=Object.extend,p=d.cssom,i=d.cssom.classList,r=d.ui.Container,w=y.test("IE"),e=y.test("IE7+"),a=false,c=v.createElement(""),b=["","-webkit-"],k=0;k<b.length;k++)try{var f=b[k]+"box";
c.style.display=f;if(c.style.display==f){a=b[k];break}}catch(j){}var t=typeof c.onresize!="undefined",h=x&&x.getComputedStyle,c=function(){return v.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};c.className="basis.Layout.Helper";var o={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:false},z=u(null,{init:function(a,b,f){this.reset();this.setElement(a,b,f)},setElement:function(a,b,f){this.element=
v.get(a);this.offsetElement=f;b||this.recalc(this.offsetElement)},copy:function(a){"top,left,bottom,right,height,width,defined".split(",").forEach(function(b){this[b]=a[b]},this)},reset:function(){s(this,o)},set:function(a,b){if(this.defined){switch(a.toLowerCase()){case "left":this.left=b;this.right=this.left+this.width;break;case "right":this.right=b;this.left=this.right-this.width;break;case "width":this.width=b;this.right=this.left+this.width;break;case "top":this.top=b;this.bottom=this.top+this.height;
break;case "bottom":this.bottom=b;this.top=this.bottom-this.height;break;case "height":this.height=b,this.bottom=this.top+this.height}(this.width<=0||this.height<=0)&&this.reset()}return this},recalc:function(a){this.reset();var b=this.element;if(b){var f=b,c=q.documentElement;if(b.getBoundingClientRect)f=b.getBoundingClientRect(),this.top=f.top,this.left=f.left,w&&(e?(this.top+=c.scrollTop-c.clientTop,this.left+=c.scrollLeft-c.clientLeft):b!=q.body&&(this.top-=q.body.clientTop-q.body.scrollTop,this.left-=
q.body.clientLeft-q.body.scrollLeft)),a&&(a=new z(a),this.top-=a.top,this.left-=a.left,a.destroy());else if(q.getBoxObjectFor){var h=q.getBoxObjectFor(c),f=q.getBoxObjectFor(b);this.top=f.screenY-h.screenY;this.left=f.screenX-h.screenX;if(y.test("FF1.5-")){if(f=b.offsetParent)this.top-=f.scrollTop,this.left-=f.scrollLeft;f!=q.body&&(this.top+=c.scrollTop,this.left+=c.scrollLeft)}if(y.test("FF2+")){if(this.top&&(f=c.scrollTop,f>2)){for(var h=0,j=Math.floor(Math.log(f)/Math.LN2);j>=0;j-=3)h+=1<<j;f>
h&&(this.top-=1)}this.left&&(this.left-=c.scrollLeft>1)}a&&(a=new z(a),this.top-=a.top,this.left-=a.left,a.destroy())}else if(b!=a){this.top=b.offsetTop;this.left=b.offsetLeft;this.top-=q.body.clientTop-q.body.scrollTop;for(this.left-=q.body.clientLeft-q.body.scrollLeft;(f=f.offsetParent)&&f!=a;)this.top+=f.offsetTop+f.clientTop-f.scrollTop,this.left+=f.offsetLeft+f.clientLeft-f.scrollLeft}else this.top=this.left=0;this.width=b.offsetWidth;this.height=b.offsetHeight;this.bottom=this.top+this.height;
this.right=this.left+this.width;this.defined=true}return this.defined},intersection:function(a){if(!this.defined)return false;a instanceof z==false&&(a=new z(a));return a.defined&&a.right>this.left&&a.left<this.right&&a.bottom>this.top&&a.top<this.bottom},inside:function(a){if(!this.defined)return false;a instanceof z==false&&(a=new z(a));return a.defined&&a.left>=this.left&&a.right<=this.right&&a.bottom>=this.bottom&&a.top<=this.top},point:function(a){if(!this.defined)return false;var b=a.left||
a.x||0,a=a.top||a.y||0;return b>=this.left&&b<this.right&&a>=this.top&&a<this.bottom},power:function(a){if(!this.defined)return false;if(a=v.get(a)||this.element)return v.setStyle(a,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"}),true},destroy:function(){delete this.element}}),b=u(z,{init:function(a,b,f){this.setBoxes(a,b,f)},setBoxes:function(a,b,f){this.boxA=a instanceof z?a:new z(a,true);this.boxB=b instanceof z?b:new z(b,true);f||this.recalc()},recalc:function(){this.reset();
if(!this.boxA.recalc()||!this.boxB.recalc())return false;if(this.boxA.intersection(this.boxB))this.top=Math.max(this.boxA.top,this.boxB.top),this.left=Math.max(this.boxA.left,this.boxB.left),this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom),this.right=Math.min(this.boxA.right,this.boxB.right),this.width=this.right-this.left,this.height=this.bottom-this.top,this.width<=0||this.height<=0?this.reset():this.defined=true;return this.defined}}),k=u(z,{recalc:function(){this.reset();var a=this.element;
if(a){var b=a;this.width=a.clientWidth;this.height=a.clientHeight;if(a.getBoundingClientRect){var f=a.getBoundingClientRect();this.top=f.top;for(this.left=f.left;b=b.offsetParent;)this.top-=b.scrollTop,this.left-=b.scrollLeft}else if(q.getBoxObjectFor){f=q.getBoxObjectFor(a);this.top=f.y;for(this.left=f.x;b=b.offsetParent;)this.top-=b.scrollTop,this.left-=b.scrollLeft}else f=new z(a),this.top=f.top+a.clientTop,this.left=f.left+a.clientLeft;this.bottom=this.top+this.height;this.right=this.left+this.width;
this.defined=true}return this.defined}});p.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});f=p.cssRule(".Basis-VerticalPanelStack");f.setStyle({overflow:"hidden"});a!==false&&(f.setProperty("display",a+"box"),f.setProperty(a+"box-orient","vertical"));f=u(r,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(b){r.prototype.init.call(this,b);this.flex?a!==false&&p.setStyleProperty(this.element,a+"box-flex",this.flex):a===false&&m(this.element,function(){this.parentNode&&
this.parentNode.realign()}.bind(this))}});u=u(r,{childClass:f,template:'<div class="Basis-VerticalPanelStack">'+(a?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(b){this.cssRule=p.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");r.prototype.init.call(this,b);a===false&&(this.realign(),m(this.childNodesElement,function(){this.realign()}.bind(this)))},insertBefore:function(a,b){if(a=
r.prototype.insertBefore.call(this,a,b))return a.flex&&this.cssRule&&i(a.element).add(this.ruleClassName),this.realign(),a},removeChild:function(a){if(r.prototype.removeChild.call(this,a))return a.flex&&this.cssRule&&i(a.element).remove(this.ruleClassName),this.realign(),a},realign:function(){if(a===false){var b=this.element,f=this.lastChild.element,c=this.tmpl.ruller,e=(new z(f,false,b)).bottom-g(b,"paddingTop")-g(b,"borderTopWidth")||0,b=n(b,c);if(h)e+=g(f,"marginBottom");else{var j=c.offsetHeight;
c.style.height=f.currentStyle.marginBottom;e+=c.offsetHeight-j}if(e=b-e){for(b=f=0;j=this.childNodes[b];b++)j.flex&&(f++,e+=n(j.element,c));f&&this.cssRule.setProperty("height",Math.max(0,e/f)+"px")}}}});d.namespace("basis.layout").extend({Box:z,Intersection:b,Viewport:k,VerticalPanel:f,VerticalPanelStack:u,Helper:c,addBlockResizeHandler:m})})(basis,this);
(function(d){var l=d.Class,g=d.dom.event,n=d.dom,m=Function.getter,q=d.cssom.classList,x=g.addGlobalHandler,u=g.removeGlobalHandler,v=d.EventObject,y=v.createEvent,s=d.layout,p=d.ua,i=d.ua.is("IE9-"),r,w={start:function(a){r&&w.over();r={dde:this,run:false,event:{initX:g.mouseX(a),initY:g.mouseY(a),deltaX:0,deltaY:0}};x("mousemove",w.move,r);x("mouseup",w.over,r);x("mousedown",w.over,r);g.cancelDefault(a);this.event_prepare(r.event)},move:function(a){var c=r.dde;if(!r.run)r.run=true,c.draging=true,
c.event_start(r.event);if(c.axisX)r.event.deltaX=c.axisXproxy(g.mouseX(a)-r.event.initX);if(c.axisY)r.event.deltaY=c.axisYproxy(g.mouseY(a)-r.event.initY);c.event_move(r.event)},over:function(a){var c=r.dde;u("mousemove",w.move,r);u("mouseup",w.over,r);u("mousedown",w.over,r);c.draging=false;r.run&&c.event_over(r.event);r=null;g.kill(a)}},e=l(v,{containerGetter:m("element"),element:null,trigger:null,baseElement:null,fixTop:true,fixRight:true,fixBottom:true,fixLeft:true,axisX:true,axisY:true,axisXproxy:Function.$self,
axisYproxy:Function.$self,event_prepare:y("prepare"),event_start:y("start"),event_move:y("move"),event_over:y("over"),init:function(a){v.prototype.init.call(this,a);var a=this.element,c=this.trigger;this.trigger=this.element=null;this.setElement(a,c);this.setBase(this.baseElement);d.Cleaner.add(this)},setElement:function(a,c){a=a&&n.get(a);c=c&&n.get(c)||a;if(this.trigger!=c&&(this.trigger&&(g.removeHandler(this.trigger,"mousedown",w.start,this),i&&g.removeHandler(this.trigger,"selectstart",w.start,
this)),this.trigger=c))g.addHandler(this.trigger,"mousedown",w.start,this),i&&g.addHandler(this.trigger,"selectstart",w.start,this);if(this.element!=a)this.element&&q(this.element).remove("Basis-Dragable"),(this.element=a)&&q(this.element).add("Basis-Dragable")},setBase:function(a){this.baseElement=n.get(a)||(p.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(r&&r.dde==this)},start:function(a){this.isDraging()||w.start.call(this,a)},stop:function(){this.isDraging()&&
w.over()},destroy:function(){d.Cleaner.remove(this);this.stop();v.prototype.destroy.call(this);this.setElement();this.setBase()}}),l=l(e,{event_start:function(a){var c=this.containerGetter(this,a.initX,a.initY);if(c){var b=new s.Box(c),k=new s.Viewport(this.baseElement);q(c).add("Basis-DragDrop-DragElement");a.element=c;a.box=b;a.viewport=k}e.prototype.event_start.call(this,a)},event_move:function(a){if(a.element){if(this.axisX){var c=a.box.left+a.deltaX;this.fixLeft&&c<0?c=0:this.fixRight&&c+a.box.width>
a.viewport.width&&(c=a.viewport.width-a.box.width);a.element.style.left=c+"px"}if(this.axisY)c=a.box.top+a.deltaY,this.fixTop&&c<0?c=0:this.fixBottom&&c+a.box.height>a.viewport.height&&(c=a.viewport.height-a.box.height),a.element.style.top=c+"px";e.prototype.event_move.call(this,a)}},event_over:function(a){a.element&&(q(a.element).remove("Basis-DragDrop-DragElement"),e.prototype.event_over.call(this,a))}});d.namespace("basis.dragdrop").extend({DragDropElement:e,MoveableElement:l})})(basis);
(function(){function d(a){if(a instanceof e)return a.set;a=a.nodeType;if(isNaN(a)==false)return a==1?w:"nodeValue"}var l=basis.Class,g=basis.dom,n=basis.Cleaner,m=Function.getter,q=basis.cssom.classList,x=basis.EventObject,u=basis.TimeEventManager,v=x.createEvent,y=basis.data,s=y.DataObject,p=y.STATE,i=l(s,{event_change:v("change"),locked:false,lockValue_:null,extendConstructor_:false,updateCount:0,init:function(a,c,f){s.prototype.init.call(this,{});c&&this.addHandler(c);this.proxy=typeof f=="function"?
f:Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,c){var f=this.value,e=this.proxy?this.proxy(a):e,i=false;if(e!==f)this.value=e,i=true,this.updateCount+=1;!this.locked&&(i||c)&&this.event_change(e,f);return i},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=true},unlock:function(){if(this.locked)this.locked=false,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,c){return this.set(a,c)},reset:function(){this.set(this.initValue)},
destroy:function(){s.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),r={destroy:function(a){this.removeLink(a)}},w=function(a){g.insert(g.clear(this),a)},e=l(i,{links_:null,event_change:function(a,c){i.prototype.event_change.call(this,a,c);if(this.links_.length&&!n.globalDestroy)for(var f=0,e;e=this.links_[f++];)this.power_(e,c)},init:function(a,c,f){i.prototype.init.call(this,a,c,f);this.links_=[];n.add(this)},addLink:function(a,c,
f){if(typeof a!="object"&&a instanceof Object==false)throw Error("basis.data.property: Link to undefined object ignored");c==null&&(c=d(a));typeof f!="function"&&(f=m(Function.$self,f));c={object:a,format:f,field:c,isEventObject:a instanceof x};this.links_.push(c);c.isEventObject&&a.addHandler(r,this);this.power_(c);return a},addLinkShortcut:function(a,c,f){return this.addLink(a,e.shortcut[c],f)},removeLink:function(a,c){if(this.links_!=null){var f=arguments.length<2;!f&&c==null&&(c=d(a));for(var e=
0,i=0,h;h=this.links_[i];i++)h.object===a&&(f||c==h.field)?h.isEventObject&&h.object.removeHandler(r,this):this.links_[e++]=h;this.links_.length=e}},clear:function(){for(var a=0,c;c=this.links_[a];a++)c.isEventObject&&c.object.removeHandler(r,this);this.links_.clear()},power_:function(a,c){var f=a.field;if(f!=null){var e=a.format(this.value),i=a.object;typeof f=="function"?f.call(i,e,arguments.length<2?e:a.format(c)):i[f]=e}},destroy:function(){this.clear();i.prototype.destroy.call(this);this.links_=
null;n.remove(this)}});e.shortcut={className:function(a,c){q(this).replace(c,a)},show:function(a){g.display(this,!!a)},hide:function(a){g.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var a=[p.READY,p.DEPRECATED,p.UNDEFINED,p.ERROR,p.PROCESSING],c={stateChanged:function(){this.fire(false,true)},update:function(){this.fire(true)},change:function(){this.fire(true)},destroy:function(a){this.remove(a)}},l=l(e,{calculateValue:function(){return this.value+
1},objects:[],timer_:null,valueChanged_:false,stateChanged_:true,state:p.UNDEFINED,extendConstructor_:true,init:function(){var a=this.handler;delete this.handler;e.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();n.add(this)},add:function(){for(var a=0,e=arguments.length;a<e;a++){var f=arguments[a];if(f instanceof
s)this.objects.add(f)&&f.addHandler(c,this);else throw Error("basis.data.property: Instance of DataObject required");}this.fire(true,true)},remove:function(a){this.objects.remove(a)&&a.removeHandler(c,this);this.fire(true,true)},clear:function(){for(var a=0,e;e=this.objects[a];a++)e.removeHandler(c,this);this.objects.clear();this.fire(true,true)},fire:function(a,c){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!c,!this.timer_&&(this.valueChanged_||
this.stateChanged_)))this.timer_=true,u.add(this,"update",Date.now())},lock:function(){this.locked=true},unlock:function(){this.locked=false},update:function(){delete this.timer_;u.remove(this,"update");if(!n.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var b=this.objects.length;if(b){for(var c=-2,f,e=0;e<b;e++){var i=this.objects[e],h=a.indexOf(String(i.state));h>c&&(f=i,c=h)}f&&this.setState(f.state,f.state.data)}else this.setState(p.UNDEFINED)}this.stateChanged_=
this.valueChanged_=false},destroy:function(){this.lock();this.clear();u.remove(this,"update");e.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:l,AbstractProperty:i,Property:e,PropertySet:l})})();
(function(d){function l(d,g){var l=Date.now()-d;return l>=g?1:l/g}var g=d.Class,n=d.dom,m=d.data.property.Property,q=d.EventObject.createEvent,x=g(m,{duration:1E3,interval:50,startTime:0,timer:null,started:false,event_start:q("start"),event_finish:q("finish"),event_invert:q("invert"),event_change:function(d,g){d==0&&this.event_start();m.prototype.event_change.call(this,d,g);d==1&&this.event_finish()},extendConstructor_:true,init:function(d){this.run=this.run.bind(this);m.prototype.init.call(this,
d)},start:function(d){this.started?d&&this.invert():(this.startTime=Date.now(),this.started=true,this.run())},run:function(){clearTimeout(this.timer);if(this.started){var d=l(this.startTime,this.duration);d>=1?this.stop():(this.set(d),this.timer=setTimeout(this.run,this.interval))}},invert:function(){this.event_invert();if(this.started){var d=l(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-d);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started)this.started=
false,this.set(1)},destroy:function(){this.stop();this.clear();m.prototype.destroy.call()}}),u=g(null,{thread:null,setter:Function.$null,notRevert:false,timeFunction:Function.$self,init:function(d,g,l,p,i){this.thread=d instanceof x?d:new x(d);this.setRange(l,p);this.setter=g;this.notInvert=i;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(i){this.setter(this.start+this.range*this.timeFunction(i))},finish:function(){this.notInvert||
(this.start+=this.range,this.range*=-1)},destroy:this.destroy},this)},setRange:function(d,g){this.start=d;this.range=g-d},destroy:function(){delete this.thread}});d.namespace("basis.animation").extend({Thread:x,Modificator:u,FX:{CSS:{FadeIn:function(d,g){return new u(d,function(d){n.setStyle(g,{opacity:d})},0,1)},FadeOut:function(d,g){return new u(d,function(d){n.setStyle(g,{opacity:d})},1,0)}}}})})(basis);
(function(d){function l(a,b,c){return c?k?a.createElementNS(c,b):a.createNode(1,b,c):a.createElement(b)}function g(a,b,c,h){a=c?k?a.createAttributeNS(c,b):a.createNode(2,b,c):a.createAttribute(b);a.nodeValue=h;return a}function n(a,b){return a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b)}function m(a,b,e){n(a,g(a.ownerDocument,c.PREFIX+(b?":"+b:""),c.NAMESPACE,e))}function q(a,b){return a.createTextNode(String(b))}function x(b,c){var e=b.nodeType,h=b.attributes,o=b.firstChild;
if(o){if(o.nodeType!=p&&o===b.lastChild)return o.nodeValue}else{var k=h&&h[0];if(e==p){if(!k)return"";if(h.length==1&&(k.baseName||k.localName)==a&&k.namespaceURI==w)return null}else if(!k)return null}var e={},k=[],i=0,d,g,r;if(o){do i=k.push(o);while(o=o.nextSibling)}if(h)for(o=0;r=h[o];o++)k.push(r);c||(c={});for(var o=0,B;B=k[o];o++){h=B.nodeName;d=o<i;r=c[h];if(d)d=x(B,c);else{if(h=="xmlns")continue;d=B.nodeValue}for(;r;)if(r.storeName&&(d[r.storeName]=h),r.rename)h=r.rename,r=c[h];else{r.format&&
(d=r.format(d));!e[h]&&r.forceArray&&(d=[d]);break}h in e?(g=e[h])&&g.push?g.push(d):e[h]=[g,d]:e[h]=d}return e}function u(b,e,k,h){if(String(e).charAt(0)=="@")return h==null?h:g(b,e.substr(1),"",String(h));else{e=l(b,e.toString(),h&&h.xmlns||e.namespace||k);if(typeof h=="undefined"||h===null)n(e,g(b,a,w,"true"));else if(typeof h=="string"||typeof h=="number"||typeof h=="function"||typeof h=="boolean"||h.constructor===Date||h.constructor===RegExp)e.appendChild(q(b,h));else{k=h.xmlns||k;h.xmlns&&c.BAD_SUPPORT&&
m(e,"",k);for(var o in h){var d=h[o];if(!(o=="xmlns"||typeof d=="function"))if(d&&Array.isArray(d))for(var r=0;r<d.length;r++)e.appendChild(u(b,o,k,d[r]));else d&&typeof d=="object"&&d.toString!==Object.prototype.toString&&(d=d.toString()),(d=u(b,o,k,d))&&(d.nodeType==i?n(e,d):e.appendChild(d))}}return e}}var v=d.dom,y=d.Class,s=d.ua,p=v.ELEMENT_NODE,i=v.ATTRIBUTE_NODE,y=y(null,{init:function(a,b,c){this.localpart=a;this.namespace=b||"";this.prefix=c||""},toString:function(){return this.prefix?this.prefix+
":"+this.localpart:this.localpart}}),r=String("http://www.w3.org/2001/XMLSchema"),w=String("http://www.w3.org/2001/XMLSchema-instance"),e=String("http://www.w3.org/2000/xmlns/"),a="nil",c={PREFIX:"xmlns",NAMESPACE:e,BAD_SUPPORT:s.test("webkit528.16-")||s.test("opera9-")},b="native",k=true,s=function(){var a=document.implementation;if(a&&a.createDocument)return function(b,c){var h=a.createDocument(b,c,null);if(h.charset&&h.charset!=document.charset)h.charset=document.charset;return h};if(window.ActiveXObject)for(var c=
["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],e=0;e<c.length;e++)try{if(new ActiveXObject(c[e]))return b=c[e],k=false,function(a,c){var f=new ActiveXObject(b);f.documentElement=l(f,c,a);return f}}catch(h){}throw Error("Browser doesn't support for XML document!");}();d.namespace("basis.xml").extend({NAMESPACE:{XMLShema:r,XMLShemaInstance:w,Namespace:e},XMLNS:c,QName:y,getElementsByTagNameNS:function(a,b,c){if(a.getElementsByTagNameNS)return a.getElementsByTagNameNS(c,b);var h=[];a.ownerDocument.setProperty("SelectionNamespaces",
'xmlns:x="'+c+'"');for(var a=a.selectNodes("//x:"+b),b=0,e;e=a[b++];)e.namespaceURI==c&&h.push(e);return h},addNamespace:m,createDocument:s,createElementNS:l,createAttributeNS:g,setAttributeNodeNS:n,createText:q,createCDATA:function(a,b){return a.createCDATASection(b)},XML2Object:x,XML2String:function(a){if(typeof XMLSerializer!="undefined")return(new XMLSerializer).serializeToString(a);if(typeof a.xml=="string")return a.xml;if(a.nodeType==v.DOCUMENT_NODE)a=a.documentElement;return v.outerHTML(a)},
Object2XML:u})})(basis);
(function(d){function l(d,g){return d<<g|d>>>32-g}function g(d){var g=[];do g.push((d&15).toString(16)),d>>=4;while(d);g.length&1&&g.push("0");return g.reverse().join("")}function n(d){if(typeof d=="number")return g(d);var r=[],r=Array.isArray(d)?d.map(n):String(d).toArray().map(function(d){return g(d.charCodeAt(0))});return r.join("")}d.namespace("basis.crypt",function(d){s=d||"";return p});var m=Array.create(255,function(d){return String.fromCharCode(d)}),q=function(){function i(d){for(var e="",
a=d.length,c=0;c<a;c++){var b=d.charCodeAt(c);e+=b<128?m[b]:b<2048?m[b>>6|192]+m[b&63|128]:m[b>>12|224]+m[b>>6&63|128]+m[b&63|128]}return e}function g(d){for(var e="",a=d.length,c,b,k,f=0;f<a;)c=d.charCodeAt(f++),c<128?e+=m[c]:(b=d.charCodeAt(f++),c&32?(k=d.charCodeAt(f++),e+=String.fromCharCode((c&15)<<12|(b&63)<<6|k&63)):e+=String.fromCharCode((c&31)<<6|b&63));return e}return d.namespace("basis.crypt.UTF16").extend({toBytes:function(d){for(var e=[],a=d.length,c=0;c<a;c++){var b=d.charCodeAt(c);
e.push(b&255,b>>8)}return e},fromBytes:function(d){for(var e="",a=d.length,c,b,k=0;k<a;)c=d[k++]||0,b=d[k++]||0,e+=String.fromCharCode(b<<8|c);return e},toUTF8:i,fromUTF8:g,toUTF8Bytes:function(d){return x.toBytes(i(d))},fromUTF8Bytes:function(d){return g(x.fromBytes(d))}})}(),x=function(){return d.namespace("basis.crypt.UTF8").extend({toBytes:function(d){for(var g=d.length,w=Array(g),e=0;e<g;e++)w[e]=d.charCodeAt(e);return w},fromBytes:function(d){for(var g=d.length,w="",e=0;e<g;e++)w+=m[d[e]];return w},
toUTF16:function(d){return q.fromUTF8(d)},fromUTF16:function(d){return q.toUTF8(d)},toUTF16Bytes:function(d){return q.toBytes(q.fromUTF8(d))},fromUTF16Bytes:function(d){return q.toUTF8(q.fromBytes(d))}})}(),u=function(){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),g={};i.forEach(function(d,e){g[d]=e});return d.namespace("basis.crypt.Base64").extend({encode:function(d,e){d.constructor!=Array&&(d=e?q.toUTF8Bytes(d):q.toBytes(d));for(var a=d.length,c=0,b="",k,f,
j,t,h,o;c<a;)k=d[c++],f=d[c++],j=d[c++],t=k>>2,k=(k&3)<<4|f>>4,h=(f&15)<<2|j>>6,o=j&63,f==void 0?h=o=64:j==void 0&&(o=64),b+=i[t]+i[k]+i[h]+i[o];return b},decode:function(d,e){for(var a=[],c,b,k,f,j,i=0,d=d.replace(/[^a-z0-9\+\/]/ig,""),h=d.length;i<h;)c=g[d.charAt(i++)],b=g[d.charAt(i++)],f=g[d.charAt(i++)],j=g[d.charAt(i++)],c=c<<2|b>>4,b=(b&15)<<4|f>>2,k=(f&3)<<6|j,a.push(c,b,k);(f==null||f==64)&&a.pop();(j==null||j==64)&&a.pop();return e?q.fromUTF8Bytes(a):q.fromBytes(a)}})}(),v=function(){function d(e){for(var a=
[],c=3;c>=0;c--)a.push(e>>c*8&255);return a}var g=[1518500249,1859775393,2400959708,3395469782],p=[function(e,a,c){return c^e&(a^c)},function(e,a,c){return e^a^c},function(e,a,c){return e&a|c&(e|a)},function(e,a,c){return a^e^c}];return function(e,a){e.constructor!=Array&&(e=a?q.toUTF8Bytes(e):q.toBytes(e));for(var c=e.length,b=[],k=0;k<c;k++)b[k>>2]|=e[k]<<(3-(k&3)<<3);c&3?b[c>>2]|=Math.pow(2,(4-(c&3)<<3)-1):b[c>>2]=2147483648;b.push.apply(b,Array.create(((b.length&15)>14?30:14)-(b.length&15),0));
b.push(c>>>29);b.push(c<<3&4294967295);b.reverse();for(var c=[1732584193,4023233417,2562383102,271733878,3285377520],f=Array.from(c),j,t=b.length>>4,h=Array(80);t--;){for(k=0;k<16;k++)h[k]=b.pop();for(k=16;k<80;k++)h[k]=l(h[k-3]^h[k-8]^h[k-14]^h[k-16],1);for(k=0;k<80;k++)j=Math.floor(k/20),c[4]=l(c[0],5)+p[j](c[1],c[2],c[3])+c[4]+h[k]+g[j]&4294967295,c[1]=l(c[1],30),c.unshift(c.pop());for(k=0;k<5;k++)c[k]=f[k]=c[k]+f[k]&4294967295}return c.map(d).flatten()}}(),y=function(){function d(a){for(var b=
arguments,c=b.length,e=a&65535,h=a>>16,o=1;o<c;o++){var i=b[o];e+=i&65535;h+=(i>>16)+(e>>16);e&=65535}return h<<16|e&65535}function g(a){for(var b=[],c=0;c<4;c++)b.push(a>>c*8&255);return b}var p=Math.pow(2,32),e,a=[],c=[],b=[function(a,b,c){return c^a&(b^c)},function(a,b,c){return b^c&(b^a)},function(a,b,c){return a^b^c},function(a,b,c){return b^(a|~c)}];return function(k,f){if(!e){e=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var j=
0;j<64;j++)switch(a[j]=Math.floor(Math.abs(Math.sin(j+1))*p),j>>4){case 0:c[j]=j;break;case 1:c[j]=j*5+1&15;break;case 2:c[j]=j*3+5&15;break;case 3:c[j]=j*7&15}}k.constructor!=Array&&(k=f?q.toUTF8Bytes(k):q.toBytes(k));for(var j=[],t=k.length,h=0;h<t;h++)j[h>>2]|=k[h]<<((h&3)<<3);j[t>>2]|=128<<((t&3)<<3);j.push.apply(j,Array(((j.length&15)>14?30:14)-(j.length&15)));j.push(t<<3&4294967295);j.push(t>>>29);for(var t=[1732584193,4023233417,2562383102,271733878],o=Array.from(t),z=j.length>>4;z--;){for(h=
0;h<64;h++)t[0]=d(l(d(t[0],b[h>>4](t[1],t[2],t[3]),j[c[h]],a[h]),e[h]),t[1]),t.unshift(t.pop());for(h=0;h<4;h++)t[h]=o[h]=d(t[h],o[h])}return t.map(g).flatten()}}(),s="",p={};Object.iterate({sha1:function(d){return v(this,d)},sha1hex:function(d){return n(v(this,d))},md5:function(d){return y(this,d)},md5hex:function(d){return n(y(this,d))},base64:function(d){return u.encode(this,d)},base64decode:function(d){return u.encode(this,d)},hex:function(){return n(this)}},function(d,g){p[d]=function(d){d=g.call(s,
d);return s=Object.extend(typeof d!="object"?Object(d):d,p)}});d.namespace("basis.crypt").extend({HEX:n,SHA1:v,MD5:y})})(basis);
(function(){function d(a,c){var b={},e;if(a&&a.length)e=b.inserted=a;if(c&&c.length)e=b.deleted=c;if(e)return b}var l=basis.Class,g=Object.extend,n=Function.$self,m=Function.$true,q=Function.$false,x=basis.EventObject.createEvent,u=basis.data.SUBSCRIPTION,v=basis.data.DataObject,y=basis.data.KeyObjectMap,s=basis.data.AbstractDataset,p=basis.data.Dataset;u.add("SOURCE",{sourceChanged:function(a,c){this.remove(a,c);this.add(a,a.source)},sourcesChanged:function(a,c){var b;if(b=c.inserted)for(var e=b.length;e-- >
0;)this.add(a,b[e]);if(b=c.deleted)for(e=b.length;e-- >0;)this.remove(a,b[e])}},function(a,c){for(var b=c.sources||[c.source],e=0,f;f=b[e++];)a(c,f)});u.add("MINUEND",{operandsChanged:function(a,c){this.minuend!==c&&(this.remove(a,c),this.add(a,a.minuend))}},function(a,c){a(c,c.minuend)});u.add("SUBTRAHEND",{operandsChanged:function(a,c,b){this.subtrahend!==b&&(this.remove(a,b),this.add(a,a.subtrahend))}},function(a,c){a(c,c.subtrahend)});var i=l(s,{subscribeTo:u.SOURCE,event_sourcesChanged:x("sourcesChanged",
"dataset","delta"),sources:null,rule:function(a){return a>0},listen:{source:{datasetChanged:function(a,c){var b=this.memberMap_,e={},f,d;if(c.inserted)for(var i=0;f=c.inserted[i];i++)d=f.eventObjectId,b[d]?b[d].count++:b[d]={count:1,object:f},e[d]=b[d];if(c.deleted)for(i=0;f=c.deleted[i];i++)d=f.eventObjectId,e[d]=b[d],b[d].count--;this.applyRule(e)},destroy:function(a){this.removeSource(a)}}},init:function(a){s.prototype.init.call(this,a);a=this.sources;this.sources=[];a&&a.forEach(this.addSource,
this)},setRule:function(a){if(typeof a!="function")a=i.UNION;if(this.rule!==a)this.rule=a,this.applyRule()},applyRule:function(a){var c=this.memberMap_,b=this.rule,e=this.sources.length,f=[],j=[],i,h,o;a||(a=c);for(var g in a)i=c[g],h=e&&i.count&&b(i.count,e),h!=!!this.item_[g]&&(h?f:j).push(i.object),i.count==0&&delete c[g];(o=d(f,j))&&this.event_datasetChanged(this,o)},addSource:function(a){if(a instanceof s&&this.sources.add(a)){a.addHandler(this.listen.source,this);var c=this.memberMap_,b;for(b in a.item_)c[b]?
c[b].count++:c[b]={count:1,object:a.item_[b]};this.applyRule();this.event_sourcesChanged(this,{inserted:[a]});return true}},removeSource:function(a){if(this.sources.remove(a)){a.removeHandler(this.listen.source,this);var c=this.memberMap_,b;for(b in a.item_)c[b].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[a]});return true}},setSources:function(a){for(var c=Array.from(this.sources),b=0,e;e=a[b];b++)e instanceof s&&(c.remove(e)||this.addSource(e));c.forEach(this.removeSource,this)},
clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){s.prototype.destroy.call(this);this.sources=null}});i.UNION=i.prototype.rule;i.INTERSECTION=function(a,c){return a==c};i.DIFFERENCE=function(a){return a==1};i.MORE_THAN_ONE_INCLUDE=function(a,c){return c==1||a>1};i.AT_LEAST_ONE_EXCLUDE=function(a,c){return c==1||a<c};var r=function(a){return!this.has(a)},w=l(s,{subscribeTo:u.MINUEND+u.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:x("operandsChanged",
"dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(a,c){if(this.subtrahend){var b=d(c.inserted&&c.inserted.filter(r,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));b&&this.event_datasetChanged(this,b)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(a,c){if(this.minuend){var b=d(c.deleted&&c.deleted.filter(r,this),c.inserted&&c.inserted.filter(this.has,this));b&&this.event_datasetChanged(this,b)}},destroy:function(){this.setOperands(this.minuend,
null)}}},init:function(a){s.prototype.init.call(this,a);var a=this.minuend,c=this.subtrahend;this.subtrahend=this.minuend=null;(a||c)&&this.setOperands(a,c)},setOperands:function(a,c){var b,e=false;a instanceof s==false&&(a=null);c instanceof s==false&&(c=null);var f=this.minuend,j=this.subtrahend;if(f!==a)e=true,f&&f.removeHandler(this.listen.minuend,this),(this.minuend=a)&&a.addHandler(this.listen.minuend,this);if(j!==c)e=true,j&&j.removeHandler(this.listen.subtrahend,this),(this.subtrahend=c)&&
c.addHandler(this.listen.subtrahend,this);if(!e)return false;this.event_operandsChanged(this,f,j);if(!a||!c)this.itemCount&&this.event_datasetChanged(this,b={deleted:this.getItems()});else{var e=[],f=[],i;for(i in this.item_)(!a.item_[i]||c.item_[i])&&e.push(this.item_[i]);for(i in a.item_)!this.item_[i]&&!c.item_[i]&&f.push(a.item_[i]);(b=d(f,e))&&this.event_datasetChanged(this,b)}return b},clear:function(){this.setOperands()}}),e=l(s,{subscribeTo:u.SOURCE,source:null,event_sourceChanged:x("sourceChanged",
"dataset","oldSource"),map:n,reduce:q,rule:q,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:{update:function(a){var c=this.map?this.map(a):a;if(c instanceof v==false||this.reduce(c))c=null;var b=this.sourceMap_[a.eventObjectId],e=b.member;if(e!=c){var f=this.memberMap_,j,i,h;b.member=c;if(e)b=e.eventObjectId,this.removeMemberRef&&this.removeMemberRef(e,a),--f[b]==0&&(delete f[b],h=[e]);if(c)e=c.eventObjectId,this.addMemberRef&&this.addMemberRef(c,a),f[e]?f[e]++:(f[e]=
1,i=[c]);(j=d(i,h))&&this.event_datasetChanged(this,j)}}},source:{datasetChanged:function(a,c){var b=this.sourceMap_,e=this.memberMap_,f=[],j=[],i,h,o;p.setAccumulateState(true);if(c.inserted)for(var g=0;i=c.inserted[g];g++){o=this.map?this.map(i):i;if(o instanceof v==false||this.reduce(o))o=null;i.addHandler(this.listen.sourceObject,this);b[i.eventObjectId]={sourceObject:i,member:o};if(o)h=o.eventObjectId,e[h]?e[h]++:(e[h]=1,f.push(o)),this.addMemberRef&&this.addMemberRef(o,i)}if(c.deleted)for(g=
0;i=c.deleted[g];g++)if(h=i.eventObjectId,o=b[h].member,i.removeHandler(this.listen.sourceObject,this),delete b[h],o)h=o.eventObjectId,--e[h]==0&&(delete e[h],j.push(o)),this.removeMemberRef&&this.removeMemberRef(o,i);p.setAccumulateState(false);(c=d(f,j))&&this.event_datasetChanged(this,c)},destroy:function(){this.setSource()}}},init:function(a){s.prototype.init.call(this,a);this.sourceMap_={};if(a=this.source)this.source=null,this.setSource(a)},setRule:function(a){typeof a!="function"&&(a=m);if(this.rule!==
a)return this.rule=a,this.applyRule()},setMap:function(a){typeof a!="function"&&(a=n);if(this.map!==a)return this.map=a,this.applyRule()},setSource:function(a){a instanceof s==false&&(a=null);if(this.source!==a){var c=this.source;c&&(c.removeHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,c,{deleted:c.getItems()}));if(this.source=a)a.addHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_sourceChanged(this,
c)}},applyRule:function(){var a=this.sourceMap_,c=this.memberMap_,b,e,f,j,i,h=[],o=[],g,p;for(p in a){i=a[p];j=i.sourceObject;b=i.member;e=this.map?this.map(j):j;if(e instanceof v==false||this.reduce(e))e=null;if(b!=e){i.member=e;if(b)f=b.eventObjectId,this.removeMemberRef&&this.removeMemberRef(b,j),c[f]--;if(e)b=e.eventObjectId,this.addMemberRef&&this.addMemberRef(e,j),b in c?c[b]++:(c[b]=1,h.push(e))}}for(f in this.item_)c[f]==0&&(delete c[f],o.push(this.item_[f]));(g=d(h,o))&&this.event_datasetChanged(this,
g);return g},clear:function(){this.setSource()},destroy:function(){s.prototype.destroy.call(this);this.sourceMap_=null}}),q=l(e,{reduce:function(a){return!this.rule(a)},rule:m}),l=l(e,{map:function(a){return this.keyMap.resolve(a)},rule:m,subsetClass:s,keyMap:null,addMemberRef:function(a,c){a.event_datasetChanged(a,{inserted:[c]})},removeMemberRef:function(a,c){a.event_datasetChanged(a,{deleted:[c]})},init:function(a){if(!this.keyMap||this.keyMap instanceof y==false)this.keyMap=new y(g({keyGetter:this.rule,
itemClass:this.subsetClass},this.keyMap));e.prototype.init.call(this,a)},getSubset:function(a,c){return this.keyMap.get(a,c)},destroy:function(){e.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:i,Subtract:w,MapReduce:e,Subset:q,Split:l})})(basis,this);
(function(d){function l(a,b){if(!a.length)return 0;var c,f,e=0,d=a.length-1;do if(c=e+d>>1,f=a[c]||0,b<f)d=c-1;else if(b>f)e=c+1;else return b==f?c:0;while(e<=d);return c+(f<b)}function g(a,b){if(!a.length)return 0;var c,f,e,d=0,j=a.length-1;do if(c=d+j>>1,e=a[c].value||0,e===f?(e=a[c].object.eventObjectId,f=b.object.eventObjectId):f=b.value||0,f<e)j=c-1;else if(f>e)d=c+1;else return f==e?c:0;while(d<=j);return c+(e<f)}function n(){for(var a=Object.slice(this.item_),b=this.index_.slice(this.offset,
this.offset+this.limit),c=[],f,e=0,d;d=b[e];e++){var j=d.object.eventObjectId;a[j]?delete a[j]:c.push(d.object)}(f=getDelta(c,values(a)))&&p.prototype.event_datasetChanged.call(this,this,f)}function m(a,b){var a=Function.getter(a),c=b+"_"+a.getterIdx_,f=w[c];if(!f)f=w[c]=this,this.indexType=b,this.indexClass=r[b],this.getter=a,this.key=c,this.createInstance=function(a){if(a instanceof p){var b=a.indexes&&a.indexes[this.key];if(!b)b=new this.indexClass(this.getter),b.addHandler(t,a),b.key=this.key;
return b}};return f}function q(a,b,c){var f=a.indexCache_;a.lock();if(b)for(var e=0,d;d=b[e++];){var j=a.valueGetter(d);f[d.eventObjectId]=j;a.add(d,j)}if(c)for(e=0;d=c[e++];)a.remove(d,f[d.eventObjectId]),delete f[d.eventObjectId];a.unlock()}var x=d.Class,u=d.TimeEventManager,v=d.data,y=v.KeyObjectMap,s=v.property.Property,p=v.AbstractDataset,i=v.dataset.MapReduce,v=x(p,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(a,b){var c;if(c=b.inserted)for(var f=0;f<
c.length;f++){var e=c[f],e={value:this.valueGetter(e),object:e},d=g(this.index_,e);this.index_.splice(d,0,e)}if(c=b.deleted)for(f=0;f<c.length;f++)e=c[f],e={value:this.valueGetter(e),object:e},d=g(this.index_,e),this.index_.splice(d,1);n.call(this)},init:function(a){this.index_=[];p.prototype.init.call(this,a)},setRange:function(a,b){this.offset=a;this.limit=b;n.call(this)}}),r=x(s,{autoDestroy:true,valueGetter:Function.$null,dataSource:null,init:function(a){s.prototype.init.call(this,this.value||
0);this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},upd:function(){}});r.Sum=x(r,{add:function(a,b){this.value+=b},remove:function(a,b){this.value-=b},upd:function(a,b,c){this.set(this.value+b-c)}});r.Avg=x(r,{sum_:0,count_:0,add:function(a,b){this.sum_+=b;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,b){this.sum_-=b;this.count_-=1;this.value=this.count_?this.sum_/this.count_:0},upd:function(a,b,c){this.sum_+=b-c;this.set(this.sum_/this.count_)}});
r.Count=x(r,{valueGetter:Function.$true,add:function(a,b){b&&(this.value+=1)},remove:function(a,b){b&&(this.value-=1)},upd:function(a,b){this.set(this.value+(b?1:-1))}});r.Max=x(r,{init:function(a,b){this.stack=[];r.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(l(this.stack,b),0,b);this.value=this.stack[this.stack.length-1]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[this.stack.length-1]},upd:function(a,b,c){this.stack.splice(l(this.stack,c),1);this.stack.splice(l(this.stack,
b),0,b);this.set(this.stack[this.stack.length-1])}});r.Min=x(r,{init:function(a,b){this.stack=[];r.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(l(this.stack,b),0,b);this.value=this.stack[0]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[0]},upd:function(a,b,c){this.stack.splice(l(this.stack,c),1);this.stack.splice(l(this.stack,b),0,b);this.set(this.stack[0])}});var w={},e=function(a){return function(b){return new m(b,a)}},a=e("Sum"),c=e("Avg"),b=e("Count"),
k=e("Min"),e=e("Max"),f={update:function(a){var b,c,f,e=a.eventObjectId,d;for(d in this.indexes)f=this.indexes[d],b=f.indexCache_[e],c=f.valueGetter(a),c!==b&&(f.upd(a,c,b),f.indexCache_[e]=c)}},j={datasetChanged:function(a,b){if(b.inserted)for(var c=0;a=b.inserted[c++];)a.addHandler(f,this);if(b.deleted)for(c=0;a=b.deleted[c++];)a.removeHandler(f,this);for(var e in this.indexes)q(this.indexes[e],b.inserted,b.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},t={destroy:function(a){this.removeIndex(a)}};
p.prototype.createIndex=function(a){if(a instanceof m!=false){if(!this.indexes)this.indexes={},this.addHandler(j),j.datasetChanged.call(this,this,{inserted:this.getItems()});var b=a.key;this.indexes[b]||(a=a.createInstance(this),this.indexes[b]=a,q(a,this.getItems()));return this.indexes[b]}};p.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var b in this.indexes)return;this.removeHandler(j);delete this.indexes}};x=x(i,{calcs:null,
indexes:null,indexes_:null,timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,b){i.prototype.event_sourceChanged.call(this,a,b);var c,f;for(f in this.indexes_)c=this.indexes_[f],b&&(this.removeIndex(f),b.removeIndex(this.indexes[f])),this.source&&this.addIndex(f,this.source.createIndex(c))},listen:{sourceObject:{update:function(a,b){i.prototype.listen.sourceObject.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=true;this.fireUpdate()}},index:{change:function(a){var b=
this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=true;b.fireUpdate()}},member:{subscribersChanged:function(a,b){a.subscriberCount>0&&b==0&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,true)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=b.eventObjectId;a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=true;a.subscriberCount>0&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];a.removeHandler(this.listen.member,
this)},init:function(a){this.indexUpdated=false;this.indexesBind_={};this.memberSourceMap={};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||this.keyMap instanceof y==false)this.keyMap=new y(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));i.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof m)if(this.indexes_[a])return;else this.indexes_[a]=
b,b=this.source&&this.source.createIndex(b);if(b instanceof r)this.indexValues[a]=b.value,this.indexes[a]=b,this.indexesBind_[a]={key:a,indexMap:this},b.addHandler(this.listen.index,this.indexesBind_[a]),this.listen.index.change.call(this.indexesBind_[a],b.value)}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},
addCalc:function(a,b){this.calcs[a]=b;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=true,u.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=false},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=false;var c={},f,e,d;for(d in this.calcs)if(f=this.calcs[d](b.sourceObject.data,this.indexValues),a.data[d]!==f&&(!isNaN(f)||!isNaN(a.data[d])))c[d]=f,e=true;e&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,true)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);i.prototype.destroy.call(this)}});
d.namespace("basis.data.index").extend({IndexedDataset:v,IndexConstructor:m,Index:r,Sum:a,Avg:c,Count:b,Max:e,Min:k,IndexMap:x})})(basis);
(function(d){function l(a){h[a]=h[a]||0;return a+h[a]++}function g(){var a=Array.from(arguments),b=a.pop();typeof b!="function"&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],f=[],e=0,h;e<a.length;e++)h=a[e].quote('"'),c.push(h+" in delta"),f.push("data["+h+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+f.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
true;return b}function n(){return g.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;b-- >0;){if(arguments[b]==null)return null;a.push(arguments[b])}return a.join("-")}))}var m=d.Class,q=d.Cleaner,x=Object.extend,u=Function.$self,v=Function.getter,y=d.data,s=d.EventObject,p=y.Dataset,i=y.dataset.Subset,r=y.dataset.Split,w=y.DataObject,e=y.STATE,a={},c={string:1,number:1},b=[],k=function(a){return isNaN(a)?null:Number(a)},f=function(a){return isNaN(a)?null:Number(a)},
j=function(a){return isNaN(a)?null:parseInt(a)},t=function(a){return a==null?null:String(a)},h={},o=d.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,f){var e=a(c,f);return e!==f&&b[e]?f:e};this.calcWrapper=function(c,f){var e=a(c,f);if(e!==f&&b[e])throw"Duplicate value for index "+f+" => "+c;return e};q.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=this.index[a];if(b&&(!c||c===b))return this.index[a]=
b,true},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],true},destroy:function(){this.index=null}}),y=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},z=function(a,b){return function(c){if(!this.name)this.name=l(b);a.prototype.init.call(this,c)}},A=function(a){return function(b,c){p.setAccumulateState(true);b=(b||[]).map(this.wrapper);p.setAccumulateState(false);return a.prototype.sync.call(this,b,c)}},C=m(p,{wrapper:Function.$self,init:z(p,
"EntitySet"),sync:A(p),set:y(p,"set"),add:y(p,"add"),remove:y(p,"remove"),destroy:function(){p.prototype.destroy.call(this);delete this.wrapper}}),E=m(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),F=m(i,{init:z(i,"EntityCollection"),sync:A(i)});F.sourceHandler=i.sourceHandler;var B=m(r,{subsetClass:E,init:z(r,"EntityGrouping"),sync:A(r),getSubset:function(a,b){var c=r.prototype.getSubset.call(this,a,b);if(c)c.wrapper=this.wrapper;return c}}),D=function(a){if(this instanceof
D){var b=new I(a||u);return function(a,c){return a!=null?(c instanceof C||(c=b.createEntitySet()),c.set(a instanceof p?a.getItems():Array.from(a)),c):null}}};D.className="basis.entity.EntitySetWrapper";var I=m(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),H=function(a){if(this instanceof H){var b=function(a,b){if(a!=null){if(a===b||a.entityType===f)return a;var j,
i=f.idField;if(c[typeof a]){if(!i)return;j=a;a={};a[i]=j}else if(f.compositeKey)j=f.compositeKey(a,a);else if(i)j=a[i];else if(d&&(b=f.singleton,!b))return f.singleton=new h(a);j!=null&&e&&(b=e.get(j,f.entityClass));b&&b.entityType===f?b.update(a):b=new h(a);return b}else return f.singleton},f=new M(a||{},b),e=f.index__,h=f.entityClass,d=f.isSingleton;x(b,{toString:function(){return this.typeName+"()"},entityType:f,type:b,typeName:f.name,index:e,reader:function(a){return f.reader(a)},get:function(a){return f.get(a)},
addField:function(a,b){f.addField(a,b)},all:f.all,createCollection:function(a,c,e){var h=f.collection_[a];return!h&&c?f.collection_[a]=new F({wrapper:b,source:e||f.all,rule:c}):h},getCollection:function(a){return f.collection_[a]},createGrouping:function(a,c,e){var h=f.grouping_[a];return!h&&c?f.grouping_[a]=new B({wrapper:b,source:e||f.all,rule:c}):h},getGrouping:function(a){return f.grouping_[a]},getSlot:function(a,b){return f.getSlot(a,b)}});return b}};H.className="basis.entity.EntityTypeWrapper";
var L=v("singleton"),G={};m(w,{});var M=m(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:false,index__:null,slot_:null,init:function(a,c){this.name=a.name||l(this.name);this.index__=a.index;this.idFields={};b.push(this);this.isSingleton=a.isSingleton;this.wrapper=c;this.all=new E(Object.extend(a.all||{},{wrapper:c}));this.slot_={};if(a.extensible)this.extensible=true;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(a.fields,this.addField,this);a.constrains&&
a.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=L;a.aliases&&Object.iterate(a.aliases,this.addAlias,this);this.collection_={};if(a.collections)for(var f in a.collections)this.collection_[f]=new F({name:f,wrapper:c,source:this.all,rule:a.collections[f]||Function.$true});this.grouping_={};if(a.groupings)for(f in a.groupings)this.grouping_[f]=new B({name:f,wrapper:c,source:this.all,rule:a.groupings[f]||Function.$true});this.entityClass=K(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:c,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(c[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||a==null)return null;for(var f in a){var e=f in this.aliases?this.aliases[f]:"";e&&e in this.fields&&(b[e]=this.fields[e].reader?this.fields[e].reader(a[f]):a[f])}return b},addAlias:function(a,b){b in this.fields&&a in this.aliases==false&&(this.aliases[a]=b)},addField:function(a,
b){if(!this.all.itemCount){this.aliases[a]=a;typeof b=="function"&&(b={type:b});if("type"in b&&typeof b.type!="function")b.type=u;var c=b.type||u;if([k,f,j,t].has(c))b.id=true;if(b.id){if(!this.index__)this.index__=new o(String);this.idFields[a]=true;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=n.apply(null,Object.keys(this.idFields))):this.idField=a}b.calc?this.addCalcField(a,b.calc,void 0):this.fields[a]=c;this.defaults[a]="defValue"in b?b.defValue:c();this.getters["get_"+
a]=function(){return this.data[a]};G[a]||(G[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var f={args:b.args,wrapper:!c?b:function(a,f,e){return c(b(a,f,e))}},e=this.calcs.length,h=0,d=0;d<this.calcs.length;d++)b.args.has(this.calcs[d].key)&&(h=d+1);if(a){f.key=a;for(d=0;d<this.calcs.length;d++)if(this.calcs[d].args.has(a)){e=d;break}if(h>e)return;if(this.idField&&a==this.idField)this.compositeKey=b;this.fields[a]=
function(a,b){typeof console!="undefined"&&console.log("Calculate fields are readonly");return b}}else e=h;this.calcs.splice(Math.min(e,h),0,f)}},get:function(a){a=this.getId(a);if(a!=null)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&a!=null){if(c[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof w)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(b!=
null){var f=this.slot_[b];f||(c[typeof a]&&(f={},this.idField&&!this.compositeKey&&(f[this.idField]=a),a=f),f=this.slot_[b]=new w({delegate:this.get(b),data:a}));return f}}}),J=m(w,{init:s.prototype.init,event_rollbackUpdate:s.createEvent("rollbackUpdate")}),K=function(b,c,f,h,d,j,i){function k(a,c,f){var e=false,h=b.calcs,d=a.__id__,j=a.data;try{if(h)for(var i=0,B;B=h[i++];){var t=B.key;if(t){var p=j[t];j[t]=B.wrapper(c,j,j[t]);j[t]!==p&&(c[t]=p,e=true)}else B.wrapper(c,j)}if(b.compositeKey)a.__id__=
b.compositeKey(c,j,a.__id__);else if(g&&g in c)a.__id__=j[g];a.__id__!==d&&b.index__.calcWrapper(a.__id__)}catch(l){a.__id__=d;for(var r in c)a.data[r]=c[r];if(f)for(r in f)if(!a.modified)a.modified=f;e=false}a.__id__!==d&&o(a,d,a.__id__);return e}function o(a,b,c){b!=null&&(f.remove(b,a),h[b]&&h[b].setDelegate());c!=null&&(f.add(c,a),h[c]&&h[c].setDelegate(a))}var g=b.idField;return m(J,i,{canHaveDelegate:false,modified:null,isTarget:true,extendConstructor_:false,init:function(a){J.prototype.init.call(this);
this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var b,f={},e;for(e in d)e in a?(f[e]=j[e],b=d[e](a[e])):b=j[e],b&&b!==this&&b instanceof s&&b.addHandler(G[e],this)&&(this.fieldHandlers_[e]=true),this.data[e]=b;k(this,f);c.event_datasetChanged(c,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(a,c,f,e){var h=d[a];if(!h){if(!b.extensible)return;h=u}var j,i=this.modified,
c=h(c,this.data[a]),h=this.data[a];if(c!==h&&(!c||!h||c.constructor!==Date||h.constructor!==Date||+c!==+h))a:{j={};if(a!=g)if(f){if(!i)this.modified=i={};if(a in i===false)j.rollback={key:a,value:void 0},i[a]=h;else if(i[a]===c&&(j.rollback={key:a,value:c},delete i[a],!Object.keys(i).length))this.modified=null}else if(i&&a in i)if(i[a]!==c){j.rollback={key:a,value:i[a]};i[a]=c;break a}else return false;this.data[a]=c;this.fieldHandlers_[a]&&(h.removeHandler(G[a],this),this.fieldHandlers_[a]=false);
c&&c!==this&&c instanceof s&&c.addHandler(G[a],this)&&(this.fieldHandlers_[a]=true);j.key=a;j.value=h;j.delta={};j.delta[a]=h}else if(!f&&i&&a in i&&(j={rollback:{key:a,value:i[a]}},delete i[a],!Object.keys(i).length))this.modified=null;if(!e&&j){var f=j.key,a=j.delta||{},o;if(j.rollback)o={},o[j.rollback.key]=j.rollback.value;k(this,a,o)&&(f=true);if(f)this.event_update(this,a),j.delta=a;o&&this.event_rollbackUpdate(this,o)}return j||false},update:function(a,b){if(a){var c,f={},e,h={},d,j;for(j in a)if(d=
this.set(j,a[j],b,true)){if(d.key)c=true,f[d.key]=d.value;if(d.rollback)e=true,h[d.rollback.key]=d.rollback.value}k(this,f,h)&&(c=true);c&&this.event_update(this,f);e&&this.event_rollbackUpdate(this,h)}return c?f:false},reset:function(){this.update(j)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=e.PROCESSING){if(this.modified){var a=
this.modified;this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(e.READY)}},destroy:function(){for(var b in this.fieldHandlers_)this.data[b].removeHandler(G[b],this);this.fieldHandlers_=a;this.__id__&&o(this,this.__id__,null);w.prototype.destroy.call(this);c.event_datasetChanged(c,{deleted:[this]});this.data=a;this.modified=null}})};d.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof K},NumericId:k,NumberId:f,IntId:j,StringId:t,Index:o,CalculateField:g,
EntityType:H,Entity:K,BaseEntity:J,EntitySetType:D,EntitySet:C,ReadOnlyEntitySet:E,Collection:F,Grouping:B})})(basis);
(function(d){var l=d.Class,g=Object.extend,n=d.EventObject,m=n.createEvent;d.ua.Cookies.get("DEBUG_MODE");var q,x,u=false,v={},y=Date.now,s=g(new n,{event_sessionOpen:m("sessionOpen"),event_sessionClose:m("sessionClose"),event_sessionFreeze:m("sessionFreeze"),event_sessionUnfreeze:m("sessionUnfreeze"),isOpened:function(){return!!q},getTimestamp:function(){if(q)return x},open:function(d,l){var m;v[d]||(v[d]=new p(d));m=v[d];q===m?u&&this.unfreeze():(this.close(),q=m,x=y(),l&&g(m.data,l),this.event_sessionOpen(this))},
close:function(){q&&(u&&this.unfreeze(),this.event_sessionClose(this),x=q=null)},freeze:function(){q&&!u&&(this.event_sessionFreeze(this),u=true,x=null)},unfreeze:function(){q&&u&&(u=false,x=y(),this.event_sessionUnfreeze(this))},storeData:function(d,g){if(q)return q.storeData(d,g);else throw Error("No opened session");},getData:function(d){if(q)return q.getData(d);else throw Error("No opened session");},destroy:function(){for(var d=Object.keys(v),g;g=d.pop();)v[g].destroy();n.prototype.destroy.call(this)}}),
p=l(n,{event_destroy:function(){q==this&&s.close();delete v[this.key]},extendConstructor_:false,init:function(d){n.prototype.init.call(this);this.key=d;this.data={}},storeData:function(d,g){if(u)throw Error("Session is frozen");return this.data[d]=g},getData:function(d){if(u)throw Error("Session is frozen");return this.data[d]},destroy:function(){n.prototype.destroy.call(this);for(var d=Object.keys(this.data),g;g=d.pop();){var p=this.data[g];p!=null&&typeof p.destroy=="function"&&p.destroy();delete this.data[g]}}});
d.namespace("basis.session").extend({SessionManager:s})})(basis);
(function(d){function l(c){var b=d.EventObject.createEvent(c),e=[c];return function(){a.dispatch.apply(this,e.concat(arguments));b.apply(this,arguments)}}function g(a,b){var e={"JS-Framework":"Basis"};r.test(b.method)?(e["Content-Type"]=b.contentType+(b.encoding?";charset="+b.encoding:""),u.test("gecko")&&(e.Connection="close")):u.test("ie")&&(e["If-Modified-Since"]=(new Date(0)).toGMTString());Object.iterate(Object.extend(e,b.headers),function(a,b){b!=null&&this.setRequestHeader(a,b)},a)}function n(a){var b=
this.transport;if(b){if(typeof a!="number")a=b.readyState;if(a!=this.prevReadyState_)if(this.prevReadyState_=a,this.event_readyStateChanged(a),a==4){y.remove(this,"timeoutAbort");var a=i.UNDEFINED,e;this.progress=false;b.onreadystatechange=Function.$undef;if(this.aborted){var f=this.abortedByTimeout_;f&&this.event_timeout();this.event_abort(f)}else a=this.responseIsSuccess(),this.update({text:b.responseText,xml:b.responseXML}),a?(this.event_success(b),a=i.READY):(this.event_failure(b),a=i.ERROR,e=
this.getRequestError(b)),this.event_httpStatus(b,b.status);this.event_complete(b);this.setState(a,e)}else this.setState(i.PROCESSING)}}function m(a){y.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=false;this.prevReadyState_=-1;if(u.test("gecko1.8.1-")&&a.asynchronous)this.transport=e();var b=this.transport;this.asynchronous?b.onreadystatechange=n.bind(this):n.call(this,0);b.open(a.method,a.location,a.asynchronous);this.progress=true;this.abortedByTimeout_=this.aborted=
false;g(b,a);this.event_start();if(this.aborted)n.call(this,4);else if(!this.aborted&&this.progress){this.requestStartTime=Date.now();y.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var d=a.postBody;if(a.method=="POST"&&u.test("ie9-"))if(typeof d=="object"&&typeof d.documentElement!="undefined"&&typeof d.xml=="string")d=d.xml;else if(typeof d=="string")d=d.replace(/\r/g,"");else if(d==null||d=="")d="[empty request]";b.send(d);return true}}var q=d.Class,x=d.dom.event,u=d.ua,v=d.Cleaner,
y=d.TimeEventManager,s=d.data,p=s.DataObject,i=s.STATE,r=/POST/i,s=d.ua.Cookies.get("DEBUG_AJAX");(function(){for(var a=192;a<=255;a++)a.toHex(),String.fromCharCode(a+848),(a+848).toHex(),a.toHex()})();var w="native",e=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var a=window.ActiveXObject;if(a)for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e=0;w=b[e];e++)try{if(new a(w))return function(){return new a(w)}}catch(f){}throw Error(w=
"Browser doesn't support for XMLHttpRequest!");}(),a=function(){var a=[],b=[{handler:{start:function(){a.add(this)},complete:function(){a.remove(this)}}}];x.onUnload(function(){b.clear()});return{addHandler:function(a,c){for(var e=0,d;d=b[e];e++)if(d.handler===a&&d.thisObject===c)return false;b.push({handler:a,thisObject:c});return true},removeHandler:function(a,c){for(var e=0,d;d=b[e];e++)if(d.handler===a&&d.thisObject===c)return b.splice(e,1),true;return false},dispatch:function(a){if(b.length)for(var c=
Array.prototype.slice.call(arguments,1),e,d,h=b.length-1;e=b[h];h--)d=e.handler[a],typeof d=="function"&&d.apply(e.thisObject||this,c)},abort:function(){for(var b=Array.from(a),f=0;f<b.length;f++)b[f].abort();return b}}}(),q=q(p,{state:i.UNDEFINED,event_start:l("start"),event_readyStateChanged:l("readyStateChanged"),event_timeout:l("timeout"),event_abort:l("abort"),event_success:l("success"),event_failure:l("failure"),event_httpStatus:l("httpStatus"),event_complete:l("complete"),event_stateChanged:function(a,
b){p.prototype.event_stateChanged.call(this,a,b);for(var e=0;e<this.influence.length;e++)this.influence[e].setState(this.state,this.state.data)},influence:null,debug:s,progress:false,aborted:false,abortedByTimeout_:false,abortCalled:false,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:true,method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(a){var b=this.influence;this.transport=e();this.requestHeaders={};this.influence=[];this.params={};b&&this.setInfluence.apply(this,
b);v.add(this);p.prototype.init.call(this,a);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var a=Array.from(arguments),b=0;b<a.length;b++)a[b].setState(this.state,this.state.data);this.influence.set(a)},clearInfluence:function(){this.influence.clear()},setParam:function(a,b){this.params[a]=b},setParams:function(a){this.clearParams();for(var b in a)this.setParam(b,a[b])},removeParam:function(a){delete this.params[a]},clearParams:function(){for(var a in this.params)delete this.params[a]},
timeoutAbort:function(){this.abortedByTimeout_=true;this.abort()},abort:function(){this.aborted=true;if(this.progress)y.remove(this,"timeoutAbort"),this.progress=false,this.transport.abort(),this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==Function.$undef&&n.call(this,4)},request:function(a){var a=a||this.url,b=this.method.toUpperCase(),e,f;if(!this.transport)throw Error("Transport is not allowed");if(!a)throw Error("URL is not defined");this.abort();delete this.requestData_;
this.update({responseText:"",responseXml:null});this.abortedByTimeout_=this.aborted=this.progress=false;e=Object.iterate(this.params,function(a,b){return b==null||b&&typeof b.toString=="function"&&b.toString()==null?null:a+"="+String(b.toString()).replace(/[\%\=\&\<\>\s\+]/g,function(a){a=a.charCodeAt(0).toHex();return"%"+(a.length<2?"0":"")+a})}).filter(Function.$isNotNull).join("&");r.test(b)?f=this.postBody||e||"":e&&(a+=(a.indexOf("?")==-1?"?":"&")+e);this.requestData_={method:b,location:a,contentType:this.contentType,
encoding:this.encoding,asynchronous:this.asynchronous,headers:Object.extend({},this.requestHeaders),postBody:f};return m.call(this,this.requestData_)},repeat:function(){if(this.requestData_)return this.abort(),m.call(this,this.requestData_)},get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var a=this.transport.status;return a==void 0||a==0||a>=200&&this.transport.status<300}}catch(b){}return false},getRequestError:function(a){return{code:"SERVER_ERROR",
msg:a.responseText}},destroy:function(){this.destroy=Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();p.prototype.destroy.call(this);delete this.transport;v.remove(this)}});d.namespace("basis.net.ajax").extend({Transport:q,TransportDispatcher:a,createEvent:l})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.net.ajax,m=d.xml,q=n.Transport,x=m.QName,u=m.addNamespace,v=m.XML2Object,y=m.Object2XML,s=m.createElementNS,p=m.NAMESPACE,i=String("http://schemas.xmlsoap.org/soap/envelope/"),r=String("http://schemas.xmlsoap.org/soap/encoding/"),w=l(null,{url:null,namespace:null,init:function(a,b){this.url=a;this.namespace=b},call:function(a,b){a=this.createMethodCall(a,b,false);a.transport.abort();a.invoke(b.header,b.body,b.callback,b.mapping)},createMethodCall:function(a,
b,c){return new e(this,new x(a,this.namespace),b,c)}}),e=l(null,{service:null,transport:null,method:null,envelope:null,body:null,init:function(b,e,d,h){d=d||{};this.method=e;this.envelope=new c;this.url=b.url;this.transport=new a(e,d.callback);this.transport.requestHeaders={SOAPAction:e.namespace+(!/\/$/.test(e.namespace)?"/":"")+e};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return b.url}};d.mapping&&this.transport.setMapping(d.mapping);
d.callback&&this.transport.setCallback(d.callback);if(h)this.body=d.body||{}},repeatCall:function(){this.transport.get()},call:function(a){return this.invoke(null,a||this.body)},invoke:function(a,b,c,e){this.transport.abort();this.envelope.getBody(true).setValue(this.method,b);a&&this.envelope.getHeader(true).setValue(a,this.method.namespace);c&&this.transport.setCallback(c);e&&this.transport.setMapping(e);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();
this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),a=l(q,{callback:{},mapping:null,method:"POST",contentType:"text/xml",encoding:"utf-8",event_success:function(a){var b=a.responseXML;if(b===void 0||b.documentElement===void 0)this.event_failure(this);else{var e=Array.from(arguments);b.xml&&DOMParser&&(b=(new DOMParser).parseFromString(b.xml,"text/xml"));this.responseEnvelope=new c(b.documentElement);e.push(this.getResponseData(),this.getRequestData());q.prototype.event_success.apply(this,
e)}},event_failure:function(a){var b=Array.from(arguments),c=this.state.data||this.getRequestError(a);c.isSoapFailure&&this.event_soapfailure(a,c.code,c.msg);b.push(c.code,c.msg);q.prototype.event_failure.apply(this,b)},event_soapfailure:n.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(a){return g.tag(a,"code")[0]},errorMessageGetter:function(a){return g.tag(a,"message")[0]},extendConstructor_:false,init:function(a){q.prototype.init.call(this);
this.soapMethod=a},setCallback:function(a){typeof a=="object"&&this.addHandler(a)},setMapping:function(a){this.mapping=a},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},getResponseData:function(){var a=this.responseEnvelope&&this.responseEnvelope.getBody();if(a)return this.responseDataGetter(a.getValue(this.mapping))},getRequestError:function(a){var b,e,d=false,a=a.responseXML;if(a!=void 0&&a.documentElement!=void 0)b=a.documentElement,d=this.errorCodeGetter(b),
e=this.errorMessageGetter(b),this.responseEnvelope=new c(b),b=d?d.firstChild.nodeValue:"UNKNOWN_ERROR",e=e?e.firstChild.nodeValue:"Unknown error",console.log("SoapError:",b.quote("("),e),d=true;return{code:b||"TRANSPORT_ERROR",msg:e,isSoapFailure:d}}}),c=l(null,{header:null,body:null,init:function(a){if(!a)a=m.createDocument(i,"soap:Envelope").documentElement,u(a,"xsd",p.XMLShema),u(a,"xsi",p.XMLShemaInstance),m.XMLNS.BAD_SUPPORT&&u(a,"soap",i);this.document=a.ownerDocument;this.element=a;this.body=
this.getBody(true)},getElementByName:function(a){return m.getElementsByTagNameNS(this.element,a,i)[0]},getHeader:function(a){var c=this.header;if(!c){var e=this.getElementByName("Header");if(e||a)c=this.header=new b(e,this.document),e||this.element.insertBefore(c.element,this.element.firstChild)}return c},setHeaderSection:function(a,b){this.getHeader(true).setSection(a,b)},getBody:function(a){var b=this.body;if(!b){var c=this.getElementByName("Body");if(c||a)b=this.body=new k(c,this.document),c||
this.element.appendChild(b.element)}return b},destroy:function(){this.header&&(this.header.destroy(),delete this.header);this.body&&(this.body.destroy(),delete this.body);delete this.element;delete this.document}}),b=l(null,{init:function(a,b){this.element=a||s(b,"Header",i)},getValue:function(){return v(this.element)},setValue:function(a,b){g.clear(this.element);this.appendChild(a,b)},appendChild:function(a,b){if(a)for(var c in a){var e=this.element.appendChild(y(this.element.ownerDocument,c,b,a[c]));
m.XMLNS.BAD_SUPPORT&&u(e,"",b)}},setSection:function(a,b){var c=m.getElementsByTagNameNS(this.element,a,a.namespace)[0];c&&g.remove(c);this.appendChild(Function.wrapper(a)(b),a.namespace)}}),k=l(null,{init:function(a,b){this.element=a||s(b,"Body",i)},getValue:function(a){return v(this.element,a)},setValue:function(a,b,c){g.clear(this.element);this.appendChild(a,b,c)},appendChild:function(a,b,c){b=y(this.element.ownerDocument,a,a.namespace,Function.$defined(b)?b:{});this.element.appendChild(b);m.XMLNS.BAD_SUPPORT&&
u(b.element,"",a.namespace);c&&m.setAttributeNodeNS(b,m.createAttributeNS(document,"encodingStyle",r,c))}});d.namespace("basis.net.soap").extend({Service:w,ServiceCall:e,ServiceCallTransport:a,Envelope:c,EnvelopeHeader:b,EnvelopeBody:k})})(basis);
(function(d){var l=Function.getter,g=d.Class,n=d.dom,m=d.ui.Node,q=d.ui.Control,x=g(m,{captionGetter:l("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){m.prototype.event_select.call(this);n.focus(this.element)},event_disable:function(){m.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=true},event_enable:function(){m.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=false},init:function(d){m.prototype.init.call(this,d);this.setCaption(this.caption)},setCaption:function(d){this.caption=d;this.tmpl.captionText.nodeValue=this.captionGetter(this)}}),g=g(q,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:x,getButtonByName:function(d){return this.childNodes.search(d,
l("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(d){return d.groupId||-d.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});d.namespace("basis.ui.button").extend({Button:x,ButtonPanel:g})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.html.Template,m=Function.getter,q=d.EventObject.createEvent,x=d.data.STATE,u=d.ui.Node,v=new n('<div{element|content} class="Basis-Label-State"/>'),y=new n('<div{element|content} class="Basis-Label-Processing"/>'),s=new n('<div{element|content} class="Basis-Label-Error"/>'),p=l(u,{cascadeDestroy:true,show_:false,visible_:false,visibilityGetter:Function.$false,insertPoint:g.INSERT_END,content:"[no text]",event_delegateChanged:function(a,b){(b?b.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:q("visibilityChanged"),init:function(a){var b=this.container;this.container=null;u.prototype.init.call(this,a);if(b)this.container=b;this.traceChanges_();return a},traceChanges_:function(){this.container&&this.visible_?this.container!=this.element.parentNode&&g.insert(this.container,this.tmpl.element,this.insertPoint):g.remove(this.element)},setContainer:function(a){if(this.container!=a)this.container=
a,this.traceChanges_()},setVisibility:function(a){if(this.visible_!=a)this.visible_=a,this.traceChanges_(),this.event_visibilityChanged(this.visible_)},destroy:function(){delete this.container;u.prototype.destroy.call(this)}}),i=l(p,{template:v,init:function(a){if(this.visibleStates&&!this.visibilityGetter){for(var b={},c,e=0;c=this.visibleStates[e++];)b[c]=true;this.visibilityGetter=m(Function.$self,b)}p.prototype.init.call(this,a)}}),q=l(i,{event_delegateChanged:function(a,b){i.prototype.event_delegateChanged.call(this,
a,b);this.delegate&&this.event_stateChanged(this)},event_stateChanged:function(a,b){i.prototype.event_stateChanged.call(this,a,b);this.setVisibility(this.visibilityGetter(this.state,b))}}),r=l(q,{visibilityGetter:function(a){return a==x.PROCESSING},content:"Processing...",template:y}),s=l(q,{visibilityGetter:function(a){return a==x.ERROR},content:"Error",template:s}),w={stateChanged:function(a,b){this.setVisibility(this.visibilityGetter(a.state,b))}},e={dataSourceChanged:function(a,b){b&&b.removeHandler(w,
this);a.dataSource&&(a.dataSource.addHandler(w,this),w.stateChanged.call(this,a.dataSource,a.dataSource.state))}},v=l(i,{event_delegateChanged:function(a,b){i.prototype.event_delegateChanged.call(this,a,b);b&&b.removeHandler(e,this);this.delegate&&(this.delegate.addHandler(e,this),e.dataSourceChanged.call(this,this.delegate,b&&b.dataSource))},template:v}),y=l(v,{visibilityGetter:function(a){return a==x.PROCESSING},content:"Processing...",template:y}),a=function(){this.setVisibility(this.visibilityGetter(this.delegate?
this.delegate.childNodes.length:0,this.delegate))},c={stateChanged:function(a){this.setVisibility(this.visibilityGetter(a.itemCount,this.delegate))}},b={childNodesModified:a,dataSourceStateChanged:a,stateChanged:a,dataSourceChanged:function(a,b){b&&b.removeHandler(c,this);a.dataSource&&(a.dataSource.addHandler(c,this),c.stateChanged.call(this,a.dataSource,a.dataSource.state))}},n=l(p,{event_delegateChanged:function(c,f){p.prototype.event_delegateChanged.call(this,c,f);f&&f.removeHandler(b,this);this.delegate&&
(this.delegate.addHandler(b,this),b.dataSourceChanged.call(this,this.delegate));a.call(this)},template:new n('<div{element|content} class="Basis-CountLabel"/>')}),l=l(n,{visibilityGetter:function(a,b){var c=b.dataSource?b.dataSource.state:b.state;return!a&&c==x.READY},content:"Empty"});d.namespace("basis.ui.label").extend({NodeLabel:p,State:i,ObjectState:q,Processing:r,Error:s,DataSourceState:v,DataSourceProcessing:y,ChildCount:n,IsEmpty:l})})(basis);
(function(d){function l(e){typeof e.expand=="function"&&e.expand()}function g(e){typeof e.collapse=="function"&&e.collapse()}var n=d.Class,m=d.dom,q=d.dom.event,x=d.cssom.classList,u=Function.getter,v=d.EventObject.createEvent,y=d.ui.Container,s=d.ui.Control,p=d.ui.PartitionNode,i=d.ui.GroupingNode,r={expandAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,l)},collapseAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,g)},expand:Function(),collapse:Function(),toggle:Function()},p=n(p,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'}),
i=n(i,{childClass:p}),w=n(y,r,{canHaveChildren:false,childFactory:null,event_collapse:v("collapse"),event_expand:v("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(e){e.titleText.nodeValue=String(this.titleGetter(this))||"[no title]"},action:{select:function(e){this.isDisabled()||this.select(q(e).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:u("data.title")}),u=n(w,{canHaveChildren:true,childClass:w,localGroupingClass:i,event_expand:function(){w.prototype.event_expand.call(this);x(this.element).remove("collapsed")},event_collapse:function(){w.prototype.event_collapse.call(this);x(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:true,collapsed:false,init:function(e){w.prototype.init.call(this,e);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed)return this.collapsed=false,this.event_expand(),true},collapse:function(){if(!this.collapsed&&this.collapsable)return this.collapsed=true,this.event_collapse(),true},toggle:function(){this.collapsed?this.expand():this.collapse()}}),n=n(s,r,{childClass:w,localGroupingClass:i,template:'<ul class="Basis-Tree"/>'});d.namespace("basis.ui").extend({Tree:n});
d.namespace("basis.ui.tree").extend({Tree:n,Node:w,Folder:u,GroupingNode:i,PartitionNode:p})})(basis);
(function(){var d=basis.Class,l=basis.dom,g=basis.dom.event,n=basis.cssom,m=Function.getter,q=basis.cssom.classList,x=basis.Cleaner,u=basis.layout,v=basis.EventObject.createEvent,y=basis.ui.Node,s=basis.ui.Container,p=basis.ui.Control,i=basis.ui.PartitionNode,r=basis.ui.GroupingNode,w={VERTICAL:"V",HORIZONTAL:"H"},e=String("LTRTRBLBLCCTRCCBCCCCCCCC"),a={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},c={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},b={finish:function(){this.visible||
(l.remove(this.element),this.event_cleanup(this))}},v=d(s,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:v("beforeShow"),event_show:v("show"),event_hide:v("hide"),event_realign:v("realign"),event_cleanup:v("cleanup"),event_layoutChanged:v("layoutChanged","oldOrientation","oldDir")&&function(a,b){var c=(a+"-"+b.qw().slice(2,4).join("-")).toLowerCase(),
f=(this.orientation+"-"+this.dir.qw().slice(2,4).join("-")).toLowerCase();q(this.element).replace(c,f,this.cssLayoutPrefix)},visible:false,autorotate:false,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:w.VERTICAL,hideOnAnyClick:true,hideOnKey:false,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(a){s.prototype.init.call(this,a);this.cssRule=n.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,
this.orientation);this.thread&&this.thread.addHandler(b,this);x.add(this)},setLayout:function(a,b,c){var f=this.dir,e=this.orientation;if(typeof a=="string")this.dir=a.toUpperCase();if(typeof b=="string")this.orientation=b;if(f!=this.dir||e!=this.orientation)this.event_layoutChanged(e,f),c||this.realign()},flip:function(a){var b=this.dir.qw(),a=a==w.VERTICAL;b[0+a]=c[b[0+a]];b[2+a]=c[b[2+a]];this.setLayout(b.join(" "))},rotate:function(b){var c=this.dir.qw(),b=(b%4+4)%4,f=[];if(!b)return c;var d=
c[0].charAt(0),j=c[1].charAt(0),i=e.indexOf(d+j)>>1,d=(i&252)+((i&3)+b&3)<<1;f.push(a[e.charAt(d)],a[e.charAt(d+1)]);d=c[2].charAt(0);j=c[3].charAt(0);i=e.indexOf(d+j)>>1;b=d!="C"&&j!="C"&&c[0]==c[2]!=(c[1]==c[3])?-b+4:b;d=(i&252)+((i&3)+b&3)<<1;f.push(a[e.charAt(d)],a[e.charAt(d+1)]);return f},isFitToViewport:function(a){if(this.visible&&this.relElement){var b=new u.Box(this.relElement,false,this.element.offsetParent),c=new u.Viewport(this.element.offsetParent),f=this.element.offsetWidth,e=this.element.offsetHeight,
a=String(a||this.dir).toUpperCase().qw(),d=a[0]=="CENTER"?b.left+(b.width>>1):b[a[0].toLowerCase()],b=a[1]=="CENTER"?b.top+(b.height>>1):b[a[1].toLowerCase()];return(a[2]!="LEFT")*(d<f>>(a[2]=="CENTER"))||(a[2]!="RIGHT")*(c.width-d<f>>(a[2]=="CENTER"))?false:(a[3]!="TOP")*(b<e>>(a[3]=="CENTER"))||(a[3]!="BOTTOM")*(c.height-b<e>>(a[3]=="CENTER"))?false:{x:d,y:b}}},realign:function(){if(this.visible&&this.relElement){for(var a=this.dir.qw(),b,c=0,f=a,e=a[2],d=a[3],j=typeof this.autorotate=="number"||
!this.autorotate.length?3:this.autorotate.length;this.autorotate&&c<=j;){if(b=this.isFitToViewport(f.join(" "))){e=f[2];d=f[3];this.setLayout(f.join(" "),null,true);break}if(c==j)break;Array.isArray(this.autorotate)?(f=this.autorotate[c++],f=typeof f=="string"?f.toUpperCase().split(" "):this.rotate(f)):f=this.rotate(++c*this.autorotate)}b||(b=new u.Box(this.relElement,false,this.element.offsetParent),b={x:a[0]=="CENTER"?b.left+(b.width>>1):b[a[0].toLowerCase()],y:a[1]=="CENTER"?b.top+(b.height>>1):
b[a[1].toLowerCase()]});a=new u.Box(this.element.offsetParent);c={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(e){case "LEFT":c.left=b.x+"px";break;case "CENTER":c.left=Math.round(b.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":c.right=a.width-b.x+"px"}switch(d){case "TOP":c.top=b.y+"px";break;case "CENTER":c.top=Math.round(b.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":c.bottom=a.height-b.y+"px"}this.cssRule.setStyle(c);this.event_realign()}},show:function(a,b,c){this.relElement=
l.get(a)||this.relElement;this.setLayout(b||this.defaultDir,c);if(this.visible)this.realign();else if(this.relElement)q(this.element).remove("pre-transition"),l.visibility(this.element,false),t.appendChild(this),this.event_beforeShow(),this.visible=true,this.realign(),this.thread&&this.thread.start(1),l.visibility(this.element,true),q(this.element).add("pre-transition"),this.event_show()},hide:function(){if(this.visible)l.parentOf(document.body,this.element)&&(this.thread?this.thread.start(1):(l.remove(this.element),
this.event_cleanup(this))),this.visible=false,this.parentNode&&t.removeChild(this),this.event_hide()},hideAll:function(){t.clear()},destroy:function(){if(this.thread)this.thread.removeHandler(b,this),this.thread=null;this.hide();s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;x.remove(this)}}),k=d(v,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
f=d(s,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(a){this.click();g.kill(a)}},event_childNodesModified:function(a,b){q(this.element).bool("hasSubItems",this.hasChildNodes());s.prototype.event_childNodesModified.call(this,a,b)},groupId:0,caption:"[untitled]",captionGetter:m("caption"),handler:null,defaultHandler:function(a){this.parentNode&&this.parentNode.defaultHandler(a)},init:function(a){s.prototype.init.call(this,
a);this.setCaption(this.caption)},setCaption:function(a){this.caption=a;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){!this.isDisabled()&&!(this instanceof j)&&(this.handler?this.handler(this):this.defaultHandler(this))}});f.prototype.childClass=f;var j=d(f,{event_childNodesModified:y.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'}),y=d(i,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'}),
r=d(r,{childClass:y}),d=d(v,{childClass:f,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:r,localGrouping:m("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'}),t=new p({id:"Basis-PopupStack",handheldMode:false,childClass:v,event_childNodesModified:function(a,b){if(b.deleted)for(var c=b.deleted.length-
1,f;f=b.deleted[c];c--)f.hide();if(b.inserted&&!b.deleted&&this.childNodes.length==b.inserted.length)q(this.element).add("IsNotEmpty"),document.body.className=document.body.className,g.addGlobalHandler("click",this.hideByClick,this),g.addGlobalHandler("keydown",this.hideByKey,this),g.addGlobalHandler("scroll",this.hideByScroll,this),g.addHandler(window,"resize",this.realignAll,this);this.lastChild?this.lastChild.select():(q(this.element).remove("IsNotEmpty"),document.body.className=document.body.className,
g.removeGlobalHandler("click",this.hideByClick,this),g.removeGlobalHandler("keydown",this.hideByKey,this),g.removeGlobalHandler("scroll",this.hideByScroll,this),g.removeHandler(window,"resize",this.realignAll,this));p.prototype.event_childNodesModified.call(this,a,b)},insertBefore:function(a,b){var c=document.documentElement.scrollTop,f=document.body.scrollTop;if(p.prototype.insertBefore.call(this,a,b)){a.documentST_=c;a.bodyST_=f;if(this.handheldMode)document.documentElement.scrollTop=0,document.body.scrollTop=
0;a.element.style.zIndex=basis.ui.Window?basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(a){if(a&&(a.hideOnAnyClick&&a.nextSibling&&this.removeChild(a.nextSibling),p.prototype.removeChild.call(this,a),this.handheldMode))document.documentElement.scrollTop=a.documentST_,document.body.scrollTop=a.bodyST_},realignAll:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(a){for(var a=
g.sender(a),b,c=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),f=0,e;e=c[f];f++){if(a===e.tmpl.closeButton||l.parentOf(e.tmpl.closeButton,a)){this.removeChild(e);return}b||(b=l.axis(a,l.AXIS_ANCESTOR_OR_SELF));if(b.has(e.element)||b.some(Array.prototype.has,e.ignoreClickFor)){this.removeChild(c[f-1]);return}}this.removeChild(c.pop())},hideByKey:function(a){var a=g.key(a),b=this.lastChild;if(b&&b.hideOnKey){var c=false;typeof b.hideOnKey=="function"?c=b.hideOnKey(a):Array.isArray(b.hideOnKey)&&
(c=b.hideOnKey.has(a));c&&b.hide()}},hideByScroll:function(a){a=g.sender(a);if(!l.parentOf(a,this.element))for(var b=this.lastChild;b;){var c=b.previousSibling;b.relElement&&b.offsetParent!==a&&l.parentOf(a,b.relElement)&&b.hide();b=c}}});g.onLoad(function(){l.insert(document.body,t.element,l.INSERT_BEGIN);t.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:w,setHandheldMode:function(a){t.handheldMode=!!a},Popup:v,Balloon:k,Menu:d,MenuGroupControl:r,MenuPartitionNode:y,MenuItem:f,
MenuItemSet:j})})(basis);
(function(d){var l=d.Class,g=d.dom.event,n=d.dom,m=d.html.Template,q=d.cssom.classList,x=d.dom.wrapper,u=x.GroupingNode,v=x.PartitionNode,y=d.ui.Node,s=d.ui.Container,p=d.ui.Control,i=d.ui.PartitionNode,r=d.ui.GroupingNode,w=l(y,{template:new m('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(a){a.titleText.nodeValue=
this.titleGetter(this)}}),e=l(u,{event_ownerChanged:function(a,b){b&&n.remove(this.headerRow);if(this.owner&&this.owner.element){var c=this,e=this.owner.element;do n.insert(e,c.headerRow,n.INSERT_BEGIN);while(c=c.localGrouping)}u.prototype.event_ownerChanged.call(this,a,b)},childClass:{init:function(a){v.prototype.init.call(this,a);this.cell=new w({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(a,b){var c=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var e=
0,d;d=this.nodes[e];e++)c+=d.cell.element.colSpan;else c=this.nodes.length;this.cell.element.colSpan=c;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{});v.prototype.event_childNodesModified.call(this,a,b)},destroy:function(){v.prototype.destroy.call(this);this.cell.destroy()}},init:function(a){u.prototype.init.call(this,a);this.element=this.childNodesElement=this.headerRow=n.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(a,b){a=
u.prototype.insertBefore.call(this,a,b);n.insert(this.headerRow,a.cell.element,n.INSERT_BEFORE,a.nextSibling&&a.nextSibling.cell.element);return a},removeChild:function(a){n.remove(a.cell.element);u.prototype.removeChild.call(a)},destroy:function(){u.prototype.destroy.call(this);this.headerRow=null}});e.prototype.localGroupingClass=e;var x=l(y,{sorting:null,defaultOrder:false,groupId:0,template:new m('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var a=this.parentNode&&this.parentNode.owner;a&&a.setLocalSorting(a.localSorting,!a.localSortingDesc)}else this.select()}},init:function(a){y.prototype.init.call(this,a);this.selectable=!!this.sorting;if(this.sorting)this.sorting=Function.getter(this.sorting),this.defaultOrder=this.defaultOrder=="desc",q(this.element).add("sortable")},select:function(){if(!this.selected)this.order=this.defaultOrder;y.prototype.select.call(this)}}),a=l(s,{childClass:x,localGroupingClass:e,
template:new m('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(a){var b=this.childNodes.search(a.localSorting,"sorting");b?(b.select(),b.order=a.localSortingDesc,q(this.tmpl.content).bool("sort-order-desc",b.order)):this.selection.clear()}}},init:function(a){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(a){(a=a.pick())&&
this.owner&&this.owner.setLocalSorting(a.sorting,a.order)}}};s.prototype.init.call(this,a);this.applyConfig_(this.structure)},applyConfig_:function(a){a&&this.setChildNodes(a.map(function(a){var b=a.header,c=Object.slice(a,["sorting","defaultOrder","groupId"]);c.content=(b==null||typeof b!="object"?b:b.content)||String.Entity.nbsp;if(typeof c.content=="function")c.content=c.content.call(this);c.cssClassName=(b.cssClassName||"")+" "+(a.cssClassName||"");return c},this))}}),c=l(y,{colSpan:1,template:new m('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),
setColSpan:function(a){this.element.colSpan=this.colSpan=a||1}}),b=l(s,{childClass:c,childFactory:function(a){return new this.childClass(a)},template:new m('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(a){s.prototype.init.call(this,a);this.applyConfig_(this.structure);this.useFooter&&n.insert(this.container||this.owner.element,this.element,1)},applyConfig_:function(a){if(a){var b=null;this.clear();this.useFooter=false;for(var e=0;e<a.length;e++){var d=
a[e],i;d.footer?(i=d.footer.content,typeof i=="function"&&(i=i.call(this)),this.useFooter=true,i=this.appendChild({cssClassName:(d.cssClassName||"")+" "+(d.footer.cssClassName||""),content:i,template:d.footer.template||c.prototype.template})):b?b.setColSpan(b.colSpan+1):i=this.appendChild({});i&&(b=i)}}}}),k=l(y,{canHaveChildren:false,repaintCount:0,getters:[],classNames:[],template:'<tr class="Basis-Table-Row" event-click="select"><\!--{cells}--\></tr>',action:{select:function(a){this.select(g(a).ctrlKey)}},
templateUpdate:function(){this.repaintCount+=1;for(var a=0,b;b=this.updaters[a];a++){var c=this.element.childNodes[b.cellIndex];b=b.getter.call(this,this,c);if(this.repaintCount>1)c.innerHTML="";if(!b||!Array.isArray(b))b=[b];for(var e=0;e<b.length;e++){var d=b[e];c.appendChild(d&&d.nodeType?d:n.createText(d!=null&&(typeof d!="string"||d!="")?d:" "))}}}}),i=l(i,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><\!-- {childNodesHere} --\></tbody>',
action:{click:function(){q(this.element).toggle("collapsed")}}}),l=l(p,{canHaveChildren:true,childClass:k,localGroupingClass:l(r,{childClass:i}),template:new m('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><\!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><\!-- {footerElement} --\></table>'),templateAction:function(a,b){p.prototype.templateAction.call(this,a,b)},init:function(c){this.applyConfig_(this.structure);p.prototype.init.call(this,
c);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new a(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new b(Object.extend({owner:this,structure:this.structure},this.footer));n.replace(this.tmpl.headerElement,this.header.element);!this.localSorting&&this.structure&&this.structure.search(true,function(a){return a.sorting&&"autosorting"in a})&&(c=this.structure[Array.lastSearchIndex],this.setLocalSorting(c.sorting,c.defaultOrder=="desc"))},applyConfig_:function(a){if(a){var b=
[],c="";this.firstChild&&this.clear();for(var e=0;e<a.length;e++){var d=a[e],i=d.body||{};if(typeof i=="function"||typeof i=="string")i={content:i};var d=[d.cssClassName||"",i.cssClassName||""].join(" ").trim(),g=i.content;c+="<td"+(i.templateRef?i.templateRef.quote("{"):"")+(d?' class="'+d+'"':"")+">"+(typeof g=="string"?i.content:"")+"</td>";typeof g=="function"&&b.push({cellIndex:e,getter:g})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new m(this.childClass.prototype.template.source.replace("<\!--{cells}--\>",
c)),updaters:b});if(this.rowBehaviour){var p=this.rowBehaviour;Object.keys(p).forEach(function(a){this.childClass.prototype[a]=function(){p[a].apply(this,arguments);k.prototype[a].apply(this,arguments)}},this)}}},loadData:function(a){this.setChildNodes(a.map(Function.wrapper("data")))},destroy:function(){p.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});d.namespace("basis.ui.table").extend({Table:l,Body:i,Header:a,HeaderCell:x,Row:k,Footer:b});
d.namespace("basis.ui").extend({Table:l})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.dom.event,m=d.cssom,q=d.TimeEventManager,x=d.ui.table.Table,u=d.layout.Box,v=d.layout.Viewport,y=d.ui.table,s=17;n.onLoad(function(){var d=g.createElement("");g.setStyle(d,{height:"100px",overflow:"scroll"});g.insert(document.body,d);s=(new u(d)).width-(new v(d)).width;m.cssRule(".ScrollBarWidthOwner").setStyle({width:s+"px"});g.remove(d)});l=l(x,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><\!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(d,
i){x.prototype.event_childNodesModified.call(this,d,i);q.add(this,"adjust",Date.now())},init:function(d){x.prototype.init.call(this,d);this.headerClone=new y.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=
this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=g.insert(this.element,g.createElement(".Basis-ScrollTable-ExpandHeaderCell",g.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new u(this.header.element);if(this.footer.useFooter)g.insert(this.tmpl.foot,this.footer.element),this.footerClone=new y.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,structure:this.structure},this.footerConfig)),this.originalCells=
this.originalCells.concat(this.footer.childNodes),this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes),g.setStyle(this.footerClone.element,{visibility:"hidden"}),this.footerBox=new u(this.footer.element),this.footerExpandCell=g.insert(this.element,g.createElement(".Basis-ScrollTable-ExpandFooterCell"));this.cellsAdjustmentInfo=[];for(var d=0,i,l;i=this.originalCells[d];d++)l=this.clonedCells[d],this.cellsAdjustmentInfo.push({element:l.element,boxChangeListener:i.element,contentSource:i.content,
contentDestination:l.content});this.tableBox=new u(this.tmpl.tableElement);this.lastScrollLeftPosition=0;n.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));n.addHandler(window,"resize",this.adjust.bind(this));this.sync();q.add(this,"adjust",Date.now())},onScroll:function(){var d=this.tmpl.scrollContainer.scrollLeft;if(d!=this.lastScrollLeftPosition)g.setStyleProperty(this.tmpl.headerFooterContainer,"left",-d+"px"),this.lastScrollLeftPosition=d},adjust:function(){this.onScroll();
this.tableBox.recalc();var d=this.tableBox.width||0;this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth?(g.setStyleProperty(this.tmpl.tableWrapperElement,"width",d+"px"),g.setStyleProperty(this.tmpl.headerFooterContainer,"width",d+s+"px")):(g.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%"),g.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%"));this.cellsAdjustmentInfo.forEach(this.adjustCell);d=Math.max(0,this.tmpl.tableWrapperElement.clientWidth-
this.tmpl.tableElement.offsetWidth+s);this.headerBox.recalc();var i=this.headerBox.height||0;m.setStyleProperty(this.element,"paddingTop",i+"px");m.setStyleProperty(this.tmpl.tableElement,"marginTop",-i+"px");m.setStyle(this.headerExpandCell,{width:d+"px",height:i+"px"});this.footer.useFooter&&(this.footerBox.recalc(),i=this.footerBox.height||0,m.setStyleProperty(this.element,"paddingBottom",i+"px"),m.setStyleProperty(this.tmpl.tableElement,"marginBottom",-i+"px"),m.setStyle(this.footerExpandCell,
{width:d+"px",height:i+"px"}))},sync:function(){this.adjust()},adjustCell:function(d){var i;i=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(d.element,null).width:d.element.clientWidth+"px";m.setStyleProperty(d.boxChangeListener,"width",i)}});d.namespace("basis.ui.scrolltable").extend({ScrollTable:l})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.dom.event,m=d.cssom,q=d.cssom.classList,x=d.Cleaner,u=d.EventObject.createEvent,v=d.dragdrop,y=d.ui.Node,s=d.ui.Container,p=d.ui.Control,i=d.ui.button.ButtonPanel,r=l(y,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(a){y.prototype.init.call(this,a);g.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});x.add(this)},capture:function(a,c){if(this.captureElement=
g.get(a||document.body))g.insert(this.captureElement,this.element),this.element.style.zIndex=c||1E3,g.show(this.element)},release:function(){if(this.captureElement)this.element.parentNode==this.captureElement&&g.remove(this.element),this.captureElement=null,g.hide(this.element)},destroy:function(){this.release();y.prototype.destroy.call(this);x.remove(this)}}),l=l(s,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><\!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(a){var c=n.key(a);c==n.KEY.ESCAPE?this.closeOnEscape&&this.close(0):c==n.KEY.ENTER&&n.sender(a).tagName!="TEXTAREA"&&n.kill(a)}},event_beforeShow:u("beforeShow"),event_open:u("open"),event_close:u("close"),event_active:u("active"),closeOnEscape:true,autocenter:true,autocenter_:false,modal:false,closed:true,moveable:true,title:"[no title]",init:function(a){s.prototype.init.call(this,a);g.hide(this.element);
a=this.tmpl.title.parentNode;this.setTitle(this.title);this.cssRule=m.uniqueRule(this.element);if(this.moveable&&v)this.dde=new v.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||a,fixRight:false,fixBottom:false}),this.dde.addHandler({move:function(){this.autocenter=false;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));g.setStyle(this.element,{top:"",left:""})}},this);var c=Array.from(this.buttons).map(function(a){return Object.complete({click:(a.click||
this.close).bind(this)},a)},this),b=Object.slice(this,["buttonOk","buttonCancel"]),e;for(e in b){var f=b[e];c.push({name:e=="buttonOk"?"ok":"cancel",caption:f.caption||f.title||f,click:(f.click||this.close).bind(this)})}if(c.length)this.buttonPanel=new i({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:c});if(!this.titleButton||this.titleButton.close!==false)q(a).add("Basis-Window-Title-ButtonPlace-Close"),g.insert(a,g.createElement("SPAN.Basis-Window-Title-ButtonPlace",
g.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',g.createElement("SPAN","Close"))),g.INSERT_BEGIN);if(this.autocenter!==false)this.autocenter=this.autocenter_=true;this.thread&&this.thread.addHandler({finish:function(){this.closed&&g.remove(this.element)}},this);x.add(this)},setTitle:function(a){g.insert(g.clear(this.tmpl.title),a)},realign:function(){if(this.autocenter)this.element.style.margin="",this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",
marginLeft:-this.element.offsetWidth/2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})},activate:function(){this.select()},open:function(a){this.closed?(g.visibility(this.element,false),g.show(this.element),e.appendChild(this),this.closed=false,this.realign(),this.thread&&this.thread.start(true),this.event_beforeShow(a),g.visibility(this.element,true),this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select(),this.event_open(a),this.event_active(a)):this.realign()},
close:function(a){if(!this.closed)this.thread?this.thread.start(1):g.remove(this.element),e.removeChild(this),this.autocenter=this.autocenter_,this.closed=true,this.event_close(a)},destroy:function(){this.dde&&(this.dde.destroy(),delete this.dde);s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;x.remove(this)}}),w=new r,e=new p({id:"Basis-WindowStack",childClass:l});e.addHandler({childNodesModified:function(){q(this.element).bool("IsNotEmpty",this.firstChild);var a=-1;if(this.lastChild){for(var c=
0,b;b=this.childNodes[c];c++)b.element.style.zIndex=2001+c*2,b.modal&&(a=c);this.lastChild.select()}a!=-1?w.capture(this.element,2E3+a*2):w.release()}});e.selection.addHandler({datasetChanged:function(){var a=this.pick(),c=e.lastChild;a?a.parentNode==e&&a!=c&&(e.insertBefore(a),e.event_childNodesModified({})):c&&this.add([c])}});n.onLoad(function(){g.insert(document.body,e.element,g.INSERT_BEGIN);for(var a=e.firstChild;a;a=a.nextSibling)a.realign()});d.namespace("basis.ui.window").extend({Window:l,
Blocker:r,getWindowTopZIndex:function(){return e.childNodes.length*2+2001}})})(basis);
(function(d){function l(e){e.selection&&!e.selection.itemCount&&(e=e.childNodes.search(false,"disabled"))&&e.select()}var g=d.Class,n=d.dom,m=Function.getter,q=d.cssom.classList,x=d.EventObject.createEvent,u=d.EventObject.event,v=d.ui.Node,y=d.ui.Container,s=d.ui.Control,x=g(s,{canHaveChildren:true,childClass:v,event_childEnabled:x("childEnabled","document","node")&&function(e,a){this.selection&&!this.selection.itemCount&&child.select();u.childEnabled.call(this,e,a)},event_childDisabled:x("childDisabled",
"document","node")&&function(e,a){l(this);u.childDisabled.call(this,e,a)},event_childNodesModified:function(e,a){l(this);s.prototype.event_childNodesModified.call(this,e,a)},item:function(e){e=isNaN(e)?this.indexOf(e):parseInt(e);return e.between(0,this.childNodes.length-1)?this.childNodes[e]:null},indexOf:function(e){return e instanceof this.childClass?this.childNodes.indexOf(e):this.childNodes.search(e,"name")?Array.lastSearchIndex:-1}}),p=g(y,{canHaveChildren:false,event_disable:function(){y.prototype.event_disable.call(this);
this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){y.prototype.event_enable.call(this);this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var e=this.tmpl.titleText,
a=this.titleGetter(this);e.nodeValue=a==null||String(a)==""?"[no title]":a},action:{select:function(){this.isDisabled()||this.select()}},titleGetter:m("data.title"),groupId:0}),i=g(x,{childClass:p,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'}),m=g(y,{event_select:function(){q(this.element).remove("Basis-Page-Hidden");
y.prototype.event_select.call(this)},event_unselect:function(){q(this.element).add("Basis-Page-Hidden");y.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'}),r=g(x,{childClass:m,template:'<div class="Basis-PageControl"/>'}),v=g(p,{canHaveChildren:true,childClass:v,event_select:function(){p.prototype.event_select.call(this);q(this.tmpl.pageElement).remove("Basis-Page-Hidden")},
event_unselect:function(){p.prototype.event_unselect.call(this);q(this.tmpl.pageElement).add("Basis-Page-Hidden")},template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',
destroy:function(){n.remove(this.tmpl.pageElement);p.prototype.destroy.call(this)}}),w=g(i,{childClass:v,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'}),g=g(i,{childClass:v,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',
insertBefore:function(e,a){if(e=i.prototype.insertBefore.call(this,e,a))return this.tmpl.pagesElement&&this.tmpl.pagesElement.insertBefore(e.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null),e},removeChild:function(e){if(e=i.prototype.removeChild.call(this,e))return this.tmpl.pagesElement&&e.element.appendChild(e.tmpl.pageElement),e},clear:function(e){this.childNodes.forEach(function(a){a.element.appendChild(a.tmpl.pageElement)});i.prototype.clear.call(this,e)}});d.namespace("basis.ui.tabs").extend({AbstractTabsControl:x,
TabControl:i,Tab:p,PageControl:r,Page:m,AccordionControl:w,TabSheetControl:g,TabSheet:v})})(basis);
(function(d){function l(a){return{hour:a.getHours(),day:a.getDate()-1,month:a.getMonth(),year:a.getFullYear()}}function g(a,b){var e={},d=c[a];if(d){var i=b.getFullYear(),g=b.getMonth(),k=b.getDate();i-=i%d[1];g=d[2]?g-g%d[2]:0;k=d[3]?k:1;e.periodStart=new Date(i,g,k);e.periodEnd=new Date(new Date(i+d[4],g+d[5],k+d[6])-1)}else e.periodStart=new Date(e.periodEnd=new Date(b));return e}var n=d.Class,m=d.dom,q=d.dom.event,x=Function.getter,u=d.cssom.classList,v=d.EventObject.createEvent,y=d.html.Template,
s=d.data.property.Property,p=d.ui.Node,i=d.ui.Container,r=d.ui.Control,w=function(a){var b=d.locale["ui.calendar"];return b?b[a]:a},e={};(function(){for(var a=32,b=2147483647;--a;)e[a]=b,b>>=1})();var a={century:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},decade:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},year:function(a){return a.periodStart.getFullYear()},quarter:function(a){return w("QUARTER").toLowerCase().format(1+a.periodStart.getMonth().base(3)/
3)},month:function(a){return w("MONTH").SHORT[a.periodStart.getMonth()].toLowerCase()},day:function(a){return a.periodStart.getDate()}},c={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},b=n(p,{canHaveChildren:false,template:new y('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(a,b){a=="click"?this.document.templateAction(a,
b,this):p.prototype.templateAction.call(this,a,b)},templateUpdate:function(a,b,c){if(!b||"periodStart"in c||"periodEnd"in c)this.tmpl.title.nodeValue=this.titleGetter(this.data),this.parentNode&&(a=u(this.element),a.bool("before",this.data.periodStart<this.parentNode.data.periodStart),a.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd))},event_select:function(){p.prototype.event_select.call(this);m.focus(this.element)}}),k=n(i,{childClass:b,template:new y('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){i.prototype.event_select.call(this);u(this.tmpl.tabElement).add("selected")},event_unselect:function(){i.prototype.event_unselect.call(this);u(this.tmpl.tabElement).remove("selected")},event_update:function(b,c){i.prototype.event_update.call(this,b,c);var e=this.data,d;if("periodStart"in c||"periodEnd"in c){this.tmpl.titleText.nodeValue=this.getTitle(e.periodStart)||"-";this.firstChild||(d=[]);for(var k=g(this.nodePeriodName,(new Date(e.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(e.periodStart)||0))),l=0;l<this.nodeCount;l++)d?d.push({cssClassName:this.nodePeriodName,titleGetter:a[this.nodePeriodName],data:k}):this.childNodes[l].update(k),k=g(this.nodePeriodName,(new Date(k.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount));d&&this.setChildNodes(d);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(e.selectedDate)||"-";(d=this.getNodeByDate(e.selectedDate))?
d.select():e.selectedDate&&this.minDate<=e.selectedDate&&e.selectedDate<=this.maxDate?this.setViewDate(e.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:true,isNextPeriodEnabled:true,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(a){i.prototype.init.call(this,a);u(this.element).add("Basis-Calendar-Section-"+this.sectionName);q.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
false))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(a){if(a&&this.data.periodStart<=a&&a<=this.data.periodEnd){a:{var b=this.childNodes;if(b.length){var c,e,d=0,i=b.length,g;do if(e=b[c=d+i>>1],a<(g=e.data.periodStart))i=c-1;else if(a>(e=e.data.periodEnd))d=c+1;else{a=a>=g&&a<=e?c:-1;break a}while(d<=i)}a=-1}if(a!=-1)return this.childNodes[a]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(g(this.periodName,new Date(+this.data.periodStart-1)))},
nextPeriod:function(){this.isNextPeriodEnabled&&this.update(g(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(a){this.update(g(this.periodName,a))},getInitOffset:Function.$null});k.Month=n(k,{sectionName:"Month",periodName:"month",template:new y(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+
w("DAY").SHORT2.map(String.format,'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:x("getDate()"),getTitle:function(a){return w("MONTH").FULL[a.getMonth()]+" "+a.getFullYear()},getInitOffset:function(a){return 1+((new Date(a)).set("day",1).getDay()+5)%7}});k.Year=n(k,{sectionName:"Year",periodName:"year",
nodePeriodName:"month",nodePeriodUnit:"month",getTabTitle:x("getMonth()",function(a){return w("MONTH").FULL[a]}),getTitle:x("getFullYear()")});k.YearDecade=n(k,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:x("getFullYear()"),getTitle:function(a){return a.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});k.Century=n(k,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",
nodePeriodUnitCount:10,getTabTitle:function(a){if(a)return a=a.getFullYear(),a-=a%10,a+"-"+(Number(a.toString().substr(-2))+9).lead(2)},getInitOffset:function(){return 1}});k.YearQuarters=n(k,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});k.Quarter=n(k,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(a){return[Math.floor(1+a.getMonth().base(3)/3),
w("QUARTER").toLowerCase(),a.getFullYear()].join(" ")}});n=n(r,{childClass:k,childFactory:Function(),template:new y(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
w("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:v("change"),event_childNodesModified:function(a,b){if(b.inserted)for(var c=0,e;e=b.inserted[c++];)e.setViewDate(this.date.value),e.update({selectedDate:this.selectedDate.value});r.prototype.event_childNodesModified.call(this,a,b);m.insert(m.clear(this.tmpl.sectionTabs),this.childNodes.map(x("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&this.firstChild.select()},
templateAction:function(a,c,e){r.prototype.templateAction.call(this,a,c);if(e instanceof b)a=e.data.periodStart,c=this.selection.pick(),this.selectedDate.set((new Date(this.selectedDate.value)).add(c.nodePeriodUnit,this.selectedDate.value.diff(c.nodePeriodUnit,a))),this.nextSection(false);else if(!u(q.sender(c)).contains("disabled"))switch(a){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(true)}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:true,sections:["Month","Year","YearDecade"],init:function(a){this.todayDate=new s(new Date);this.selectedDate=new s(new Date(this.date||new Date));this.date=new s(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(a,b){this.constructor.prototype.event_datasetChanged.call(this,
a,b);var c=this.pick();c&&c.update({selectedDate:this.selectedDate.value})}};r.prototype.init.call(this,a);this.selectedDate.addHandler({change:function(a){for(var b=this.firstChild;b;b=b.nextSibling)b.update({selectedDate:a})}},this);this.todayDate.addLink(this.tmpl.todayText,null,x("toFormat('%D.%M.%Y')"));this.sections&&m.insert(this,this.sections.map(function(a){return new k[a]},this))},setSection:function(a){(a=this.childNodes.search("sectionName",a))&&a.select()},nextSection:function(a){var b=
this.selection.pick();(b=a?b.nextSibling:b.previousSibling)?(b.select(),b.setViewDate(this.selectedDate.value)):a||this.event_change()},selectDate:function(a){a-this.date.value!=0&&this.date.set(a)},getNextPeriod:function(a,b){if(!this.isNextPeriodEnabled(a,b))return false;if(this.map){var c=b?1:-1,d=b?"start":"till",i=b?"till":"start",k=(new Date(a)).add("millisecond",c),m=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(m){var p=g("year",k);for(p.periodEnd.getFullYear()==k.getFullYear()&&
(p[d]=k);!this.isPeriodEnabled(p.periodStart,p.periodEnd);)p=g("year",k.add("year",c));for(p[i]=g("month",p[d])[i];!this.isPeriodEnabled(p.periodStart,p.periodEnd);)p=g("month",k.add("month",c));var r=l(p[d]),i=l(p[i]);if(m=m[i.year]&&m[i.year][i.month]){this.periodEnableByDefault&&(d=e[p.periodEnd.getMonthDayCount()],m=m&d^d);for(d=r.day;d!=i.day+c;d+=c)if(m>>d&1){k=new Date(r.year,r.month,d+1);break}}else return g("day",p[d])}}return g("day",k)},isNextPeriodEnabled:function(a,b){if(!b&&this.minDate&&
this.minDate>a)return false;if(b&&this.maxDate&&this.maxDate<a)return false;if(this.map)if(this.periodEnableByDefault){if(!b&&this.minDate)return this.isPeriodEnabled(this.minDate,a);if(b&&this.maxDate)return this.isPeriodEnabled(a,this.maxDate)}else{var c=b?1:-1,e=a.getFullYear(),d=(new Date(a)).add("millisecond",c),i=d.getFullYear(),k=Object.keys(this.map.enable).filter(function(a){return c*a>=c*i}),l=k.length;if(l)for(var k=k.sort(function(a,b){return c*(a>b)||-c*(a<b)}),p=0;p<l;p++){var m=g("year",
new Date(k[p],0));if(this.isPeriodEnabled(b&&k[p]==e?d:m.periodStart,!b&&k[p]==e?d:m.periodEnd))return true}return false}return true},isPeriodEnabled:function(a,b){if(this.minDate&&this.minDate>b)return false;if(this.maxDate&&this.maxDate<a)return false;var c=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(c){var d=l(a),i=l(b),g,k,p,m=d.month,r=new Date(d.year,d.month),B=11-d.month,q=B+1+(i.year-d.year-1)*12+(i.month+1)-1;if(this.periodEnableByDefault){if(q==0)return!(g=c[d.year])||
!(k=g[d.month])||(k^2147483647)>>d.day&e[i.day-d.day+1];for(var n=0;n<=q;n++){if(!n||B==n%12)if(g=c[r.getFullYear()],!g)return true;k=g[m=r.getMonth()];if(!k)return true;p=e[r.getMonthDayCount()];if(n/q?n/q==1?(k&p^p)&e[i.day+1]:k&p^p:(k&p^p)>>d.day)return true;r.setMonth(m+1)}}else{if(q==0)return(g=c[d.year])&&(k=g[d.month])&&k>>d.day&e[i.day-d.day+1];for(n=0;n<=q;n++){if(!n||B==n%12||!g)if(g=c[r.getFullYear()],!g){n+=12;r.setMonth(m+12);continue}if((k=g[m=r.getMonth()])&&(n/q?n/q==1?k&e[i.day+1]:
k:k>>d.day))return true;r.setMonth(m+1)}}return false}return true},destroy:function(){r.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});d.namespace("basis.ui.calendar").extend({Calendar:n,CalendarSection:k})})(basis);
(function(d){function l(a,b){return new q(a.source.replace("<\!-- {fieldPlace} --\>",b))}var g=d.Class,n=d.dom.event,m=d.dom,q=d.html.Template,x=d.Cleaner,u=Object.complete,v=Function.getter,y=d.cssom.classList,s=d.data.property.Property,p=d.EventObject,i=d.dom.wrapper.Selection,r=d.ui.Control,w=d.ui.Node,e=d.ui.Container,a=p.createEvent,c=new q('<div{element|selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><\!-- {fieldPlace} --\></div></div>'),
b=g(w,{canHaveChildren:false,template:c,nextFieldOnEnter:true,serializable:true,event_select:function(){m.focus(this.tmpl.field,true);w.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");w.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");w.prototype.event_disable.call(this)},event_input:a("input"),event_change:a("change"),event_keydown:a("keydown"),event_keypress:a("keypress"),event_keyup:a("keyup")&&
function(a){if(this.nextFieldOnEnter){var b=n.key(a);b==n.KEY.ENTER||b==n.KEY.CTRL_ENTER?(n.cancelDefault(a),this.nextFieldFocus()):this.setValid()}p.event.keyup.call(this,a)},event_focus:a("focus")&&function(a){this.valid&&this.setValid();p.event.focus.call(this,a)},event_blur:a("blur")&&function(a){this.validate(true);p.event.blur.call(this,a)},init:function(a){w.prototype.init.call(this,a);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=this.title||"";if(this.tmpl.field){n.addHandler(this.tmpl.field,
"keydown",this.keydown,this);n.addHandler(this.tmpl.field,"keyup",this.keyup,this);n.addHandler(this.tmpl.field,"keypress",this.keypress,this);n.addHandler(this.tmpl.field,"blur",this.blur,this);n.addHandler(this.tmpl.field,"focus",this.focus,this);n.addHandler(this.tmpl.field,"change",this.change,this);n.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);
this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value)this.defaultValue=this.value,this.setDefaultValue()},setReadOnly:function(a){a?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},setSample:function(a){if(this.tmpl.sampleContainer&&a)this.sampleElement?
m.insert(m.clear(this.sampleElement),a):m.insert(this.tmpl.sampleContainer,this.sampleElement=m.createElement("SPAN.Basis-Field-Sample",a));else if(this.sampleElement)m.remove(this.sampleElement),this.sampleElement=null},getValue:function(){return this.tmpl.field.value},setValue:function(a){a=a||"";if(this.tmpl.field.value!=a)this.tmpl.field.value=a,this.event_change()},setMaxLength:function(a){this.maxLength=a},setMinLength:function(a){this.minLength=a},attachValidator:function(a,b){this.validators.add(a)&&
b&&this.validate()},detachValidator:function(a,b){this.validators.remove(a)&&b&&this.validate()},change:function(a){this.event_change(a)},input:function(a){this.event_input(a)},keydown:function(a){this.event_keydown(a)},keyup:function(a){this.event_keyup(a)},keypress:function(a){this.event_keypress(a)},blur:function(a){this.event_blur(a)},focus:function(a){this.event_focus(a)},select:function(){this.unselect();w.prototype.select.apply(this,arguments)},setValid:function(a,b){var c=y(this.element);
typeof a=="boolean"?(c.bool("invalid",!a),c.bool("valid",a),b?this.element.title=b:this.element.removeAttribute("title")):(c.remove("invalid"),c.remove("valid"),this.element.removeAttribute("title"));this.valid=a},validate:function(a){var b;this.setValid();for(var c=0;c<this.validators.length;c++)if(b=this.validators[c](this))return a||this.setValid(false,b.message),b;this.getValue()!=""&&this.setValid(true)},nextFieldFocus:function(){var a=m.axis(this,m.AXIS_FOLLOWING_SIBLING).search(true,"selectable");
a?a.select():this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){n.clearHandlers(this.element);this.tmpl.field&&n.clearHandlers(this.tmpl.field);this.button&&(n.clearHandlers(this.button),delete this.button);this.validators.clear();w.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});b.create=function(a,c){a={radiogroup:"RadioGroup",checkgroup:"CheckGroup"}[a.toLowerCase()]||a.capitalize();if(b[a])return new b[a](c);
else throw Error("Wrong field type `{0}`".format(a));};b.Hidden=g(b,{selectable:false,template:new q('<input{element|field} type="hidden"/>')});b.Text=g(b,{template:l(c,'<input{field} type="text"/>'),init:function(a){b.prototype.init.call(this,a);this.minLength&&this.attachValidator(z.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(a){this.tmpl.field.setAttribute("maxlength",a,0);b.prototype.setMaxLength.call(this,a)}});b.Password=
g(b.Text,{template:l(c,'<input{field} type="password"/>')});b.File=g(b,{template:l(c,'<input{field} type="file"/>')});b.Textarea=g(b,{nextFieldOnEnter:false,template:l(c,"<textarea{field}/>"),init:function(a){this.counter=m.createElement(".counter",b.LOCALE.Textarea.SYMBOLS_LEFT+": ",m.createText(0));b.prototype.init.call(this,a);this.minLength&&this.attachValidator(z.MinLength);this.maxLength&&this.attachValidator(z.MaxLength);n.addHandler(this.tmpl.field,"keyup",this.updateCounter,this);n.addHandler(this.tmpl.field,
"input",this.updateCounter,this);window.opera&&n.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=true;this.contentEditable=false})},updateCounter:function(){var a=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=a>=0?a:0},setValue:function(a){b.prototype.setValue.call(this,a);this.updateCounter()},setMaxLength:function(a){b.prototype.setMaxLength.call(this,a);a?(this.updateCounter(),m.insert(this.tmpl.sampleContainer,this.counter)):m.remove(this.counter)},
destroy:function(){delete this.counter;b.prototype.destroy.call(this)}});b.Checkbox=g(b,{value:false,template:new q('<div{element} class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox"/><span>{titleText}</span></label></div></div>'),invert:function(){this.setValue(!this.getValue())},setValue:function(a){var b=this.tmpl.field.checked;this.tmpl.field.checked=!!a;b!=this.tmpl.field.checked&&this.event_change()},getValue:function(){return this.tmpl.field.checked}});
b.Label=g(b,{cssClassName:"Basis-Field-Label",template:l(c,"<label{field}>{fieldValueText}</label>"),valueGetter:Function.$self,event_change:function(){b.prototype.event_change.apply(this,arguments);this.tmpl.fieldValueText.nodeValue=this.valueGetter(this.getValue())}});var k=g(w,{canHaveChildren:false,titleGetter:function(a){return a.title||a.getValue()},valueGetter:v("value"),getTitle:function(){return this.titleGetter(this)},getValue:function(){return this.valueGetter(this)}}),f={datasetChanged:function(){this.event_change()}},
j=g(b,e,{childClass:k,template:b.prototype.template,multipleSelect:false,init:function(a){this.selection=new i({multiple:!!this.multipleSelect});this.selection.addHandler(f,this);b.prototype.init.call(this,a);x.add(this)},getValue:function(){var a=this.selection.getItems().map(v("getValue()"));return!this.selection.multiple?a[0]:a},setValue:function(a){var b={};(this.multipleSelect?Array.from(a):[a]).forEach(function(a){b[a]=true});for(var a=[],c=this.firstChild;c;c=c.nextSibling)b[c.getValue()]&&
a.push(c);this.selection.set(a)},destroy:function(){b.prototype.destroy.call(this);x.remove(this)}});j.Item=k;e=g(k,{event_select:function(){this.tmpl.field.checked=true;k.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;k.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");w.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");w.prototype.event_disable.call(this)},
template:new q('<label{element} class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,b,c){k.prototype.templateUpdate.call(this,a,b,c);a.field.value=this.getValue();a.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){a=="select"&&!this.isDisabled()&&this.select();k.prototype.templateAction.call(this,a,b)}});b.RadioGroup=g(j,{childClass:e,template:l(c,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),
childFactory:function(a){a=j.prototype.childFactory.call(this,a);if(this.name)a.tmpl.field.name=this.name;return a}});b.RadioGroup.Item=e;e=g(k,{event_select:function(){this.tmpl.field.checked=true;k.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;k.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");w.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");
w.prototype.event_disable.call(this)},template:new q('<label{element} event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,b,c){k.prototype.templateUpdate.call(this,a,b,c);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){a=="click"&&!this.isDisabled()&&(this.select(this.parentNode.multipleSelect),n.sender(b).tagName!="INPUT"&&n.kill(b));k.prototype.templateAction.call(this,
a,b)}});b.CheckGroup=g(j,{childClass:e,multipleSelect:true,template:l(c,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});b.CheckGroup.Item=e;e=g(k,{event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:new q("<option{element|field}>{titleText}</option>"),templateUpdate:function(a,b,c){k.prototype.templateUpdate.call(this,a,b,c);a.field.value=this.getValue();a.field.text=
this.getTitle()}});b.Select=g(j,{childClass:e,template:l(c,"<select{field|childNodesElement}/>"),event_keyup:function(a,b){this.change();j.prototype.event_keyup.call(this,a,b)},setValue:function(a){(a=this.childNodes.search(a,"getValue()"))?this.selection.set([a]):this.selection.clear()}});b.Select.Item=e;var t={show:function(){y(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){y(this.tmpl.field).remove("Basis-DropdownList-Opened")}},e=g(k,{template:new q('<div{element} class="Basis-Combobox-Item" event-click="click">{titleText}</div>'),
templateUpdate:function(a,b,c){k.prototype.templateUpdate.call(this,a,b,c);a.titleText.nodeValue=this.getTitle()},templateAction:function(a,b){a=="click"&&!this.isDisabled()&&(this.select(),this.parentNode&&this.parentNode.hide(),n.kill(b));k.prototype.templateAction.call(this,a,b)}}),h={keyup:function(a){var b=n.key(a),c=this.selection.pick();switch(b){case n.KEY.DOWN:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=m.axis(c?c:this.firstChild,m.AXIS_FOLLOWING_SIBLING).search(false,
"disabled");break;case n.KEY.UP:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=c?m.axis(c,m.AXIS_PRESCENDING_SIBLING).search(false,"disabled"):this.firstChild}c&&(c.select(),m.focus(this.tmpl.field))},keydown:function(a){var b=n.key(a);b==n.KEY.DOWN||b==n.KEY.UP?n.kill(a):b==n.KEY.ENTER&&(this.popup.visible&&this.hide(),n.kill(a))}};b.Combobox=g(j,{childClass:e,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();j.prototype.event_enable.call(this)},
event_change:function(){j.prototype.event_change.call(this);var a=this.getValue();this.property&&this.property.set(a);if(this.hidden)this.hidden.value=a;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:l(c,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><\!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent"/>'),
templateAction:function(a,b){a=="click"&&(this.isDisabled()||this.popup.visible?this.hide():this.show({}),n.kill(b));j.prototype.templateAction.call(this,a,b)},init:function(a){if(!d.ui.popup)throw Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:Function.getter("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&
this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};j.prototype.init.call(this,a);this.satellite.captionItem.setDelegate(this.selection.pick());n.addHandlers(this.tmpl.field,h,this);if(this.name)m.insert(this.tmpl.field,this.hidden=m.createElement("INPUT[type=hidden][name={0}]".format(String(this.name).quote())));this.popup=new d.ui.popup.Popup(u({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,
handler:t,handlerContext:this},this.popup));this.property&&this.property.addLink(this,this.setValue)},show:function(){this.popup.show(this.tmpl.field);this.select()},hide:function(){this.popup.hide()},getTitle:function(){var a=this.selection.pick();return a&&a.getTitle()},getValue:function(){var a=this.selection.pick();return a&&a.getValue()},setValue:function(a){this.getValue()!=a&&((a=this.childNodes.search(a,"getValue()"))&&!a.isDisabled()?this.selection.set([a]):this.selection.clear())},destroy:function(){if(this.property)this.property.removeLink(this),
this.property=null;this.popup.destroy();this.popup=null;j.prototype.destroy.call(this)}});b.Combobox.Item=e;var o=g(null,{init:function(a,b){this.field=a;this.message=b}}),z={NO_LOCALE:"There is no locale for this error",RegExp:function(a){a.constructor!=RegExp&&(a=RegExp(a));return function(b){var c=b.getValue();if(c!=""&&!c.match(a))return new o(b,z.LOCALE.RegExp.WRONG_FORMAT||z.NO_LOCALE)}},Required:function(a){var b=a.getValue();if(Function.$isNull(b)||b=="")return new o(a,z.LOCALE.Required.MUST_BE_FILLED||
z.NO_LOCALE)},Number:function(a){var b=a.getValue();if(isNaN(b))return new o(a,z.LOCALE.Number.WRONG_FORMAT||z.NO_LOCALE)},Currency:function(a){var b=a.getValue();if(isNaN(b))return new o(a,z.LOCALE.Currency.WRONG_FORMAT||z.NO_LOCALE);if(b<=0)return new o(a,z.LOCALE.Currency.MUST_BE_GREATER_ZERO||z.NO_LOCALE)},Email:function(a){var b=a.getValue().trim();if(b!=""&&!b.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new o(a,z.LOCALE.Email.WRONG_FORMAT||z.NO_LOCALE)},
Url:function(a){var b=a.getValue().trim();if(b!=""&&!b.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new o(a,z.LOCALE.Url.WRONG_FORMAT||z.NO_LOCALE)},MinLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?b.length:String(b).length)<a.minLength)return new o(a,(z.LOCALE.MinLength.MUST_BE_LONGER_THAN||z.NO_LOCALE).format(a.minLength))},MaxLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?
b.length:String(b).length)>a.maxLength)return new o(a,(z.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||z.NO_LOCALE).format(a.maxLength))}},a=g(r,{canHaveChildren:true,childClass:b,childFactory:function(a){return b.create(a.type||"text",a)},onSubmit:Function.$false,event_reset:a("reset"),event_disable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_disable();r.prototype.event_disable.call(this)},event_enable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_enable();
r.prototype.event_enable.call(this)},template:new q('<div{element} class="Basis-FormContent"/>'),getFieldByName:function(a){return this.childNodes.search(a,"name")},getFieldById:function(a){return this.childNodes.search(a,"id")},serialize:function(){for(var a={},b=this.firstChild;b;b=b.nextSibling)b.serializable&&b.name&&(a[b.name]=b.getValue());return a},setData:function(a,b){this.loadData(a,b)},loadData:function(a,b){for(var c=Object.keys(a),e=this.firstChild;e;e=e.nextSibling)c.indexOf(e.name)!=
-1?e.setValue(a[e.name]):e.setDefaultValue(),e.setValid();b||this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.setDefaultValue();this.event_reset()},validate:function(){for(var a,b=[],c=this.firstChild;c;c=c.nextSibling)(a=c.validate())&&b.push(a);return b.length?(b[0].field.select(),b):true},submit:function(){if(this.validate()===true&&this.onSubmit)this.onSubmit(this.serialize())}}),e=g(a,{template:new q('<form{element|formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent"/></form>'),
method:"POST",init:function(a){this.selection=false;r.prototype.init.call(this,a);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=this.action;if(this.enctype)this.formElement.enctype=this.enctype;n.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(a){this.formElement.method=a?a.toUpperCase():"POST"},submit:function(){if(this.validate()===true&&!this.onSubmit())if(this.tagName==
"FORM")return false;else this.formElement.submit();return true}}),A=g(s,{matchFunction:function(a,b){if(!b){var c=a._m||this.textNodeGetter(a);c.constructor!=Array&&(c=[c]);for(var e=false,f=0;f<c.length;f++){var d=c[f];if(d){var i=false,h=d.nodeValue.split(this.rx);if(h.length>1){if(!a._x)a._x=[];if(!a._m)a._m=[];m.replace(a._x[f]||d,a._x[f]=m.createElement("SPAN.matched",m.wrap(h,this.map)));a._m[f]=d;i=e=true}a._x&&a._x[f]&&!i&&(m.replace(a._x[f],a._m[f]),a._x[f]=a._m[f])}}return e}if(a._x){for(f=
0;f<a._x.length;f++)a._x[f]&&m.replace(a._x[f],a._m[f]);delete a._x;delete a._m}return false},event_change:function(a){this.rx=this.regexpGetter(a);s.prototype.event_change.call(this,a)},extendConstructor_:true,init:function(){var a=this.startPoints||"";this.textNodeGetter=v(this.textNodeGetter||"tmpl.titleText");if(typeof this.regexpGetter!="function")this.regexpGetter=function(b){return RegExp("("+a+")("+b.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||"SPAN.match"]=function(a,b){return b%
3==2};s.prototype.init.call(this,"",this.handlers,String.trim)}}),C={childNodesModified:function(a,b){if(b.inserted)for(var c=0,e;e=b.inserted[c];c++)this.matchFunction(e,this.value=="")}},E=g(A,{event_change:function(a){A.prototype.event_change.call(this,a);this.match()},init:function(a){A.prototype.init.call(this,a);this.node.addHandler(C,this)},match:function(){for(var a=this.node.firstChild;a;a=a.nextSibling)this.matchFunction(a,this.value=="")}}),F=g(A,{event_change:function(a){A.prototype.event_change.call(this,
a);this.node.setMatchFunction(a?this.matchFunction.bind(this):null)}}),g=g(b.Text,{cssClassName:"Basis-MatchInput",matchFilterClass:F,event_keyup:function(a){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_keyup.call(this,a)},event_change:function(a){this.matchFilter.set(this.tmpl.field.value);b.Text.prototype.event_change.call(this,a)},init:function(a){b.Text.prototype.init.call(this,a);this.matchFilter=new this.matchFilterClass(this.matchFilter)}});d.namespace("basis.ui.form").extend({createFieldTemplate:function(a){return l(c,
a)},FormContent:a,Form:e,Field:b,Validator:z,ValidatorError:o,RadioGroup:b.RadioGroup,CheckGroup:b.CheckGroup,Combobox:b.Combobox,ComplexField:j,Matcher:E,MatchFilter:F,MatchInput:g})})(basis);
(function(){function d(e,a){if(window[e])return window[e];for(var e=e.charAt(0).toUpperCase()+e.substr(1),c=0,b;b=y[c++];)if(window[b+e])return window[b+e];return a}var l=basis.Class,g=basis.dom,n=basis.EventObject,m=basis.dom.event,q=basis.cssom.classList,x=false,u=false,v;(function(){function e(a,b){for(var e;e=b.shift();)if(typeof a.style[e]!="undefined")return e;return false}var a=g.createElement("");(v=e(a,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))&&(x=true);
if(x&&(e(a,["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style))u=true})();var y=["webkit","moz","o","ms"],s=d("requestAnimationFrame",function(e){return window.setTimeout(e,15)}),p=d("cancelRequestAnimFrame",clearInterval),i=l(n,{minScrollDelta:0,preventScrollX:false,preventScrollY:false,scrollPropertyType:"style",event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),
event_startInertia:n.createEvent("startInertia","scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(e){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=
this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;n.prototype.init.call(this,e);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.scrollPropertyType=="scroll"?(g.setStyle(this.targetElement,{overflow:"hidden"}),this.updateElementPosition=this.updatePosition_scrollTopLeft,this.calcDimentions=
this.calcDimentions_scrollTopLeft):(g.setStyle(this.targetElement,{position:"relative"}),this.updateElementPosition=x?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft,this.calcDimentions=this.calcDimentions_styleTopLeft);if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var e=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",a=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px",c={};c[v]="translate("+e+", "+a+")"+(u?" translateZ(0)":"");g.setStyle(this.targetElement,c)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;
this.scrollX=!this.preventScrollX&&this.maxPositionX>0;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&this.maxPositionY>0},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var e=this.targetElement.offsetParent;if(e)this.maxPositionX=this.targetElement.scrollWidth-e.offsetWidth,this.scrollX=!this.preventScrollX&&this.maxPositionX>0,this.maxPositionY=this.targetElement.scrollHeight-
e.offsetHeight,this.scrollY=!this.preventScrollY&&this.maxPositionY>0},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating)this.targetElement.offsetWidth&&
this.calcDimentions(),this.startViewportX=this.viewportX,this.startViewportY=this.viewportY,this.isUpdating=true,this.updateFrameHandle=this.nextFrame(),this.startTime=this.lastUpdateTime=Date.now(),this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=false,p(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(e){this.stopUpdate();this.panningActive=true;this.lastMouseX=m.mouseX(e);this.lastMouseY=m.mouseY(e);
this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,this);m.addHandler(document,"touchend",this.onMouseUp,this);m.cancelDefault(e)},onMouseMove:function(e){(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var a=Date.now(),c=a-this.lastMotionUpdateTime;this.lastMotionUpdateTime=a;if(c){if(this.minScrollDeltaXReached||
!this.minScrollDeltaYReached)a=m.mouseX(e),c=this.lastMouseX-a,this.lastMouseX=a,this.viewportTargetX+=c;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)e=m.mouseY(e),a=this.lastMouseY-e,this.lastMouseY=e,this.viewportTargetY+=a;if(this.minScrollDelta>0&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=
true;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var e=Date.now()-this.lastMotionUpdateTime,e=Math.max(10,e);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,e/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,e/100)));m.removeHandler(document,
"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(e){e||(e=Date.now());var a=e-this.lastUpdateTime;this.lastUpdateTime=e;if(a){if(this.panningActive){var c;if(this.scrollX&&(c=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,c))this.currentVelocityX=Math.abs(c)/
a,this.currentDirectionX=c==0?0:c<0?-1:1;if(this.scrollY&&(c=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,c))this.currentVelocityY=Math.abs(c)/a,this.currentDirectionY=c==0?0:c<0?-1:1}else if(this.processInertia){if(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*a,this.currentVelocityX*=0.94,this.currentVelocityX<0.0010||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX))this.viewportTargetX=Math.min(this.maxPositionX,
Math.max(this.minPositionX,this.viewportTargetX)),this.currentVelocityX=0;if(this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*a,this.currentVelocityY*=0.94,this.currentVelocityY<0.0010||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY))this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY)),this.currentVelocityY=0;if(this.currentVelocityX==0&&this.currentVelocityY==0)this.processInertia=false}a=c=0;this.scrollX&&
(c=this.viewportTargetX-this.viewportX,this.viewportX+=c*(this.panningActive||this.currentVelocityX>0?1:0.12));this.scrollY&&(a=this.viewportTargetY-this.viewportY,this.viewportY+=a*(this.panningActive||this.currentVelocityY>0?1:0.12));c=!this.scrollX||this.currentVelocityX<0.0010&&Math.abs(c)<0.1;a=!this.scrollY||this.currentVelocityY<0.0010&&Math.abs(a)<0.1;if(!this.panningActive&&c&&a){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();
this.event_updatePosition(this,e,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPosition:function(e,a){this.viewportX=e;this.viewportY=a;this.isUpdating?this.stopUpdate():(this.resetVariables(),this.updateElementPosition())},setTargetPosition:function(e,a){this.viewportTargetX=e||0;this.viewportTargetY=a||0;this.startUpdate();this.processInertia=true},calcExpectedPosition:function(e){var a=
0,c=e=="x"?this.currentVelocityX:this.currentVelocityY,b=e=="x"?this.currentDirectionX:this.currentDirectionY,d=e=="x"?this.viewportTargetX:this.viewportTargetY,f=e=="x"?this.minPositionX:this.minPositionY,e=e=="x"?this.maxPositionX:this.maxPositionY;if(c)for(var i=Math.log(0.0010/c)/Math.log(0.94),g=0;g<i;g++)a+=b*c*15,c*=0.94;return Math.max(f,Math.min(e,d+a))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),
r=l(n,{minScrollDelta:0,scrollX:true,scrollY:true,event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),event_startInertia:n.createEvent("startInertia","scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(e){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=
this.viewportY=this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;n.prototype.init.call(this,e);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=x?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;
if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var e=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",a=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px";this.targetElement.style[v]="translate("+e+", "+a+")"+(u?" translateZ(0)":
"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating)this.isUpdating=true,this.updateFrameHandle=this.nextFrame(),this.lastUpdateTime=Date.now(),
this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=false,p(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(e){this.stopUpdate();this.panningActive=true;this.lastMouseX=m.mouseX(e);this.lastMouseY=m.mouseY(e);this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,
this);m.addHandler(document,"touchend",this.onMouseUp,this);m.cancelDefault(e)},onMouseMove:function(e){(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var a=Date.now(),c=a-this.lastMotionUpdateTime;this.lastMotionUpdateTime=a;if(c){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached)a=m.mouseX(e),c=this.lastMouseX-a,this.lastMouseX=a,this.viewportTargetX+=c;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)e=m.mouseY(e),a=
this.lastMouseY-e,this.lastMouseY=e,this.viewportTargetY+=a;if(this.minScrollDelta>0&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,
this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var e=Date.now()-this.lastMotionUpdateTime,e=Math.max(10,e);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,e/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,e/100)));m.removeHandler(document,"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);
m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(e){e||(e=Date.now());var a=e-this.lastUpdateTime;this.lastUpdateTime=e;if(a){if(this.panningActive){var c;if(this.scrollX&&(c=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,c))this.currentVelocityX=Math.abs(c)/a,this.currentDirectionX=c==0?0:c<0?-1:1;if(this.scrollY&&(c=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,
c))this.currentVelocityY=Math.abs(c)/a,this.currentDirectionY=c==0?0:c<0?-1:1}else this.processInertia&&(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*a,this.currentVelocityX*=0.94),this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*a,this.currentVelocityY*=0.94));a=c=0;this.scrollX&&(c=this.viewportTargetX-this.viewportX,this.viewportX+=c*(this.panningActive||this.currentVelocityX>0?1:0.12));this.scrollY&&(a=this.viewportTargetY-
this.viewportY,this.viewportY+=a*(this.panningActive||this.currentVelocityY>0?1:0.12));c=!this.scrollX||Math.abs(c)<0.5;a=!this.scrollY||Math.abs(a)<0.5;if(!this.panningActive&&c&&a){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,e,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,
this.targetElement)},setPositionX:function(e,a){a?(this.viewportTargetX=e||0,this.currentVelocityX=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetX=this.viewportX=e,this.updateElementPosition())},setPositionY:function(e,a){a?(this.viewportTargetY=e||0,this.currentVelocityY=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetY=this.viewportY=e,this.updateElementPosition())},calcExpectedPosition:function(e){var a=0,c=e=="x"?this.currentVelocityX:this.currentVelocityY,b=e=="x"?this.currentDirectionX:
this.currentDirectionY,e=e=="x"?this.viewportTargetX:this.viewportTargetY;if(c)for(var d=Math.log(0.0010/c)/Math.log(0.94),f=0;f<d;f++)a+=b*c*15,c*=0.94;return e+a},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),w=l(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',init:function(e){basis.ui.Node.prototype.init.call(this,
e);this.startProperty=this.type=="horizontal"?"left":"top";this.endProperty=this.type=="horizontal"?"right":"bottom";q(this.element).add(this.type)},recalcSize:function(e){g.display(this.element,e<1);var a=this.type=="horizontal"?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=a-a*e},updatePosition:function(e){var a=this.trackSize*e,e=this.trackSize-this.trackSize*e;a<0&&(a=0);e<0&&(e=0);var c={};c[this.startProperty]=a+"px";c[this.endProperty]=e+"px";g.setStyle(this.tmpl.trackElement,
c)}}),l=l(basis.ui.Container,{useScrollbars:true,scrollX:true,scrollY:true,wheelDelta:40,event_realign:n.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(e){e=m.wheelDelta(e);this.scrollX?this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*e,true):this.scrollY&&this.scroller.setPositionY(this.scroller.viewportTargetY-
this.wheelDelta*e,true)}},init:function(e){basis.ui.Node.prototype.init.call(this,e);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;e=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new r(e);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=
new w({type:"horizontal",container:this.element});if(this.scrollY)this.vScrollbar=new w({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){q(this.element).add("scrollProcess")},finish:function(){q(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var e=this.scroller;e.panningActive||this.fixPosition();this.useScrollbars&&(this.scrollX&&this.hScrollbar.updatePosition(e.viewportX/this.maxPositionX),this.scrollY&&this.vScrollbar.updatePosition(e.viewportY/
this.maxPositionY))},fixPosition:function(){var e=this.scroller;if(this.scrollX&&(e.viewportX<this.minPositionX||e.viewportX>this.maxPositionX)){var a=Math.min(this.maxPositionX,Math.max(this.minPositionX,e.viewportX));e.setPositionX(a,true)}if(this.scrollY&&(e.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))a=Math.min(this.maxPositionY,Math.max(this.minPositionY,e.viewportY)),e.setPositionY(a,true)},realign:function(){this.calcDimentions();this.scrollUpdatePosition();this.event_realign()},
calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var e=this.element.offsetWidth,a=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,a-e)}if(this.scrollY){var c=this.element.offsetHeight,b=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,b-c)}this.useScrollbars&&(this.scrollX&&this.hScrollbar.recalcSize(e/a),this.scrollY&&this.vScrollbar.recalcSize(c/b))}},destroy:function(){this.scroller.destroy();basis.ui.Node.prototype.destroy.call(this)}});
basis.namespace("basis.ui.scroller").extend({Scroller:i,Scroller2:r,ScrollPanel:l})})(basis);
(function(d){var l=d.Class,g=d.dom,n=d.dom.event,m=d.cssom,q=d.dom.wrapper,x=d.ui.Container,u=d.animation.Modificator,v=l(d.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(d){d.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),y=l(x,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:v}}}),s=true,p=l(x,{behaviour:{click:function(d,g){g&&g.delegate.parentNode.scrollToNode(g.delegate)}},init:function(d){this.inherit(d);this.document=this;s&&n.addHandler(this.element,"mousewheel",function(d){try{this.owner.content.dispatchEvent(d)}catch(i){s=false,n.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}}),l=l(q.Control,{childClass:y,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:true,init:function(i){this.inherit(Object.complete({childNodes:null},i));var l=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new l({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;m.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new q.ChildNodesDataset(this);
this.header=new p({container:this.element,childClass:l,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new p({container:this.element,childClass:l,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});g.hide(this.header.element);g.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new d.Animation.Thread({duration:400,interval:15});var w=this;this.modificator=new u(this.thread,function(e){w.content.scrollTop=parseInt(e);
w.recalc()},0,0,true);this.modificator.timeFunction=function(e){return Math.sin(Math.acos(1-e))};n.addHandler(this.content,"scroll",this.recalc,this);n.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",true);i.childNodes&&this.setChildNodes(i.childNodes);this.timer_=setInterval(function(){w.recalc()},500)},scrollToNode:function(d){if(d&&d.parentNode===this)if(d=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[g.index(d)]),this.thread){var l=
this.content.scrollTop;this.modificator.setRange(l,l);this.thread.stop();this.modificator.setRange(l,d);this.thread.start()}else this.content.scrollTop=d},recalc:function(){var d=this.content,l=d.clientHeight,p=d.scrollHeight,d=d.scrollTop,e=l==p;if(this.clientHeight_!=l||this.scrollHeight_!=p){this.clientHeight_=l;this.scrollHeight_=p;var p=[],a=[];if(!e)for(var c=this.meterElement.offsetHeight,b=0,l=c*this.childNodes.length-l,k,f=0;k=this.childNodes[f];f++)k=k.element.offsetTop,p.push(k?k-b:p[f-
1]||0),a.push(k?k+l:a[f-1]||l),b+=c,l-=c;this.topPoints=p;this.bottomPoints=a;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=e)this.isFit=e,g.display(this.header.element,!e),g.display(this.footer.element,!e);if(!e&&this.scrollTop_!=d)if(this.scrollTop_=d,e)this.lastTopPoint=0,this.lastBottomPoint=this.childNodes.length;else{var j=this.topPoints.binarySearchPos(d),m=this.bottomPoints.binarySearchPos(d);if(this.lastTopPoint!=j)this.lastTopPoint=j,this.header.childNodes.forEach(function(a,
b){a.element.style.display=b>=j?"none":""});if(this.lastBottomPoint!=m)this.lastBottomPoint=m,this.footer.childNodes.forEach(function(a,b){a.element.style.display=b<m?"none":""})}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();n.removeHandler(this.content,"scroll",this.recalc,this);n.removeHandler(window,"resize",this.recalc,this);this.inherit()}});d.namespace("basis.ui.toc").extend({Control:l,
ControlItem:y,ControlItemHeader:v,ControlHeaderList:p})})(basis);
(function(d){var l=d.dom,g=d.dom.event,n=d.EventObject.createEvent,m=d.cssom.classList,q=d.dragdrop.DragDropElement,x=d.layout.Box,u=d.ui.Node,v=d.ui.Container,y=u.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(d){u.prototype.init.call(this,d);l.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&m(this.element).add("last");this.isRange&&m(this.element).add("range")}}),s=v.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:y,captionGetter:Function.$self,count:0,marks:null,init:function(d){v.prototype.init.call(this,d);this.apply()},apply:function(){var d=this.marks||[];if(this.count>0){var g=this;d.push.apply(d,Array.create(this.count,function(e){var a=this.closest((e+1)/g.count);return{pos:(a-this.min)/this.range_,caption:g.captionFormat(a),isLast:g.count==
e+1}},this.owner_))}var l=0,d=d.filter(Function.$isNotNull).sortAsObject("pos").map(function(e){var a=e.pos;e.width=e.pos-l;e.pos=l;l=a;return e},this);l!=1&&d.push({pos:l,width:1-l,isLast:true});this.setChildNodes(d)}}),p={move:function(){var d=this.tmpl.scrollbar;this.setValue_((g.mouseX(event)-(new x(d)).left)/d.offsetWidth*this.count_)}},n=u.subclass({event_change:n("change"),captionFormat:function(d){return Math.round(Number(d))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(d){var l=this.tmpl.scrollbar;this.setValue_((g.mouseX(d)-(new x(l)).left)/l.offsetWidth*this.count_)},focus:function(){l.focus(this.element)},step:function(d){var p=g.wheelDelta(d);if(p)l.focus(this.element),p<0?this.stepDown():this.stepUp();else switch(g.key(d)){case g.KEY.DOWN:case g.KEY.LEFT:case 189:case 109:this.stepDown();break;case g.KEY.UP:case g.KEY.RIGHT:case 187:case 107:this.stepUp();break;case g.KEY.PAGEDOWN:this.stepDown(10);break;case g.KEY.PAGEUP:this.stepUp(10);
break;case g.KEY.HOME:this.setValue(this.min);break;case g.KEY.END:this.setValue(this.max)}}},satelliteConfig:{marks:{instanceOf:v.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:s})}},marks:"auto",init:function(d){var g=this.step,l=this.value;this.step=0;this.value=this.min;this.value_=0;u.prototype.init.call(this,d);this.setProperties(this.min,this.max,g);this.setValue(isNaN(l)?this.min:l);this.scrollbarDD=new q({element:this.tmpl.scrollTrumb,handler:p,handlerContext:this})},
setProperties:function(d,g,l){if(d>g)var e=d,d=g,g=e;l=l||1;d=d||0;if(this.min!=d||this.max!=g||this.step!=l)this.count_=Math.ceil((g-d)/l),this.step=l,this.min=d,this.max=this.min+this.count_*this.step,this.range_=this.max-this.min,this.tmpl.minValue.nodeValue=this.captionFormat(this.min),this.tmpl.maxValue.nodeValue=this.captionFormat(this.max),m(this.element).bool("NoMax",this.max==this.min),this.marks&&this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(a){typeof a!=
"object"&&(a={count:a});a=Object.extend({captionFormat:this.captionFormat,owner_:this},a);if(a.count=="auto")a.count=Math.min(this.count_,20);return a},this)),this.setValue(this.value||this.min)},closest:function(d){return this.normalize(this.min+this.range_*d.fit(0,1)+this.step/2)},normalize:function(d){if(d<this.min)d=this.min;else if(d>this.max)d=this.max;return this.min+Math.floor(1.0E-5+(d-this.min)/this.step)*this.step},stepUp:function(d){this.setValue_(this.value_+parseInt(d||1))},stepDown:function(d){this.setValue_(this.value_-
parseInt(d||1))},setValue_:function(d){d=Math.round(d).fit(0,this.count_);if(this.value_!=d){this.value_=d;var g=this.value;this.value=this.normalize(this.min+d*this.step);this.tmpl.scrollTrumb.style.left=(100*(d/this.count_)).toFixed(4)+"%";this.event_change(this,g)}},setValue:function(d){this.setValue_((d-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;u.prototype.destroy.call(this)}});Object.extend(n,{MarkLayer:s,Mark:y});d.namespace("basis.ui.slider").extend({Slider:n})})(basis);
(function(d){function l(d,g){if(window.getComputedStyle){var l=document.defaultView.getComputedStyle(d,null);if(l)return l.getPropertyValue(g)}else if(d.currentStyle)return d.currentStyle[g]}var g=d.dom,n=d.cssom.classList,m=d.dragdrop.DragDropElement,q=d.cssom.cssRule("IFRAME"),x={width:"deltaX",height:"deltaY"},u={width:{"-1":"w-resize",1:"e-resize"},height:{"-1":"n-resize",1:"s-resize"}},m=m.subclass(function(d){return{factor:NaN,property:"width",event_prepare:function(){x[this.property]?q.setProperty("pointerEvents",
"none"):(typeof console!="undefined"&&console.warn("Property to change `"+this.property+"` is unsupported"),this.stop())},event_start:function(g){d.event_start.call(this,g);g.delta=x[this.property];g.factor=this.factor;var m=this.element.parentNode,p=l(this.element,"float"),i=l(this.element,"position");if(g.delta=="deltaY"){if(m=m.clientHeight-parseFloat(l(m,"padding-top"))-parseFloat(l(m,"padding-bottom")),g.offsetStart=this.element.offsetHeight,isNaN(g.factor))g.factor=i!="static"&&l(this.element,
"bottom")!="auto"?-1:1}else if(m=m.clientWidth-parseFloat(l(m,"padding-left"))-parseFloat(l(m,"padding-right")),g.offsetStart=this.element.offsetWidth,isNaN(g.factor))g.factor=p=="right"||i!="static"&&l(this.element,"right")!="auto"?-1:1;g.offsetStartInPercent=100/m;n(this.resizer).add("selected")},event_move:function(g){d.event_move.call(this,g);this.element.style[this.property]=g.offsetStartInPercent*(g.offsetStart+g.factor*g[g.delta])+"%"},event_over:function(g){d.event_over.call(this,g);n(this.resizer).remove("selected");
q.setProperty("pointerEvents","auto")},init:function(l){this.resizer=g.createElement(".Basis-Resizer");this.resizer.style.cursor=u[this.property][1];d.init.call(this,l)},setElement:function(l){var m=this.element;d.setElement.call(this,l,this.resizer);m!==this.element&&(m&&g.remove(this.resizer),this.element&&g.insert(this.element,this.resizer))}}});d.namespace("basis.ui.resizer").extend({Resizer:m})})(basis);
(function(d){function l(d){return(100*d).toFixed(4)+"%"}function g(d){var i=d.childNodes.search(d.activePage_,"data.pageNumber");i?i.select():d.selection.clear()}var n=d.dom.event,m=d.EventObject.createEvent,q=d.cssom.classList,x=d.layout.Box,u=d.dragdrop.DragDropElement,v=d.ui.Control,y=d.ui.Node.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
templateUpdate:function(d){var i=this.pageGetter(this);d.pageNumber.nodeValue=i+1;d.link.href=this.urlGetter(i)},action:{click:function(d){n.kill(d);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))}}),s={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(d){d=((this.initOffset+d.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(d*(this.pageCount_-this.pageSpan_)));
this.tmpl.scrollTrumb.style.left=l(d)},over:function(){this.setSpanStartPage(this.spanStartPage_)}},m=v.subclass({childClass:y,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(d,i){var g=this.tmpl.scrollbar,g=(n.mouseX(i)-(new x(g)).left)/g.offsetWidth;this.setSpanStartPage(Math.floor(g*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(d){(d=n.wheelDelta(d))&&this.setSpanStartPage(this.spanStartPage_+d)}},event_activePageChanged:m("activePageChanged"),event_pageCountChanged:m("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(d){v.prototype.init.call(this,d);this.setProperties(d.pageCount||0,
d.pageSpan);this.setActivePage(Math.max(d.activePage-1,0),true);this.scrollbarDD=new u({element:this.tmpl.scrollTrumb,handler:s,handlerContext:this})},setProperties:function(d,i,g){d=d||1;i=Math.min(i||10,d);if(i!=this.pageSpan_)this.pageSpan_=i,this.setChildNodes(Array.create(i,function(a){return{data:{pageNumber:a}}}));if(this.pageCount_!=d){this.pageCount_=d;var m=1/d;this.tmpl.activePageMark.style.width=l(m/(1-m));this.tmpl.activePageMarkWrapper.style.width=l(1-m);this.event_pageCountChanged(this.pageCount_)}var m=
i/d,e=m/(1-m);this.tmpl.scrollTrumbWrapper.style.width=l(1-m);this.tmpl.scrollTrumb.style.width=l(e);q(this.element).bool("Basis-Paginator-WithNoScroll",i>=d);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(arguments.length==3?g:this.activePage_)},setActivePage:function(d,i){d=d.fit(0,this.pageCount_-1);if(d!=this.activePage_)this.activePage_=Number(d),g(this),this.event_activePageChanged(d);this.tmpl.activePageMark.style.left=l(d/Math.max(this.pageCount_-1,1));i&&this.spotlightPage(this.activePage_)},
spotlightPage:function(d){this.setSpanStartPage(d-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(d){d=d.fit(0,this.pageCount_-this.pageSpan_);if(d!=this.spanStartPage_){this.spanStartPage_=d;for(var i=this.childNodes.length;i-- >0;)this.childNodes[i].update({pageNumber:d+i});g(this)}this.tmpl.scrollTrumb.style.left=l((d/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;v.prototype.destroy.call(this)}});d.namespace("basis.ui.paginator").extend({Paginator:m})})(basis);
(function(d){var l="basis.ui.pageslider",g=d.dom,n=d.Class,m=d.cssom.classList,l="basis.ui",n=n(d.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(g,l){d.ui.tabs.PageControl.event_childNodesModified.call(this,g,l);for(var m=0,n;n=this.childNodes[m];m++)d.cssom.setStyle(n.element,{left:100*m+"%"})},init:function(g){var l="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=d.cssom.cssRule("."+l+" > .Basis-Page");this.constructor.superClass_.prototype.init.call(this,
g);m(this.element).add(l);this.scroller=new d.ui.Scroller({targetElement:this.element,preventScrollY:true,minScrollDelta:10,handler:{startInertia:function(d){var g=this.selection.pick();if(g){var l=g;d.currentDirectionX==0||d.currentDirectionX==1&&d.viewportX<g.element.offsetLeft||d.currentDirectionX==-1&&d.viewportX>g.element.offsetLeft?(d.minScrollDeltaXReached=true,l=this.childNodes[Math.round(d.viewportX/g.element.offsetWidth)]):l=d.currentDirectionX==1?g.nextSibling:g.previousSibling;l||(l=g);
l==g?this.slideToPage(g):l.select()}d.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var d=this.pick();d&&d.parentNode.slideToPage(d)}});if(this.selection.itemCount){var n=this;setTimeout(function(){n.slideToPage(n.selection.pick())},0)}},slideToPage:function(d){this.scroller.setTargetPosition(d.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);g.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});d.namespace(l).extend({PageSlider:n})})(basis);
(function(d){var l=d.dom.wrapper.Node,g=d.ui.Node,n=l.subclass({draw:function(d){d.save();d.fillStyle="red";d.fillRect(this.data.value*10,10,30,30);d.restore()},update:function(){var d=l.prototype.update.apply(this,arguments);if(d)for(var g=this.parentNode;g;){if(g instanceof m){g.updateCount++;break}g=g.parentNode}return d}}),m=g.subclass({template:"<canvas{canvas}><div>Canvas doesn't support.</div></canvas>",childFactory:function(d){return new this.childClass(d)},childClass:n,drawCount:0,lastDrawUpdateCount:-1,
init:function(d){g.prototype.init.call(this,d);this.element.width=this.width;this.element.height=this.height;this.updateCount=0;if((d=this.tmpl.canvas)&&d.getContext)this.context=d.getContext("2d");this.updateTimer_=setInterval(this.draw.bind(this),1E3/60)},reset:function(){this.element.width=this.element.clientWidth;this.element.height=this.element.clientHeight},isNeedToDraw:function(){return this.context&&(this.updateCount!=this.lastDrawUpdateCount||this.element.width!=this.lastDrawWidth||this.element.height!=
this.lastDrawHeight)},draw:function(){if(!this.isNeedToDraw())return false;this.lastDrawWidth=this.element.width;this.lastDrawHeight=this.element.height;this.lastDrawUpdateCount=this.updateCount;this.drawCount+=1;this.reset();this.drawFrame();return true},drawFrame:function(){for(var d=this.firstChild;d;d=d.nextSibling)d.draw(this.context)},destroy:function(){clearInterval(this.updateTimer_);g.prototype.destroy.call(this)}});d.namespace("basis.ui.canvas").extend({Canvas:m,Shape:n})})(basis);
(function(d){function l(d,g){for(var l=function(d){function g(b,c,e,i){a!=c&&l.push(d.substring(a,c).replace(m,'<span class="token-keyword">$1</span>'));a=e+1;l.push('<span class="token-'+b+'">'+d.substring(c,e+1)+"</span>"+(i||""))}for(var l=[],n=d.toArray(),e,a=0,c=0;c<n.length;c++)if(n[c]=="'")for(e=c;++c<n.length;){if(n[c]=="'"){g("string",e,c);break}if(n[c]=="\n")break;n[c]=="\\"&&(c++,n[c]=="\n"&&(g("string",e,c-1),e=c+1))}else if(n[c]=='"')for(e=c;++c<n.length;){if(n[c]=='"'){g("string",e,
c);break}if(n[c]=="\n")break;n[c]=="\\"&&(c++,n[c]=="\n"&&(g("string",e,c-1),e=c))}else if(n[c]=="/"){e=c;c++;if(n[c]=="/"){for(;++c<n.length;)if(n[c]=="\n")break;g("comment",e,c-1)}if(n[c]=="*")for(;++c<n.length;)if(n[c]=="*"&&n[c+1]=="/"){g("comment",e,++c);break}else n[c]=="\n"&&(g("comment",e,c-1,"\n"),a=e=c+1)}l.push(d.substr(a).replace(m,'<span class="token-keyword">$1</span>'));return l}(function(d){d=d.trimRight().replace(/\r\n|\n\r|\r/g,"\n");g||(d=d.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));
d=d.replace(/\n[ \t]+/g,function(a){return a.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!g){for(var i=1E3,l=d.split(/\n+/),m=Number(d.match(/^function/)!=null);m<l.length;m++){var e=l[m].match(/^\s*/);if(e[0].length<i)i=e[0].length;if(i==0)break}i>0&&(d=d.replace(RegExp("(^|\\n) {"+i+"}","g"),"$1"))}return d=d.replace(RegExp("(^|\\n)( +)","g"),function(a,c,b){return c+"\u00a0".repeat(b.length)})}(d).replace(/</g,"&lt;")).join("").split("\n"),n=String(l.length>>1).length,y=[],s=0;s<l.length;s++)y.push('<div class="line '+
(s%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(s+1).lead(n)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(l[s]+"\r\n")+"</span></div>");return y.join("")}var g=d.Class,n=d.ui.Node,m=RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+")\\b","g"),g=g(n,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',
codeGetter:Function.getter("data.code"),normalize:true,templateUpdate:function(){var d=this.codeGetter(this);if(d!=this.code_)this.code_=d,this.tmpl.codeElement.innerHTML=l(d,!this.normalize)}});d.namespace("basis.format.highlight").extend({highlight:l,SourceCodeNode:g})})(basis);
