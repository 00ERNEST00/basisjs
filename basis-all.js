/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(r){function z(b,d){for(var a in d)b[a]=d[a];return b}function x(b,d){for(var a in d)if(a in b==false)b[a]=d[a];return b}function A(b){return b==null||b==undefined}function y(b){return b}function C(b){var d={};b.names=function(a){return Object.slice(d,typeof a=="string"?a.qw():a)};b.extend=function(a){x(d,a);z(this,a);return this};return b}function I(b,d){for(var a=b.split("."),c=r,e,f,i;a.length;){e=a.shift();f=(f?f+".":"")+e;if(!c[e]){c[e]=C((!a.length?d:null)||function(){},f);if(i)i.namespaces_[f]=
c[e]}c=c[e];if(!i){i=c;if(!i.namespaces_)i.namespaces_={}}}return p[b]=c}z(Object,{extend:z,complete:x,keys:function(b){var d=[];for(var a in b)d.push(a);return d},values:function(b){var d=[];for(var a in b)d.push(b[a]);return d},slice:function(b,d){var a={};if(!d)return z(a,b);for(var c=0,e;e=d[c++];)if(e in b)a[e]=b[e];return a},splice:function(b,d){var a={};if(!d)return z(a,b);for(var c=0,e;e=d[c++];)if(e in b){a[e]=b[e];delete b[e]}return a},iterate:function(b,d,a){var c=[];for(var e in b)c.push(d.call(a,
e,b[e]));return c},coalesce:function(){for(var b=arguments,d=0;d<b.length;d++)if(b[d]!=null)return b[d]}});var H=function(){},B=function(){var b=1,d={},a={},c=function(e){return e.modificator};c.getter=c;c.getterIdx_=b++;return function(e,f){var i,m;if(!f){if(e.getter)return e.getter;if(typeof e=="function")return e}if(typeof e!="function")if(a[e])i=a[e];else{i=new Function("object","return object != null ? object."+e+" : object");i.path=e;i.getterIdx_=b++;a[e]=i}else{i=e;if(!i.getterIdx_)i.getterIdx_=
b++}m=i.getterIdx_;var g=d[m];if(g)if(typeof f=="undefined"){if(g.nmg)return g.nmg}else for(m=0;m<g.length;m++){if(g[m].modificator===f)return g[m].getter}else g=d[m]=[];var n=true;switch(f&&typeof f){case "string":m=function(s){return f.format(i(s))};break;case "function":m=function(s){return f(i(s))};break;case "object":n=false;m=function(s){return f[i(s)]};break;default:m=i.path?i:function(s){return i(s)}}if(n){g.push({getter:m,modificator:f});if(typeof f=="undefined")g.nmg=m}return m.getter=m}}();
z(Function,{$undefined:function(b){return b==undefined},$defined:function(b){return b!=undefined},$isNull:A,$isNotNull:function(b){return b!=null&&b!=undefined},$isSame:function(b){return b===this},$isNotSame:function(b){return b!==this},$self:y,$const:function(b){return function(){return b}},$false:function(){return false},$true:function(){return true},$null:function(){return null},$undef:H,getter:B,def:function(b,d,a){a=a||A;return function(c){c=b(c);return a(c)?d:c}},wrapper:function(b){return function(d){var a=
{};a[b]=d;return a}},lazyInit:function(b,d){var a=0,c,e;return c=function(){if(!a++){c.inited=true;c.data=e=b.apply(d||this,arguments)}return e}},lazyInitAndRun:function(b,d,a){var c=0,e,f;return e=function(){if(!c++){e.inited=true;e.data=f=b.call(a||this)}d.apply(f,arguments);return f}},runOnce:function(b,d){var a=0;return function(){if(!a++)return b.apply(d||this,arguments)}}});x(Function.prototype,{bind:function(b){var d=this,a=Array.from(arguments,1);return a.length?function(){return d.apply(b,
a.concat.apply(a,arguments))}:function(){return d.apply(b,arguments)}}});x(Array,{isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"}});z(Array,{from:function(b,d){if(b!=null){var a=b.length;if(typeof a=="undefined")return[b];d||(d=0);if(a-d>0){for(var c=[],e=0,f=d;f<a;)c[e++]=b[f++];return c}}return[]},create:function(b,d,a){for(var c=[],e=0;e<b;e++)c[e]=typeof d=="function"?d.call(a,e,c):d;return c}});x(Array.prototype,{indexOf:function(b,d){d=parseInt(d)||0;if(d<0)return-1;
for(;d<this.length;d++)if(this[d]===b)return d;return-1},lastIndexOf:function(b,d){var a=this.length;d=parseInt(d);for(d=isNaN(d)||d>=a?a-1:(d+a)%a;d>=0;d--)if(this[d]===b)return d;return-1},forEach:function(b,d){for(var a=0,c=this.length;a<c;a++)a in this&&b.call(d,this[a],a,this)},every:function(b,d){for(var a=0,c=this.length;a<c;a++)if(a in this&&!b.call(d,this[a],a,this))return false;return true},some:function(b,d){for(var a=0,c=this.length;a<c;a++)if(a in this&&b.call(d,this[a],a,this))return true;
return false},filter:function(b,d){for(var a=[],c=0,e=this.length;c<e;c++)c in this&&b.call(d,this[c],c,this)&&a.push(this[c]);return a},map:function(b,d){for(var a=[],c=0,e=this.length;c<e;c++)if(c in this)a[c]=b.call(d,this[c],c,this);return a},reduce:function(b,d){var a=this.length,c=arguments.length;if(a==0&&c==1)throw new TypeError;var e,f=0;if(c>1){e=d;f=1}for(c=0;c<a;c++)if(c in this)e=f++?b.call(null,e,this[c],c,this):this[c];return e}});z(Array.prototype,{flatten:function(){return this.concat.apply([],
this)},repeat:function(b){return Array.create(parseInt(b)||0,this).flatten()},item:function(b){b=parseInt(b||0);return this[b>=0?b:this.length+b]},search:function(b,d,a){Array.lastSearchIndex=-1;d=Function.getter(d||y);a=parseInt(a)||0;for(var c=this.length;a<c;a++)if(d(this[a])===b)return this[Array.lastSearchIndex=a]},lastSearch:function(b,d,a){Array.lastSearchIndex=-1;d=Function.getter(d||y);var c=this.length;a=isNaN(a)||a==null?c:parseInt(a);for(c=a>c?c:a;c-- >0;)if(d(this[c])===b)return this[Array.lastSearchIndex=
c]},binarySearchPos:function(b,d,a,c,e,f){if(!this.length)return c?-1:0;d=Function.getter(d||y);a=!!a;var i;e=isNaN(e)?0:e;var m=isNaN(f)?this.length-1:f;do{f=e+m>>1;i=d(this[f]);if(a?b>i:b<i)m=f-1;else if(a?b<i:b>i)e=f+1;else return b==i?f:c?-1:0}while(e<=m);return c?-1:f+(i<b^a)},binarySearch:function(b,d){return this.binarySearchPos(b,d,false,true)},add:function(b){return this.indexOf(b)==-1&&!!this.push(b)},remove:function(b){b=this.indexOf(b);return b!=-1&&!!this.splice(b,1)},has:function(b){return this.indexOf(b)!=
-1},merge:function(b){return this.reduce(z,b||{})},sortAsObject:function(b,d,a){b=Function.getter(b);a=a?-1:1;return this.map(function(c,e){return{i:e,v:b(c)}}).sort(d||function(c,e){return a*(c.v>e.v||-(c.v<e.v)||(c.i>e.i?1:-1))}).map(function(c){return this[c.i]},this)},set:function(b){if(this!==b){this.length=0;this.push.apply(this,b)}return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var E=Array.prototype.splice;Array.prototype.splice=function(){var b=Array.from(arguments);
if(b.length<2)b[1]=this.length;return E.apply(this,b)}}var F={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};x(String,{toLowerCase:function(b){return String(b).toLowerCase()},toUpperCase:function(b){return String(b).toUpperCase()},trim:function(b){return String(b).trim()},trimLeft:function(b){return String(b).trimLeft()},
trimRight:function(b){return String(b).trimRight()},isEmpty:function(b){return b==null||String(b)==""},isNotEmpty:function(b){return b!=null&&String(b)!=""}});x(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});z(String.prototype,{toObject:function(b){try{return Function("return 0,"+this)()}catch(d){if(b)throw d;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:
function(){for(var b=[],d=this.length,a=0;a<d;a++)b[a]=this.charAt(a);return b},repeat:function(b){return(new Array(parseInt(b)+1||0)).join(this)},qw:function(){var b=this.trim();return b?b.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,"\\$&")},format:function(b){for(var d={},a=0;a<arguments.length;a++)d[a]=arguments[a];typeof b=="object"&&z(d,b);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(c,e,f,i,m){c=e in d?d[e]:m?"":
c;if(f&&!isNaN(c)){c=Number(c);return f=="."?c.toFixed(i):c.lead(i)}return c})},quote:function(b,d){b=b||'"';d=d||F[b]||b;var a=(b.length==1?b:"")+(d.length==1?d:"");return b+(a?this.replace(new RegExp("["+a.forRegExp()+"]","g"),"\\$&"):this)+d},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(b,d){return d.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(b){return"-"+b.toLowerCase()})}});
String.format=String.prototype.format;if("|||".split(/\|/).length+"|||".split(/(\|)/).length!=11)String.prototype.split=function(b){if(b==""||b&&b.source=="")return this.toArray();var d=[],a=0,c;if(b instanceof RegExp)for(b.global||(b=new RegExp(b.source,/\/([mi]*)$/.exec(b)[1]+"g"));c=b.exec(this);){c[0]=this.substring(a,c.index);d.push.apply(d,c);a=b.lastIndex}else for(;(c=this.indexOf(b,a))!=-1;){d.push(this.substring(a,c));a=c+b.length}d.push(this.substr(a));return d};if("12".substr(-1)!="2"){var v=
String.prototype.substr;String.prototype.substr=function(b,d){return v.call(this,b<0?Math.max(0,this.length+b):b,d)}}z(Number.prototype,{fit:function(b,d){if(!isNaN(b)&&this<b)return Number(b);if(!isNaN(d)&&this>d)return Number(d);return this},between:function(b,d){return!isNaN(this)&&this>=b&&this<=d},quote:function(b,d){return(this+"").quote(b,d)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(b){return!b||isNaN(b)?0:
Math.floor(this/b)*b},lead:function(b,d){return(this+"").replace(/\d+/,function(a){return(b-=a.length-1)>1?Array(b).join(d||0)+a:a})},group:function(b,d){return(this+"").replace(/\d+/,function(a){return a.replace(/\d/g,function(c,e){return!e+(a.length-e)%(b||3)?c:(d||" ")+c})})},format:function(b,d,a,c,e){b=this.toFixed(b);if(d||e)b=b.replace(/(\d+)(\.?)/,function(f,i,m){return(d?Number(i).group(3,d):i)+(m?e||m:"")});if(a)b=b.replace(/^-?/,"$&"+(a||""));return b+(c||"")}});x(Date,{now:function(){return+new Date}});
(new Date).getYear()<1900&&z(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(b){return this.setFullYear(!isNaN(b)&&b<100?Number(b)+1900:b)}});var p={},w=function(){function b(f,i){for(var m=p[f],g=i?i.split(/\./):[];m&&g.length;)m=m[g.shift()];return m}var d=r.document?r.document.getElementsByTagName("SCRIPT"):null,a=(d?d[d.length-1].src:module.filename).replace(/[^\/]+$/,""),c={},e;if(typeof require=="function")e=function(f){return require(requirePath+f.replace(/\./g,
"/"))};else{e=function(f,i){var m=f.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],g=f.substr(m.length?m.length+1:0),n=b(m,g),s=/^basis\./.test(m)?a:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!p[m]||!n)if(/^https?:/.test(s))if(c[f])throw"Attempt to load namespace, probably cycle require";else{c[f]=1;s=s+(i||"")+f.replace(/\./g,"/")+".js";var G=new XMLHttpRequest;G.open("POST",s,false);G.send(null);if(G.status==200){try{(new Function(G.responseText)).call(r)}catch(K){throw K;
}e.sequence.push(f.replace(/\./g,"/")+".js")}else if(G.status==404&&g)w(m);else throw"unable to load module "+f+" by basis.require()";}else throw"Path `"+f+"` can't be resolved";return n||b(m,g)};e.sequence=[]}return e}(),t=function(){function b(m){return typeof m=="function"&&m.basisClass_}var d=Function(),a={id:1},c={},e=function(){for(var m in{toString:1})return;return true}();z(d,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+
(this.constructor||this).className+"]"},destroy:function(){for(var m in this)this[m]=null;this.destroy=H}},create:function(m){if(typeof m!="function")m=d;var g=Function();g.prototype=m.prototype;g=new g;for(var n={className:m.className+"._SubClass_",basisClass_:true,superClass_:m,extendConstructor_:!!m.extendConstructor_,__extend__:function(k){return k&&(typeof k=="object"||typeof k=="function"&&!b(k))&&k!==c?d.create.call(null,q,k):k},extend:d.extend,subclass:function(){return d.create.apply(null,
[q].concat(Array.from(arguments)))},prototype:g},s=arguments,G=1;G<s.length;G++)n.extend(typeof s[G]=="function"&&!b(s[G])?s[G](m.prototype):s[G]);var K={},q=n.extendConstructor_?function(k,u){this.eventObjectId=a.id++;var D;for(var L in k){D=this[L];this[L]=D&&D.__extend__?D.__extend__(k[L]):k[L]}this.init(u||K)}:function(){this.eventObjectId=a.id++;this.init.apply(this,arguments)};g.constructor=q;for(var h in g)if(g[h]===c)g[h]=q;z(q,n);return q},extend:function(m){var g=this.prototype;if(m.prototype)m=
m.prototype;for(var n in m){var s=m[n],G=g[n];if(n=="className"||n=="extendConstructor_")this[n]=s;else g[n]=G&&G.__extend__?G.__extend__(s):s}if(e&&m[n="toString"]!==Object.prototype[n])g[n]=m[n];return this}});var f=function(m,g){return{__extend__:function(n){var s=Function();s.prototype=this;s=new s;g(s,n);return s}}.__extend__(m)},i=function(m){return f(m,z)};return I("basis.Class",d.create).extend({SELF:c,BaseClass:d,create:d.create,isClass:b,CustomExtendProperty:f,ExtensibleProperty:i,NestedExtProperty:function(m){return f(m,
function(g,n){for(var s in n){var G=g[s];g[s]=G&&G.__extend__?G.__extend__(n[s]):i(n[s])}})}})}(),j=function(){function b(f){var i=a[f];i||(i=a[f]=function(){var m=this.handlers_,g,n;if(m&&m.length){m=d.call(m);for(var s=m.length;s-- >0;){g=m[s];n=g.handler[f];typeof n=="function"&&n.apply(g.thisObject,arguments)}}});return i}var d=Array.prototype.slice,a={},c,e=t(null,{handlers_:null,event_destroy:c=b("destroy","object"),listen:t.NestedExtProperty(),extendConstructor_:true,init:function(){if(this.handler)(this.handlers_||
(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(f,i){var m=this.handlers_;if(!m)m=this.handlers_=[];i||(i=this);for(var g=m.length,n;g-- >0;){n=m[g];if(n.handler===f&&n.thisObject===i)return false}return!!m.push({handler:f,thisObject:i||this})},removeHandler:function(f,i){var m=this.handlers_;if(m){i||(i=this);for(var g=m.length,n;g-- >0;){n=m[g];if(n.handler===f&&n.thisObject===i)return!!m.splice(g,1)}return false}},destroy:function(){if(this.handlers_){c.call(this,
this);this.handlers_=null}}});e.createEvent=b;e.event=a;return e}(),o=function(){var b=[];return{add:function(d){d!=null&&b.push(d)},remove:function(d){b.remove(d)}}}();(function(){function b(g){if(d){if(g.source!=r||g.data!=a)return;basis.dom.event.kill(g)}if(c.length){g=c.shift();delete e[g.key];g.fn()}}var d=typeof addEventListener=="function"&&typeof postMessage=="function",a="zeroTimeoutMessage",c=[],e={},f=1;d&&r.addEventListener("message",b,true);var i=setTimeout;r.setTimeout=function(g,n){var s;
if(n)s=i.call(r,g,n);else{s={key:"z"+f++,fn:typeof g=="function"?g:new Function(g)};e[s.key]=s;c.push(s);if(d)postMessage(a,"*");else s.timer=i.call(r,b,0);s=s.key}return s};var m=clearTimeout;r.clearTimeout=function(g){if(/z\d+/.test(g)){var n=e[g];if(n){clearTimeout(n.timer);c.remove(n);delete e[g]}}else return m.call(r,g)}})();var l=function(){function b(){if(!n)if(f.length){var s=Date.now(),G=Math.max(f[0].eventTime,s);if(G<m){clearTimeout(g);g=setTimeout(a,(m=G)-s)}}else{g=clearTimeout(g);m=
c}}function d(s,G){var K=s.eventObjectId,q=i[G]&&i[G][K];if(q){f.remove(q);delete i[G][K];b()}}function a(){var s=Date.now();s=f.binarySearchPos(s+15,e);n=true;f.splice(0,s).forEach(function(G){delete i[G.eventName][G.object.eventObjectId];G.callback.call(G.object)});n=false;m=c;b()}var c=2E12,e=B("eventTime"),f=[],i={},m=c,g=null,n=false;o.add({destroy:function(){n=true;clearTimeout(g);f.length=0;i=null}});return{add:function(s,G,K){var q=s.eventObjectId,h=i[G];h||(h=i[G]={});var k=h[q];if(k){if(isNaN(K))return d(s,
G);if(k.eventTime==K)return;f.remove(k);k.eventTime=K}else{if(isNaN(K))return;k=h[q]={eventName:G,object:s,eventTime:K,callback:s[G]}}f.splice(f.binarySearchPos(K,e),0,k);b()},remove:d}}();I("basis").extend({namespace:I,platformFeature:{},EventObject:j,TimeEventManager:l,Cleaner:o,require:w});r.basis.locale={}})(this);
(function(r,z){function x(o){var l=1E6;o=String(o).split(".");for(var b=0,d=0;b<4&&b<o.length;b++,l/=100)d+=o[b]*l;return d}function A(){for(var o=0;o<arguments.length;o++){var l=arguments[o].toLowerCase();if(l in C){if(C[l])return true}else{var b=l.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(b){C[l]=false;var d=b[1].toLowerCase(),a=x(b[3]);b=b[4]||"=";if(d=I[d])return C[l]=!a||b=="="&&d==a||b=="+"&&d>=a||b=="-"&&d<a}}}return false}var y="basis.ua",C={},I={},H=z.navigator&&z.navigator.userAgent,B=
"unknown",E="unknown",F={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]};for(var v in F)if(!(v=="MSIE"&&z.opera))if(!(v=="Safari"&&H.match(/chrome/i)))if(!(v=="AppleWebKit"&&H.match(/iphone/i)))if(H.match(new RegExp(v+
".(\\d+(\\.\\d+)*)","i"))){var p=F[v],w=z.opera&&typeof z.opera.version=="function"?z.opera.version():RegExp.$1,t=x(w);B=p[0]+t;E=p[0]+" "+w;for(B=0;B<p.length;B++)I[p[B].toLowerCase()]=t}r.platformFeature.datauri=false;H=typeof Image!="undefined"?new Image:{};H.onload=function(){r.platformFeature.datauri=true};H.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";F={set:function(o,l,b,d){document.cookie=o+"="+(l==null?"":escape(l))+";path="+(d||(location.pathname.indexOf("/")==
0?"":"/")+location.pathname)+(b?";expires="+(new Date(Date.now()+b*1E3)).toGMTString():"")},get:function(o){return(o=document.cookie.match(new RegExp("(^|;)\\s*"+o+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(o[2])},remove:function(o,l){document.cookie=o+"=;expires="+(new Date(0)).toGMTString()+";path="+(l||(location.pathname.indexOf("/")==0?"":"/")+location.pathname)}};if(A("IE7-"))try{document.execCommand("BackgroundImageCache",false,true)}catch(j){}y=r.namespace(y);y.toString=function(){return E};return y.extend({testImage:H,
prettyName:E,test:A,is:function(o){return A(o)},Cookies:F})})(basis,this);
(function(r,z){function x(g,n,s){if(n!=null)return g.insertBefore(a(n)?n:I(n),s||null)}function A(g){return B("",g.cloneNode(true)).innerHTML}function y(g){return a(g)||g&&g.nodeType?g:typeof g=="string"?p.getElementById(g):null}function C(g,n,s){var G,K=[];s=typeof s=="string"?getter(s):s||Function.$true;n&26&&s(g)&&K.push(g);switch(n){case 1:case 2:for(G=g;(G=G[j])&&G!==g.document;)s(G)&&K.push(G);break;case 64:for(G=g[o];G;){s(G)&&K.push(G);G=G[l]}break;case 4:case 8:if(g[o]){n=new c(g);n.nodes(s,
K)}break;case 128:n=new c(g,s);for(n.cursor_=g[l]||g[j];G=n.next();)K.push(G);break;case 256:for(G=g;G=G[l];)s(G)&&K.push(G);break;case 32:s(g[j])&&K.push(g[j]);break;case 512:n=new c(g,s,c.BACKWARD);for(n.cursor_=g[b]||g[j];G=n.next();)K.push(G);break;case 1024:for(G=g;G=G[b];)s(G)&&K.push(G);break}return K}function I(g){return p.createTextNode(g!=null?g:"")}function H(){for(var g=p.createDocumentFragment(),n=arguments.length,s=H.array=[],G=0;G<n;G++)s.push(x(g,arguments[G]));return g}function B(g){var n=
g!=undefined&&typeof g!="string",s=(n?g.description:g)||"",G="div",K=s.match(/^([a-z0-9\_\-]+)(.*)$/i);if(K){G=K[1];s=K[2]}if(s!=""){for(var q=[],h={},k;K=m.exec(s);){if(K[8])throw new Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+s+"\n\nProblem place:\n> "+s.substr(0,K.index)+"--\>"+s.substr(K.index)+"<--");k=K[1]||K[2]||K[3];if(K[1])h.id=k;else if(K[2])q.push(k);else if(k!="class")h[k]=K[4]?v(K[5],K[6],K[7]):k}if(f&&h.name&&/^(input|textarea|select)$/i.test(G))G=
"<"+G+" name="+h.name+">"}s=p.createElement(G);if(h){if(h.style&&i)s.style.cssText=h.style;for(var u in h)s.setAttribute(u,h[u],0)}if(q&&q.length)s.className=q.join(" ");arguments.length>1&&x(s,H.apply(0,Array.from(arguments,1).flatten()));if(n){g.css&&r.cssom&&r.cssom.setStyle(s,g.css);if(r.dom.event)for(var D in g)if(typeof g[D]=="function")r.dom.event.addHandler(s,D,g[D],s);else g[D]instanceof r.dom.event.Handler&&r.dom.event.addHandler(s,D,g[D].handler,g[D].thisObject)}return s}function E(g,n){return g[j]?
g[j].replaceChild(n,g):g}function F(g){if(p.selection){var n=p.selection.createRange();n.compareEndPoints("StartToEnd",n)!=0&&n.collapse(g);return n.getBookmark().charCodeAt(2)-2}}var v=Object.coalesce,p=z.document,w=r.Class,t=p.createElement("div"),j="parentNode",o="firstChild",l="nextSibling",b="previousSibling",d;d=typeof t.compareDocumentPosition=="function"?function(g,n){return g.compareDocumentPosition(n)}:function(g,n){if(g==n)return 0;if(g.document!=n.document)return 33;return g.sourceIndex>
n.sourceIndex?2|8*n.contains(childA):4|16*g.contains(childB)};var a;if(typeof Node!="undefined"){a=function(g){return g instanceof Node};if(!Node.prototype.contains)Node.prototype.contains=function(g){return!!(this.compareDocumentPosition(g)&16)}}else a=function(g){return g&&g.ownerDocument===p};var c=w(null,{root_:null,cursor_:null,filter:Function.$true,init:function(g,n,s){this.setRoot(g);this.setDirection(s);if(typeof n=="function")this.filter=n},setDirection:function(g){Object.extend(this,g?{a:"lastChild",
b:b,c:l,d:o}:{a:o,b:l,c:b,d:"lastChild"})},setRoot:function(g){this.root_=g||p;this.reset()},reset:function(){this.cursor_=null},first:function(g){this.reset();return this.next(g)},last:function(g){this.reset();return this.prev(g)},nodes:function(g,n){var s;n||(n=[]);for(this.reset();s=this.next(g);)n.push(s);return n},next:function(g){g=g||this.filter;var n=this.cursor_||this.root_;do for(var s=n[this.a];!s;){if(n===this.root_)return this.cursor_=null;(s=n[this.b])||(n=n[j])}while(!g(n=s));return this.cursor_=
n},prev:function(g){g=g||this.filter;var n=this.cursor_,s=this.c,G=this.d;do{var K=n?n[s]:this.root_[G];if(K){for(;K[G];)K=K[G];n=K}else if(n)n=n[j];if(!n||n===this.root_){n=null;break}}while(!g(n));return this.cursor_=n},destroy:function(){this.cursor_=this.root_=null}});c.BACKWARD=true;var e="textContent innerText nodeValue".qw(),f=function(){var g=p.createElement("input");g.name="a";return!/name/.test(A(g))}(),i;t.setAttribute("style","color: red");i=t.style.color!=="red";var m=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return r.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:c,outerHTML:A,textContent:function(g){for(var n=0,s;s=e[n++];)if(g[s]!=null)return g[s];return C(g,4,function(G){return G.nodeType==3}).map(getter("nodeValue")).join("")},get:y,tag:function(g,n){g=y(g)||p;return n=="*"&&g.all?Array.from(g.all):Array.from(g.getElementsByTagName(n||"*"))},axis:C,findAncestor:function(g,n,s){for(;g&&g!==s;){if(n(g))return g;g=g.parentNode}},createElement:B,createText:I,createFragment:H,insert:function(g,
n,s,G){g=y(g);if(!g)throw new Error("basis.dom.insert: destination node can't be null");switch(s){case undefined:case "end":G=null;break;case "begin":G=g[o];break;case "before":break;case "after":G=G[l];break;default:G=Number(s).between(0,g.childNodes.length)?g.childNodes[s]:null}s=!a(g);if(!n||!Array.isArray(n))s=s?n&&g.insertBefore(n,G):x(g,n,G);else if(s){s=[];for(var K=0,q=n.length;K<q;K++)s[K]=g.insertBefore(n[K],G)}else{g.insertBefore(H.apply(0,n),G);s=H.array}return s},remove:function(g){return g[j]?
g[j].removeChild(g):g},replace:E,swap:function(g,n){if(g===n||d(g,n)&25)return false;E(g,t);E(n,g);E(t,n);return true},clone:function(g,n){var s=g.cloneNode(!n);s.attachEvent&&C(s,8).forEach(Event.clearHandlers);return s},clear:function(g){for(g=y(g);g.lastChild;)g.removeChild(g.lastChild);return g},wrap:function(g,n,s){var G=[];s=Function.getter(s||Function.$self);for(var K in n)for(var q=0;q<g.length;q++){var h=s(g[q]);G[q]=n[K](g[q],q,h)?B(K,h):g[q]}return G},setAttribute:function(g,n,s){s==null?
g.removeAttribute(n):g.setAttribute(n,s)},parentOf:function(g,n){return g.contains(n)},isInside:function(g,n){return g==n||n.contains(g)},focus:function(g,n){try{g=y(g);g.focus();n&&g.select&&g.select()}catch(s){}},setSelectionRange:function(g,n,s){if(arguments.length<3)s=n;if(g.setSelectionRange)g.setSelectionRange(n,s);else if(g.createTextRange){var G=g.createTextRange();G.collapse(true);G.moveStart("character",n);G.moveEnd("character",s-n);G.select()}},getSelectionStart:function(g){return typeof g.selectionStart!=
"undefined"?g.selectionStart:F(true)},getSelectionEnd:function(g){return typeof g.selectionEnd!="undefined"?g.selectionEnd:F(false)}})})(basis,this);
(function(r,z){function x(b){return b||z.event}function A(b){return typeof b=="string"?v.get(b):b}function y(b){b=x(b);if(b.stopPropagation)b.stopPropagation();else b.cancelBubble=true}function C(b){b=x(b);if(b.preventDefault)b.preventDefault();else b.returnValue=false}function I(b){var d=Array.from(j[b.type]);if(d)for(var a=d.length;a-- >0;){var c=d[a];c.handler.call(c.thisObject,b)}}function H(b,d,a,c){b=A(b);if(!b)throw new Error("Event.addHandler: can't attach event listener to undefined");if(typeof a!=
"function")throw new Error("Event.addHandler: handler must be a function");b[w]||(b[w]={});var e={handler:a,thisObject:c},f=b[w],i=f[d];if(i){for(b=0;d=i[b];b++)if(d.handler===a&&d.thisObject===c)return;i.push(e)}else{i=f[d]=[e];i.fireEvent=function(m){m=x(m);if(o&&m)if(typeof m.returnValue=="undefined"){I(m);if(m.cancelBubble===true)return;if(typeof m.returnValue=="undefined")m.returnValue=true}for(var g=0,n;n=i[g++];)n.handler.call(n.thisObject,m)};b.addEventListener?b.addEventListener(d,i.fireEvent,
false):b.attachEvent("on"+d,i.fireEvent)}}function B(b,d,a,c){b=A(b);var e=b[w];if(e)if(e=e[d])for(var f=0,i;i=e[f];f++)if(i.handler===a&&i.thisObject===c){e.splice(f,1);e.length||E(b,d);return}}function E(b,d){b=A(b);var a=b[w];if(a)if(typeof d!="string")for(d in a)E(b,d);else{var c=a[d];if(c){b.removeEventListener?b.removeEventListener(d,c.fireEvent,false):b.detachEvent("on"+d,c.fireEvent);delete a[d]}}}var F=z.document,v=r.dom,p=Function.$null,w="__basisEvents",t={mousewheel:["mousewheel","DOMMouseScroll"]},
j={},o=!F.addEventListener,l=function(){function b(){d++||setTimeout(function(){for(var e=0;e<a.length;e++)a[e].callback.call(a[e].thisObject)},10)}var d=false,a=[];if(r.ua.is("ie7-"))(function(){var e="_"+Date.now();F.write('<script id="'+e+'" defer src="//:"><\/script>');A(e).onreadystatechange=function(){if(this.readyState=="complete"){v.remove(this);b()}}})();else if(r.ua.is("safari525-"))var c=setInterval(function(){if(/loaded|complete/.test(F.readyState)){clearInterval(c);b()}},15);else H(F,
"DOMContentLoaded",b,false);H(F,"load",b,false);H(z,"load",b,false);return function(e,f){d||a.push({callback:e,thisObject:f})}}();return r.namespace("basis.dom.event",x).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(b){return t[b]||[b]},Handler:function(b,
d){this.handler=b;this.thisObject=d},sender:function(b){b=x(b);return b.target||b.srcElement},cancelBubble:y,cancelDefault:C,kill:function(b,d){if(d=A(d))H(d,b,Event.kill);else{C(b);y(b)}},key:function(b){b=x(b);return b.keyCode||b.which||0},charCode:function(b){b=x(b);return b.charCode||b.keyCode||0},mouseButton:function(b,d){b=x(b);return typeof b.which=="number"?b.which==d.VALUE:b.button&d.BIT},mouseX:function(b){b=x(b);return b.changedTouches?b.changedTouches[0].pageX:"pageX"in b?b.pageX:b.clientX+
(F.documentElement.scrollLeft||F.body.scrollLeft)},mouseY:function(b){b=x(b);return b.changedTouches?b.changedTouches[0].pageY:"pageY"in b?b.pageY:b.clientY+(F.documentElement.scrollTop||F.body.scrollTop)},wheelDelta:function(b){b=x(b);return"wheelDelta"in b?b.wheelDelta/120:b.type=="DOMMouseScroll"?-b.detail/3:0},addGlobalHandler:function(b,d,a){var c=j[b];if(c)for(b=c.length;b-- >0;){var e=c[b];if(e.handler===d&&e.thisObject===a)return}else{F.addEventListener?F.addEventListener(b,I,true):H(F,b,
p);c=j[b]=[]}c.push({handler:d,thisObject:a})},removeGlobalHandler:function(b,d,a){var c=j[b];if(c)for(var e=0,f;f=c[e];e++)if(f.handler===d&&f.thisObject===a){c.splice(e,1);if(!c.length){delete j[b];F.removeEventListener?F.removeEventListener(b,I,true):B(F,b,p)}return}},addHandler:H,addHandlers:function(b,d,a){b=A(b);for(var c in d)H(b,c,d[c],a)},removeHandler:B,clearHandlers:E,fireEvent:function(b,d){b=A(b);var a=b[w];a&&a[d]&&a[d].fireEvent()},onLoad:l,onUnload:function(b,d){H(z,"unload",b,d)}})})(basis,
this);
(function(){function r(b,d,a){for(var c=1,e;d;){if(d&1){e=p[c];if(a&c){b.addHandler(e.handler,e.context);e.action(e.context.add,b)}else{b.removeHandler(e.handler,e.context);e.action(e.context.remove,b)}}d>>=1;c<<=1}}function z(b){return Array.isArray(b)?b.map(z):{data:b}}var x=basis.Class,A=basis.EventObject,y=Object.values,C=Function.$self,I=A.createEvent,H=A.event,B={},E=[],F={},v={PRIORITY:[],values_:{},add:function(b,d){var a=b.toUpperCase(),c=b.toLowerCase();this[a]=c;F[c]=true;if(d){d=this.indexOf(d);
d==-1?this.PRIORITY.push(c):this.PRIORITY.splice(d,0,c)}}};v.add("READY");v.add("DEPRECATED");v.add("UNDEFINED");v.add("ERROR");v.add("PROCESSING");var p={},w=1,t={NONE:0,MASK:0,add:function(b,d,a){p[w]={handler:d,action:a,context:{add:function(c,e){if(e){var f=t[b]+"_"+c.eventObjectId;if(!e.subscribers_)e.subscribers_={};if(!e.subscribers_[f]){var i=e.subscriberCount;e.subscribers_[f]=c;e.subscriberCount+=1;e.event_subscribersChanged(e,i)}}},remove:function(c,e){if(e){var f=t[b]+"_"+c.eventObjectId;
if(e.subscribers_[f]){var i=e.subscriberCount;delete e.subscribers_[f];e.subscriberCount-=1;e.event_subscribersChanged(e,i)}}}}};t[b]=w;t.MASK|=w;w<<=1}};t.add("DELEGATE",{delegateChanged:function(b,d){this.remove(b,d);this.add(b,b.delegate)}},function(b,d){b(d,d.delegate)});t.add("TARGET",{targetChanged:function(b,d){this.remove(b,d);this.add(b,b.target)}},function(b,d){b(d,d.target)});var j=x(A,{state:v.READY,data:null,canHaveDelegate:true,delegate:null,root:null,cascadeDestroy:false,isTarget:false,
target:null,active:false,subscribeTo:t.DELEGATE+t.TARGET,subscriberCount:0,subscribers_:null,event_update:I("update","object","delta"),event_stateChanged:I("stateChanged","object","oldState"),event_delegateChanged:I("delegateChanged","object","oldDelegate"),event_rootChanged:I("rootChanged","object","oldRoot"),event_targetChanged:I("targetChanged","object","oldTarget")&&function(b,d){var a=this.listen.target;if(a){d&&d.removeHandler(a,this);this.target&&this.target.addHandler(a,this)}H.targetChanged.call(this,
b,d)},event_subscribersChanged:I("subscribersChanged","object"),event_activeChanged:I("activeChanged","object"),listen:{delegate:{update:function(b,d){this.data=b.data;this.event_update(this,d)},stateChanged:function(b,d){this.state=b.state;this.event_stateChanged(this,d)},targetChanged:function(b,d){this.target=b.target;this.event_targetChanged(this,d)},rootChanged:function(b,d){this.data=b.data;this.event_rootChanged(this,d)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},
init:function(b){A.prototype.init.call(this,b);if(b=this.delegate){this.delegate=null;this.data=b.data;this.state=b.state;this.setDelegate(b)}else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&r(this,this.subscribeTo,t.MASK)},isConnected:function(b){if(b instanceof j){for(;b&&b!==this&&b!==b.delegate;)b=b.delegate;return b===this}return false},getRootDelegate:function(){for(var b=this;b.delegate&&b.delegate!==b;)b=b.delegate;return b},setDelegate:function(b){if(this.canHaveDelegate&&
b&&b instanceof j){if(b.delegate&&this.isConnected(b))return false}else b=null;if(this.delegate!==b){var d=this.state,a=this.data,c=this.delegate,e=this.target,f=this.root,i={},m=this.listen.delegate;c&&m&&c.removeHandler(m,this);if(b){this.delegate=b;this.root=b.root;this.data=b.data;this.state=b.state;this.target=b.target;m&&b.addHandler(m,this);for(var g in b.data)if(g in a===false)i[g]=undefined;for(g in a)if(a[g]!==b.data[g])i[g]=a[g]}else{this.target=this.delegate=null;this.root=this;this.data=
{};for(g in a)this.data[g]=a[g]}this.event_delegateChanged(this,c);this.root!==f&&this.event_rootChanged(this,f);this.target!==e&&this.event_targetChanged(this,e);if(b){for(g in i){this.event_update(this,i);break}if(d!==this.state&&(String(d)!=this.state||d.data!==this.state.data))this.event_stateChanged(this,d)}return true}return false},setState:function(b,d){var a=this.target||this.getRootDelegate();if(a!==this)return a.setState(b,d);a=String(b);if(!F[a])throw new Error("Wrong state value");if(this.state!=
a||this.state.data!=d){var c=this.state;this.state=Object(a);this.state.data=d;this.event_stateChanged(this,c);return true}return false},deprecate:function(){this.state!=v.PROCESSING&&this.setState(v.DEPRECATED)},update:function(b){var d=this.target||this.getRootDelegate();if(d!==this)return d.update(b);if(b){d={};var a=0;for(var c in b)if(this.data[c]!==b[c]){a++;d[c]=this.data[c];this.data[c]=b[c]}if(a){this.event_update(this,d);return d}}return false},setActive:function(b){b=!!b;if(this.active!=
b){this.active=b;this.event_activeChanged(this);r(this,this.subscribeTo,t.MASK*b);return true}return false},setSubscription:function(b){b=b&t.MASK;var d=this.subscribeTo^b;if(d){this.subscribeTo=b;this.active&&r(this,d,b);return true}return false},destroy:function(){this.active&&r(this,this.subscribeTo,0);this.delegate&&this.setDelegate();A.prototype.destroy.call(this);this.data=B;this.state=v.UNDEFINED;this.target=this.root=null}});C=x(null,{itemClass:j,keyGetter:C,map_:null,extendConstructor_:true,
init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(b){return this.get(this.keyGetter(b),b)},create:function(b){var d={};if(b instanceof j)d.delegate=b;else d.data={id:b,title:b};return new this.itemClass(d)},get:function(b,d){var a=b instanceof j?b.eventObjectId:b,c=this.map_[a];if(!c&&d){c=this.map_[a]=this.create(b,d);c.addHandler({destroy:function(){delete this.map_[a]}},this)}return c},destroy:function(){basis.Cleaner.remove(this);for(var b=y(this.map_),d=0,a;a=b[d++];)a.destroy()}});
var o=x(j,{state:v.UNDEFINED,itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:I("datasetChanged","dataset","delta")&&function(b,d){var a,c=0,e=0,f;if(a=d.inserted)for(;f=a[c];){this.item_[f.eventObjectId]=f;c++}if(a=d.deleted)for(;f=a[e];){delete this.item_[f.eventObjectId];e++}this.itemCount+=c-e;this.cache_=null;H.datasetChanged.call(this,b,d)},init:function(b){j.prototype.init.call(this,b);this.memberMap_={};this.item_={}},has:function(b){return!!(b&&this.item_[b.eventObjectId])},
getItems:function(){if(!this.cache_)this.cache_=y(this.item_);return this.cache_},pick:function(){for(var b in this.item_)return this.item_[b];return null},top:function(b){var d=[];if(b)for(var a in this.item_)if(d.push(this.item_[a])>=b)break;return d},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();j.prototype.destroy.call(this);this.cache_=E;this.itemCount=0;this.item_=this.memberMap_=null}}),l=x(o,{listen:{item:{destroy:function(b){this.memberMap_[b.eventObjectId]&&
this.remove([b])}}},init:function(b){o.prototype.init.call(this,b);if(b=this.items){this.set(b);this.items=null}},add:function(b){for(var d,a=this.memberMap_,c=[],e=this.listen.item,f=0;f<b.length;f++){var i=b[f];if(i instanceof j){var m=i.eventObjectId;if(!a[m]){a[m]=i;e&&i.addHandler(e,this);c.push(i)}}}if(c.length)this.event_datasetChanged(this,d={inserted:c});return d},remove:function(b){for(var d,a=this.memberMap_,c=[],e=this.listen.item,f=0;f<b.length;f++){var i=b[f];if(i instanceof j){var m=
i.eventObjectId;if(a[m]){e&&i.removeHandler(e,this);delete a[m];c.push(i)}}}if(c.length)this.event_datasetChanged(this,d={deleted:c});return d},set:function(b){if(!this.itemCount)return this.add(b);if(!b.length)return this.clear();for(var d=this.memberMap_,a={},c=[],e=[],f,i,m=this.listen.item,g=0;g<b.length;g++){f=b[g];if(f instanceof j){i=f.eventObjectId;a[i]=f;if(!d[i]){d[i]=f;m&&f.addHandler(m,this);e.push(f)}}}for(i in d)if(!a[i]){f=d[i];m&&f.removeHandler(m,this);delete d[i];c.push(f)}var n;
b={};var s;if(e&&e.length)s=b.inserted=e;if(c&&c.length)s=b.deleted=c;if(s)n=b;if(c=n)this.event_datasetChanged(this,c);return c},sync:function(b,d){if(b){l.setAccumulateState(true);for(var a=this.memberMap_,c,e,f={},i=[],m,g=0;g<b.length;g++){c=b[g];if(c instanceof j){e=c.eventObjectId;f[e]=c;a[e]||i.push(c)}}for(e in this.item_)f[e]||this.item_[e].destroy();if(d&&i.length)m=this.add(i);l.setAccumulateState(false);return m}},clear:function(){var b,d=this.getItems(),a=this.listen.item;if(d.length){if(a)for(b=
d.length;b-- >0;)d[b].removeHandler(a,this);this.event_datasetChanged(this,b={deleted:d});this.memberMap_={}}return b}});l.setAccumulateState=function(){function b(g){var n=g.dataset;e.call(n,n,g)}function d(g,n){var s=g.eventObjectId,G=n.inserted,K=n.deleted,q=m[s];if(G&&K){if(q){delete m[s];b(q)}return e.call(g,g,n)}if(q){var h=q[G?"inserted":"deleted"];if(h)return h.push.apply(h,G||K);else b(q)}m[s]=n;n.dataset=g}function a(){f=1;setAccumulateState(false)}var c=o.prototype,e=c.event_datasetChanged,
f=0,i,m={};return function(g){if(g){if(f==0){c.event_datasetChanged=d;i=setTimeout(a,0)}f++}else{f-=f>0;if(f==0){clearTimeout(i);c.event_datasetChanged=e;g=m;m={};y(g).forEach(b)}}}}();basis.namespace("basis.data",z).extend({STATE:v,SUBSCRIPTION:t,Object:j,DataObject:j,KeyObjectMap:C,AbstractDataset:o,Dataset:l})})(basis,this);
(function(r,z){function x(d,a,c,e){a=a.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i);for(var f=j(),i,m=0;m<a.length;m++){if(m%2){i=a[m].split(/\|/);d.getters[i[0]]=c+"childNodes["+e+"]";i=i.length>1?i[1]:i[0]}else i=a[m].length?a[m]:null;if(i!=null){if(t){f.lastChild&&f.appendChild(H.createComment(""));e++}f.appendChild(o(i));e++}}return f}function A(d){return function(a){if(!(a&&a.type=="click"&&a.which==3)){var c=r.dom.event.sender(a),e,f;do if(e=c.getAttributeNode&&c.getAttributeNode(d))break;while(c=
c.parentNode);if(c&&e){do if(f=c.basisObjectId)if((f=v[f])&&f.templateAction){c=e.nodeValue.qw();e=0;for(var i;i=c[e++];)f.templateAction(i,r.dom.event(a));break}while(c=c.parentNode)}}}}function y(d,a,c){a=a.trim();if(!a)return"";for(var e="",f;f=w.exec(a);){var i=f[2],m=f[4]||f[5]||i;if(f[3])d.getters[f[3]]=c+'.getAttributeNode("'+i+'")';if(f=i.match(/^event-([a-z]+)/i)){var g=f[1];if(!F[g]){F[g]=true;f=0;g=r.dom.event.browserEvents(g);for(var n;n=g[f++];)r.dom.event.addGlobalHandler(n,A(i))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(s,G){s=r.dom.event(s);var K=this,q;do if(q=K.basisObjectId)if((q=v[q])&&q.templateAction){K=G.qw();for(var h=0,k;k=K[h++];)q.templateAction(k,r.dom.event(s));break}while(K=K.parentNode)}}e+=i=="class"?m.trim().replace(/^(.)|\s+/g,".$1"):"["+i+(m?"="+m.quote('"'):"")+"]"}return e}function C(d,a){if(!d.stack)d.stack=[];if(!d.source)d.source=d.str;a||(a=".");for(var c=j(),e,f=0,i,m=d.stack;i=p.exec(d.str);){e=RegExp.leftContext;d.str=d.str.substr(e.length+i[0].length);if(e.length){c.appendChild(x(d,
e,a,f));f=c.childNodes.length}if(i[5])if(i[5]==m[m.length-1]){m.pop();return c}else throw"Wrong end tag";if(i[6]){if(i[7])d.getters[i[7]]=a+"childNodes["+f+"]";c.appendChild(H.createComment(i[6]))}else{e=i[1];var g=i[2],n=!!i[4],s=a+"childNodes["+f+"]";i=B.createElement(e+y(d,i[3],s));if(g)d.getters[g]=s;if(!n){m.push(e);i.appendChild(C(d,s+"."))}c.appendChild(i)}f++}d.str.length&&c.appendChild(x(d,d.str,a,f));if(m.length)throw"No end tag for "+m.reverse();return c}function I(d){if(!this.proto){d=
this.source;if(typeof d=="function")this.source=d=d();d=d.trim();d={str:d,getters:{element:".childNodes[0]"}};var a=C(d);d=Object.iterate(d.getters,function(m,g){for(var n=m.split(/\|/).map(String.format,"obj_.{0}"),s=g.split(/(\.?childNodes\[(\d+)\])/),G=a,K=0;K<s.length;K+=3){var q=s[K+2];if(!q)break;s[K+2]="";G=G.childNodes[q];if(G.previousSibling)G.nextSibling||(s[K+1]=".lastChild");else s[K+1]=".firstChild"}return{name:n[0],alias:n.join("="),path:"dom_"+s.join("")}}).sortAsObject("path");for(var c=
0;c<d.length;c++)for(var e=new RegExp("^"+d[c].path.forRegExp()),f=c+1,i;i=d[f++];)i.path=i.path.replace(e,d[c].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(m,g){obj_=m||{};dom_=proto_.cloneNode(true);_code_();if(g&&obj_.element){var n=obj_.element.basisObjectId=map_.seed++;map_[n]=g}return obj_}.toString().replace("_code_()",d.map(String.format,"{alias}={path};\n").join(""))))(a,v);this.clearInstance=(new Function("map_","var obj_; return "+function(m){obj_=
m;(m=obj_.element&&obj_.element.basisObjectId)&&delete map_[m];_code_()}.toString().replace("_code_()",d.map(String.format,"{alias}=null;\n").join(""))))(v)}}var H=z.document,B=r.dom,E=r.Class,F={},v={seed:1},p=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,w=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;B.createFragment();var t=B.createElement("","a","b").cloneNode(true).childNodes.length==
1,j=B.createFragment,o=B.createText,l=E(null,{__extend__:function(d){return d instanceof l?d:new l(d)},init:function(d){this.source=d},createInstance:function(d,a){I.call(this);return this.createInstance(d,a)},clearInstance:function(){I.call(this)}}),b=H.createElement("DIV");return r.namespace("basis.html").extend({Template:l,escape:function(d){return B.createElement("DIV",B.createText(d)).innerHTML},unescape:function(d){b.innerHTML=d;return b.firstChild.nodeValue},string2Html:function(d){b.innerHTML=
d;return B.createFragment.apply(null,Array.from(b.childNodes))}})})(basis,this);
(function(r){function z(h){return h.sortingValue||0}function x(h,k){h=h.sortingValue||0;k=k.sortingValue||0;return+(h>k)||-(h<k)}function A(h,k){h=h.sortingValue||0;k=k.sortingValue||0;return-(h>k)||+(h<k)}function y(h){return h.childNodes.sort(h.localSortingDesc?A:x)}function C(h,k){var u=k.length-1;h.childNodes=k;h.firstChild=k[0]||null;h.lastChild=k[u]||null;for(var D=u;u=k[D];D--){u.nextSibling=k[D+1]||null;u.previousSibling=k[D-1]||null;h.insertBefore(u,u.nextSibling)}}function I(h,k){var u=
h.childFactory||h.document&&h.document.childFactory,D;k=Object.extend({document:h.document,contextSelection:h.selection||h.contextSelection},k);if(u){D=u.call(h,k);if(D instanceof h.childClass)return D}if(!D)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(h.childClass&&h.childClass.className)+" but "+(D&&D.constructor&&D.constructor.className)+")";}function H(){return r.ui.apply(this,arguments)}var B=r.Class,E=r.dom,F=r.data,v=F.SUBSCRIPTION,
p=F.DataObject,w=F.AbstractDataset,t=F.Dataset,j=E.AXIS_DESCENDANT,o=E.AXIS_DESCENDANT_OR_SELF,l=Function.getter,b=Object.complete,d=E.axis;F=r.EventObject.createEvent;var a=r.EventObject.event,c={NONE:"none",PARENT:"parent",OWNER:"owner"};v.add("DATASOURCE",{dataSourceChanged:function(h,k){this.remove(h,k);this.add(h,h.dataSource)}},function(h,k){h(k,k.dataSource)});var e=B.ExtensibleProperty(),f={ownerChanged:function(){},destroy:function(h){E.replace(h.element,this)}},i=function(){var h=this.key,
k=this.config,u=this.owner,D=typeof k.existsIf!="function"||k.existsIf(u),L=u.satellite[h];if(D){D="delegate"in k;var P="dataSource"in k,Q=typeof k.delegate=="function"?k.delegate(u):null,J=typeof k.dataSource=="function"?k.dataSource(u):null;if(L){D&&L.setDelegate(Q);P&&L.setDataSource(J)}else{var M=u.tmpl[k.replace||h];L={owner:u};if(D)L.delegate=Q;if(P)L.dataSource=J;if(k.config)Object.complete(L,typeof k.config=="function"?k.config(u):k.config);L=new k.instanceOf(L);u.satellite[h]=L;if(M&&L instanceof
r.ui.Node&&L.element){E.replace(M,L.element);L.addHandler(f,M)}}}else if(L){L.destroy();L.owner=null;delete u.satellite[h]}},m=B.CustomExtendProperty({update:true},function(h,k){for(var u in k)h[u]=k[u]?i:null}),g=B(p,{event_update:function(h,k){p.prototype.event_update.call(this,h,k);var u=this.parentNode;if(u){u.matchFunction&&this.match(u.matchFunction);u.insertBefore(this,this.nextSibling)}},event_childNodesModified:F("childNodesModified","node","delta"),event_dataSourceChanged:F("dataSourceChanged",
"node","oldDataSource"),event_localGroupingChanged:F("localGroupingChanged","node","oldGroupingNode"),event_localSortingChanged:F("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:F("ownerChanged","node","oldOwner"),event_satellitesChanged:F("satellitesChanged","node","delta"),subscribeTo:p.prototype.subscribeTo+v.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegate:c.NONE,nodeType:"DOMWrapperNode",canHaveChildren:false,childNodes:null,
dataSource:null,colMap_:null,destroyDataSourceMember:true,document:null,parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:false,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:e,satellite:null,owner:null,init:function(h){var k=this.dataSource,u=this.childNodes,D=this.localGrouping;if(k)this.dataSource=null;p.prototype.init.call(this,h);if(D){this.localGrouping=null;this.setLocalGrouping(D)}if(this.canHaveChildren){this.childNodes=
[];if(k){this.dataSource=null;this.setDataSource(k)}else u&&this.setChildNodes(u)}else{if(u)this.childNodes=null;if(k)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==e)for(var L in this.satelliteConfig){h=this.satelliteConfig[L];if(B.isClass(h))h={instanceOf:h};if(typeof h=="object"){k={key:L,owner:this,config:h};h=h.hook?m.__extend__(h.hook):m;for(L in h)if(h[L]===i){this.addHandler(h,k);break}i.call(k)}}if(L=this.owner){this.owner=null;this.setOwner(L)}},appendChild:function(){},
insertBefore:function(){},removeChild:function(){},replaceChild:function(){},clear:function(){},hasChildNodes:function(){return this.childNodes.length>0},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(h){if(!h||h instanceof g==false)h=null;if(this.owner!==h){var k=this.owner,u=this.listen.owner;this.owner=h;if(u){k&&k.removeHandler(u,this);h&&h.addHandler(u,this)}this.event_ownerChanged(this,k);this.autoDelegate==
c.OWNER&&this.setDelagate(h)}},destroy:function(){p.prototype.destroy.call(this);if(this.dataSource)this.setDataSource();else this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping){this.localGrouping.destroy();this.localGrouping=null}this.owner&&this.setOwner();if(this.satellite){for(var h in this.satellite){var k=this.satellite[h];k.destroy();k.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=
this.childNodes=this.document=null}}),n=B(g,{autoDestroyIfEmpty:false,nodes:null,first:null,last:null,init:function(h){this.nodes=[];g.prototype.init.call(this,h)},insert:function(h,k){var u=this.nodes,D=k?u.indexOf(k):-1;if(D==-1){u.push(h);this.last=h}else u.splice(D,0,h);this.first=u[0];h.groupNode=this;this.event_childNodesModified(this,{inserted:[h]})},remove:function(h){var k=this.nodes;if(k.remove(h)){this.first=k[0]||null;this.last=k[k.length-1]||null;h.groupNode=null;this.event_childNodesModified(this,
{deleted:[h]})}!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var h=this.nodes,k=h.length;k-- >0;)h[k].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:h});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){g.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),s={canHaveChildren:true,childClass:g,childFactory:null,listen:{dataSource:{datasetChanged:function(h,k){var u={},D=[];if(k.deleted){u.deleted=
D;if(this.childNodes.length==k.deleted.length){D.push.apply(D,this.childNodes);var L=this.dataSource;this.dataSource=null;this.clear(true);this.dataSource=L;this.colMap_={}}else{L=0;for(var P;P=k.deleted[L];L++){P=P.eventObjectId;var Q=this.colMap_[P];delete this.colMap_[P];Q.canHaveDelegate=true;this.removeChild(Q);D.push(Q)}}}if(k.inserted){u.inserted=[];for(L=0;P=k.inserted[L];L++){Q=I(this,{cascadeDestroy:false,delegate:P});Q.canHaveDelegate=false;this.colMap_[P.eventObjectId]=Q;u.inserted.push(Q);
this.firstChild&&this.insertBefore(Q)}}this.firstChild?this.event_childNodesModified(this,u):this.setChildNodes(u.inserted);if(this.destroyDataSourceMember&&D.length)for(L=0;P=D[L];L++)P.destroy()},destroy:function(h){this.dataSource===h&&this.setDataSource()}}},appendChild:function(h){return this.insertBefore(h)},insertBefore:function(h,k){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(h.firstChild){var u=this;do if(u==h)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";
while(u=u.parentNode)}if(this.dataSource&&!this.dataSource.has(h.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(h instanceof this.childClass==false)h=I(this,h instanceof p?{delegate:h}:h);var D=h.parentNode===this,L=h.groupNode,P=this.localGrouping,Q=this.localSorting,J,M=this.childNodes,N,S,U=null;u=-1;var aa=false,R;if(D){R=h.nextSibling;S=h.previousSibling}if(Q){k=null;J=this.localSortingDesc;N=Q(h)||0;if(D)if(N===h.sortingValue)aa=true;
else if((!R||(J?R.sortingValue<=N:R.sortingValue>=N))&&(!S||(J?S.sortingValue>=N:S.sortingValue<=N))){h.sortingValue=N;aa=true}}if(P){U=P.getGroupNode(h);S=U.nodes;if(L===U)if(aa||D&&R===k)return h;if(Q)if(aa)u=R&&R.groupNode===U?S.indexOf(R):S.length;else{u=S.binarySearchPos(N,z,J);h.sortingValue=N}else u=k&&k.groupNode===U?S.indexOf(k):S.length;if(u<S.length)k=S[u];else if(U.last)k=U.last.nextSibling;else{u=U;for(k=null;u=u.nextSibling;)if(k=u.first)break}if(h===k||D&&h.nextSibling===k){if(L!==
U){L&&L.remove(h);U.insert(h)}return h}u=-1}else if(Q){if(aa)return h;u=M.binarySearchPos(N,z,J);k=M[u];h.sortingValue=N;if(h===k||D&&R===k)return h}else{if(k&&k.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(D){if(R===k)return h;if(h===k)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}if(D){if(h.nextSibling)h.nextSibling.previousSibling=h.previousSibling;else this.lastChild=h.previousSibling;if(h.previousSibling)h.previousSibling.nextSibling=
h.nextSibling;else this.firstChild=h.nextSibling;h.previousSibling=null;h.nextSibling=null;if(u==-1)M.remove(h);else{J=M.indexOf(h);M.splice(J,1);J<u&&u--}if(L){L.remove(h);L=null}}else h.parentNode&&h.parentNode.removeChild(h);L!=U&&U.insert(h,k);if(k){if(u==-1)u=M.indexOf(k);if(u==-1)throw"basis.dom.wrapper: Node was not found";h.nextSibling=k;M.splice(u,0,h)}else{u=M.length;M.push(h);k={previousSibling:this.lastChild};this.lastChild=h}h.parentNode=this;h.previousSibling=k.previousSibling;if(u==
0)this.firstChild=h;else k.previousSibling.nextSibling=h;k.previousSibling=h;var W=false,$=false,Y=this.selection||this.contextSelection;if(!h.document&&h.document!==this.document){W=this.document;h.document=this.document}if(!h.contextSelection&&h.contextSelection!==Y){h.contextSelection=Y;$=!h.selection;h.selected&&Y.add([h])}if(h.firstChild&&(W||$))d(h,j).forEach(function(O){if(W&&!O.document)O.document=W;if($&&!O.contextSelection){O.selected&&O.unselect();O.contextSelection=Y}});if(!D){h.match&&
h.match(this.matchFunction);h.autoDelegate==c.PARENT&&h.setDelegate(this);this.dataSource||this.event_childNodesModified(this,{inserted:[h]})}return h},removeChild:function(h){if(h==null||h.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(h instanceof this.childClass==false)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(h))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(h),
1);h.parentNode=null;if(h.nextSibling)h.nextSibling.previousSibling=h.previousSibling;else this.lastChild=h.previousSibling;if(h.previousSibling)h.previousSibling.nextSibling=h.nextSibling;else this.firstChild=h.nextSibling;h.nextSibling=null;h.previousSibling=null;h.document===this.document&&d(h,o).forEach(function(L){if(L.document==this.document)L.document=null},this);if(h.contextSelection){for(var k=h.contextSelection,u=h,D=[];u;){if(u.contextSelection===k){u.selected&&D.push(u);u.contextSelection=
null}if(!u.selection&&u.firstChild)u=u.firstChild;else if(u.nextSibling)u=u.nextSibling;else for(;u=u.parentNode;)if(u.nextSibling){u=u.nextSibling;break}}k.remove(D)}h.groupNode&&h.groupNode.remove(h);this.dataSource||this.event_childNodesModified(this,{deleted:[h]});h.autoDelegate==c.PARENT&&h.setDelegate();return h},replaceChild:function(h,k){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(k==null||k.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
this.insertBefore(h,k);return this.removeChild(k)},clear:function(h){if(this.dataSource)this.setDataSource();else if(this.firstChild){var k=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:k});for(var u=k.length;u-- >0;){var D=k[u];D.parentNode=null;D.groupNode=null;if(h){if(D.selection||D.document)d(D,E.AXIS_DESCENDANT_OR_SELF).forEach(function(L){if(this.selection&&L.selection===this.selection){L.selected&&L.selection.remove([L]);
L.selection=null}if(L.document===this.document)L.document=null},this);D.nextSibling=null;D.previousSibling=null;D.autoDelegate==c.PARENT&&D.setDelegate()}else D.destroy()}if(this.localGrouping){h=this.localGrouping.childNodes;for(u=h.length-1;k=h[u];u--)k.clear()}}},setChildNodes:function(h,k){this.dataSource||this.clear(!!k);if(h){if("length"in h==false)h=[h];if(h.length){var u=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var D=0,L=h.length;D<L;D++)this.insertBefore(h[D]);
this.event_childNodesModified=u;this.event_childNodesModified(this,{inserted:this.childNodes})}}},setDataSource:function(h){if(!h||!this.canHaveChildren||h instanceof w==false)h=null;if(this.dataSource!==h){var k=this.dataSource,u=this.listen.dataSource;this.dataSource=h;if(k){this.colMap_=null;u&&k.removeHandler(u,this);k.itemCount&&this.clear()}if(h){this.colMap_={};if(u){h.addHandler(u,this);h.itemCount&&u.datasetChanged&&u.datasetChanged.call(this,h,{inserted:h.getItems()})}}this.event_dataSourceChanged(this,
k)}},setLocalGrouping:function(h){if(typeof h=="function"||typeof h=="string")h={groupGetter:l(h)};if(h instanceof K==false)h=h!=null&&typeof h=="object"?new this.localGroupingClass(Object.complete({},h)):null;if(this.localGrouping!==h){var k=this.localGrouping,u;if(this.localGrouping){if(!h){this.localGrouping=null;if(this.firstChild){u=this.localSorting?y(this):this.childNodes;for(var D=u.length;D-- >0;)u[D].groupNode=null;C(this,u)}}k.setOwner()}if(h){this.localGrouping=h;h.setOwner(this);if(this.firstChild){u=
this.localSorting?y(this):this.childNodes;for(D=0;h=u[D];D++)h.groupNode=this.localGrouping.getGroupNode(h);u=u;for(D=0;h=u[D];D++)h.groupNode.nodes.push(h);u.length=0;for(D=this.localGrouping.nullGroup;D;D=D.nextSibling){h=D.nodes;D.first=h[0]||null;D.last=h[h.length-1]||null;u.push.apply(u,h);D.event_childNodesModified(D,{inserted:h})}C(this,u)}}this.event_localGroupingChanged(this,k)}},setLocalSorting:function(h,k){if(h)h=l(h);if(this.localSorting!=h||this.localSortingDesc!=!!k){var u=this.localSorting,
D=this.localSortingDesc;this.localSortingDesc=!!k;this.localSorting=h||null;if(h&&this.firstChild){var L=[],P;for(P=this.firstChild;P;P=P.nextSibling)P.sortingValue=h(P)||0;if(this.localGrouping)for(var Q=this.localGrouping.nullGroup;Q;Q=Q.nextSibling){P=Q.nodes=y({childNodes:Q.nodes,localSortingDesc:this.localSortingDesc});Q.first=P[0]||null;Q.last=P[P.length-1]||null;L.push.apply(L,P)}else L=y(this);C(this,L)}this.event_localSortingChanged(this,u,D)}},setMatchFunction:function(h){if(this.matchFunction!=
h){var k=this.matchFunction;this.matchFunction=h;for(var u=this.lastChild;u;u=u.previousSibling)u.match(h);this.event_matchFunctionChanged(this,k)}}};v=B(g,{event_enable:F("enable","node"),event_disable:F("disable","node"),event_select:F("select","node"),event_unselect:F("unselect","node"),event_match:F("match","node"),event_unmatch:F("unmatch","node"),event_matchFunctionChanged:F("matchFunctionChanged","node","oldMatchFunction"),selectable:true,selected:false,selection:null,contextSelection:null,
matchFunction:null,matched:true,disabled:false,init:function(h){if(this.selection&&this.selection instanceof w==false)this.selection=new q(this.selection);g.prototype.init.call(this,h);this.disabled&&this.event_disable(this);if(this.selected){this.selected=false;this.select(true)}},setSelection:function(h){if(this.selection==h)return false;var k=this.selection;d(this,j,function(u){if(u.contextSelection==k){u.selected&&k&&k.remove([u]);u.contextSelection=h}});this.selection=h;return true},hasOwnSelection:function(){return!!this.selection},
select:function(h){var k=this.selected,u=this.contextSelection;if(u)if(h)k?u.remove([this]):u.add([this]);else this.selectable&&u.set([this]);else if(!k&&this.selectable&&!this.isDisabled()){this.selected=true;this.event_select(this)}return this.selected!=k},unselect:function(){var h=this.selected;if(h){var k=this.contextSelection;if(k)k.remove([this]);else{this.selected=false;this.event_unselect(this)}}return this.selected!=h},enable:function(){if(this.disabled){this.disabled=false;this.event_enable(this)}},
disable:function(){if(!this.disabled){this.disabled=true;this.event_disable(this)}},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!E.findAncestor(this,l("disabled"))},match:function(h){if(typeof h!="function")h=null;this.underMatch_&&!h&&this.underMatch_(this,true);this.underMatch_=h;h=!h||h(this);if(this.matched!=h)(this.matched=h)?this.event_match(this):this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){if(this.hasOwnSelection()){this.selection.destroy();
delete this.selection}this.unselect();g.prototype.destroy.call(this)}});var G=B(v,s,{}),K=B(g,s,{event_childNodesModified:function(h,k){a.childNodesModified.call(this,h,k);this.nullGroup.nextSibling=this.firstChild;if(k.inserted&&this.dataSource&&this.nullGroup.first)for(var u=this.owner,D=Array.from(this.nullGroup.nodes),L=D.length;L-- >0;)u.insertBefore(D[L],D[L].nextSibling)},event_ownerChanged:function(h,k){k&&k.localGrouping===this&&k.setLocalGrouping(null,true);this.owner&&this.owner.localGrouping!==
this&&this.owner.setLocalGrouping(this);a.ownerChanged.call(this,h,k);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:true,autoDestroyEmptyGroups:true,titleGetter:l("data.title"),groupGetter:Function.$undef,childClass:n,childFactory:function(h){return new this.childClass(b(h,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?false:this.autoDestroyEmptyGroups}))},init:function(h){this.map_={};this.nullGroup=new n({autoDestroyIfEmpty:false});
g.prototype.init.call(this,h)},getGroupNode:function(h){h=this.groupGetter(h);var k=h instanceof p,u=this.map_[k?h.eventObjectId:h];if(!u&&!this.dataSource)u=this.appendChild(k?{delegate:h}:{data:{id:h,title:h}});return u||this.nullGroup},insertBefore:function(h,k){h=s.insertBefore.call(this,h,k);if("groupId_"in h==false){h.groupId_=h.delegate?h.delegate.eventObjectId:h.data.id;this.map_[h.groupId_]=h}if(h.first){var u=this.owner,D=u.childNodes,L=h.first,P=h.last,Q,J,M;for(Q=h;Q=Q.previousSibling;)if(M=
Q.last)break;if(!M)M=this.nullGroup.last;for(Q=h;Q=Q.nextSibling;)if(J=Q.first)break;if(L.previousSibling!==M||P.nextSibling!==J){if(L.previousSibling)L.previousSibling.nextSibling=P.nextSibling;if(P.nextSibling)P.nextSibling.previousSibling=L.previousSibling;Q=D.splice(D.indexOf(L),h.nodes.length);var N=D.indexOf(J);Q.unshift(N!=-1?N:D.length,0);D.splice.apply(D,Q);L.previousSibling=M;P.nextSibling=J;if(M)M.nextSibling=L;if(J)J.previousSibling=P;u.firstChild=D[0];u.lastChild=D[D.length-1]}}return h},
removeChild:function(h){s.removeChild.call(this,h);delete this.map_[h.groupId_];return h},clear:function(){s.clear.call(this);this.map_={}},destroy:function(){this.setOwner();g.prototype.destroy.call(this);this.map_=null}});g.prototype.localGroupingClass=K;F=B(w,{autoDestroy:true,sourceNode:null,listen:{sourceNode:{childNodesModified:function(h,k){var u=this.memberMap_,D={},L=0,P=0,Q=k.inserted,J=k.deleted;if(Q&&Q.length)for(D.inserted=Q;h=Q[L];){u[h.eventObjectId]=h;L++}if(J&&J.length)for(D.deleted=
J;h=J[P];){delete u[h.eventObjectId];P++}if(L||P)this.event_datasetChanged(this,D)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:F("sourceNodeChanged")&&function(h,k){a.sourceNodeChanged.call(this,h,k);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:false,init:function(h,k){w.prototype.init.call(this,k);h&&this.setSourceNode(h)},setSourceNode:function(h){if(h instanceof g==false)h=null;if(h!==this.sourceNode){var k=this.sourceNode,
u=this.listen.sourceNode;this.sourceNode=h;if(u){var D=u.childNodesModified;if(k){k.removeHandler(u,this);D&&D.call(this,k,{deleted:k.childNodes})}if(h){h.addHandler(u,this);D&&D.call(this,h,{inserted:h.childNodes})}}this.event_sourceNodeChanged(this,k)}},destroy:function(){this.setSourceNode();w.prototype.destroy.call(this)}});var q=B(t,{multiple:false,event_datasetChanged:function(h,k){t.prototype.event_datasetChanged.call(this,h,k);if(k.inserted)for(var u=0,D;D=k.inserted[u];u++)if(!D.selected){D.selected=
true;D.event_select()}if(k.deleted)for(u=0;D=k.deleted[u];u++)if(D.selected){D.selected=false;D.event_unselect()}},add:function(h){if(!this.multiple)if(this.itemCount)return this.set(h);else h.splice(1);for(var k=[],u=0,D;D=h[u];u++)D.contextSelection==this&&D.selectable&&k.push(D);return t.prototype.add.call(this,k)},set:function(h){for(var k=[],u=0,D;D=h[u];u++)D.contextSelection==this&&D.selectable&&k.push(D);this.multiple||h.splice(1);return t.prototype.set.call(this,k)}});r.namespace("basis.dom.wrapper",
H).extend({DELEGATE:c,AbstractNode:g,InteractiveNode:v,Node:G,GroupingNode:K,PartitionNode:n,simpleTemplate:H,ChildNodesDataset:F,Selection:q})})(basis);
(function(r,z){function x(k,u){return C(u,true).getRule(k,true)}function A(k,u){var D=k.match(/^([^{]+)\{(.*)\}\s*$/);if(D){for(var L=D[1].trim().split(/\s*,\s*/),P=0;P<L.length;P++)this.addRule(L[P],D[2]||null,u++);return u-1}}function y(k,u){var D=j.createElement(!k?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:u?"alternate ":"",url:k.quote('"')}));j.tag(null,"HEAD")[0].appendChild(D);D=D.sheet||D.styleSheet;try{if(!D.cssRules)D.cssRules=D.rules}catch(L){}if(!D.insertRule)D.insertRule=
A;if(!D.deleteRule)D.deleteRule=D.removeRule;return D}function C(k,u){k||(k="DefaultGenericStyleSheet");if(!c[k])if(u)c[k]=new i(y());return c[k]}function I(k,u,D,L){L=L||{};u=u.qw();for(var P=0,Q;Q=u[P];P++)if(typeof f.style[Q]!="undefined"){if(D)r.platformFeature["css-"+k]=Q;e[k]={key:Q,getter:L[Q]};return}}function H(k,u){var D=e[k];if(k=D?D.key:k.replace(/^-ms-/,"ms-").camelize())return{key:k,value:D&&D.getter?D.getter(u):u}}function B(k,u,D){if(typeof k.setProperty=="function")return k.setProperty(u,
D);if(u=H(u,D))return k.style[u.key]=u.value}function E(k,u){for(var D in u)B(k,D,u[D]);return k}function F(k,u){return B(k,"display",typeof u=="string"?u:u?"":"none")}function v(k,u){return B(k,"visibility",u?"":"hidden")}function p(k){return G[k]||(G[k]=new RegExp("\\s*\\b"+k+"\\b"))}function w(k,u){var D=(u?"g":"s")+k;return q[D]||(q[D]=new RegExp((u?"":"\\s*")+"\\b"+k+"\\S*\\b"))}var t=z.document,j=r.dom,o=r.dom.event,l=r.Class,b=/\s*!important/i,d=String("important"),a=1,c={},e={},f=j.createElement("DIV");
I("opacity","opacity MozOpacity KhtmlOpacity filter",true,{fitler:function(k){return"alpha(opacity:"+parseInt(k*100)+")"}});I("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",true);I("float","cssFloat styleFloat");var i=l(null,{styleSheet:null,rules:null,init:function(k){this.styleSheet=k;this.rules=[];this.map_={}},getRule:function(k,u){if(!this.map_[k])if(u){for(var D=this.styleSheet,L=this.rules.length,P=D.insertRule(k+"{}",L),Q=L;Q<=P;Q++)this.rules.push(new m(D.cssRules[Q]));
this.map_[k]=L!=P?new g(this.rules.splice(L)):this.rules[L]}return this.map_[k]},deleteRule:function(k){var u=this.map_[k];if(u){u=u.rules||[u];for(var D=0;D<u.length;D++){var L=this.rules.indexOf(u[D]);this.stylesheet.deleteRule(L);this.rules.splice(L,1)}delete this.map_[k]}},destroy:function(){delete this.rules}}),m=l(null,{rule:null,selector:"",init:function(k){if(k){this.rule=k;this.selector=k.selectorText}},setProperty:function(k,u){var D,L=!!b.test(u),P=this.rule.style;if(L||(P.getPropertyPriority?
P.getPropertyPriority(k)==d:false)){u=u.replace(b,"");if(D=H(k,u)){var Q=D.key;if(P.setProperty){L||P.removeProperty(Q);P.setProperty(Q,D.value,L?d:"")}else{D=Q+": "+D.value+(L?" !"+d:"")+";";P.cssText=P.cssText.replace(new RegExp(P[Q]?Q+"\\s*:\\s*"+P[Q]+"(\\s*!"+d+")?\\s*;?":"^","i"),D)}}}else B(this.rule,k,u)},setStyle:function(k){Object.iterate(k,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),g=l(null,{rules:null,init:function(k){this.rules=
k},destroy:function(){delete this.rules}});["setProperty","setStyle","clear"].forEach(function(k){g.prototype[k]=function(){for(var u,D=0;u=this.rules[D];D++)u[k].apply(u,arguments)}});var n={};["em","ex","px","%"].forEach(function(k){n[k=="%"?"percent":k]=function(u){return u==0||isNaN(u)?"0":u+k}});var s,G={},K=l(null,{init:function(k){this.element=k},toString:function(){return this.element.className},set:function(k){this.clear();k.qw().forEach(this.add,this)},replace:function(k,u,D){D=D||"";typeof k!=
"undefined"&&this.remove(D+k);typeof u!="undefined"&&this.add(D+u)},bool:function(k,u){u?this.add(k):this.remove(k)},clear:function(){this.element.className=""},contains:function(k){return!!this.element.className.match(p(k))},item:function(k){return this.element.className.qw()[k]},add:function(k){this.element.className.match(p(k))||(this.element.className+=" "+k)},remove:function(k){var u=this.element.className;k=u.replace(p(k),"");if(k!=u)this.element.className=k},toggle:function(k){var u=this.contains(k);
u?this.remove(k):this.add(k);return!u}}),q={},h=l(null,{delim:"-",init:function(k,u){this.classList=u;this.prefix=k+this.delim},add:function(k){this.classList.add(this.prefix+k)},remove:function(k){this.classList.remove(this.prefix+k)},items:function(){var k=this.classList.toString();if(k)return k.toString().match(w(this.prefix,true))},set:function(k){var u=this.items();k=typeof k!="undefined"?this.prefix+k:"";var D=this.classList;if(u)if(u.length==1){if(u[0]===k)return;D.remove(u[0])}else this.clear();
k&&D.add(k)},clear:function(){this.items().forEach(this.classList.remove,this.classList)}});if(z.DOMTokenList&&t.documentElement.classList){l=K.prototype;Object.extend(z.DOMTokenList.prototype,{set:l.set,replace:l.replace,bool:l.bool,clear:function(){for(var k=this.length;k-- >0;)this.remove(this[k])},setPrefixToken:l.setPrefixToken});s=function(k){return(typeof k=="string"?j.get(k):k).classList}}else s=function(k){return new K(typeof k=="string"?j.get(k):k)};o.onLoad(function(){s(t.body).bool("opacity-not-support",
!r.platformFeature["css-opacity"])});j.extend({setStyleProperty:B,setStyle:E,display:F,show:function(k){return F(k,1)},hide:function(k){return F(k)},visibility:v,visible:function(k){return v(k,1)},invisible:function(k){return v(k)}});return r.namespace("basis.cssom").extend({setStyleProperty:B,setStyle:E,classList:function(k,u){return u?new h(u,s(k)):s(k)},uniqueRule:function(k){var u="genericRule-"+a++;k&&s(k).add(u);k=x("."+u);k.token=u;return k},cssRule:x,getStyleSheet:C,addStyleSheet:y,CssStyleSheetWrapper:i,
CssRuleWrapper:m,CssRuleWrapperSet:g}).extend(n)})(basis,this);
(function(r){function z(o){return!!(!(o%400)||o%100&&!(o%4))}function x(o,l){return o==1?28+z(l):I[o]}function A(o,l){return l.replace(w,function(b,d){return v[d](o)})}function y(o,l,b,d,a,c,e){return new Date(o,l-1,b,d||0,a||0,c||0,e||0)}var C=Function.getter,I=[31,28,31,30,31,30,31,31,30,31,30,31],H={day:864E5,hour:36E5,minute:6E4,second:1E3},B="year month day hour minute second millisecond".qw(),E={},F={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(o,l){E[o]=C("get"+l+"()");F[o]=new Function("d,v","d.set"+l+"(v)")});var v={y:C("getFullYear().toString().substr(2)"),Y:C("getFullYear()"),d:C("getDate()"),D:C("getDate()","{0:02}"),m:C("getMonth() + 1"),M:C("getMonth() + 1","{0:02}"),h:C("getHours()"),H:C("getHours()","{0:02}"),i:C("getHours() % 12 || 12","{0:02}"),p:C("getHours() > 12",{"true":"pm","false":"am"}),P:C("getHours() > 12",{"true":"PM","false":"AM"}),I:C("getMinutes()","{0:02}"),s:C("getSeconds()"),
S:C("getSeconds()","{0:02}"),z:C("getMilliseconds()"),Z:C("getMilliseconds()","{0:03}")},p=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,w=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return z(this.getFullYear())},getMonthDayCount:function(){return x(this.getMonth(),this.getFullYear())},add:function(o,l){var b=E[o];if(!b)throw new Error("Unknown date part: "+o);var d;if(o=="year"||o=="month"){d=this.getDate();d>28&&this.setDate(1)}F[o](this,
b(this)+l);if(d>28){b=this.getMonthDayCount();d>b&&this.setDate(b)}return this},diff:function(o,l){if(o=="year"||o=="month"){var b=Number(this)-Number(l)>0?-1:1,d=b>0?this:l,a=b>0?l:this,c=d.getFullYear();c=a.getFullYear()-c;if(o=="year")return b*c;d=d.getMonth();a=a.getMonth();return b*(c?(c>1?(c-1)*12:0)+(11-d)+(a+1):a-d)}else{b=Math.floor((l-this)/H[o]);return b+Number(E[o](new Date(l-b*H[o]))-E[o](this)!=0)}},set:function(o,l){var b=F[o];if(!b)throw new Error("Unknown date part: "+o);var d;if(o==
"year"||o=="month"){d=this.getDate();d>28&&this.setDate(1)}b(this,l);if(d>28){b=this.getMonthDayCount();d>b&&this.setDate(b)}return this},get:function(o){if(E[o])return E[o](this);throw new Error("Unknown date part: "+o);},toISODateString:function(){return A(this,"%Y-%M-%D")},toISOTimeString:function(){return A(this,"%H:%I:%S.%Z")},fromDate:function(o){if(o instanceof Date){this.setFullYear(o.getFullYear(),o.getMonth(),o.getDate());this.setTime(o.getTime())}return this},toFormat:function(o){return A(this,
o)}});var t=Date.prototype.toISOString;if(t&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return t.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(o){var l=String(o).match(p);if(!l)throw new Error("Value of date isn't in ISO format: "+o);l[2]-=1;o=0;for(var b;b=B[o];o++)this.set(b,l[o+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,
toODBCTime:Date.prototype.toISOTimeString,toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var j=/\D/;Date.fromISOString=function(o){return o?y.apply(null,String(o).split(j)):null};Date.timer=function(o){var l=o||new Date;l.measure=function(b){return b?((new Date-l)/1E3).toFixed(3):new Date-l};return l};r.namespace("basis.date").extend({isLeapYear:z,getMonthDayCount:x,format:A})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.html.Template,y=r.cssom.classList,C=Function.getter,I=r.Cleaner,H=r.dom.wrapper.Node,B=r.dom.wrapper.PartitionNode,E=r.dom.wrapper.GroupingNode,F=z.ExtensibleProperty(),v=function(w){return{template:new A("<div/>"),action:F,cssClassName:null,event_update:function(t,j){this.templateUpdate(this.tmpl,"update",j);w.event_update.call(this,t,j)},event_select:function(t){w.event_select.call(this,t);y(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(t){w.event_unselect.call(this,t);y(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(t){w.event_disable.call(this,t);y(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(t){w.event_enable.call(this,t);y(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(t){w.event_match.call(this,t);x.display(this.element,true)},event_unmatch:function(t){w.event_unmatch.call(this,t);x.display(this.element,
false)},init:function(t){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere){this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode;this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere}if(this.content)x.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=x.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;w.init.call(this,t);if(this.id)this.element.id=
this.id;if(t=this.cssClassName){if(typeof t=="string")t={element:t};for(var j in t){var o=this.tmpl[j];if(o){o=y(o);for(var l=String(t[j]).qw(),b=0,d;d=l[b++];)o.add(d)}}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&x.insert(this.container,this.element)},templateAction:function(t,j){var o=this.action[t];o&&o.call(this,j)},templateUpdate:function(){},destroy:function(){var t=this.element;w.destroy.call(this);t&&t.parentNode&&t.parentNode.removeChild(t);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}};H=z(H,v,{});C=z(B,v,{titleGetter:C("data.title"),templateUpdate:function(w){if(w.titleText)w.titleText.nodeValue=String(this.titleGetter(this))}});v=function(w){return{insertBefore:function(t,j){t=w.insertBefore.call(this,t,j);var o=t.groupNode||this,l=t.nextSibling;o=o.childNodesElement||o.element||this.childNodesElement||this.element;var b=t.element;l=(l&&l.element.parentNode==o?l.element:null)||o.insertPoint||null;if(b.parentNode!==o||
b.nextSibling!==l)o.insertBefore(b,l);return t},removeChild:function(t){w.removeChild.call(this,t);var j=t.element,o=j.parentNode;o&&o.removeChild(j);return t},clear:function(t){if(t)for(var j=this.firstChild;j;){var o=j.element;o.parentNode&&o.parentNode.removeChild(o);j=j.nextSibling}w.clear.call(this,t)},setChildNodes:function(t,j){var o=x.createFragment(),l=this.localGrouping||this,b=l.childNodesElement||l.element;l.childNodesElement=o;w.setChildNodes.call(this,t,j);b.insertBefore(o,b.insertPoint||
null);l.childNodesElement=b}}};B=z(E,v,{childClass:C,localGroupingClass:z.SELF,event_ownerChanged:function(w,t){var j=this,o=this.owner,l=null;if(o){l=o.tmpl&&o.tmpl.groupsElement||o.childNodesElement||o.element;l.appendChild(this.nullElement)}do j.element=j.childNodesElement=l;while(j=j.localGrouping);E.prototype.event_ownerChanged.call(this,w,t)},init:function(w){this.element=this.childNodesElement=this.nullElement=x.createFragment();E.prototype.init.call(this,w)}});var p=z(H,v,{childClass:H,childFactory:function(w){return new this.childClass(w)},
localGroupingClass:B});z=z(p,{selection:{},init:function(w){this.document=this;p.prototype.init.call(this,w);I.add(this)},destroy:function(){if(this.selection){this.selection.destroy();this.selection=null}p.prototype.destroy.call(this);I.remove(this)}});v=function(w,t){for(var j=w.match(/\{(this_[^\}]+)\}/g)||[],o=[],l=0;l<j.length;l++){var b=j[l].match(/\{(this_[^\|\}]+)\}/)[1];o.push("this.tmpl."+b+".nodeValue = "+b.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(d){return Object.extend({template:tmpl_,
templateUpdate:function(a,c,e){d.templateUpdate.call(this,a,c,e);_code_()}},config_)}.toString().replace("_code_()",o.join(";\n")))(new A(w),t)};r.namespace("basis.ui",v).extend({simpleTemplate:v,Node:H,Container:p,PartitionNode:C,GroupingNode:B,Control:z})})(basis);
(function(r,z){function x(g,n){if(f)try{return parseFloat(I.getComputedStyle(g,null)[n])}catch(s){return 0}else return 0}function A(g,n){if(f)return x(g,"height");else{v.setStyle(n,{borderTop:g.currentStyle.borderTopWidth+" solid red",borderBottom:g.currentStyle.borderBottomWidth+" solid red",paddingTop:g.currentStyle.paddingTop,paddingBottom:g.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"});return g.offsetHeight-n.offsetHeight}}function y(g,n){if(e){p(g).add("Basis-Layout-OnResizeElement");
g.onresize=n}else{var s=B.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});B.insert(g,s);s.onload=function(){(s.contentWindow.onresize=n)()}}}for(var C=z.document,I=C.defaultView,H=r.Class,B=r.dom,E=r.ua,F=Object.extend,v=r.cssom,p=r.cssom.classList,w=r.ui.Container,t=E.test("IE"),j=E.test("IE7+"),o=false,l=B.createElement(""),b=["","-webkit-"],d=0;d<b.length;d++)try{var a=b[d]+"box";
l.style.display=a;if(l.style.display==a){o=b[d];break}}catch(c){}var e=typeof l.onresize!="undefined",f=I&&I.getComputedStyle;l=function(){return B.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};l.className="basis.Layout.Helper";var i={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:false},m=H(null,{init:function(g,n,s){this.reset();this.setElement(g,n,s)},setElement:function(g,n,s){this.element=
B.get(g);this.offsetElement=s;n||this.recalc(this.offsetElement)},copy:function(g){["top","left","bottom","right","height","width","defined"].forEach(function(n){this[n]=g[n]},this)},reset:function(){F(this,i)},set:function(g,n){if(this.defined){switch(g.toLowerCase()){case "left":this.left=n;this.right=this.left+this.width;break;case "right":this.right=n;this.left=this.right-this.width;break;case "width":this.width=n;this.right=this.left+this.width;break;case "top":this.top=n;this.bottom=this.top+
this.height;break;case "bottom":this.bottom=n;this.top=this.bottom-this.height;break;case "height":this.height=n;this.bottom=this.top+this.height;break}if(this.width<=0||this.height<=0)this.reset()}return this},recalc:function(g){this.reset();var n=this.element;if(n){var s=n,G=C.documentElement;if(n.getBoundingClientRect){s=n.getBoundingClientRect();this.top=s.top;this.left=s.left;if(t)if(j){this.top+=G.scrollTop-G.clientTop;this.left+=G.scrollLeft-G.clientLeft}else if(n!=C.body){this.top-=C.body.clientTop-
C.body.scrollTop;this.left-=C.body.clientLeft-C.body.scrollLeft}if(g){g=new m(g);this.top-=g.top;this.left-=g.left;g.destroy()}}else if(C.getBoxObjectFor){var K=C.getBoxObjectFor(G);s=C.getBoxObjectFor(n);this.top=s.screenY-K.screenY;this.left=s.screenX-K.screenX;if(E.test("FF1.5-")){if(s=n.offsetParent){this.top-=s.scrollTop;this.left-=s.scrollLeft}if(s!=C.body){this.top+=G.scrollTop;this.left+=G.scrollLeft}}if(E.test("FF2+")){if(this.top){s=G.scrollTop;if(s>2){K=0;for(var q=Math.floor(Math.log(s)/
Math.LN2);q>=0;q-=3)K+=1<<q;if(s>K)this.top-=1}}if(this.left)this.left-=G.scrollLeft>1}if(g){g=new m(g);this.top-=g.top;this.left-=g.left;g.destroy()}}else if(n!=g){this.top=n.offsetTop;this.left=n.offsetLeft;this.top-=C.body.clientTop-C.body.scrollTop;for(this.left-=C.body.clientLeft-C.body.scrollLeft;(s=s.offsetParent)&&s!=g;){this.top+=s.offsetTop+s.clientTop-s.scrollTop;this.left+=s.offsetLeft+s.clientLeft-s.scrollLeft}}else this.top=this.left=0;this.width=n.offsetWidth;this.height=n.offsetHeight;
this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=true}return this.defined},intersection:function(g){if(!this.defined)return false;if(g instanceof m==false)g=new m(g);return g.defined&&g.right>this.left&&g.left<this.right&&g.bottom>this.top&&g.top<this.bottom},inside:function(g){if(!this.defined)return false;if(g instanceof m==false)g=new m(g);return g.defined&&g.left>=this.left&&g.right<=this.right&&g.bottom>=this.bottom&&g.top<=this.top},point:function(g){if(!this.defined)return false;
var n=g.left||g.x||0;g=g.top||g.y||0;return n>=this.left&&n<this.right&&g>=this.top&&g<this.bottom},power:function(g){if(!this.defined)return false;if(g=B.get(g)||this.element){B.setStyle(g,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"});return true}},destroy:function(){delete this.element}});b=H(m,{init:function(g,n,s){this.setBoxes(g,n,s)},setBoxes:function(g,n,s){this.boxA=g instanceof m?g:new m(g,true);this.boxB=n instanceof m?n:new m(n,true);s||this.recalc()},
recalc:function(){this.reset();if(!this.boxA.recalc()||!this.boxB.recalc())return false;if(this.boxA.intersection(this.boxB)){this.top=Math.max(this.boxA.top,this.boxB.top);this.left=Math.max(this.boxA.left,this.boxB.left);this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom);this.right=Math.min(this.boxA.right,this.boxB.right);this.width=this.right-this.left;this.height=this.bottom-this.top;if(this.width<=0||this.height<=0)this.reset();else this.defined=true}return this.defined}});d=H(m,{recalc:function(){this.reset();
var g=this.element;if(g){var n=g;this.width=g.clientWidth;this.height=g.clientHeight;if(g.getBoundingClientRect){var s=g.getBoundingClientRect();this.top=s.top;for(this.left=s.left;n=n.offsetParent;){this.top-=n.scrollTop;this.left-=n.scrollLeft}}else if(C.getBoxObjectFor){s=C.getBoxObjectFor(g);this.top=s.y;for(this.left=s.x;n=n.offsetParent;){this.top-=n.scrollTop;this.left-=n.scrollLeft}}else{s=new m(g);this.top=s.top+g.clientTop;this.left=s.left+g.clientLeft}this.bottom=this.top+this.height;this.right=
this.left+this.width;this.defined=true}return this.defined}});v.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});a=v.cssRule(".Basis-VerticalPanelStack");a.setStyle({overflow:"hidden"});if(o!==false){a.setProperty("display",o+"box");a.setProperty(o+"box-orient","vertical")}a=H(w,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(g){w.prototype.init.call(this,g);if(this.flex)o!==false&&v.setStyleProperty(this.element,o+"box-flex",this.flex);else o===false&&y(this.element,
function(){this.parentNode&&this.parentNode.realign()}.bind(this))}});H=H(w,{childClass:a,template:'<div class="Basis-VerticalPanelStack">'+(o?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(g){this.cssRule=v.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");w.prototype.init.call(this,g);if(o===false){this.realign();y(this.childNodesElement,function(){this.realign()}.bind(this))}},insertBefore:function(g,
n){if(g=w.prototype.insertBefore.call(this,g,n)){g.flex&&this.cssRule&&p(g.element).add(this.ruleClassName);this.realign();return g}},removeChild:function(g){if(w.prototype.removeChild.call(this,g)){g.flex&&this.cssRule&&p(g.element).remove(this.ruleClassName);this.realign();return g}},realign:function(){if(o===false){var g=this.element,n=this.lastChild.element,s=this.tmpl.ruller,G=(new m(n,false,g)).bottom-x(g,"paddingTop")-x(g,"borderTopWidth")||0;g=A(g,s);if(f)G+=x(n,"marginBottom");else{var K=
s.offsetHeight;s.style.height=n.currentStyle.marginBottom;G+=s.offsetHeight-K}if(G=g-G){n=0;G=G;for(g=0;K=this.childNodes[g];g++)if(K.flex){n++;G+=A(K.element,s)}n&&this.cssRule.setProperty("height",Math.max(0,G/n)+"px")}}}});r.namespace("basis.layout").extend({Box:m,Intersection:b,Viewport:d,VerticalPanel:a,VerticalPanelStack:H,Helper:l,addBlockResizeHandler:y})})(basis,this);
(function(r){var z=r.Class,x=r.dom.event,A=r.dom,y=Function.getter,C=r.cssom.classList,I=x.addGlobalHandler,H=x.removeGlobalHandler,B=r.EventObject,E=B.createEvent,F=r.layout,v=r.ua,p=r.ua.is("IE9-"),w,t={start:function(l){w&&t.over();w={dde:this,run:false,event:{initX:x.mouseX(l),initY:x.mouseY(l),deltaX:0,deltaY:0}};I("mousemove",t.move,w);I("mouseup",t.over,w);I("mousedown",t.over,w);x.cancelDefault(l);this.event_prepare(w.event)},move:function(l){var b=w.dde;if(!w.run){w.run=true;b.draging=true;
b.event_start(w.event)}if(b.axisX)w.event.deltaX=b.axisXproxy(x.mouseX(l)-w.event.initX);if(b.axisY)w.event.deltaY=b.axisYproxy(x.mouseY(l)-w.event.initY);b.event_move(w.event)},over:function(l){var b=w.dde;H("mousemove",t.move,w);H("mouseup",t.over,w);H("mousedown",t.over,w);b.draging=false;w.run&&b.event_over(w.event);w=null;x.kill(l)}},j={dragable:"Basis-Dragable",element:"Basis-DragDrop-DragElement"},o=z(B,{containerGetter:y("element"),element:null,trigger:null,baseElement:null,fixTop:true,fixRight:true,
fixBottom:true,fixLeft:true,axisX:true,axisY:true,axisXproxy:Function.$self,axisYproxy:Function.$self,event_prepare:E("prepare"),event_start:E("start"),event_move:E("move"),event_over:E("over"),init:function(l){B.prototype.init.call(this,l);l=this.element;var b=this.trigger;this.trigger=this.element=null;this.setElement(l,b);this.setBase(this.baseElement);r.Cleaner.add(this)},setElement:function(l,b){l=l&&A.get(l);b=b&&A.get(b)||l;if(this.trigger!=b){if(this.trigger){x.removeHandler(this.trigger,
"mousedown",t.start,this);p&&x.removeHandler(this.trigger,"selectstart",t.start,this)}if(this.trigger=b){x.addHandler(this.trigger,"mousedown",t.start,this);p&&x.addHandler(this.trigger,"selectstart",t.start,this)}}if(this.element!=l){this.element&&C(this.element).remove(j.dragable);(this.element=l)&&C(this.element).add(j.dragable)}},setBase:function(l){this.baseElement=A.get(l)||(v.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(w&&w.dde==this)},start:function(l){this.isDraging()||
t.start.call(this,l)},stop:function(){this.isDraging()&&t.over()},destroy:function(){r.Cleaner.remove(this);this.stop();B.prototype.destroy.call(this);this.setElement();this.setBase()}});z=z(o,{event_start:function(l){var b=this.containerGetter(this,l.initX,l.initY);if(b){var d=new F.Box(b),a=new F.Viewport(this.baseElement);C(b).add(j.element);l.element=b;l.box=d;l.viewport=a}o.prototype.event_start.call(this,l)},event_move:function(l){if(l.element){if(this.axisX){var b=l.box.left+l.deltaX;if(this.fixLeft&&
b<0)b=0;else if(this.fixRight&&b+l.box.width>l.viewport.width)b=l.viewport.width-l.box.width;l.element.style.left=b+"px"}if(this.axisY){b=l.box.top+l.deltaY;if(this.fixTop&&b<0)b=0;else if(this.fixBottom&&b+l.box.height>l.viewport.height)b=l.viewport.height-l.box.height;l.element.style.top=b+"px"}o.prototype.event_move.call(this,l)}},event_over:function(l){if(l.element){C(l.element).remove(j.element);o.prototype.event_over.call(this,l)}}});r.namespace("basis.dragdrop").extend({DragDropElement:o,MoveableElement:z})})(basis);
(function(){function r(b){if(b instanceof j)return b.set;b=b.nodeType;if(isNaN(b)==false)return b==1?t:"nodeValue"}var z=basis.Class,x=basis.dom,A=basis.Cleaner,y=Function.getter,C=basis.cssom.classList,I=basis.EventObject,H=basis.TimeEventManager,B=I.createEvent,E=basis.data,F=E.DataObject,v=E.STATE,p=z(F,{event_change:B("change"),locked:false,lockValue_:null,extendConstructor_:false,updateCount:0,init:function(b,d,a){F.prototype.init.call(this,{});d&&this.addHandler(d);this.proxy=typeof a=="function"?
a:Function.$self;this.initValue=this.value=this.proxy(b)},set:function(b,d){var a=this.value,c=this.proxy?this.proxy(b):c,e=false;if(c!==a){this.value=c;e=true;this.updateCount+=1}if(!this.locked&&(e||d))this.event_change(c,a);return e},lock:function(){if(!this.locked){this.lockValue_=this.value;this.locked=true}},unlock:function(){if(this.locked){this.locked=false;this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)}},update:function(b,d){return this.set(b,d)},reset:function(){this.set(this.initValue)},
destroy:function(){F.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),w={destroy:function(b){this.removeLink(b)}},t=function(b){x.insert(x.clear(this),b)},j=z(p,{links_:null,event_change:function(b,d){p.prototype.event_change.call(this,b,d);if(!(!this.links_.length||A.globalDestroy))for(var a=0,c;c=this.links_[a++];)this.power_(c,d)},init:function(b,d,a){p.prototype.init.call(this,b,d,a);this.links_=[];A.add(this)},addLink:function(b,
d,a){if(typeof b!="object"&&b instanceof Object==false)throw new Error("basis.data.property: Link to undefined object ignored");if(d==null)d=r(b);if(typeof a!="function")a=y(Function.$self,a);d={object:b,format:a,field:d,isEventObject:b instanceof I};this.links_.push(d);d.isEventObject&&b.addHandler(w,this);this.power_(d);return b},addLinkShortcut:function(b,d,a){return this.addLink(b,j.shortcut[d],a)},removeLink:function(b,d){if(this.links_!=null){var a=arguments.length<2;if(!a&&d==null)d=r(b);for(var c=
0,e=0,f;f=this.links_[e];e++)if(f.object===b&&(a||d==f.field))f.isEventObject&&f.object.removeHandler(w,this);else this.links_[c++]=f;this.links_.length=c}},clear:function(){for(var b=0,d;d=this.links_[b];b++)d.isEventObject&&d.object.removeHandler(w,this);this.links_.clear()},power_:function(b,d){var a=b.field;if(a!=null){var c=b.format(this.value),e=b.object;if(typeof a=="function")a.call(e,c,arguments.length<2?c:b.format(d));else e[a]=c}},destroy:function(){this.clear();p.prototype.destroy.call(this);
this.links_=null;A.remove(this)}});j.shortcut={className:function(b,d){C(this).replace(d,b)},show:function(b){x.display(this,!!b)},hide:function(b){x.display(this,!b)},disable:function(b){this.disabled=!!b},enable:function(b){this.disabled=!b}};var o=v.PRIORITY,l={stateChanged:function(){this.fire(false,true)},update:function(){this.fire(true)},change:function(){this.fire(true)},destroy:function(b){this.remove(b)}};z=z(j,{calculateValue:function(){return this.value+1},objects:[],timer_:null,valueChanged_:false,
stateChanged_:true,state:v.UNDEFINED,extendConstructor_:true,init:function(){var b=this.handler;delete this.handler;j.prototype.init.call(this,this.value||0,b,this.proxy);if(this.objects.length){b=this.objects;this.objects=[];this.lock();this.add.apply(this,b);this.unlock()}else this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();A.add(this)},add:function(){for(var b=0,d=arguments.length;b<d;b++){var a=arguments[b];if(a instanceof F)this.objects.add(a)&&a.addHandler(l,
this);else throw new Error("basis.data.property: Instance of DataObject required");}this.fire(true,true)},remove:function(b){this.objects.remove(b)&&b.removeHandler(l,this);this.fire(true,true)},clear:function(){for(var b=0,d;d=this.objects[b];b++)d.removeHandler(l,this);this.objects.clear();this.fire(true,true)},fire:function(b,d){if(!this.locked){this.valueChanged_=this.valueChanged_||!!b;this.stateChanged_=this.stateChanged_||!!d;if(!this.timer_&&(this.valueChanged_||this.stateChanged_)){this.timer_=
true;H.add(this,"update",Date.now())}}},lock:function(){this.locked=true},unlock:function(){this.locked=false},update:function(){delete this.timer_;H.remove(this,"update");if(!A.globalDestroy){this.valueChanged_&&this.set(this.calculateValue());if(this.stateChanged_){var b=this.objects.length;if(b){for(var d=-2,a,c=0;c<b;c++){var e=this.objects[c],f=o.indexOf(String(e.state));if(f>d){a=e;d=f}}a&&this.setState(a.state,a.state.data)}else this.setState(v.UNDEFINED)}}this.stateChanged_=this.valueChanged_=
false},destroy:function(){this.lock();this.clear();H.remove(this,"update");j.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:z,AbstractProperty:p,Property:j,PropertySet:z})})();
(function(r){function z(B,E){var F=Date.now()-B;return F>=E?1:F/E}var x=r.Class,A=r.dom,y=r.data.property.Property,C=r.EventObject.createEvent,I=x(y,{duration:1E3,interval:50,startTime:0,timer:null,started:false,event_start:C("start"),event_finish:C("finish"),event_invert:C("invert"),event_change:function(B,E){B==0&&this.event_start();y.prototype.event_change.call(this,B,E);B==1&&this.event_finish()},extendConstructor_:true,init:function(B){this.run=this.run.bind(this);y.prototype.init.call(this,
B)},start:function(B){if(this.started)B&&this.invert();else{this.startTime=Date.now();this.started=true;this.run()}},run:function(){clearTimeout(this.timer);if(this.started){var B=z(this.startTime,this.duration);if(B>=1)this.stop();else{this.set(B);this.timer=setTimeout(this.run,this.interval)}}},invert:function(){this.event_invert();if(this.started){var B=z(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-B);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started){this.started=
false;this.set(1)}},destroy:function(){this.stop();this.clear();y.prototype.destroy.call()}}),H=x(null,{thread:null,setter:Function.$null,notRevert:false,timeFunction:Function.$self,init:function(B,E,F,v,p){this.thread=B instanceof I?B:new I(B);this.setRange(F,v);this.setter=E;this.notInvert=p;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(w){this.setter(this.start+this.range*this.timeFunction(w))},finish:function(){if(!this.notInvert){this.start+=
this.range;this.range*=-1}},destroy:this.destroy},this)},setRange:function(B,E){this.start=B;this.range=E-B},destroy:function(){delete this.thread}});x={CSS:{FadeIn:function(B,E){return new H(B,function(F){A.setStyle(E,{opacity:F})},0,1)},FadeOut:function(B,E){return new H(B,function(F){A.setStyle(E,{opacity:F})},1,0)}}};r.namespace("basis.animation").extend({Thread:I,Modificator:H,FX:x})})(basis);
(function(r){function z(a,c,e){return e?d?a.createElementNS(e,c):a.createNode(1,c,e):a.createElement(c)}function x(a,c,e,f){a=e?d?a.createAttributeNS(e,c):a.createNode(2,c,e):a.createAttribute(c);a.nodeValue=f;return a}function A(a,c){return a.setAttributeNodeNS?a.setAttributeNodeNS(c):a.setAttributeNode(c)}function y(a,c,e){A(a,x(a.ownerDocument,l.PREFIX+(c?":"+c:""),l.NAMESPACE,e))}function C(a,c){return a.createTextNode(String(c))}function I(a,c){var e=a.nodeType,f=a.attributes,i=a.firstChild;
if(i){if(i.nodeType!=v&&i===a.lastChild)return i.nodeValue}else{var m=f&&f[0];if(e==v){if(!m)return"";if(f.length==1&&(m.baseName||m.localName)==o&&m.namespaceURI==t)return null}else if(!m)return null}e={};m=[];var g=0,n,s,G;if(i=i){do g=m.push(i);while(i=i.nextSibling)}if(f)for(i=0;G=f[i];i++)m.push(G);c||(c={});for(i=0;n=m[i];i++){f=n.nodeName;G=c[f];if(i<g)n=I(n,c);else{if(f=="xmlns")continue;n=n.nodeValue}for(;G;){if(G.storeName)n[G.storeName]=f;if(G.rename){f=G.rename;G=c[f]}else{if(G.format)n=
G.format(n);if(!e[f]&&G.forceArray)n=[n];break}}if(f in e)if((s=e[f])&&s.push)s.push(n);else e[f]=[s,n];else e[f]=n}return e}function H(a,c,e,f){if(String(c).charAt(0)=="@")return f==null?f:x(a,c.substr(1),"",String(f));else{c=z(a,c.toString(),f&&f.xmlns||c.namespace||e);if(typeof f=="undefined"||f===null)A(c,x(a,o,t,"true"));else if(typeof f=="string"||typeof f=="number"||typeof f=="function"||typeof f=="boolean"||f.constructor===Date||f.constructor===RegExp)c.appendChild(C(a,f));else{e=f.xmlns||
e;f.xmlns&&l.BAD_SUPPORT&&y(c,"",e);for(var i in f){var m=f[i];if(!(i=="xmlns"||typeof m=="function"))if(m&&Array.isArray(m))for(var g=0;g<m.length;g++)c.appendChild(H(a,i,e,m[g]));else{if(m&&typeof m=="object"&&m.toString!==Object.prototype.toString)m=m.toString();if(m=H(a,i,e,m))m.nodeType==p?A(c,m):c.appendChild(m)}}}return c}}var B=r.dom,E=r.Class,F=r.ua,v=B.ELEMENT_NODE,p=B.ATTRIBUTE_NODE;E=E(null,{init:function(a,c,e){this.localpart=a;this.namespace=c||"";this.prefix=e||""},toString:function(){return this.prefix?
this.prefix+":"+this.localpart:this.localpart}});var w=String("http://www.w3.org/2001/XMLSchema"),t=String("http://www.w3.org/2001/XMLSchema-instance"),j=String("http://www.w3.org/2000/xmlns/"),o="nil",l={PREFIX:"xmlns",NAMESPACE:j,BAD_SUPPORT:F.test("webkit528.16-")||F.test("opera9-")},b="native",d=true;F=function(){var a=document.implementation;if(a&&a.createDocument)return function(i,m){var g=a.createDocument(i,m,null);if(g.charset&&g.charset!=document.charset)g.charset=document.charset;return g};
if(window.ActiveXObject)for(var c=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],e=0;e<c.length;e++)try{if(new ActiveXObject(c[e])){b=c[e];d=false;return function(i,m){var g=new ActiveXObject(b);g.documentElement=z(g,m,i);return g}}}catch(f){}throw new Error("Browser doesn't support for XML document!");}();r.namespace("basis.xml").extend({NAMESPACE:{XMLShema:w,XMLShemaInstance:t,Namespace:j},XMLNS:l,QName:E,getElementsByTagNameNS:function(a,c,e){if(a.getElementsByTagNameNS)return a.getElementsByTagNameNS(e,
c);var f=[];a.ownerDocument.setProperty("SelectionNamespaces",'xmlns:x="'+e+'"');a=a.selectNodes("//x:"+c);c=0;for(var i;i=a[c++];)i.namespaceURI==e&&f.push(i);return f},addNamespace:y,createDocument:F,createElementNS:z,createAttributeNS:x,setAttributeNodeNS:A,createText:C,createCDATA:function(a,c){return a.createCDATASection(c)},XML2Object:I,XML2String:function(a){if(typeof XMLSerializer!="undefined")return(new XMLSerializer).serializeToString(a);if(typeof a.xml=="string")return a.xml;if(a.nodeType==
B.DOCUMENT_NODE)a=a.documentElement;return B.outerHTML(a)},Object2XML:H})})(basis);
(function(r){function z(p,w){return p<<w|p>>>32-w}function x(p){var w=[];do{w.push((p&15).toString(16));p>>=4}while(p);w.length&1&&w.push("0");return w.reverse().join("")}function A(p){if(typeof p=="number")return x(p);var w=[];w=Array.isArray(p)?p.map(A):String(p).toArray().map(function(t){return x(t.charCodeAt(0))});return w.join("")}r.namespace("basis.crypt",function(p){F=p||"";return v});var y=Array.create(255,function(p){return String.fromCharCode(p)}),C=function(){function p(t){for(var j="",
o=t.length,l=0;l<o;l++){var b=t.charCodeAt(l);j+=b<128?y[b]:b<2048?y[b>>6|192]+y[b&63|128]:y[b>>12|224]+y[b>>6&63|128]+y[b&63|128]}return j}function w(t){for(var j="",o=t.length,l,b,d,a=0;a<o;){l=t.charCodeAt(a++);if(l<128)j+=y[l];else{b=t.charCodeAt(a++);if(l&32){d=t.charCodeAt(a++);j+=String.fromCharCode((l&15)<<12|(b&63)<<6|d&63)}else j+=String.fromCharCode((l&31)<<6|b&63)}}return j}return r.namespace("basis.crypt.UTF16").extend({toBytes:function(t){for(var j=[],o=t.length,l=0;l<o;l++){var b=t.charCodeAt(l);
j.push(b&255,b>>8)}return j},fromBytes:function(t){for(var j="",o=t.length,l,b,d=0;d<o;){l=t[d++]||0;b=t[d++]||0;j+=String.fromCharCode(b<<8|l)}return j},toUTF8:p,fromUTF8:w,toUTF8Bytes:function(t){return I.toBytes(p(t))},fromUTF8Bytes:function(t){return w(I.fromBytes(t))}})}(),I=function(){return r.namespace("basis.crypt.UTF8").extend({toBytes:function(p){for(var w=p.length,t=new Array(w),j=0;j<w;j++)t[j]=p.charCodeAt(j);return t},fromBytes:function(p){for(var w=p.length,t="",j=0;j<w;j++)t+=y[p[j]];
return t},toUTF16:function(p){return C.fromUTF8(p)},fromUTF16:function(p){return C.toUTF8(p)},toUTF16Bytes:function(p){return C.toBytes(C.fromUTF8(p))},fromUTF16Bytes:function(p){return C.toUTF8(C.fromBytes(p))}})}(),H=function(){var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),w={};p.forEach(function(t,j){w[t]=j});return r.namespace("basis.crypt.Base64").extend({encode:function(t,j){if(t.constructor!=Array)t=j?C.toUTF8Bytes(t):C.toBytes(t);for(var o=t.length,l=
0,b="",d,a,c,e,f;l<o;){d=t[l++];a=t[l++];c=t[l++];e=(a&15)<<2|c>>6;f=c&63;if(a==undefined)e=f=64;else if(c==undefined)f=64;b+=p[d>>2]+p[(d&3)<<4|a>>4]+p[e]+p[f]}return b},decode:function(t,j){var o=[],l,b,d,a,c=0;t=t.replace(/[^a-z0-9\+\/]/ig,"");for(var e=t.length;c<e;){l=w[t.charAt(c++)];b=w[t.charAt(c++)];d=w[t.charAt(c++)];a=w[t.charAt(c++)];o.push(l<<2|b>>4,(b&15)<<4|d>>2,(d&3)<<6|a)}if(d==null||d==64)o.pop();if(a==null||a==64)o.pop();return j?C.fromUTF8Bytes(o):C.fromBytes(o)}})}(),B=function(){function p(j){for(var o=
[],l=3;l>=0;l--)o.push(j>>l*8&255);return o}var w=[1518500249,1859775393,2400959708,3395469782],t=[function(j,o,l){return l^j&(o^l)},function(j,o,l){return j^o^l},function(j,o,l){return j&o|l&(j|o)},function(j,o,l){return o^j^l}];return function(j,o){if(j.constructor!=Array)j=o?C.toUTF8Bytes(j):C.toBytes(j);for(var l=j.length,b=[],d=0;d<l;d++)b[d>>2]|=j[d]<<(3-(d&3)<<3);if(l&3)b[l>>2]|=Math.pow(2,(4-(l&3)<<3)-1);else b[l>>2]=2147483648;b.push.apply(b,Array.create(((b.length&15)>14?30:14)-(b.length&
15),0));b.push(l>>>29);b.push(l<<3&4294967295);b.reverse();l=[1732584193,4023233417,2562383102,271733878,3285377520];for(var a=Array.from(l),c,e=b.length>>4,f=new Array(80);e--;){for(d=0;d<16;d++)f[d]=b.pop();for(d=16;d<80;d++)f[d]=z(f[d-3]^f[d-8]^f[d-14]^f[d-16],1);for(d=0;d<80;d++){c=Math.floor(d/20);l[4]=z(l[0],5)+t[c](l[1],l[2],l[3])+l[4]+f[d]+w[c]&4294967295;l[1]=z(l[1],30);l.unshift(l.pop())}for(d=0;d<5;d++)l[d]=a[d]=l[d]+a[d]&4294967295}return l.map(p).flatten()}}(),E=function(){function p(d){for(var a=
arguments,c=a.length,e=d&65535,f=d>>16,i=1;i<c;i++){var m=a[i];e+=m&65535;f+=(m>>16)+(e>>16);e&=65535}return f<<16|e&65535}function w(d){for(var a=[],c=0;c<4;c++)a.push(d>>c*8&255);return a}var t=Math.pow(2,32),j,o=[],l=[],b=[function(d,a,c){return c^d&(a^c)},function(d,a,c){return a^c&(a^d)},function(d,a,c){return d^a^c},function(d,a,c){return a^(d|~c)}];return function(d,a){if(!j){j=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var c=
0;c<64;c++){o[c]=Math.floor(Math.abs(Math.sin(c+1))*t);switch(c>>4){case 0:l[c]=c;break;case 1:l[c]=c*5+1&15;break;case 2:l[c]=c*3+5&15;break;case 3:l[c]=c*7&15;break}}}if(d.constructor!=Array)d=a?C.toUTF8Bytes(d):C.toBytes(d);c=[];for(var e=d.length,f=0;f<e;f++)c[f>>2]|=d[f]<<((f&3)<<3);c[e>>2]|=128<<((e&3)<<3);c.push.apply(c,Array(((c.length&15)>14?30:14)-(c.length&15)));c.push(e<<3&4294967295);c.push(e>>>29);e=[1732584193,4023233417,2562383102,271733878];for(var i=Array.from(e),m=c.length>>4;m--;){for(f=
0;f<64;f++){e[0]=p(z(p(e[0],b[f>>4](e[1],e[2],e[3]),c[l[f]],o[f]),j[f]),e[1]);e.unshift(e.pop())}for(f=0;f<4;f++)e[f]=i[f]=p(e[f],i[f])}return e.map(w).flatten()}}(),F="",v={};Object.iterate({sha1:function(p){return B(this,p)},sha1hex:function(p){return A(B(this,p))},md5:function(p){return E(this,p)},md5hex:function(p){return A(E(this,p))},base64:function(p){return H.encode(this,p)},base64decode:function(p){return H.encode(this,p)},hex:function(){return A(this)}},function(p,w){v[p]=function(t){t=
w.call(F,t);return F=Object.extend(typeof t!="object"?Object(t):t,v)}});r.namespace("basis.crypt").extend({HEX:A,SHA1:B,MD5:E})})(basis);
(function(){function r(a,c){var e={},f;if(a&&a.length)f=e.inserted=a;if(c&&c.length)f=e.deleted=c;if(f)return e}function z(a,c){if(!a.length)return 0;var e,f,i,m=0,g=a.length-1;do{e=m+g>>1;i=a[e].value||0;if(i===f){i=a[e].object.eventObjectId;f=c.object.eventObjectId}else f=c.value||0;if(f<i)g=e-1;else if(f>i)m=e+1;else return f==i?e:0}while(m<=g);return e+(i<f)}var x=basis.Class,A=Object.extend,y=Object.values,C=Function.$self,I=Function.$true,H=Function.$false,B=basis.EventObject.createEvent,E=
basis.data.SUBSCRIPTION,F=basis.data.DataObject,v=basis.data.KeyObjectMap,p=basis.data.AbstractDataset,w=basis.data.Dataset;E.add("SOURCE",{sourceChanged:function(a,c){this.remove(a,c);this.add(a,a.source)},sourcesChanged:function(a,c){var e;if(e=c.inserted)for(var f=e.length;f-- >0;)this.add(a,e[f]);if(e=c.deleted)for(f=e.length;f-- >0;)this.remove(a,e[f])}},function(a,c){for(var e=c.sources||[c.source],f=0,i;i=e[f++];)a(c,i)});E.add("MINUEND",{operandsChanged:function(a,c){if(this.minuend!==c){this.remove(a,
c);this.add(a,a.minuend)}}},function(a,c){a(c,c.minuend)});E.add("SUBTRAHEND",{operandsChanged:function(a,c,e){if(this.subtrahend!==e){this.remove(a,e);this.add(a,a.subtrahend)}}},function(a,c){a(c,c.subtrahend)});var t={datasetChanged:function(a,c){var e=this.memberMap_,f={},i,m;if(c.inserted)for(var g=0;i=c.inserted[g];g++){m=i.eventObjectId;if(e[m])e[m].count++;else e[m]={count:1,object:i};f[m]=e[m]}if(c.deleted)for(g=0;i=c.deleted[g];g++){m=i.eventObjectId;f[m]=e[m];e[m].count--}this.applyRule(f)},
destroy:function(a){this.removeSource(a)}},j=x(p,{subscribeTo:E.SOURCE,event_sourcesChanged:B("sourcesChanged","dataset","delta"),sources:null,rule:function(a){return a>0},listen:{source:t},init:function(a){p.prototype.init.call(this,a);a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){if(typeof a!="function")a=j.UNION;if(this.rule!==a){this.rule=a;this.applyRule()}},applyRule:function(a){var c=this.memberMap_,e=this.rule,f=this.sources.length,i=[],m=[],g,n;a||
(a=c);for(var s in a){g=c[s];n=f&&g.count&&e(g.count,f);if(n!=!!this.item_[s])(n?i:m).push(g.object);g.count==0&&delete c[s]}if(a=r(i,m))this.event_datasetChanged(this,a)},addSource:function(a){if(a instanceof p)if(this.sources.add(a)){this.listen.source&&a.addHandler(this.listen.source,this);var c=this.memberMap_;for(var e in a.item_)if(c[e])c[e].count++;else c[e]={count:1,object:a.item_[e]};this.applyRule();this.event_sourcesChanged(this,{inserted:[a]});return true}},removeSource:function(a){if(this.sources.remove(a)){this.listen.source&&
a.removeHandler(this.listen.source,this);var c=this.memberMap_;for(var e in a.item_)c[e].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[a]});return true}},setSources:function(a){for(var c=Array.from(this.sources),e=0,f;f=a[e];e++)if(f instanceof p)c.remove(f)||this.addSource(f);c.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){p.prototype.destroy.call(this);this.sources=null}});j.UNION=j.prototype.rule;
j.INTERSECTION=function(a,c){return a==c};j.DIFFERENCE=function(a){return a==1};j.MORE_THAN_ONE_INCLUDE=function(a,c){return c==1||a>1};j.AT_LEAST_ONE_EXCLUDE=function(a,c){return c==1||a<c};var o=function(a){return!this.has(a)};t={datasetChanged:function(a,c){if(this.subtrahend){var e=r(c.inserted&&c.inserted.filter(o,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));e&&this.event_datasetChanged(this,e)}},destroy:function(){this.setOperands(null,this.subtrahend)}};var l={datasetChanged:function(a,
c){if(this.minuend){var e=r(c.deleted&&c.deleted.filter(o,this),c.inserted&&c.inserted.filter(this.has,this));e&&this.event_datasetChanged(this,e)}},destroy:function(){this.setOperands(this.minuend,null)}};t=x(p,{subscribeTo:E.MINUEND+E.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:B("operandsChanged","dataset","oldMinuend","oldSubtrahend"),listen:{minuend:t,subtrahend:l},init:function(a){p.prototype.init.call(this,a);a=this.minuend;var c=this.subtrahend;this.subtrahend=this.minuend=
null;if(a||c)this.setOperands(a,c)},setOperands:function(a,c){var e,f=false;if(a instanceof p==false)a=null;if(c instanceof p==false)c=null;var i=this.minuend,m=this.subtrahend;if(i!==a){f=true;this.minuend=a;var g=this.listen.minuend;if(g){i&&i.removeHandler(g,this);a&&a.addHandler(g,this)}}if(m!==c){f=true;this.subtrahend=c;if(g=this.listen.subtrahend){m&&m.removeHandler(g,this);c&&c.addHandler(g,this)}}if(!f)return false;this.event_operandsChanged(this,i,m);if(!a||!c){if(this.itemCount)this.event_datasetChanged(this,
e={deleted:this.getItems()})}else{e=[];f=[];for(var n in this.item_)if(!a.item_[n]||c.item_[n])e.push(this.item_[n]);for(n in a.item_)!this.item_[n]&&!c.item_[n]&&f.push(a.item_[n]);if(e=r(f,e))this.event_datasetChanged(this,e)}return e},clear:function(){this.setOperands()}});var b={subscribeTo:E.SOURCE,source:null,sourceMap_:null,event_sourceChanged:B("sourceChanged","dataset","oldSource"),init:function(a){this.sourceMap_={};p.prototype.init.call(this,a);if(a=this.source){this.source=null;this.setSource(a)}},
setSource:function(a){if(a instanceof p==false)a=null;if(this.source!==a){var c=this.source,e=this.listen.source;this.source=a;if(e){var f=e.datasetChanged;if(c){c.removeHandler(e,this);f&&f.call(this,c,{deleted:c.getItems()})}if(a){a.addHandler(e,this);f&&f.call(this,a,{inserted:a.getItems()})}}this.event_sourceChanged(this,c)}},clear:function(){this.setSource()}},d=x(p,b,{map:C,reduce:H,rule:I,addMemberRef:null,removeMemberRef:null,listen:{sourceObject:{update:function(a){var c=this.map?this.map(a):
a;if(c instanceof F==false||this.reduce(c))c=null;var e=this.sourceMap_[a.eventObjectId],f=e.member;if(f!=c){var i=this.memberMap_,m,g;e.member=c;if(f){e=f.eventObjectId;this.removeMemberRef&&this.removeMemberRef(f,a);if(--i[e]==0){delete i[e];g=[f]}}if(c){f=c.eventObjectId;this.addMemberRef&&this.addMemberRef(c,a);if(i[f])i[f]++;else{i[f]=1;m=[c]}}if(a=r(m,g))this.event_datasetChanged(this,a)}}},source:{datasetChanged:function(a,c){var e=this.sourceMap_,f=this.memberMap_,i=[],m=[],g,n,s,G=this.listen.sourceObject;
w.setAccumulateState(true);if(c.inserted)for(var K=0;g=c.inserted[K];K++){s=this.map?this.map(g):g;if(s instanceof F==false||this.reduce(s))s=null;G&&g.addHandler(G,this);e[g.eventObjectId]={sourceObject:g,member:s};if(s){n=s.eventObjectId;if(f[n])f[n]++;else{f[n]=1;i.push(s)}this.addMemberRef&&this.addMemberRef(s,g)}}if(c.deleted)for(K=0;g=c.deleted[K];K++){n=g.eventObjectId;s=e[n].member;G&&g.removeHandler(G,this);delete e[n];if(s){n=s.eventObjectId;if(--f[n]==0){delete f[n];m.push(s)}this.removeMemberRef&&
this.removeMemberRef(s,g)}}w.setAccumulateState(false);if(c=r(i,m))this.event_datasetChanged(this,c)},destroy:function(){this.setSource()}}},init:function(a){b.init.call(this,a)},setRule:function(a){if(typeof a!="function")a=I;if(this.rule!==a){this.rule=a;return this.applyRule()}},setMap:function(a){if(typeof a!="function")a=C;if(this.map!==a){this.map=a;return this.applyRule()}},setReduce:function(a){if(typeof a!="function")a=H;if(this.reduce!==a){this.reduce=a;return this.applyRule()}},applyRule:function(){var a=
this.sourceMap_,c=this.memberMap_,e,f,i,m,g,n=[],s=[];for(var G in a){g=a[G];m=g.sourceObject;e=g.member;f=this.map?this.map(m):m;if(f instanceof F==false||this.reduce(f))f=null;if(e!=f){g.member=f;if(e){i=e.eventObjectId;this.removeMemberRef&&this.removeMemberRef(e,m);c[i]--}if(f){e=f.eventObjectId;this.addMemberRef&&this.addMemberRef(f,m);if(e in c)c[e]++;else{c[e]=1;n.push(f)}}}}for(i in this.item_)if(c[i]==0){delete c[i];s.push(this.item_[i])}if(a=r(n,s))this.event_datasetChanged(this,a);return a},
destroy:function(){p.prototype.destroy.call(this);this.sourceMap_=null}});B=x(d,{reduce:function(a){return!this.rule(a)}});E=x(d,{map:function(a){return this.keyMap.resolve(a)},subsetClass:p,keyMap:null,addMemberRef:function(a,c){a.event_datasetChanged(a,{inserted:[c]})},removeMemberRef:function(a,c){a.event_datasetChanged(a,{deleted:[c]})},init:function(a){if(!this.keyMap||this.keyMap instanceof v==false)this.keyMap=new v(A({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));d.prototype.init.call(this,
a)},getSubset:function(a,c){return this.keyMap.get(a,c)},destroy:function(){d.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});l=x(p,b,{rule:I,index_:null,offset:0,limit:10,listen:{sourceObject:{update:function(a){var c=this.sourceMap_[a.eventObjectId];a=this.rule(a);var e=this.index_;if(a!==c.value){e.splice(z(e,c),1);c.value=a;e.splice(z(e,c),0,c);this.applyRule()}}},source:{datasetChanged:function(a,c){var e=this.sourceMap_,f=this.index_,i=this.listen.sourceObject,m,g;if(g=
c.inserted)for(var n=0,s;s=g[n];n++){m={object:s,value:this.rule(s)};e[s.eventObjectId]=m;f.splice(z(f,m),0,m);i&&s.addHandler(i,this)}if(g=c.deleted)for(n=0;s=g[n];n++){m=e[s.eventObjectId];f.splice(z(f,m),1);i&&s.removeHandler(i,this)}this.applyRule()}}},init:function(a){this.index_=[];b.init.call(this,a)},setRange:function(a,c){this.offset=a;this.limit=c;this.applyRule()},applyRule:function(){for(var a=Object.slice(this.item_),c=this.index_.slice(this.offset,this.offset+this.limit),e=[],f=0,i;i=
c[f];f++){var m=i.object.eventObjectId;if(a[m])delete a[m];else e.push(i.object)}if(a=r(e,y(a)))this.event_datasetChanged(this,a)}});x=x(p,b,{rule:I,map:C,subsetClass:p,listen:{sourceObject:{update:function(a,c){var e=this.sourceMap_,f=this.memberMap_,i=a.eventObjectId,m=e[i].list;e=e[i].list={};i=this.rule(a);var g=[],n=[],s;if(Array.isArray(i))for(var G=0;G<i.length;G++)if(s=this.keyMap.resolve(i[G])){K=s.eventObjectId;e[K]=s;if(!m[K]){s.event_datasetChanged(s,{inserted:[a]});if(f[K])f[K]++;else{g.push(s);
f[K]=1}}}for(var K in m)if(!e[K]){s=m[K];s.event_datasetChanged(s,{deleted:[a]});if(!--f[K]){delete f[K];n.push(s)}}if(c=r(g,n))this.event_datasetChanged(this,c)}},source:{datasetChanged:function(a,c){var e=this.sourceMap_,f=this.memberMap_,i=this.listen.sourceObject,m,g,n,s=[],G=[];if(m=c.inserted)for(var K=0,q;q=m[K];K++){var h=this.rule(q),k={object:q,list:{}};e[q.eventObjectId]=k;if(Array.isArray(h))for(var u=0;u<h.length;u++)if(g=this.keyMap.resolve(h[u])){g.event_datasetChanged(g,{inserted:[q]});
n=g.eventObjectId;k.list[n]=g;if(f[n])f[n]++;else{s.push(g);f[n]=1}}i&&q.addHandler(i,this)}if(m=c.deleted)for(K=0;q=m[K];K++){g=q.eventObjectId;h=e[g].list;delete e[g];for(n in h){g=h[n];g.event_datasetChanged(g,{deleted:[q]});if(!--f[n]){delete f[n];G.push(g)}}i&&q.removeHandler(i,this)}if(c=r(s,G))this.event_datasetChanged(this,c)}}},init:function(a){if(!this.keyMap||this.keyMap instanceof v==false)this.keyMap=new v(A({keyGetter:this.map,itemClass:this.subsetClass},this.keyMap));b.init.call(this,
a)}});basis.namespace("basis.data.dataset").extend({Merge:j,Subtract:t,MapReduce:d,Subset:B,Split:E,Slice:l,Cloud:x})})(basis,this);
(function(r){function z(a,c){if(!a.length)return 0;var e,f,i=0,m=a.length-1;do{e=i+m>>1;f=a[e]||0;if(c<f)m=e-1;else if(c>f)i=e+1;else return c==f?e:0}while(i<=m);return e+(f<c)}function x(a,c){a=Function.getter(a);var e=c+"_"+a.getterIdx_,f=p[e];if(!f){f=p[e]=this;this.indexType=c;this.indexClass=v[c];this.getter=a;this.key=e;this.createInstance=function(i){if(i instanceof E){var m=i.indexes&&i.indexes[this.key];if(!m){m=new this.indexClass(this.getter);m.addHandler(d,i);m.key=this.key}return m}}}return f}
function A(a,c,e){var f=a.indexCache_;a.lock();if(c)for(var i=0,m;m=c[i++];){var g=a.valueGetter(m);f[m.eventObjectId]=g;a.add(m,g)}if(e)for(i=0;m=e[i++];){a.remove(m,f[m.eventObjectId]);delete f[m.eventObjectId]}a.unlock()}var y=r.Class,C=r.TimeEventManager,I=r.data,H=I.KeyObjectMap,B=I.property.Property,E=I.AbstractDataset,F=I.dataset.MapReduce,v=y(B,{autoDestroy:true,valueGetter:Function.$null,dataSource:null,init:function(a){B.prototype.init.call(this,this.value||0);this.indexCache_={};this.valueGetter=
a},add:function(){},remove:function(){},upd:function(){}});v.Sum=y(v,{add:function(a,c){this.value+=c},remove:function(a,c){this.value-=c},upd:function(a,c,e){this.set(this.value+c-e)}});v.Avg=y(v,{sum_:0,count_:0,add:function(a,c){this.sum_+=c;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,c){this.sum_-=c;this.count_-=1;this.value=this.count_?this.sum_/this.count_:0},upd:function(a,c,e){this.sum_+=c-e;this.set(this.sum_/this.count_)}});v.Count=y(v,{valueGetter:Function.$true,
add:function(a,c){if(c)this.value+=1},remove:function(a,c){if(c)this.value-=1},upd:function(a,c){this.set(this.value+(c?1:-1))}});v.Max=y(v,{init:function(a,c){this.stack=[];v.prototype.init.call(this,a,c)},add:function(a,c){this.stack.splice(z(this.stack,c),0,c);this.value=this.stack[this.stack.length-1]},remove:function(a,c){this.stack.remove(c);this.value=this.stack[this.stack.length-1]},upd:function(a,c,e){this.stack.splice(z(this.stack,e),1);this.stack.splice(z(this.stack,c),0,c);this.set(this.stack[this.stack.length-
1])}});v.Min=y(v,{init:function(a,c){this.stack=[];v.prototype.init.call(this,a,c)},add:function(a,c){this.stack.splice(z(this.stack,c),0,c);this.value=this.stack[0]},remove:function(a,c){this.stack.remove(c);this.value=this.stack[0]},upd:function(a,c,e){this.stack.splice(z(this.stack,e),1);this.stack.splice(z(this.stack,c),0,c);this.set(this.stack[0])}});var p={},w=function(a){return function(c){return new x(c,a)}};I=w("Sum");var t=w("Avg"),j=w("Count"),o=w("Min");w=w("Max");var l={update:function(a){var c,
e,f,i=a.eventObjectId;for(var m in this.indexes){f=this.indexes[m];c=f.indexCache_[i];e=f.valueGetter(a);if(e!==c){f.upd(a,e,c);f.indexCache_[i]=e}}}},b={datasetChanged:function(a,c){if(c.inserted)for(var e=0;a=c.inserted[e++];)a.addHandler(l,this);if(c.deleted)for(e=0;a=c.deleted[e++];)a.removeHandler(l,this);for(var f in this.indexes)A(this.indexes[f],c.inserted,c.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},d={destroy:function(a){this.removeIndex(a)}};E.prototype.createIndex=
function(a){if(a instanceof x!=false){if(!this.indexes){this.indexes={};this.addHandler(b);b.datasetChanged.call(this,this,{inserted:this.getItems()})}var c=a.key;if(!this.indexes[c]){a=a.createInstance(this);this.indexes[c]=a;A(a,this.getItems())}return this.indexes[c]}};E.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var c in this.indexes)return;this.removeHandler(b);delete this.indexes}};y=y(F,{calcs:null,indexes:null,indexes_:null,
timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,c){F.prototype.event_sourceChanged.call(this,a,c);var e;for(var f in this.indexes_){e=this.indexes_[f];if(c){this.removeIndex(f);c.removeIndex(this.indexes[f])}this.source&&this.addIndex(f,this.source.createIndex(e))}},listen:{sourceObject:{update:function(a,c){F.prototype.listen.sourceObject.update.call(this,a,c);this.sourceMap_[a.eventObjectId].updated=true;this.fireUpdate()}},index:{change:function(a){var c=
this.indexMap;c.indexValues[this.key]=a;c.indexUpdated=true;c.fireUpdate()}},member:{subscribersChanged:function(a,c){a.subscriberCount>0&&c==0&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,true)},addMemberRef:function(a,c){this.memberSourceMap[a.eventObjectId]=c.eventObjectId;this.listen.member&&a.addHandler(this.listen.member,this);this.sourceMap_[c.eventObjectId].updated=true;a.subscriberCount>0&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];
this.listen.member&&a.removeHandler(this.listen.member,this)},init:function(a){this.indexUpdated=false;this.indexesBind_={};this.memberSourceMap={};var c=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||this.keyMap instanceof H==false)this.keyMap=new H(Object.complete({create:function(e,f){return new this.itemClass(f)}},this.keyMap));F.prototype.init.call(this,a);Object.iterate(c,this.addIndex,this)},addIndex:function(a,c){if(!this.indexes[a]){if(c instanceof
x)if(this.indexes_[a])return;else{this.indexes_[a]=c;c=this.source&&this.source.createIndex(c)}if(c instanceof v){this.indexValues[a]=c.value;this.indexes[a]=c;this.indexesBind_[a]={key:a,indexMap:this};var e=this.listen.index;if(e){c.addHandler(e,this.indexesBind_[a]);e.change&&e.change.call(this.indexesBind_[a],c.value)}}}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a]){this.indexes[a]&&this.listen.index&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]);delete this.indexValues[a];
delete this.indexesBind_[a];delete this.indexes[a];delete this.indexes_[a]}},addCalc:function(a,c){this.calcs[a]=c;this.fireUpdate()},removeCalc:function(a){delete this.calcs[a]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_){this.timer_=true;C.add(this,"apply",Date.now())}},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=
this.indexUpdated=false},calcMember:function(a){var c=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];if(a.subscriberCount&&(c.updated||this.indexUpdated)){c.updated=false;var e={},f,i;for(var m in this.calcs){f=this.calcs[m](c.sourceObject.data,this.indexValues,c.sourceObject);if(a.data[m]!==f&&(!isNaN(f)||!isNaN(a.data[m]))){e[m]=f;i=true}}i&&a.update(e)}},getMember:function(a){return this.keyMap.get(a,true)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=
this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);F.prototype.destroy.call(this)}});r.namespace("basis.data.index").extend({IndexConstructor:x,Index:v,Sum:I,Avg:t,Count:j,Max:w,Min:o,IndexMap:y})})(basis);
(function(r){function z(J){f[J]=f[J]||0;return J+f[J]++}function x(){var J=Array.from(arguments),M=J.pop();typeof M!="function"&&console.warn("Last argument for calculate field constructor must be a function");for(var N=[],S=[],U=0,aa;U<J.length;U++){aa=J[U].quote('"');N.push(aa+" in delta");S.push("data["+aa+"]")}M=(new Function("calc","return function(delta, data, oldValue){"+(N.length?"if ("+N.join(" || ")+")":"")+"return calc("+S.join(", ")+");"+(N.length?"return oldValue;":"")+"}"))(M);M.args=
J;M.isCalcField=true;return M}function A(){return x.apply(null,Array.from(arguments).concat(function(){for(var J=[],M=arguments.length;M-- >0;){if(arguments[M]==null)return null;J.push(arguments[M])}return J.join("-")}))}var y=r.Class,C=r.Cleaner,I=Object.extend,H=Function.$self,B=Function.getter,E=r.data,F=r.EventObject,v=E.Dataset,p=E.dataset.Subset,w=E.dataset.Split,t=E.DataObject,j=E.STATE,o={},l={string:1,number:1},b=[],d=function(J){return isNaN(J)?null:Number(J)},a=function(J){return isNaN(J)?
null:Number(J)},c=function(J){return isNaN(J)?null:parseInt(J)},e=function(J){return J==null?null:String(J)},f={},i=r.Class(null,{init:function(J){var M=this.index={};this.normalize=J;this.valueWrapper=function(N,S){var U=J(N,S);if(U!==S&&M[U])return S;return U};this.calcWrapper=function(N,S){var U=J(N,S);if(U!==S&&M[U])throw"Duplicate value for index "+S+" => "+N;return U};C.add(this)},get:function(J,M){var N=this.index[J];if(N&&(!M||N instanceof M))return N},add:function(J,M){var N=this.index[J];
if(M&&(!N||N===M)){this.index[J]=M;return true}},remove:function(J,M){if(this.index[J]===M){delete this.index[J];return true}},destroy:function(){this.index=null}});E=function(J,M){return function(N){return J.prototype[M].call(this,N&&N.map(this.wrapper))}};var m=function(J,M){return function(N){if(!this.name)this.name=z(M);J.prototype.init.call(this,N)}},g=function(J){return function(M,N){v.setAccumulateState(true);M=(M||[]).map(this.wrapper);v.setAccumulateState(false);return J.prototype.sync.call(this,
M,N)}},n=y(v,{wrapper:Function.$self,init:m(v,"EntitySet"),sync:g(v),set:E(v,"set"),add:E(v,"add"),remove:E(v,"remove"),destroy:function(){v.prototype.destroy.call(this);delete this.wrapper}}),s=y(n,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),G=y(p,{init:m(p,"EntityCollection"),sync:g(p)});G.sourceHandler=p.sourceHandler;var K=y(w,{subsetClass:s,init:m(w,"EntityGrouping"),sync:g(w),getSubset:function(J,M){var N=w.prototype.getSubset.call(this,J,M);if(N)N.wrapper=
this.wrapper;return N}}),q=function(J){if(this instanceof q){var M=new h(J||H);return function(N,S){if(N!=null){S instanceof n||(S=M.createEntitySet());S.set(N instanceof v?N.getItems():Array.from(N));return S}else return null}}};q.className="basis.entity.EntitySetWrapper";var h=y(null,{init:function(J){this.wrapper=J},createEntitySet:function(){return new n({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),k=function(J){if(this instanceof k){var M=
function(R,W){if(R!=null){if(R===W||R.entityType===N)return R;var $,Y=N.idField;if(l[typeof R]){if(!Y)return;$=R;R={};R[Y]=$}else if(N.compositeKey)$=N.compositeKey(R,R);else if(Y)$=R[Y];else if(aa){W=N.singleton;if(!W)return N.singleton=new U(R)}if($!=null&&S)W=S.get($,N.entityClass);if(W&&W.entityType===N)W.update(R);else W=new U(R);return W}else return N.singleton},N=new L(J||{},M),S=N.index__,U=N.entityClass,aa=N.isSingleton;I(M,{toString:function(){return this.typeName+"()"},entityType:N,type:M,
typeName:N.name,index:S,reader:function(R){return N.reader(R)},get:function(R){return N.get(R)},addField:function(R,W){N.addField(R,W)},all:N.all,createCollection:function(R,W,$){var Y=N.collection_[R];if(!Y&&W)return N.collection_[R]=new G({wrapper:M,source:$||N.all,rule:W});return Y},getCollection:function(R){return N.collection_[R]},createGrouping:function(R,W,$){var Y=N.grouping_[R];if(!Y&&W)return N.grouping_[R]=new K({wrapper:M,source:$||N.all,rule:W});return Y},getGrouping:function(R){return N.grouping_[R]},
getSlot:function(R,W){return N.getSlot(R,W)}});return M}};k.className="basis.entity.EntityTypeWrapper";var u=B("singleton"),D={};y(t,{});var L=y(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:false,index__:null,slot_:null,init:function(J,M){this.name=J.name||z(this.name);this.index__=J.index;this.idFields={};b.push(this);this.isSingleton=J.isSingleton;this.wrapper=M;this.all=new s(Object.extend(J.all||{},{wrapper:M}));this.slot_={};if(J.extensible)this.extensible=true;this.fields=
{};this.defaults={};this.aliases={};this.getters={};Object.iterate(J.fields,this.addField,this);J.constrains&&J.constrains.forEach(function(S){this.addCalcField(null,S)},this);if(this.isSingleton)this.get=u;J.aliases&&Object.iterate(J.aliases,this.addAlias,this);this.collection_={};if(J.collections)for(var N in J.collections)this.collection_[N]=new G({name:N,wrapper:M,source:this.all,rule:J.collections[N]||Function.$true});this.grouping_={};if(J.groupings)for(N in J.groupings)this.grouping_[N]=new K({name:N,
wrapper:M,source:this.all,rule:J.groupings[N]||Function.$true});this.entityClass=Q(this,this.all,this.index__,this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:M,typeName:this.name,getId:function(){return this.__id__}})},reader:function(J){var M={};if(l[typeof J]){if(this.idField){M[this.idField]=J;return M}return null}if(!J||J==null)return null;for(var N in J){var S=N in this.aliases?this.aliases[N]:"";if(S&&S in this.fields)M[S]=this.fields[S].reader?this.fields[S].reader(J[N]):
J[N]}return M},addAlias:function(J,M){if(M in this.fields)if(J in this.aliases==false)this.aliases[J]=M},addField:function(J,M){if(!this.all.itemCount){this.aliases[J]=J;if(typeof M=="function")M={type:M};if("type"in M&&typeof M.type!="function")M.type=H;var N=M.type||H;if([d,a,c,e].has(N))M.id=true;if(M.id){if(!this.index__)this.index__=new i(String);this.idFields[J]=true;if(this.idField||this.compositeKey){this.idField=null;this.compositeKey=A.apply(null,Object.keys(this.idFields))}else this.idField=
J}if(M.calc)this.addCalcField(J,M.calc,void 0);else this.fields[J]=N;this.defaults[J]="defValue"in M?M.defValue:N();this.getters["get_"+J]=function(){return this.data[J]};D[J]||(D[J]={destroy:function(){this.set(J,null)}})}},addCalcField:function(J,M,N){if(!(J&&this.fields[J])){if(!this.calcs)this.calcs=[];for(var S={args:M.args,wrapper:!N?M:function(W,$,Y){return N(M(W,$,Y))}},U=this.calcs.length,aa=0,R=0;R<this.calcs.length;R++)if(M.args.has(this.calcs[R].key))aa=R+1;if(J){S.key=J;for(R=0;R<this.calcs.length;R++)if(this.calcs[R].args.has(J)){U=
R;break}if(aa>U)return;if(this.idField&&J==this.idField)this.compositeKey=M;this.fields[J]=function(W,$){typeof console!="undefined"&&console.log("Calculate fields are readonly");return $}}else U=aa;this.calcs.splice(Math.min(U,aa),0,S)}},get:function(J){J=this.getId(J);if(J!=null)return this.index__.get(J,this.entityClass)},getId:function(J){if((this.idField||this.compositeKey)&&J!=null){if(l[typeof J])return J;if(J&&J.entityType===this)return J.__id__;if(J instanceof t)J=J.data;return this.compositeKey?
this.compositeKey(J,J):J[this.idField]}},getSlot:function(J){var M=this.getId(J);if(M!=null){var N=this.slot_[M];if(!N){if(l[typeof J]){N={};if(this.idField&&!this.compositeKey)N[this.idField]=J;J=N}N=this.slot_[M]=new t({delegate:this.get(M),data:J})}return N}}}),P=y(t,{init:F.prototype.init,event_rollbackUpdate:F.createEvent("rollbackUpdate")}),Q=function(J,M,N,S,U,aa,R){function W(O,T,Z){var ba=false,ca=J.calcs,X=O.__id__,V=O.data;try{if(ca)for(var da=0,fa;fa=ca[da++];){var ea=fa.key;if(ea){var ha=
V[ea];V[ea]=fa.wrapper(T,V,V[ea]);if(V[ea]!==ha){T[ea]=ha;ba=true}}else fa.wrapper(T,V)}if(J.compositeKey)O.__id__=J.compositeKey(T,V,O.__id__);else if(Y&&Y in T)O.__id__=V[Y];O.__id__!==X&&J.index__.calcWrapper(O.__id__)}catch(ia){O.__id__=X;for(var ga in T)O.data[ga]=T[ga];if(Z)for(ga in Z)if(!O.modified)O.modified=Z;ba=false}O.__id__!==X&&$(O,X,O.__id__);return ba}function $(O,T,Z){if(T!=null){N.remove(T,O);S[T]&&S[T].setDelegate()}if(Z!=null){N.add(Z,O);S[Z]&&S[Z].setDelegate(O)}}var Y=J.idField;
return y(P,R,{canHaveDelegate:false,modified:null,isTarget:true,extendConstructor_:false,init:function(O){P.prototype.init.call(this);this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var T,Z={};for(var ba in U){if(ba in O){Z[ba]=aa[ba];T=U[ba](O[ba])}else T=aa[ba];if(T&&T!==this&&T instanceof F)if(T.addHandler(D[ba],this))this.fieldHandlers_[ba]=true;this.data[ba]=T}W(this,Z);M.event_datasetChanged(M,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+
"("+this.entityType.name+")]"},get:function(O){return this.data[O]},set:function(O,T,Z,ba){var ca=U[O];if(!ca){if(!J.extensible)return;ca=H}var X,V=this.modified;T=ca(T,this.data[O]);ca=this.data[O];if(T!==ca&&(!T||!ca||T.constructor!==Date||ca.constructor!==Date||+T!==+ca))a:{X={};if(O!=Y)if(Z){if(!V)this.modified=V={};if(O in V===false){X.rollback={key:O,value:undefined};V[O]=ca}else if(V[O]===T){X.rollback={key:O,value:T};delete V[O];if(!Object.keys(V).length)this.modified=null}}else if(V&&O in
V)if(V[O]!==T){X.rollback={key:O,value:V[O]};V[O]=T;break a}else return false;this.data[O]=T;if(this.fieldHandlers_[O]){ca.removeHandler(D[O],this);this.fieldHandlers_[O]=false}if(T&&T!==this&&T instanceof F)if(T.addHandler(D[O],this))this.fieldHandlers_[O]=true;X.key=O;X.value=ca;X.delta={};X.delta[O]=ca}else if(!Z&&V&&O in V){X={rollback:{key:O,value:V[O]}};delete V[O];if(!Object.keys(V).length)this.modified=null}if(!ba&&X){Z=X.key;O=X.delta||{};var da;if(X.rollback){da={};da[X.rollback.key]=X.rollback.value}if(W(this,
O,da))Z=true;if(Z){this.event_update(this,O);X.delta=O}da&&this.event_rollbackUpdate(this,da)}return X||false},update:function(O,T){if(O){var Z,ba={},ca,X={},V;for(var da in O)if(V=this.set(da,O[da],T,true)){if(V.key){Z=true;ba[V.key]=V.value}if(V.rollback){ca=true;X[V.rollback.key]=V.rollback.value}}if(W(this,ba,X))Z=true;Z&&this.event_update(this,ba);ca&&this.event_rollbackUpdate(this,X)}return Z?ba:false},reset:function(){this.update(aa)},clear:function(){var O={};for(var T in this.data)O[T]=undefined;
return this.update(O)},commit:function(O){if(this.modified){var T=this.modified;this.modified=null}this.update(O);T&&this.event_rollbackUpdate(this,T)},rollback:function(){if(this.state!=j.PROCESSING){if(this.modified){var O=this.modified;this.modified=null;this.update(O);this.event_rollbackUpdate(this,O)}this.setState(j.READY)}},destroy:function(){for(var O in this.fieldHandlers_)this.data[O].removeHandler(D[O],this);this.fieldHandlers_=o;this.__id__&&$(this,this.__id__,null);t.prototype.destroy.call(this);
M.event_datasetChanged(M,{deleted:[this]});this.data=o;this.modified=null}})};r.namespace("basis.entity").extend({isEntity:function(J){return J&&J instanceof Q},NumericId:d,NumberId:a,IntId:c,StringId:e,Index:i,CalculateField:x,EntityType:k,Entity:Q,BaseEntity:P,EntitySetType:q,EntitySet:n,ReadOnlyEntitySet:s,Collection:G,Grouping:K})})(basis);
(function(r){var z=r.Class,x=Object.extend,A=r.EventObject,y=A.createEvent;r.ua.Cookies.get("DEBUG_MODE");var C,I,H=false,B={},E=Date.now,F=x(new A,{event_sessionOpen:y("sessionOpen"),event_sessionClose:y("sessionClose"),event_sessionFreeze:y("sessionFreeze"),event_sessionUnfreeze:y("sessionUnfreeze"),isOpened:function(){return!!C},getTimestamp:function(){if(C)return I},open:function(p,w){var t;B[p]||(B[p]=new v(p));t=B[p];if(C===t)H&&this.unfreeze();else{this.close();C=t;I=E();w&&x(t.data,w);this.event_sessionOpen(this)}},
close:function(){if(C){H&&this.unfreeze();this.event_sessionClose(this);I=C=null}},freeze:function(){if(C&&!H){this.event_sessionFreeze(this);H=true;I=null}},unfreeze:function(){if(C&&H){H=false;I=E();this.event_sessionUnfreeze(this)}},storeData:function(p,w){if(C)return C.storeData(p,w);else throw new Error("No opened session");},getData:function(p){if(C)return C.getData(p);else throw new Error("No opened session");},destroy:function(){for(var p=Object.keys(B),w;w=p.pop();)B[w].destroy();A.prototype.destroy.call(this)}}),
v=z(A,{event_destroy:function(){C==this&&F.close();delete B[this.key]},extendConstructor_:false,init:function(p){A.prototype.init.call(this);this.key=p;this.data={}},storeData:function(p,w){if(H)throw new Error("Session is frozen");return this.data[p]=w},getData:function(p){if(H)throw new Error("Session is frozen");return this.data[p]},destroy:function(){A.prototype.destroy.call(this);for(var p=Object.keys(this.data),w;w=p.pop();){var t=this.data[w];t!=null&&typeof t.destroy=="function"&&t.destroy();
delete this.data[w]}}});r.namespace("basis.session").extend({SessionManager:F})})(basis);
(function(r){function z(b){var d=r.EventObject.createEvent(b),a=[b];return function(){l.dispatch.apply(this,a.concat(arguments));d.apply(this,arguments)}}function x(b,d){var a={"JS-Framework":"Basis"};if(w.test(d.method)){a["Content-Type"]=d.contentType+(d.encoding?";charset="+d.encoding:"");if(H.test("gecko"))a.Connection="close"}else if(H.test("ie"))a["If-Modified-Since"]=(new Date(0)).toGMTString();Object.iterate(Object.extend(a,d.headers),function(c,e){e!=null&&this.setRequestHeader(c,e)},b)}
function A(b){var d=this.transport;if(d){if(typeof b!="number")b=d.readyState;if(b!=this.prevReadyState_){this.prevReadyState_=b;this.event_readyStateChanged(b);if(b==4){E.remove(this,"timeoutAbort");b=p.UNDEFINED;var a;this.progress=false;d.onreadystatechange=Function.$undef;if(this.aborted){var c=this.abortedByTimeout_;c&&this.event_timeout();this.event_abort(c)}else{b=this.responseIsSuccess();this.update({text:d.responseText,xml:d.responseXML});if(b){this.event_success(d);b=p.READY}else{this.event_failure(d);
b=p.ERROR;a=this.getRequestError(d)}this.event_httpStatus(d,d.status)}this.event_complete(d);this.setState(b,a)}else this.setState(p.PROCESSING)}}}function y(b){E.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=false;this.prevReadyState_=-1;if(H.test("gecko1.8.1-")&&b.asynchronous)this.transport=o();var d=this.transport;if(this.asynchronous)d.onreadystatechange=A.bind(this);else A.call(this,0);d.open(b.method,b.location,b.asynchronous);this.progress=true;this.abortedByTimeout_=
this.aborted=false;x(d,b);this.event_start();if(this.aborted)A.call(this,4);else if(!(this.aborted||!this.progress)){this.requestStartTime=Date.now();E.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var a=b.postBody;if(b.method=="POST"&&H.test("ie9-"))if(typeof a=="object"&&typeof a.documentElement!="undefined"&&typeof a.xml=="string")a=a.xml;else if(typeof a=="string")a=a.replace(/\r/g,"");else if(a==null||a=="")a="[empty request]";d.send(a);return true}}var C=r.Class,I=r.dom.event,
H=r.ua,B=r.Cleaner,E=r.TimeEventManager,F=r.data,v=F.DataObject,p=F.STATE,w=/POST/i;F=r.ua.Cookies.get("DEBUG_AJAX");var t={};(function(){var b=t.win1251={escape:{},unescape:{}};b.escape["401"]="%A8";b.unescape.A8=1025;b.escape["451"]="%B8";b.unescape.B8=1105;for(var d=192;d<=255;d++){b.unescape[d.toHex()]=String.fromCharCode(d+848);b.escape[(d+848).toHex()]="%"+d.toHex()}})();var j="native",o=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var b=window.ActiveXObject;
if(b)for(var d=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],a=0;j=d[a];a++)try{if(new b(j))return function(){return new b(j)}}catch(c){}throw new Error(j="Browser doesn't support for XMLHttpRequest!");}(),l=function(){var b=[],d=[{handler:{start:function(){b.add(this)},complete:function(){b.remove(this)}}}];I.onUnload(function(){d.clear()});return{addHandler:function(a,c){for(var e=0,f;f=d[e];e++)if(f.handler===a&&f.thisObject===c)return false;d.push({handler:a,
thisObject:c});return true},removeHandler:function(a,c){for(var e=0,f;f=d[e];e++)if(f.handler===a&&f.thisObject===c){d.splice(e,1);return true}return false},dispatch:function(a){if(d.length)for(var c=Array.prototype.slice.call(arguments,1),e,f,i=d.length-1;e=d[i];i--){f=e.handler[a];if(typeof f=="function")f.apply(e.thisObject||this,c)}},abort:function(){for(var a=Array.from(b),c=0;c<a.length;c++)a[c].abort();return a}}}();C=C(v,{state:p.UNDEFINED,event_start:z("start"),event_readyStateChanged:z("readyStateChanged"),
event_timeout:z("timeout"),event_abort:z("abort"),event_success:z("success"),event_failure:z("failure"),event_httpStatus:z("httpStatus"),event_complete:z("complete"),event_stateChanged:function(b,d){v.prototype.event_stateChanged.call(this,b,d);for(var a=0;a<this.influence.length;a++)this.influence[a].setState(this.state,this.state.data)},influence:null,debug:F,progress:false,aborted:false,abortedByTimeout_:false,abortCalled:false,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:true,
method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(b){var d=this.influence;this.transport=o();this.requestHeaders={};this.influence=[];this.params={};d&&this.setInfluence.apply(this,d);B.add(this);v.prototype.init.call(this,b);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var b=Array.from(arguments),d=0;d<b.length;d++)b[d].setState(this.state,this.state.data);this.influence.set(b)},clearInfluence:function(){this.influence.clear()},
setParam:function(b,d){this.params[b]=d},setParams:function(b){this.clearParams();for(var d in b)this.setParam(d,b[d])},removeParam:function(b){delete this.params[b]},clearParams:function(){for(var b in this.params)delete this.params[b]},timeoutAbort:function(){this.abortedByTimeout_=true;this.abort()},abort:function(){this.aborted=true;if(this.progress){E.remove(this,"timeoutAbort");this.progress=false;this.transport.abort();this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==
Function.$undef&&A.call(this,4)}},request:function(b){b=b||this.url;var d=this.method.toUpperCase(),a,c;if(!this.transport)throw new Error("Transport is not allowed");if(!b)throw new Error("URL is not defined");this.abort();delete this.requestData_;this.update({responseText:"",responseXml:null});this.abortedByTimeout_=this.aborted=this.progress=false;a=Object.iterate(this.params,function(e,f){return f==null||f&&typeof f.toString=="function"&&f.toString()==null?null:e+"="+String(f.toString()).replace(/[\%\=\&\<\>\s\+]/g,
function(i){i=i.charCodeAt(0).toHex();return"%"+(i.length<2?"0":"")+i})}).filter(Function.$isNotNull).join("&");if(w.test(d))c=this.postBody||a||"";else if(a)b+=(b.indexOf("?")==-1?"?":"&")+a;this.requestData_={method:d,location:b,contentType:this.contentType,encoding:this.encoding,asynchronous:this.asynchronous,headers:Object.extend({},this.requestHeaders),postBody:c};return y.call(this,this.requestData_)},repeat:function(){if(this.requestData_){this.abort();return y.call(this,this.requestData_)}},
get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var b=this.transport.status;return b==undefined||b==0||b>=200&&this.transport.status<300}}catch(d){}return false},getRequestError:function(b){return{code:"SERVER_ERROR",msg:b.responseText}},destroy:function(){this.destroy=Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();v.prototype.destroy.call(this);delete this.transport;
B.remove(this)}});r.namespace("basis.net.ajax").extend({Transport:C,TransportDispatcher:l,createEvent:z})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.net.ajax,y=r.xml,C=A.Transport,I=y.QName,H=y.addNamespace,B=y.XML2Object,E=y.Object2XML,F=y.createElementNS,v=y.NAMESPACE,p=String("http://schemas.xmlsoap.org/soap/envelope/"),w=String("http://schemas.xmlsoap.org/soap/encoding/"),t=z(null,{url:null,namespace:null,init:function(a,c){this.url=a;this.namespace=c},call:function(a,c){a=this.createMethodCall(a,c,false);a.transport.abort();a.invoke(c.header,c.body,c.callback,c.mapping)},createMethodCall:function(a,
c,e){return new j(this,new I(a,this.namespace),c,e)}}),j=z(null,{service:null,transport:null,method:null,envelope:null,body:null,init:function(a,c,e,f){e=e||{};this.method=c;this.envelope=new l;this.url=a.url;this.transport=new o(c,e.callback);this.transport.requestHeaders={SOAPAction:c.namespace+(!/\/$/.test(c.namespace)?"/":"")+c};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return a.url}};e.mapping&&this.transport.setMapping(e.mapping);
e.callback&&this.transport.setCallback(e.callback);if(f)this.body=e.body||{}},repeatCall:function(){this.transport.get()},call:function(a){return this.invoke(null,a||this.body)},invoke:function(a,c,e,f){this.transport.abort();this.envelope.getBody(true).setValue(this.method,c);a&&this.envelope.getHeader(true).setValue(a,this.method.namespace);e&&this.transport.setCallback(e);f&&this.transport.setMapping(f);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();
this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),o=z(C,{callback:{},mapping:null,method:"POST",contentType:"text/xml",encoding:"utf-8",event_success:function(a){var c=a.responseXML;if(c===undefined||c.documentElement===undefined)this.event_failure(this);else{var e=Array.from(arguments);if(c.xml&&DOMParser)c=(new DOMParser).parseFromString(c.xml,"text/xml");this.responseEnvelope=new l(c.documentElement);e.push(this.getResponseData(),this.getRequestData());C.prototype.event_success.apply(this,
e)}},event_failure:function(a){var c=Array.from(arguments),e=this.state.data||this.getRequestError(a);e.isSoapFailure&&this.event_soapfailure(a,e.code,e.msg);c.push(e.code,e.msg);C.prototype.event_failure.apply(this,c)},event_soapfailure:A.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(a){return x.tag(a,"code")[0]},errorMessageGetter:function(a){return x.tag(a,"message")[0]},extendConstructor_:false,init:function(a){C.prototype.init.call(this);
this.soapMethod=a},setCallback:function(a){typeof a=="object"&&this.addHandler(a)},setMapping:function(a){this.mapping=a},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},getResponseData:function(){var a=this.responseEnvelope&&this.responseEnvelope.getBody();if(a)return this.responseDataGetter(a.getValue(this.mapping))},getRequestError:function(a){var c,e,f=false;a=a.responseXML;if(a!=undefined&&a.documentElement!=undefined){c=a.documentElement;f=
this.errorCodeGetter(c);e=this.errorMessageGetter(c);this.responseEnvelope=new l(c);c=f?f.firstChild.nodeValue:"UNKNOWN_ERROR";e=e?e.firstChild.nodeValue:"Unknown error";console.log("SoapError:",c.quote("("),e);f=true}return{code:c||"TRANSPORT_ERROR",msg:e,isSoapFailure:f}}}),l=z(null,{header:null,body:null,init:function(a){if(!a){a=y.createDocument(p,"soap:Envelope").documentElement;H(a,"xsd",v.XMLShema);H(a,"xsi",v.XMLShemaInstance);y.XMLNS.BAD_SUPPORT&&H(a,"soap",p)}this.document=a.ownerDocument;
this.element=a;this.body=this.getBody(true)},getElementByName:function(a){return y.getElementsByTagNameNS(this.element,a,p)[0]},getHeader:function(a){var c=this.header;if(!c){var e=this.getElementByName("Header");if(e||a){c=this.header=new b(e,this.document);e||this.element.insertBefore(c.element,this.element.firstChild)}}return c},setHeaderSection:function(a,c){this.getHeader(true).setSection(a,c)},getBody:function(a){var c=this.body;if(!c){var e=this.getElementByName("Body");if(e||a){c=this.body=
new d(e,this.document);e||this.element.appendChild(c.element)}}return c},destroy:function(){if(this.header){this.header.destroy();delete this.header}if(this.body){this.body.destroy();delete this.body}delete this.element;delete this.document}}),b=z(null,{init:function(a,c){this.element=a||F(c,"Header",p)},getValue:function(){return B(this.element)},setValue:function(a,c){x.clear(this.element);this.appendChild(a,c)},appendChild:function(a,c){if(a)for(var e in a){var f=this.element.appendChild(E(this.element.ownerDocument,
e,c,a[e]));y.XMLNS.BAD_SUPPORT&&H(f,"",c)}},setSection:function(a,c){var e=y.getElementsByTagNameNS(this.element,a,a.namespace)[0];e&&x.remove(e);this.appendChild(Function.wrapper(a)(c),a.namespace)}}),d=z(null,{init:function(a,c){this.element=a||F(c,"Body",p)},getValue:function(a){return B(this.element,a)},setValue:function(a,c,e){x.clear(this.element);this.appendChild(a,c,e)},appendChild:function(a,c,e){c=E(this.element.ownerDocument,a,a.namespace,Function.$defined(c)?c:{});this.element.appendChild(c);
y.XMLNS.BAD_SUPPORT&&H(c.element,"",a.namespace);e&&y.setAttributeNodeNS(c,y.createAttributeNS(document,"encodingStyle",w,e))}});r.namespace("basis.net.soap").extend({Service:t,ServiceCall:j,ServiceCallTransport:o,Envelope:l,EnvelopeHeader:b,EnvelopeBody:d})})(basis);
(function(r){var z=Function.getter,x=r.Class,A=r.dom,y=r.ui.Node,C=r.ui.Control,I=x(y,{captionGetter:z("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){y.prototype.event_select.call(this);A.focus(this.element)},event_disable:function(){y.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=true},event_enable:function(){y.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=false},init:function(H){y.prototype.init.call(this,H);this.setCaption(this.caption)},setCaption:function(H){this.caption=H;this.tmpl.captionText.nodeValue=this.captionGetter(this)}});x=x(C,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:I,getButtonByName:function(H){return this.childNodes.search(H,
z("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(H){return H.groupId||-H.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});r.namespace("basis.ui.button").extend({Button:I,ButtonPanel:x})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.html.Template,y=Function.getter,C=r.EventObject.createEvent,I=r.data.STATE,H=r.ui.Node,B=new A('<div{element|content} class="Basis-Label-State"/>'),E=new A('<div{element|content} class="Basis-Label-Processing"/>'),F=new A('<div{element|content} class="Basis-Label-Error"/>'),v=z(H,{cascadeDestroy:true,show_:false,visible_:false,visibilityGetter:Function.$false,insertPoint:x.INSERT_END,content:"[no text]",event_delegateChanged:function(d,a){(a?a.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:C("visibilityChanged"),init:function(d){var a=this.container;this.container=null;H.prototype.init.call(this,d);if(a)this.container=a;this.traceChanges_();return d},traceChanges_:function(){if(this.container&&this.visible_)this.container!=this.element.parentNode&&x.insert(this.container,this.tmpl.element,this.insertPoint);else x.remove(this.element)},setContainer:function(d){if(this.container!=d){this.container=
d;this.traceChanges_()}},setVisibility:function(d){if(this.visible_!=d){this.visible_=d;this.traceChanges_();this.event_visibilityChanged(this.visible_)}},destroy:function(){delete this.container;H.prototype.destroy.call(this)}}),p=z(v,{template:B,init:function(d){if(this.visibleStates&&!this.visibilityGetter){for(var a={},c,e=0;c=this.visibleStates[e++];)a[c]=true;this.visibilityGetter=y(Function.$self,a)}v.prototype.init.call(this,d)}});C=z(p,{event_delegateChanged:function(d,a){p.prototype.event_delegateChanged.call(this,
d,a);this.delegate&&this.event_stateChanged(this)},event_stateChanged:function(d,a){p.prototype.event_stateChanged.call(this,d,a);this.setVisibility(this.visibilityGetter(this.state,a))}});var w=z(C,{visibilityGetter:function(d){return d==I.PROCESSING},content:"Processing...",template:E});F=z(C,{visibilityGetter:function(d){return d==I.ERROR},content:"Error",template:F});var t={stateChanged:function(d,a){this.setVisibility(this.visibilityGetter(d.state,a))}},j={dataSourceChanged:function(d,a){a&&
a.removeHandler(t,this);if(d.dataSource){d.dataSource.addHandler(t,this);t.stateChanged.call(this,d.dataSource,d.dataSource.state)}}};B=z(p,{event_delegateChanged:function(d,a){p.prototype.event_delegateChanged.call(this,d,a);a&&a.removeHandler(j,this);if(this.delegate){this.delegate.addHandler(j,this);j.dataSourceChanged.call(this,this.delegate,a&&a.dataSource)}},template:B});E=z(B,{visibilityGetter:function(d){return d==I.PROCESSING},content:"Processing...",template:E});var o=function(){this.setVisibility(this.visibilityGetter(this.delegate?
this.delegate.childNodes.length:0,this.delegate))},l={stateChanged:function(d){this.setVisibility(this.visibilityGetter(d.itemCount,this.delegate))}},b={childNodesModified:o,dataSourceStateChanged:o,stateChanged:o,dataSourceChanged:function(d,a){a&&a.removeHandler(l,this);if(d.dataSource){d.dataSource.addHandler(l,this);l.stateChanged.call(this,d.dataSource,d.dataSource.state)}}};A=z(v,{event_delegateChanged:function(d,a){v.prototype.event_delegateChanged.call(this,d,a);a&&a.removeHandler(b,this);
if(this.delegate){this.delegate.addHandler(b,this);b.dataSourceChanged.call(this,this.delegate)}o.call(this)},template:new A('<div{element|content} class="Basis-CountLabel"/>')});z=z(A,{visibilityGetter:function(d,a){var c=a.dataSource?a.dataSource.state:a.state;return!d&&c==I.READY},content:"Empty"});r.namespace("basis.ui.label").extend({NodeLabel:v,State:p,ObjectState:C,Processing:w,Error:F,DataSourceState:B,DataSourceProcessing:E,ChildCount:A,IsEmpty:z})})(basis);
(function(r){function z(j){typeof j.expand=="function"&&j.expand()}function x(j){typeof j.collapse=="function"&&j.collapse()}var A=r.Class,y=r.dom,C=r.dom.event,I=r.cssom.classList,H=Function.getter,B=r.EventObject.createEvent,E=r.ui.Container,F=r.ui.Control,v=r.ui.PartitionNode,p=r.ui.GroupingNode,w={expandAll:function(){y.axis(this,y.AXIS_DESCENDANT_OR_SELF,z)},collapseAll:function(){y.axis(this,y.AXIS_DESCENDANT_OR_SELF,x)},expand:Function(),collapse:Function(),toggle:Function()};v=A(v,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'});
p=A(p,{childClass:v});var t=A(E,w,{canHaveChildren:false,childFactory:null,event_collapse:B("collapse"),event_expand:B("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(j){j.titleText.nodeValue=String(this.titleGetter(this))||"[no title]"},action:{select:function(j){this.isDisabled()||this.select(C(j).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:H("data.title")});H=A(t,{canHaveChildren:true,childClass:t,localGroupingClass:p,event_expand:function(){t.prototype.event_expand.call(this);I(this.element).remove("collapsed")},event_collapse:function(){t.prototype.event_collapse.call(this);I(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:true,collapsed:false,init:function(j){t.prototype.init.call(this,j);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed){this.collapsed=false;this.event_expand();return true}},collapse:function(){if(!this.collapsed&&this.collapsable){this.collapsed=true;this.event_collapse();return true}},toggle:function(){this.collapsed?this.expand():this.collapse()}});A=A(F,w,{childClass:t,localGroupingClass:p,template:'<ul class="Basis-Tree"/>'});r.namespace("basis.ui").extend({Tree:A});
r.namespace("basis.ui.tree").extend({Tree:A,Node:t,Folder:H,GroupingNode:p,PartitionNode:v})})(basis);
(function(){var r=basis.Class,z=basis.dom,x=basis.dom.event,A=basis.cssom,y=Function.getter,C=basis.cssom.classList,I=basis.Cleaner,H=basis.layout,B=basis.EventObject.createEvent,E=basis.ui.Node,F=basis.ui.Container,v=basis.ui.Control,p=basis.ui.PartitionNode,w=basis.ui.GroupingNode,t={VERTICAL:"V",HORIZONTAL:"H"},j=String("LTRTRBLBLCCTRCCBCCCCCCCC"),o={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},l={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},b={finish:function(){if(!this.visible){z.remove(this.element);
this.event_cleanup(this)}}};B=r(F,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:B("beforeShow"),event_show:B("show"),event_hide:B("hide"),event_realign:B("realign"),event_cleanup:B("cleanup"),event_layoutChanged:B("layoutChanged","oldOrientation","oldDir")&&function(f,i){var m=(f+"-"+i.qw().slice(2,4).join("-")).toLowerCase(),g=(this.orientation+
"-"+this.dir.qw().slice(2,4).join("-")).toLowerCase();C(this.element).replace(m,g,this.cssLayoutPrefix)},visible:false,autorotate:false,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:t.VERTICAL,hideOnAnyClick:true,hideOnKey:false,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(f){F.prototype.init.call(this,f);this.cssRule=A.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,
this.orientation);this.thread&&this.thread.addHandler(b,this);I.add(this)},setLayout:function(f,i,m){var g=this.dir,n=this.orientation;if(typeof f=="string")this.dir=f.toUpperCase();if(typeof i=="string")this.orientation=i;if(g!=this.dir||n!=this.orientation){this.event_layoutChanged(n,g);m||this.realign()}},flip:function(f){var i=this.dir.qw();f=f==t.VERTICAL;i[0+f]=l[i[0+f]];i[2+f]=l[i[2+f]];this.setLayout(i.join(" "))},rotate:function(f){var i=this.dir.qw();f=(f%4+4)%4;var m=[];if(!f)return i;
var g=i[0].charAt(0),n=i[1].charAt(0),s=j.indexOf(g+n)>>1;g=(s&252)+((s&3)+f&3)<<1;m.push(o[j.charAt(g)],o[j.charAt(g+1)]);g=i[2].charAt(0);n=i[3].charAt(0);s=j.indexOf(g+n)>>1;f=g!="C"&&n!="C"&&i[0]==i[2]!=(i[1]==i[3])?-f+4:f;g=(s&252)+((s&3)+f&3)<<1;m.push(o[j.charAt(g)],o[j.charAt(g+1)]);return m},isFitToViewport:function(f){if(this.visible&&this.relElement){var i=new H.Box(this.relElement,false,this.element.offsetParent),m=new H.Viewport(this.element.offsetParent),g=this.element.offsetWidth,n=
this.element.offsetHeight;f=String(f||this.dir).toUpperCase().qw();var s=f[0]=="CENTER"?i.left+(i.width>>1):i[f[0].toLowerCase()];i=f[1]=="CENTER"?i.top+(i.height>>1):i[f[1].toLowerCase()];if((f[2]!="LEFT")*(s<g>>(f[2]=="CENTER"))||(f[2]!="RIGHT")*(m.width-s<g>>(f[2]=="CENTER")))return false;if((f[3]!="TOP")*(i<n>>(f[3]=="CENTER"))||(f[3]!="BOTTOM")*(m.height-i<n>>(f[3]=="CENTER")))return false;return{x:s,y:i}}},realign:function(){if(this.visible&&this.relElement){for(var f=this.dir.qw(),i,m=0,g=
f,n=f[2],s=f[3],G=typeof this.autorotate=="number"||!this.autorotate.length?3:this.autorotate.length;this.autorotate&&m<=G;){if(i=this.isFitToViewport(g.join(" "))){n=g[2];s=g[3];this.setLayout(g.join(" "),null,true);break}if(m==G)break;if(Array.isArray(this.autorotate)){g=this.autorotate[m++];g=typeof g=="string"?g.toUpperCase().split(" "):this.rotate(g)}else g=this.rotate(++m*this.autorotate)}if(!i){i=new H.Box(this.relElement,false,this.element.offsetParent);i={x:f[0]=="CENTER"?i.left+(i.width>>
1):i[f[0].toLowerCase()],y:f[1]=="CENTER"?i.top+(i.height>>1):i[f[1].toLowerCase()]}}f=new H.Box(this.element.offsetParent);m={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(n){case "LEFT":m.left=i.x+"px";break;case "CENTER":m.left=Math.round(i.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":m.right=f.width-i.x+"px";break}switch(s){case "TOP":m.top=i.y+"px";break;case "CENTER":m.top=Math.round(i.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":m.bottom=f.height-i.y+"px";break}this.cssRule.setStyle(m);
this.event_realign()}},show:function(f,i,m){this.relElement=z.get(f)||this.relElement;this.setLayout(i||this.defaultDir,m);if(this.visible)this.realign();else if(this.relElement){C(this.element).remove("pre-transition");z.visibility(this.element,false);e.appendChild(this);this.event_beforeShow();this.visible=true;this.realign();this.thread&&this.thread.start(1);z.visibility(this.element,true);C(this.element).add("pre-transition");this.event_show()}},hide:function(){if(this.visible){if(z.parentOf(document.body,
this.element))if(this.thread)this.thread.start(1);else{z.remove(this.element);this.event_cleanup(this)}this.visible=false;this.parentNode&&e.removeChild(this);this.event_hide()}},hideAll:function(){e.clear()},destroy:function(){if(this.thread){this.thread.removeHandler(b,this);this.thread=null}this.hide();F.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;I.remove(this)}});var d=r(B,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
a=r(F,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(f){this.click();x.kill(f)}},event_childNodesModified:function(f,i){C(this.element).bool("hasSubItems",this.hasChildNodes());F.prototype.event_childNodesModified.call(this,f,i)},groupId:0,caption:"[untitled]",captionGetter:y("caption"),handler:null,defaultHandler:function(f){this.parentNode&&this.parentNode.defaultHandler(f)},init:function(f){F.prototype.init.call(this,
f);this.setCaption(this.caption)},setCaption:function(f){this.caption=f;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){if(!this.isDisabled()&&!(this instanceof c))this.handler?this.handler(this):this.defaultHandler(this)}});a.prototype.childClass=a;var c=r(a,{event_childNodesModified:E.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'});E=r(p,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'});
w=r(w,{childClass:E});r=r(B,{childClass:a,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:w,localGrouping:y("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'});var e=new v({id:"Basis-PopupStack",handheldMode:false,childClass:B,event_childNodesModified:function(f,i){if(i.deleted)for(var m=i.deleted.length-
1,g;g=i.deleted[m];m--)g.hide();if(i.inserted&&!i.deleted&&this.childNodes.length==i.inserted.length){C(this.element).add("IsNotEmpty");document.body.className=document.body.className;x.addGlobalHandler("click",this.hideByClick,this);x.addGlobalHandler("keydown",this.hideByKey,this);x.addGlobalHandler("scroll",this.hideByScroll,this);x.addHandler(window,"resize",this.realignAll,this)}if(this.lastChild)this.lastChild.select();else{C(this.element).remove("IsNotEmpty");document.body.className=document.body.className;
x.removeGlobalHandler("click",this.hideByClick,this);x.removeGlobalHandler("keydown",this.hideByKey,this);x.removeGlobalHandler("scroll",this.hideByScroll,this);x.removeHandler(window,"resize",this.realignAll,this)}v.prototype.event_childNodesModified.call(this,f,i)},insertBefore:function(f,i){var m=document.documentElement.scrollTop,g=document.body.scrollTop;if(v.prototype.insertBefore.call(this,f,i)){f.documentST_=m;f.bodyST_=g;if(this.handheldMode){document.documentElement.scrollTop=0;document.body.scrollTop=
0}f.element.style.zIndex=basis.ui.Window?basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(f){if(f){f.hideOnAnyClick&&f.nextSibling&&this.removeChild(f.nextSibling);v.prototype.removeChild.call(this,f);if(this.handheldMode){document.documentElement.scrollTop=f.documentST_;document.body.scrollTop=f.bodyST_}}},realignAll:function(){for(var f=this.firstChild;f;f=f.nextSibling)f.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(f){f=x.sender(f);
for(var i,m=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),g=0,n;n=m[g];g++){if(f===n.tmpl.closeButton||z.parentOf(n.tmpl.closeButton,f)){this.removeChild(n);return}i||(i=z.axis(f,z.AXIS_ANCESTOR_OR_SELF));if(i.has(n.element)||i.some(Array.prototype.has,n.ignoreClickFor)){this.removeChild(m[g-1]);return}}this.removeChild(m.pop())},hideByKey:function(f){f=x.key(f);var i=this.lastChild;if(i&&i.hideOnKey){var m=false;if(typeof i.hideOnKey=="function")m=i.hideOnKey(f);else if(Array.isArray(i.hideOnKey))m=
i.hideOnKey.has(f);m&&i.hide()}},hideByScroll:function(f){f=x.sender(f);if(!z.parentOf(f,this.element))for(var i=this.lastChild;i;){var m=i.previousSibling;i.relElement&&i.offsetParent!==f&&z.parentOf(f,i.relElement)&&i.hide();i=m}}});x.onLoad(function(){z.insert(document.body,e.element,z.INSERT_BEGIN);e.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:t,setHandheldMode:function(f){e.handheldMode=!!f},Popup:B,Balloon:d,Menu:r,MenuGroupControl:w,MenuPartitionNode:E,MenuItem:a,MenuItemSet:c})})(basis);
(function(r){var z=r.Class,x=r.dom.event,A=r.dom,y=r.html.Template,C=r.cssom.classList,I=r.dom.wrapper,H=I.GroupingNode,B=I.PartitionNode,E=r.ui.Node,F=r.ui.Container,v=r.ui.Control,p=r.ui.PartitionNode,w=r.ui.GroupingNode,t=z(E,{template:new y('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(a){a.titleText.nodeValue=
this.titleGetter(this)}}),j=z(H,{event_ownerChanged:function(a,c){c&&A.remove(this.headerRow);if(this.owner&&this.owner.element){var e=this,f=this.owner.element;do A.insert(f,e.headerRow,A.INSERT_BEGIN);while(e=e.localGrouping)}H.prototype.event_ownerChanged.call(this,a,c)},childClass:{init:function(a){B.prototype.init.call(this,a);this.cell=new t({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(a,c){var e=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var f=
0,i;i=this.nodes[f];f++)e+=i.cell.element.colSpan;else e=this.nodes.length;this.cell.element.colSpan=e;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{});B.prototype.event_childNodesModified.call(this,a,c)},destroy:function(){B.prototype.destroy.call(this);this.cell.destroy()}},init:function(a){H.prototype.init.call(this,a);this.element=this.childNodesElement=this.headerRow=A.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(a,c){a=
H.prototype.insertBefore.call(this,a,c);A.insert(this.headerRow,a.cell.element,A.INSERT_BEFORE,a.nextSibling&&a.nextSibling.cell.element);return a},removeChild:function(a){A.remove(a.cell.element);H.prototype.removeChild.call(a)},destroy:function(){H.prototype.destroy.call(this);this.headerRow=null}});j.prototype.localGroupingClass=j;I=z(E,{sorting:null,defaultOrder:false,groupId:0,template:new y('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var a=this.parentNode&&this.parentNode.owner;a&&a.setLocalSorting(a.localSorting,!a.localSortingDesc)}else this.select()}},init:function(a){E.prototype.init.call(this,a);this.selectable=!!this.sorting;if(this.sorting){this.sorting=Function.getter(this.sorting);this.defaultOrder=this.defaultOrder=="desc";C(this.element).add("sortable")}},select:function(){if(!this.selected)this.order=this.defaultOrder;E.prototype.select.call(this)}});var o=z(F,{childClass:I,
localGroupingClass:j,template:new y('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(a){var c=this.childNodes.search(a.localSorting,"sorting");if(c){c.select();c.order=a.localSortingDesc;C(this.tmpl.content).bool("sort-order-desc",c.order)}else this.selection.clear()}}},init:function(a){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(c){(c=
c.pick())&&this.owner&&this.owner.setLocalSorting(c.sorting,c.order)}}};F.prototype.init.call(this,a);this.applyConfig_(this.structure)},applyConfig_:function(a){a&&this.setChildNodes(a.map(function(c){var e=c.header,f=Object.slice(c,["sorting","defaultOrder","groupId"]);f.content=(e==null||typeof e!="object"?e:e.content)||String.Entity.nbsp;if(typeof f.content=="function")f.content=f.content.call(this);f.cssClassName=(e.cssClassName||"")+" "+(c.cssClassName||"");return f},this))}}),l=z(E,{colSpan:1,
template:new y('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),setColSpan:function(a){this.element.colSpan=this.colSpan=a||1}}),b=z(F,{childClass:l,childFactory:function(a){return new this.childClass(a)},template:new y('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(a){F.prototype.init.call(this,a);this.applyConfig_(this.structure);if(this.useFooter)A.insert(this.container||this.owner.element,this.element,1)},
applyConfig_:function(a){if(a){var c=null;this.clear();this.useFooter=false;for(var e=0;e<a.length;e++){var f=a[e],i;if(f.footer){i=f.footer.content;if(typeof i=="function")i=i.call(this);this.useFooter=true;i=this.appendChild({cssClassName:(f.cssClassName||"")+" "+(f.footer.cssClassName||""),content:i,template:f.footer.template||l.prototype.template})}else if(c)c.setColSpan(c.colSpan+1);else i=this.appendChild({});if(i)c=i}}}}),d=z(E,{canHaveChildren:false,repaintCount:0,getters:[],classNames:[],
template:'<tr class="Basis-Table-Row" event-click="select"><!--{cells}--\></tr>',action:{select:function(a){this.select(x(a).ctrlKey)}},templateUpdate:function(){this.repaintCount+=1;for(var a=0,c;c=this.updaters[a];a++){var e=this.element.childNodes[c.cellIndex];c=c.getter.call(this,this,e);if(this.repaintCount>1)e.innerHTML="";if(!c||!Array.isArray(c))c=[c];for(var f=0;f<c.length;f++){var i=c[f];e.appendChild(i&&i.nodeType?i:A.createText(i!=null&&(typeof i!="string"||i!="")?i:" "))}}}});p=z(p,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><!-- {childNodesHere} --\></tbody>',
action:{click:function(){C(this.element).toggle("collapsed")}}});z=z(v,{canHaveChildren:true,childClass:d,localGroupingClass:z(w,{childClass:p}),template:new y('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><!-- {footerElement} --\></table>'),templateAction:function(a,c){v.prototype.templateAction.call(this,a,c)},init:function(a){this.applyConfig_(this.structure);v.prototype.init.call(this,
a);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new o(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new b(Object.extend({owner:this,structure:this.structure},this.footer));A.replace(this.tmpl.headerElement,this.header.element);if(!this.localSorting&&this.structure&&this.structure.search(true,function(c){return c.sorting&&"autosorting"in c})){a=this.structure[Array.lastSearchIndex];this.setLocalSorting(a.sorting,a.defaultOrder=="desc")}},applyConfig_:function(a){if(a){var c=
[],e="";this.firstChild&&this.clear();for(var f=0;f<a.length;f++){var i=a[f],m=i.body||{};if(typeof m=="function"||typeof m=="string")m={content:m};i=[i.cssClassName||"",m.cssClassName||""].join(" ").trim();var g=m.content;e+="<td"+(m.templateRef?m.templateRef.quote("{"):"")+(i?' class="'+i+'"':"")+">"+(typeof g=="string"?m.content:"")+"</td>";typeof g=="function"&&c.push({cellIndex:f,getter:g})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new y(this.childClass.prototype.template.source.replace("<!--{cells}--\>",
e)),updaters:c});if(this.rowBehaviour){var n=this.rowBehaviour;Object.keys(n).forEach(function(s){this.childClass.prototype[s]=function(){n[s].apply(this,arguments);d.prototype[s].apply(this,arguments)}},this)}}},loadData:function(a){this.setChildNodes(a.map(Function.wrapper("data")))},destroy:function(){v.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});r.namespace("basis.ui.table").extend({Table:z,Body:p,Header:o,HeaderCell:I,Row:d,Footer:b});
r.namespace("basis.ui").extend({Table:z})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.dom.event,y=r.cssom,C=r.TimeEventManager,I=r.ui.table.Table,H=r.layout.Box,B=r.layout.Viewport,E=r.ui.table,F=17;A.onLoad(function(){var v=x.createElement("");x.setStyle(v,{height:"100px",overflow:"scroll"});x.insert(document.body,v);F=(new H(v)).width-(new B(v)).width;y.cssRule(".ScrollBarWidthOwner").setStyle({width:F+"px"});x.remove(v)});z=z(I,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(v,
p){I.prototype.event_childNodesModified.call(this,v,p);C.add(this,"adjust",Date.now())},init:function(v){I.prototype.init.call(this,v);this.headerClone=new E.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=
this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=x.insert(this.element,x.createElement(".Basis-ScrollTable-ExpandHeaderCell",x.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new H(this.header.element);if(this.footer.useFooter){x.insert(this.tmpl.foot,this.footer.element);this.footerClone=new E.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,structure:this.structure},this.footerConfig));this.originalCells=
this.originalCells.concat(this.footer.childNodes);this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes);x.setStyle(this.footerClone.element,{visibility:"hidden"});this.footerBox=new H(this.footer.element);this.footerExpandCell=x.insert(this.element,x.createElement(".Basis-ScrollTable-ExpandFooterCell"))}this.cellsAdjustmentInfo=[];v=0;for(var p,w;p=this.originalCells[v];v++){w=this.clonedCells[v];this.cellsAdjustmentInfo.push({element:w.element,boxChangeListener:p.element,contentSource:p.content,
contentDestination:w.content})}this.tableBox=new H(this.tmpl.tableElement);this.lastScrollLeftPosition=0;A.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));A.addHandler(window,"resize",this.adjust.bind(this));this.sync();C.add(this,"adjust",Date.now())},onScroll:function(){var v=this.tmpl.scrollContainer.scrollLeft;if(v!=this.lastScrollLeftPosition){x.setStyleProperty(this.tmpl.headerFooterContainer,"left",-v+"px");this.lastScrollLeftPosition=v}},adjust:function(){this.onScroll();
this.tableBox.recalc();var v=this.tableBox.width||0;if(this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth){x.setStyleProperty(this.tmpl.tableWrapperElement,"width",v+"px");x.setStyleProperty(this.tmpl.headerFooterContainer,"width",v+F+"px")}else{x.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%");x.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%")}this.cellsAdjustmentInfo.forEach(this.adjustCell);v=Math.max(0,this.tmpl.tableWrapperElement.clientWidth-
this.tmpl.tableElement.offsetWidth+F);this.headerBox.recalc();var p=this.headerBox.height||0;y.setStyleProperty(this.element,"paddingTop",p+"px");y.setStyleProperty(this.tmpl.tableElement,"marginTop",-p+"px");y.setStyle(this.headerExpandCell,{width:v+"px",height:p+"px"});if(this.footer.useFooter){this.footerBox.recalc();p=this.footerBox.height||0;y.setStyleProperty(this.element,"paddingBottom",p+"px");y.setStyleProperty(this.tmpl.tableElement,"marginBottom",-p+"px");y.setStyle(this.footerExpandCell,
{width:v+"px",height:p+"px"})}},sync:function(){this.adjust()},adjustCell:function(v){var p;p=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(v.element,null).width:v.element.clientWidth+"px";y.setStyleProperty(v.boxChangeListener,"width",p)}});r.namespace("basis.ui.scrolltable").extend({ScrollTable:z})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.dom.event,y=r.cssom,C=r.cssom.classList,I=r.Cleaner,H=r.EventObject.createEvent,B=r.dragdrop,E=r.ui.Node,F=r.ui.Container,v=r.ui.Control,p=r.ui.button.ButtonPanel,w=z(E,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(o){E.prototype.init.call(this,o);x.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});I.add(this)},capture:function(o,l){if(this.captureElement=
x.get(o||document.body)){x.insert(this.captureElement,this.element);this.element.style.zIndex=l||1E3;x.show(this.element)}},release:function(){if(this.captureElement){this.element.parentNode==this.captureElement&&x.remove(this.element);this.captureElement=null;x.hide(this.element)}},destroy:function(){this.release();E.prototype.destroy.call(this);I.remove(this)}});z=z(F,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(o){var l=A.key(o);if(l==A.KEY.ESCAPE)this.closeOnEscape&&this.close(0);else l==A.KEY.ENTER&&A.sender(o).tagName!="TEXTAREA"&&A.kill(o)}},event_beforeShow:H("beforeShow"),event_open:H("open"),event_close:H("close"),event_active:H("active"),closeOnEscape:true,autocenter:true,autocenter_:false,modal:false,closed:true,moveable:true,title:"[no title]",init:function(o){F.prototype.init.call(this,o);x.hide(this.element);
o=this.tmpl.title.parentNode;this.setTitle(this.title);this.cssRule=y.uniqueRule(this.element);if(this.moveable)if(B){this.dde=new B.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||o,fixRight:false,fixBottom:false});this.dde.addHandler({move:function(){this.autocenter=false;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));x.setStyle(this.element,{top:"",left:""})}},this)}var l=Array.from(this.buttons).map(function(c){return Object.complete({click:(c.click||
this.close).bind(this)},c)},this),b=Object.slice(this,["buttonOk","buttonCancel"]);for(var d in b){var a=b[d];l.push({name:d=="buttonOk"?"ok":"cancel",caption:a.caption||a.title||a,click:(a.click||this.close).bind(this)})}if(l.length)this.buttonPanel=new p({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:l});if(!this.titleButton||this.titleButton.close!==false){C(o).add("Basis-Window-Title-ButtonPlace-Close");x.insert(o,x.createElement("SPAN.Basis-Window-Title-ButtonPlace",
x.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',x.createElement("SPAN","Close"))),x.INSERT_BEGIN)}if(this.autocenter!==false)this.autocenter=this.autocenter_=true;this.thread&&this.thread.addHandler({finish:function(){this.closed&&x.remove(this.element)}},this);I.add(this)},setTitle:function(o){x.insert(x.clear(this.tmpl.title),o)},realign:function(){if(this.autocenter){this.element.style.margin="";this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",
marginLeft:-this.element.offsetWidth/2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})}},activate:function(){this.select()},open:function(o){if(this.closed){x.visibility(this.element,false);x.show(this.element);j.appendChild(this);this.closed=false;this.realign();this.thread&&this.thread.start(true);this.event_beforeShow(o);x.visibility(this.element,true);this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select();this.event_open(o);this.event_active(o)}else this.realign()},
close:function(o){if(!this.closed){this.thread?this.thread.start(1):x.remove(this.element);j.removeChild(this);this.autocenter=this.autocenter_;this.closed=true;this.event_close(o)}},destroy:function(){if(this.dde){this.dde.destroy();delete this.dde}F.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;I.remove(this)}});var t=new w,j=new v({id:"Basis-WindowStack",childClass:z});j.addHandler({childNodesModified:function(){C(this.element).bool("IsNotEmpty",this.firstChild);var o=-1;
if(this.lastChild){for(var l=0,b;b=this.childNodes[l];l++){b.element.style.zIndex=2001+l*2;if(b.modal)o=l}this.lastChild.select()}o!=-1?t.capture(this.element,2E3+o*2):t.release()}});j.selection.addHandler({datasetChanged:function(){var o=this.pick(),l=j.lastChild;if(o){if(o.parentNode==j&&o!=l){j.insertBefore(o);j.event_childNodesModified({})}}else l&&this.add([l])}});A.onLoad(function(){x.insert(document.body,j.element,x.INSERT_BEGIN);for(var o=j.firstChild;o;o=o.nextSibling)o.realign()});r.namespace("basis.ui.window").extend({Window:z,
Blocker:w,getWindowTopZIndex:function(){return j.childNodes.length*2+2001}})})(basis);
(function(r){function z(j){if(j.selection&&!j.selection.itemCount)(j=j.childNodes.search(false,"disabled"))&&j.select()}var x=r.Class,A=r.dom,y=Function.getter,C=r.cssom.classList,I=r.EventObject.createEvent,H=r.EventObject.event,B=r.ui.Node,E=r.ui.Container,F=r.ui.Control;I=x(F,{canHaveChildren:true,childClass:B,event_childEnabled:I("childEnabled","document","node")&&function(j,o){this.selection&&!this.selection.itemCount&&child.select();H.childEnabled.call(this,j,o)},event_childDisabled:I("childDisabled",
"document","node")&&function(j,o){z(this);H.childDisabled.call(this,j,o)},event_childNodesModified:function(j,o){z(this);F.prototype.event_childNodesModified.call(this,j,o)},item:function(j){j=isNaN(j)?this.indexOf(j):parseInt(j);return j.between(0,this.childNodes.length-1)?this.childNodes[j]:null},indexOf:function(j){if(j instanceof this.childClass)return this.childNodes.indexOf(j);if(this.childNodes.search(j,"name"))return Array.lastSearchIndex;return-1}});var v=x(E,{canHaveChildren:false,event_disable:function(){E.prototype.event_disable.call(this);
this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){E.prototype.event_enable.call(this);this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var j=this.tmpl.titleText,
o=this.titleGetter(this);j.nodeValue=o==null||String(o)==""?"[no title]":o},action:{select:function(){this.isDisabled()||this.select()}},titleGetter:y("data.title"),groupId:0}),p=x(I,{childClass:v,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'});y=x(E,{event_select:function(){C(this.element).remove("Basis-Page-Hidden");
E.prototype.event_select.call(this)},event_unselect:function(){C(this.element).add("Basis-Page-Hidden");E.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'});var w=x(I,{childClass:y,template:'<div class="Basis-PageControl"/>'});B=x(v,{canHaveChildren:true,childClass:B,event_select:function(){v.prototype.event_select.call(this);C(this.tmpl.pageElement).remove("Basis-Page-Hidden")},
event_unselect:function(){v.prototype.event_unselect.call(this);C(this.tmpl.pageElement).add("Basis-Page-Hidden")},template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',
destroy:function(){A.remove(this.tmpl.pageElement);v.prototype.destroy.call(this)}});var t=x(p,{childClass:B,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'});x=x(p,{childClass:B,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',
insertBefore:function(j,o){if(j=p.prototype.insertBefore.call(this,j,o)){if(this.tmpl.pagesElement)this.tmpl.pagesElement.insertBefore(j.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null);return j}},removeChild:function(j){if(j=p.prototype.removeChild.call(this,j)){this.tmpl.pagesElement&&j.element.appendChild(j.tmpl.pageElement);return j}},clear:function(j){this.childNodes.forEach(function(o){o.element.appendChild(o.tmpl.pageElement)});p.prototype.clear.call(this,j)}});r.namespace("basis.ui.tabs").extend({AbstractTabsControl:I,
TabControl:p,Tab:v,PageControl:w,Page:y,AccordionControl:t,TabSheetControl:x,TabSheet:B})})(basis);
(function(r){function z(a){return{hour:a.getHours(),day:a.getDate()-1,month:a.getMonth(),year:a.getFullYear()}}function x(a,c){var e={},f=l[a];if(f){var i=c.getFullYear(),m=c.getMonth(),g=c.getDate();i-=i%f[1];m=f[2]?m-m%f[2]:0;g=f[3]?g:1;e.periodStart=new Date(i,m,g);e.periodEnd=new Date(new Date(i+f[4],m+f[5],g+f[6])-1)}else e.periodStart=new Date(e.periodEnd=new Date(c));return e}var A=r.Class,y=r.dom,C=r.dom.event,I=Function.getter,H=r.cssom.classList,B=r.EventObject.createEvent,E=r.html.Template,
F=r.data.property.Property,v=r.ui.Node,p=r.ui.Container,w=r.ui.Control,t=function(a){var c=r.locale["ui.calendar"];return c?c[a]:a},j={};(function(){for(var a=32,c=2147483647;--a;){j[a]=c;c>>=1}})();var o={century:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},decade:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},year:function(a){return a.periodStart.getFullYear()},quarter:function(a){return t("QUARTER").toLowerCase().format(1+a.periodStart.getMonth().base(3)/
3)},month:function(a){return t("MONTH").SHORT[a.periodStart.getMonth()].toLowerCase()},day:function(a){return a.periodStart.getDate()}},l={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},b=A(v,{canHaveChildren:false,template:new E('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(a,c){a=="click"?this.document.templateAction(a,
c,this):v.prototype.templateAction.call(this,a,c)},templateUpdate:function(a,c,e){if(!c||"periodStart"in e||"periodEnd"in e){this.tmpl.title.nodeValue=this.titleGetter(this.data);if(this.parentNode){a=H(this.element);a.bool("before",this.data.periodStart<this.parentNode.data.periodStart);a.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd)}}},event_select:function(){v.prototype.event_select.call(this);y.focus(this.element)}}),d=A(p,{childClass:b,template:new E('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){p.prototype.event_select.call(this);H(this.tmpl.tabElement).add("selected")},event_unselect:function(){p.prototype.event_unselect.call(this);H(this.tmpl.tabElement).remove("selected")},event_update:function(a,c){p.prototype.event_update.call(this,a,c);var e=this.data,f;if("periodStart"in c||"periodEnd"in c){this.tmpl.titleText.nodeValue=this.getTitle(e.periodStart)||"-";this.firstChild||(f=[]);for(var i=x(this.nodePeriodName,(new Date(e.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(e.periodStart)||0))),m=0;m<this.nodeCount;m++){f?f.push({cssClassName:this.nodePeriodName,titleGetter:o[this.nodePeriodName],data:i}):this.childNodes[m].update(i);i=x(this.nodePeriodName,(new Date(i.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount))}f&&this.setChildNodes(f);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(e.selectedDate)||"-";if(f=this.getNodeByDate(e.selectedDate))f.select();
else e.selectedDate&&this.minDate<=e.selectedDate&&e.selectedDate<=this.maxDate?this.setViewDate(e.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:true,isNextPeriodEnabled:true,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(a){p.prototype.init.call(this,a);H(this.element).add("Basis-Calendar-Section-"+this.sectionName);C.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
false))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(a){if(a&&this.data.periodStart<=a&&a<=this.data.periodEnd){a:{var c=this.childNodes;if(c.length){var e,f,i=0,m=c.length,g;do{f=c[e=i+m>>1];if(a<(g=f.data.periodStart))m=e-1;else if(a>(f=f.data.periodEnd))i=e+1;else{a=a>=g&&a<=f?e:-1;break a}}while(i<=m)}a=-1}if(a!=-1)return this.childNodes[a]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(x(this.periodName,new Date(+this.data.periodStart-1)))},
nextPeriod:function(){this.isNextPeriodEnabled&&this.update(x(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(a){this.update(x(this.periodName,a))},getInitOffset:Function.$null});d.Month=A(d,{sectionName:"Month",periodName:"month",template:new E(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+
t("DAY").SHORT2.map(String.format,'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:I("getDate()"),getTitle:function(a){return t("MONTH").FULL[a.getMonth()]+" "+a.getFullYear()},getInitOffset:function(a){return 1+((new Date(a)).set("day",1).getDay()+5)%7}});d.Year=A(d,{sectionName:"Year",periodName:"year",
nodePeriodName:"month",nodePeriodUnit:"month",getTabTitle:I("getMonth()",function(a){return t("MONTH").FULL[a]}),getTitle:I("getFullYear()")});d.YearDecade=A(d,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:I("getFullYear()"),getTitle:function(a){return a.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});d.Century=A(d,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",
nodePeriodUnitCount:10,getTabTitle:function(a){if(a){a=a.getFullYear();a=a-a%10;return a+"-"+(Number(a.toString().substr(-2))+9).lead(2)}},getInitOffset:function(){return 1}});d.YearQuarters=A(d,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});d.Quarter=A(d,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(a){return[Math.floor(1+a.getMonth().base(3)/
3),t("QUARTER").toLowerCase(),a.getFullYear()].join(" ")}});A=A(w,{childClass:d,childFactory:Function(),template:new E(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
t("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:B("change"),event_childNodesModified:function(a,c){if(c.inserted)for(var e=0,f;f=c.inserted[e++];){f.setViewDate(this.date.value);f.update({selectedDate:this.selectedDate.value})}w.prototype.event_childNodesModified.call(this,a,c);y.insert(y.clear(this.tmpl.sectionTabs),this.childNodes.map(I("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&
this.firstChild.select()},templateAction:function(a,c,e){w.prototype.templateAction.call(this,a,c);if(e instanceof b){a=e.data.periodStart;c=this.selection.pick();this.selectedDate.set((new Date(this.selectedDate.value)).add(c.nodePeriodUnit,this.selectedDate.value.diff(c.nodePeriodUnit,a)));this.nextSection(false)}else if(!H(C.sender(c)).contains("disabled"))switch(a){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(true);break}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:true,sections:["Month","Year","YearDecade"],init:function(a){this.todayDate=new F(new Date);this.selectedDate=new F(new Date(this.date||new Date));this.date=new F(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(c,e){this.constructor.prototype.event_datasetChanged.call(this,
c,e);var f=this.pick();f&&f.update({selectedDate:this.selectedDate.value})}};w.prototype.init.call(this,a);this.selectedDate.addHandler({change:function(c){for(var e=this.firstChild;e;e=e.nextSibling)e.update({selectedDate:c})}},this);this.todayDate.addLink(this.tmpl.todayText,null,I("toFormat('%D.%M.%Y')"));this.sections&&y.insert(this,this.sections.map(function(c){return new d[c]},this))},setSection:function(a){(a=this.childNodes.search("sectionName",a))&&a.select()},nextSection:function(a){var c=
this.selection.pick();if(c=a?c.nextSibling:c.previousSibling){c.select();c.setViewDate(this.selectedDate.value)}else a||this.event_change()},selectDate:function(a){a-this.date.value!=0&&this.date.set(a)},getNextPeriod:function(a,c){if(!this.isNextPeriodEnabled(a,c))return false;if(this.map){var e=c?1:-1,f=c?"start":"till",i=c?"till":"start",m=(new Date(a)).add("millisecond",e),g=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(g){var n=x("year",m);if(n.periodEnd.getFullYear()==m.getFullYear())n[f]=
m;for(;!this.isPeriodEnabled(n.periodStart,n.periodEnd);)n=x("year",m.add("year",e));for(n[i]=x("month",n[f])[i];!this.isPeriodEnabled(n.periodStart,n.periodEnd);)n=x("month",m.add("month",e));var s=z(n[f]);i=z(n[i]);if(g=g[i.year]&&g[i.year][i.month]){if(this.periodEnableByDefault){f=j[n.periodEnd.getMonthDayCount()];g=g&f^f}for(f=s.day;f!=i.day+e;f+=e)if(g>>f&1){m=new Date(s.year,s.month,f+1);break}}else return x("day",n[f])}}return x("day",m)},isNextPeriodEnabled:function(a,c){if(!c&&this.minDate&&
this.minDate>a)return false;if(c&&this.maxDate&&this.maxDate<a)return false;if(this.map)if(this.periodEnableByDefault){if(!c&&this.minDate)return this.isPeriodEnabled(this.minDate,a);if(c&&this.maxDate)return this.isPeriodEnabled(a,this.maxDate)}else{var e=c?1:-1,f=a.getFullYear(),i=(new Date(a)).add("millisecond",e),m=i.getFullYear(),g=Object.keys(this.map.enable).filter(function(K){return e*K>=e*m}),n=g.length;if(n){g=g.sort(function(K,q){return e*(K>q)||-e*(K<q)});for(var s=0;s<n;s++){var G=x("year",
new Date(g[s],0));if(this.isPeriodEnabled(c&&g[s]==f?i:G.periodStart,!c&&g[s]==f?i:G.periodEnd))return true}}return false}return true},isPeriodEnabled:function(a,c){if(this.minDate&&this.minDate>c)return false;if(this.maxDate&&this.maxDate<a)return false;var e=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(e){var f=z(a),i=z(c),m,g,n,s=f.month,G=new Date(f.year,f.month),K=11-f.month,q=K+1+(i.year-f.year-1)*12+(i.month+1)-1;if(this.periodEnableByDefault){if(q==0)return!(m=e[f.year])||
!(g=m[f.month])||(g^2147483647)>>f.day&j[i.day-f.day+1];for(var h=0;h<=q;h++){if(!h||K==h%12){m=e[G.getFullYear()];if(!m)return true}g=m[s=G.getMonth()];if(!g)return true;n=j[G.getMonthDayCount()];if(h/q?h/q==1?(g&n^n)&j[i.day+1]:g&n^n:(g&n^n)>>f.day)return true;G.setMonth(s+1)}}else{if(q==0)return(m=e[f.year])&&(g=m[f.month])&&g>>f.day&j[i.day-f.day+1];for(h=0;h<=q;h++){if(!h||K==h%12||!m){m=e[G.getFullYear()];if(!m){h+=12;G.setMonth(s+12);continue}}if((g=m[s=G.getMonth()])&&(h/q?h/q==1?g&j[i.day+
1]:g:g>>f.day))return true;G.setMonth(s+1)}}return false}return true},destroy:function(){w.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});r.namespace("basis.ui.calendar").extend({Calendar:A,CalendarSection:d})})(basis);
(function(r){function z(q,h){return new C(q.source.replace("<!-- {fieldPlace} --\>",h))}var x=r.Class,A=r.dom.event,y=r.dom,C=r.html.Template,I=r.Cleaner,H=Object.complete,B=Function.getter,E=r.cssom.classList,F=r.data.property.Property,v=r.EventObject,p=r.dom.wrapper.Selection,w=r.ui.Control,t=r.ui.Node,j=r.ui.Container,o=r.ui.popup.Popup,l=v.createEvent,b=new C('<div{selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><!-- {fieldPlace} --\></div></div>'),
d=t.subclass({canHaveChildren:false,template:b,nextFieldOnEnter:true,serializable:true,event_select:function(){y.focus(this.tmpl.field,true);t.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");t.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");t.prototype.event_disable.call(this)},event_input:l("input","event"),event_change:l("change","event"),event_keydown:l("keydown","event"),event_keypress:l("keypress",
"event"),event_keyup:l("keyup","event")&&function(q){if(this.nextFieldOnEnter)if([A.KEY.ENTER,A.KEY.CTRL_ENTER].has(A.key(q))){A.cancelDefault(q);this.nextFieldFocus()}else this.setValid();v.event.keyup.call(this,q)},event_focus:l("focus","event")&&function(q){this.valid&&this.setValid();v.event.focus.call(this,q)},event_blur:l("blur","event")&&function(q){this.validate(true);v.event.blur.call(this,q)},init:function(q){t.prototype.init.call(this,q);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=
this.title||"";if(this.tmpl.field){A.addHandler(this.tmpl.field,"keydown",this.keydown,this);A.addHandler(this.tmpl.field,"keyup",this.keyup,this);A.addHandler(this.tmpl.field,"keypress",this.keypress,this);A.addHandler(this.tmpl.field,"blur",this.blur,this);A.addHandler(this.tmpl.field,"focus",this.focus,this);A.addHandler(this.tmpl.field,"change",this.change,this);A.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=
this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value){this.defaultValue=this.value;this.setDefaultValue()}},setReadOnly:function(q){q?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},
setSample:function(q){if(this.tmpl.sampleContainer&&q)this.sampleElement?y.insert(y.clear(this.sampleElement),q):y.insert(this.tmpl.sampleContainer,this.sampleElement=y.createElement("SPAN.Basis-Field-Sample",q));else if(this.sampleElement){y.remove(this.sampleElement);this.sampleElement=null}},getValue:function(){return this.tmpl.field.value},setValue:function(q){q=q||"";if(this.tmpl.field.value!=q){this.tmpl.field.value=q;this.event_change()}},setMaxLength:function(q){this.maxLength=q},setMinLength:function(q){this.minLength=
q},attachValidator:function(q,h){this.validators.add(q)&&h&&this.validate()},detachValidator:function(q,h){this.validators.remove(q)&&h&&this.validate()},change:function(q){this.event_change(q)},input:function(q){this.event_input(q)},keydown:function(q){this.event_keydown(q)},keyup:function(q){this.event_keyup(q)},keypress:function(q){this.event_keypress(q)},blur:function(q){this.event_blur(q)},focus:function(q){this.event_focus(q)},select:function(){this.unselect();t.prototype.select.apply(this,
arguments)},setValid:function(q,h){var k=E(this.element);if(typeof q=="boolean"){k.bool("invalid",!q);k.bool("valid",q);if(h)this.element.title=h;else this.element.removeAttribute("title")}else{k.remove("invalid");k.remove("valid");this.element.removeAttribute("title")}this.valid=q},validate:function(q){var h;this.setValid();for(var k=0;k<this.validators.length;k++)if(h=this.validators[k](this)){q||this.setValid(false,h.message);return h}this.getValue()!=""&&this.setValid(true)},nextFieldFocus:function(){var q=
y.axis(this,y.AXIS_FOLLOWING_SIBLING).search(true,"selectable");if(q)q.select();else this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){A.clearHandlers(this.element);this.tmpl.field&&A.clearHandlers(this.tmpl.field);if(this.button){A.clearHandlers(this.button);delete this.button}this.validators.clear();t.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});d.create=function(q,h){q={radiogroup:"RadioGroup",
checkgroup:"CheckGroup"}[q.toLowerCase()]||q.capitalize();if(d[q])return new d[q](h);else throw new Error("Wrong field type `{0}`".format(q));};d.Hidden=d.subclass({selectable:false,template:'<input{field} type="hidden" />'});d.Text=d.subclass({template:z(b,'<input{field} type="text" />'),init:function(q){d.prototype.init.call(this,q);this.minLength&&this.attachValidator(g.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(q){this.tmpl.field.setAttribute("maxlength",
q,0);d.prototype.setMaxLength.call(this,q)}});d.Password=d.Text.subclass({template:z(b,'<input{field} type="password" />')});d.File=d.subclass({template:z(b,'<input{field} type="file" />')});d.Textarea=d.subclass({nextFieldOnEnter:false,template:z(b,"<textarea{field} />"),init:function(q){this.counter=y.createElement(".counter",d.LOCALE.Textarea.SYMBOLS_LEFT+": ",y.createText(0));d.prototype.init.call(this,q);this.minLength&&this.attachValidator(g.MinLength);this.maxLength&&this.attachValidator(g.MaxLength);
A.addHandler(this.tmpl.field,"keyup",this.updateCounter,this);A.addHandler(this.tmpl.field,"input",this.updateCounter,this);window.opera&&A.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=true;this.contentEditable=false})},updateCounter:function(){var q=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=q>=0?q:0},setValue:function(q){d.prototype.setValue.call(this,q);this.updateCounter()},setMaxLength:function(q){d.prototype.setMaxLength.call(this,q);if(q){this.updateCounter();
y.insert(this.tmpl.sampleContainer,this.counter)}else y.remove(this.counter)},destroy:function(){delete this.counter;d.prototype.destroy.call(this)}});d.Checkbox=d.subclass({value:false,template:'<div class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox" /><span>{titleText}</span></label></div></div>',invert:function(){this.setValue(!this.getValue())},setValue:function(q){var h=this.tmpl.field.checked;this.tmpl.field.checked=!!q;
h!=this.tmpl.field.checked&&this.event_change()},getValue:function(){return this.tmpl.field.checked}});d.Label=d.subclass({cssClassName:"Basis-Field-Label",template:z(b,"<label{field}>{fieldValueText}</label>"),valueGetter:Function.$self,event_change:function(){d.prototype.event_change.apply(this,arguments);this.tmpl.fieldValueText.nodeValue=this.valueGetter(this.getValue())}});var a=t.subclass({canHaveChildren:false,titleGetter:function(q){return q.title||q.getValue()},valueGetter:B("value"),getTitle:function(){return this.titleGetter(this)},
getValue:function(){return this.valueGetter(this)}}),c={datasetChanged:function(){this.event_change()}},e=x(d,j,{childClass:a,template:d.prototype.template,multipleSelect:false,init:function(q){this.selection=new p({multiple:!!this.multipleSelect});this.selection.addHandler(c,this);d.prototype.init.call(this,q);I.add(this)},getValue:function(){var q=this.selection.getItems().map(B("getValue()"));return!this.selection.multiple?q[0]:q},setValue:function(q){var h={};(this.multipleSelect?Array.from(q):
[q]).forEach(function(u){h[u]=true});q=[];for(var k=this.firstChild;k;k=k.nextSibling)h[k.getValue()]&&q.push(k);this.selection.set(q)},destroy:function(){d.prototype.destroy.call(this);I.remove(this)}});e.Item=a;j=a.subclass({event_select:function(){this.tmpl.field.checked=true;a.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;a.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");t.prototype.event_enable.call(this)},
event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");t.prototype.event_disable.call(this)},template:'<label class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>',templateUpdate:function(q,h,k){a.prototype.templateUpdate.call(this,q,h,k);q.field.value=this.getValue();q.titleText.nodeValue=this.getTitle()},action:{select:function(){this.isDisabled()||this.select()}}});d.RadioGroup=e.subclass({childClass:j,
template:z(b,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),childFactory:function(q){q=e.prototype.childFactory.call(this,q);if(this.name)q.tmpl.field.name=this.name;return q}});d.RadioGroup.Item=j;j=a.subclass({event_select:function(){this.tmpl.field.checked=true;a.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;a.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");t.prototype.event_enable.call(this)},
event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");t.prototype.event_disable.call(this)},template:'<label event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>',templateUpdate:function(q,h,k){a.prototype.templateUpdate.call(this,q,h,k);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},action:{click:function(q){if(!this.isDisabled()){this.select(this.parentNode.multipleSelect);A.sender(q).tagName!="INPUT"&&
A.kill(q)}}}});d.CheckGroup=e.subclass({childClass:j,multipleSelect:true,template:z(b,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});d.CheckGroup.Item=j;j=a.subclass({event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:"<option{field}>{titleText}</option>",templateUpdate:function(q,h,k){a.prototype.templateUpdate.call(this,q,h,k);q.field.value=this.getValue();q.field.text=
this.getTitle()}});d.Select=e.subclass({childClass:j,template:z(b,"<select{field|childNodesElement} />"),event_keyup:function(q,h){this.change();e.prototype.event_keyup.call(this,q,h)},setValue:function(q){(q=this.childNodes.search(q,"getValue()"))?this.selection.set([q]):this.selection.clear()}});d.Select.Item=j;var f={show:function(){E(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){E(this.tmpl.field).remove("Basis-DropdownList-Opened")}};j=a.subclass({template:'<div class="Basis-Combobox-Item" event-click="click">{titleText}</div>',
templateUpdate:function(q,h,k){a.prototype.templateUpdate.call(this,q,h,k);q.titleText.nodeValue=this.getTitle()},action:{click:function(q){if(!this.isDisabled()){this.select();this.parentNode&&this.parentNode.hide();A.kill(q)}}}});var i={keyup:function(q){var h=A.key(q),k=this.selection.pick();switch(h){case A.KEY.DOWN:if(q.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;k=y.axis(k?k:this.firstChild,y.AXIS_FOLLOWING_SIBLING).search(false,"disabled");break;case A.KEY.UP:if(q.altKey)return this.popup.visible?
this.hide():!this.isDisabled()?this.show():null;k=k?y.axis(k,y.AXIS_PRESCENDING_SIBLING).search(false,"disabled"):this.firstChild;break}if(k){k.select();y.focus(this.tmpl.field)}},keydown:function(q){var h=A.key(q);if(h==A.KEY.DOWN||h==A.KEY.UP)A.kill(q);else if(h==A.KEY.ENTER){this.popup.visible&&this.hide();A.kill(q)}}};d.Combobox=e.subclass({childClass:j,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();e.prototype.event_enable.call(this)},event_change:function(){e.prototype.event_change.call(this);
var q=this.getValue();this.property&&this.property.set(q);if(this.hidden)this.hidden.value=q;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:z(b,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent" />'),action:{click:function(q){this.isDisabled()||
this.popup.visible?this.hide():this.show({});A.kill(q)}},init:function(q){if(!r.ui.popup)throw new Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:B("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};
e.prototype.init.call(this,q);this.satellite.captionItem.setDelegate(this.selection.pick());A.addHandlers(this.tmpl.field,i,this);if(this.name)y.insert(this.tmpl.field,this.hidden=y.createElement("INPUT[type=hidden][name={0}]".format(String(this.name).quote())));this.popup=new o(H({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,handler:f,handlerContext:this},this.popup));this.property&&this.property.addLink(this,
this.setValue)},show:function(){this.popup.show(this.tmpl.field);this.select()},hide:function(){this.popup.hide()},getTitle:function(){var q=this.selection.pick();return q&&q.getTitle()},getValue:function(){var q=this.selection.pick();return q&&q.getValue()},setValue:function(q){if(this.getValue()!=q)(q=this.childNodes.search(q,"getValue()"))&&!q.isDisabled()?this.selection.set([q]):this.selection.clear()},destroy:function(){if(this.property){this.property.removeLink(this);this.property=null}this.popup.destroy();
this.popup=null;e.prototype.destroy.call(this)}});d.Combobox.Item=j;var m=x(null,{init:function(q,h){this.field=q;this.message=h}}),g={NO_LOCALE:"There is no locale for this error",RegExp:function(q){if(q.constructor!=RegExp)q=new RegExp(q);return function(h){var k=h.getValue();if(k!=""&&!k.match(q))return new m(h,g.LOCALE.RegExp.WRONG_FORMAT||g.NO_LOCALE)}},Required:function(q){var h=q.getValue();if(Function.$isNull(h)||h=="")return new m(q,g.LOCALE.Required.MUST_BE_FILLED||g.NO_LOCALE)},Number:function(q){var h=
q.getValue();if(isNaN(h))return new m(q,g.LOCALE.Number.WRONG_FORMAT||g.NO_LOCALE)},Currency:function(q){var h=q.getValue();if(isNaN(h))return new m(q,g.LOCALE.Currency.WRONG_FORMAT||g.NO_LOCALE);if(h<=0)return new m(q,g.LOCALE.Currency.MUST_BE_GREATER_ZERO||g.NO_LOCALE)},Email:function(q){var h=q.getValue().trim();if(h!=""&&!h.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new m(q,g.LOCALE.Email.WRONG_FORMAT||g.NO_LOCALE)},Url:function(q){var h=q.getValue().trim();
if(h!=""&&!h.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new m(q,g.LOCALE.Url.WRONG_FORMAT||g.NO_LOCALE)},MinLength:function(q){var h=q.getValue();if((Function.$isNotNull(h.length)?h.length:String(h).length)<q.minLength)return new m(q,(g.LOCALE.MinLength.MUST_BE_LONGER_THAN||g.NO_LOCALE).format(q.minLength))},MaxLength:function(q){var h=q.getValue();if((Function.$isNotNull(h.length)?h.length:String(h).length)>
q.maxLength)return new m(q,(g.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||g.NO_LOCALE).format(q.maxLength))}};x=w.subclass({canHaveChildren:true,childClass:d,childFactory:function(q){return d.create(q.type||"text",q)},onSubmit:Function.$false,event_reset:l("reset"),event_disable:function(){for(var q=this.firstChild;q;q=q.nextSibling)q.disabled||q.event_disable();w.prototype.event_disable.call(this)},event_enable:function(){for(var q=this.firstChild;q;q=q.nextSibling)q.disabled||q.event_enable();w.prototype.event_enable.call(this)},
template:'<div class="Basis-FormContent" />',getFieldByName:function(q){return this.childNodes.search(q,"name")},getFieldById:function(q){return this.childNodes.search(q,"id")},serialize:function(){for(var q={},h=this.firstChild;h;h=h.nextSibling)if(h.serializable&&h.name)q[h.name]=h.getValue();return q},setData:function(q,h){this.loadData(q,h)},loadData:function(q,h){for(var k=Object.keys(q),u=this.firstChild;u;u=u.nextSibling){k.indexOf(u.name)!=-1?u.setValue(q[u.name]):u.setDefaultValue();u.setValid()}h||
this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var q=this.firstChild;q;q=q.nextSibling)q.setDefaultValue();this.event_reset()},validate:function(){for(var q,h=[],k=this.firstChild;k;k=k.nextSibling)if(q=k.validate())h.push(q);if(h.length){h[0].field.select();return h}else return true},submit:function(){this.validate()===true&&this.onSubmit&&this.onSubmit(this.serialize())}});l=x.subclass({template:'<form{formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent" /></form>',
method:"POST",init:function(q){this.selection=false;w.prototype.init.call(this,q);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=this.action;if(this.enctype)this.formElement.enctype=this.enctype;A.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(q){this.formElement.method=q?q.toUpperCase():"POST"},submit:function(){if(this.validate()===true&&!this.onSubmit())if(this.tagName==
"FORM")return false;else this.formElement.submit();return true}});var n=F.subclass({matchFunction:function(q,h){if(!h){var k=q._original||this.textNodeGetter(q);Array.isArray(k)||(k=[k]);q._original=k;for(var u=0,D=k.length;D-- >0;){var L=k[D];if(L){var P=L.nodeValue.split(this.rx);if(P.length>1){if(!q._replaced)q._replaced={};y.replace(q._replaced[D]||L,q._replaced[D]=y.createElement("SPAN.matched",y.wrap(P,this.map)));u++}else if(q._replaced&&q._replaced[D]){y.replace(q._replaced[D],L);delete q._replaced[D]}}}return u>
0}if(q._replaced){for(k in q._replaced)y.replace(q._replaced[k],q._original[k]);delete q._replaced;delete q._original}return false},event_change:function(q,h){this.rx=this.regexpGetter(q);F.prototype.event_change.call(this,q,h)},extendConstructor_:true,init:function(){var q=this.startPoints||"";this.textNodeGetter=B(this.textNodeGetter||"tmpl.titleText");if(typeof this.regexpGetter!="function")this.regexpGetter=function(h){return new RegExp("("+q+")("+h.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||
"SPAN.match"]=function(h,k){return k%3==2};F.prototype.init.call(this,"",this.handlers,String.trim)}}),s={childNodesModified:function(q,h){h.inserted&&h.inserted.forEach(function(k){this.matchFunction(k,this.value=="")},this)}};j=n.subclass({event_change:function(q,h){n.prototype.event_change.call(this,q,h);this.match()},init:function(q){n.prototype.init.call(this,q);this.node.addHandler(s,this)},match:function(){this.node.childNodes.forEach(function(q){this.matchFunction(q,this.value=="")},this)}});
var G=n.subclass({event_change:function(q,h){n.prototype.event_change.call(this,q,h);this.node.setMatchFunction(q?this.matchFunction.bind(this):null)}}),K=d.Text.subclass({cssClassName:"Basis-MatchInput",matchFilterClass:G,event_keyup:function(q){this.matchFilter.set(this.tmpl.field.value);d.Text.prototype.event_keyup.call(this,q)},event_change:function(q){this.matchFilter.set(this.tmpl.field.value);d.Text.prototype.event_change.call(this,q)},init:function(q){d.Text.prototype.init.call(this,q);this.matchFilter=
new this.matchFilterClass(this.matchFilter)}});r.namespace("basis.ui.form").extend({createFieldTemplate:function(q){return z(b,q)},FormContent:x,Form:l,Field:d,Validator:g,ValidatorError:m,RadioGroup:d.RadioGroup,CheckGroup:d.CheckGroup,Combobox:d.Combobox,ComplexField:e,Matcher:j,MatchFilter:G,MatchInput:K})})(basis);
(function(){function r(j,o){if(window[j])return window[j];j=j.charAt(0).toUpperCase()+j.substr(1);for(var l=0,b;b=E[l++];)if(window[b+j])return window[b+j];return o}var z=basis.Class,x=basis.dom,A=basis.EventObject,y=basis.dom.event,C=basis.cssom.classList,I=false,H=false,B;(function(){function j(l,b){for(var d;d=b.shift();)if(typeof l.style[d]!="undefined")return d;return false}var o=x.createElement("");if(B=j(o,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))I=true;if(I)if(j(o,
["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style)H=true})();var E=["webkit","moz","o","ms"],F=r("requestAnimationFrame",function(j){return window.setTimeout(j,15)}),v=r("cancelRequestAnimFrame",clearInterval),p=z(A,{minScrollDelta:0,preventScrollX:false,preventScrollY:false,scrollPropertyType:"style",event_start:A.createEvent("start","scrollerObject"),event_finish:A.createEvent("finish","scrollerObject"),
event_startInertia:A.createEvent("startInertia","scrollerObject"),event_updatePosition:A.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(j){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=
this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;A.prototype.init.call(this,j);if(this.targetElement){y.addHandler(this.targetElement,"mousedown",this.onMouseDown,this);y.addHandler(this.targetElement,"touchstart",this.onMouseDown,this)}this.onUpdateHandler=this.onUpdate.bind(this);if(this.scrollPropertyType=="scroll"){x.setStyle(this.targetElement,{overflow:"hidden"});this.updateElementPosition=this.updatePosition_scrollTopLeft;this.calcDimentions=
this.calcDimentions_scrollTopLeft}else{x.setStyle(this.targetElement,{position:"relative"});this.updateElementPosition=I?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;this.calcDimentions=this.calcDimentions_styleTopLeft}if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var j={};j[B]="translate("+(-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px")+", "+(-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px")+")"+(H?" translateZ(0)":"");x.setStyle(this.targetElement,j)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;this.scrollX=
!this.preventScrollX&&this.maxPositionX>0;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&this.maxPositionY>0},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var j=this.targetElement.offsetParent;if(j){this.maxPositionX=this.targetElement.scrollWidth-j.offsetWidth;this.scrollX=!this.preventScrollX&&this.maxPositionX>0;this.maxPositionY=this.targetElement.scrollHeight-j.offsetHeight;
this.scrollY=!this.preventScrollY&&this.maxPositionY>0}},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating){this.targetElement.offsetWidth&&this.calcDimentions();
this.startViewportX=this.viewportX;this.startViewportY=this.viewportY;this.isUpdating=true;this.updateFrameHandle=this.nextFrame();this.startTime=this.lastUpdateTime=Date.now();this.event_start(this)}},stopUpdate:function(){if(this.isUpdating){this.resetVariables();this.isUpdating=false;v(this.updateFrameHandle);this.updateElementPosition();this.event_finish(this)}},onMouseDown:function(j){this.stopUpdate();this.panningActive=true;this.lastMouseX=y.mouseX(j);this.lastMouseY=y.mouseY(j);this.lastMotionUpdateTime=
Date.now();y.addHandler(document,"mousemove",this.onMouseMove,this);y.addHandler(document,"touchmove",this.onMouseMove,this);y.addHandler(document,"mouseup",this.onMouseUp,this);y.addHandler(document,"touchend",this.onMouseUp,this);y.cancelDefault(j)},onMouseMove:function(j){if(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)this.startUpdate();var o=Date.now(),l=o-this.lastMotionUpdateTime;this.lastMotionUpdateTime=o;if(l){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached){o=
y.mouseX(j);l=this.lastMouseX-o;this.lastMouseX=o;this.viewportTargetX+=l}if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached){j=y.mouseY(j);o=this.lastMouseY-j;this.lastMouseY=j;this.viewportTargetY+=o}if(this.minScrollDelta>0)if(!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;
if(this.minScrollDeltaYReached){this.viewportTargetX=this.viewportX;this.currentDirectionX=0}if(this.minScrollDeltaXReached){this.viewportTargetY=this.viewportY;this.currentDirectionY=0}}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var j=Date.now()-this.lastMotionUpdateTime;j=Math.max(10,j);this.lastMotionUpdateTime=0;if(this.scrollX)this.currentVelocityX*=1-Math.min(1,Math.max(0,j/100));if(this.scrollY)this.currentVelocityY*=1-Math.min(1,Math.max(0,j/100));y.removeHandler(document,
"mousemove",this.onMouseMove,this);y.removeHandler(document,"touchmove",this.onMouseMove,this);y.removeHandler(document,"mouseup",this.onMouseUp,this);y.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(j){j||(j=Date.now());var o=j-this.lastUpdateTime;this.lastUpdateTime=j;if(o){if(this.panningActive){var l;if(this.scrollX){l=this.viewportTargetX-this.lastViewportTargetX;this.lastViewportTargetX=this.viewportTargetX;if(l){this.currentVelocityX=
Math.abs(l)/o;this.currentDirectionX=l==0?0:l<0?-1:1}}if(this.scrollY){l=this.viewportTargetY-this.lastViewportTargetY;this.lastViewportTargetY=this.viewportTargetY;if(l){this.currentVelocityY=Math.abs(l)/o;this.currentDirectionY=l==0?0:l<0?-1:1}}}else if(this.processInertia){if(this.scrollX){this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*o;this.currentVelocityX*=0.94;if(this.currentVelocityX<0.001||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX){this.viewportTargetX=
Math.min(this.maxPositionX,Math.max(this.minPositionX,this.viewportTargetX));this.currentVelocityX=0}}if(this.scrollY){this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*o;this.currentVelocityY*=0.94;if(this.currentVelocityY<0.001||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY){this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY));this.currentVelocityY=0}}if(this.currentVelocityX==0&&this.currentVelocityY==0)this.processInertia=
false}o=l=0;if(this.scrollX){l=this.viewportTargetX-this.viewportX;this.viewportX+=l*(this.panningActive||this.currentVelocityX>0?1:0.12)}if(this.scrollY){o=this.viewportTargetY-this.viewportY;this.viewportY+=o*(this.panningActive||this.currentVelocityY>0?1:0.12)}l=!this.scrollX||this.currentVelocityX<0.001&&Math.abs(l)<0.1;o=!this.scrollY||this.currentVelocityY<0.001&&Math.abs(o)<0.1;if(!this.panningActive&&l&&o){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=
this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,j,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=F(this.onUpdateHandler,this.targetElement)},setPosition:function(j,o){this.viewportX=j;this.viewportY=o;if(this.isUpdating)this.stopUpdate();else{this.resetVariables();this.updateElementPosition()}},setTargetPosition:function(j,o){this.viewportTargetX=j||0;this.viewportTargetY=o||0;this.startUpdate();
this.processInertia=true},calcExpectedPosition:function(j){var o=0,l=j=="x"?this.currentVelocityX:this.currentVelocityY,b=j=="x"?this.currentDirectionX:this.currentDirectionY,d=j=="x"?this.viewportTargetX:this.viewportTargetY,a=j=="x"?this.minPositionX:this.minPositionY;j=j=="x"?this.maxPositionX:this.maxPositionY;if(l){var c=Math.log(0.001/l)/Math.log(0.94);l=l;for(var e=0;e<c;e++){o+=b*l*15;l*=0.94}}return Math.max(a,Math.min(j,d+o))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},
calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),w=z(A,{minScrollDelta:0,scrollX:true,scrollY:true,event_start:A.createEvent("start","scrollerObject"),event_finish:A.createEvent("finish","scrollerObject"),event_startInertia:A.createEvent("startInertia","scrollerObject"),event_updatePosition:A.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(j){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=
this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;A.prototype.init.call(this,j);if(this.targetElement){y.addHandler(this.targetElement,"mousedown",this.onMouseDown,this);y.addHandler(this.targetElement,"touchstart",this.onMouseDown,this)}this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=
I?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){this.targetElement.style[B]="translate("+(-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px")+", "+(-(this.isUpdating?
this.viewportY:Math.round(this.viewportY))+"px")+")"+(H?" translateZ(0)":"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating){this.isUpdating=
true;this.updateFrameHandle=this.nextFrame();this.lastUpdateTime=Date.now();this.event_start(this)}},stopUpdate:function(){if(this.isUpdating){this.resetVariables();this.isUpdating=false;v(this.updateFrameHandle);this.updateElementPosition();this.event_finish(this)}},onMouseDown:function(j){this.stopUpdate();this.panningActive=true;this.lastMouseX=y.mouseX(j);this.lastMouseY=y.mouseY(j);this.lastMotionUpdateTime=Date.now();y.addHandler(document,"mousemove",this.onMouseMove,this);y.addHandler(document,
"touchmove",this.onMouseMove,this);y.addHandler(document,"mouseup",this.onMouseUp,this);y.addHandler(document,"touchend",this.onMouseUp,this);y.cancelDefault(j)},onMouseMove:function(j){if(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)this.startUpdate();var o=Date.now(),l=o-this.lastMotionUpdateTime;this.lastMotionUpdateTime=o;if(l){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached){o=y.mouseX(j);l=this.lastMouseX-o;this.lastMouseX=o;this.viewportTargetX+=
l}if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached){j=y.mouseY(j);o=this.lastMouseY-j;this.lastMouseY=j;this.viewportTargetY+=o}if(this.minScrollDelta>0)if(!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;if(this.minScrollDeltaYReached){this.viewportTargetX=this.viewportX;this.currentDirectionX=
0}if(this.minScrollDeltaXReached){this.viewportTargetY=this.viewportY;this.currentDirectionY=0}}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var j=Date.now()-this.lastMotionUpdateTime;j=Math.max(10,j);this.lastMotionUpdateTime=0;if(this.scrollX)this.currentVelocityX*=1-Math.min(1,Math.max(0,j/100));if(this.scrollY)this.currentVelocityY*=1-Math.min(1,Math.max(0,j/100));y.removeHandler(document,"mousemove",this.onMouseMove,this);y.removeHandler(document,"touchmove",this.onMouseMove,
this);y.removeHandler(document,"mouseup",this.onMouseUp,this);y.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(j){j||(j=Date.now());var o=j-this.lastUpdateTime;this.lastUpdateTime=j;if(o){if(this.panningActive){var l;if(this.scrollX){l=this.viewportTargetX-this.lastViewportTargetX;this.lastViewportTargetX=this.viewportTargetX;if(l){this.currentVelocityX=Math.abs(l)/o;this.currentDirectionX=l==0?0:l<0?-1:1}}if(this.scrollY){l=this.viewportTargetY-
this.lastViewportTargetY;this.lastViewportTargetY=this.viewportTargetY;if(l){this.currentVelocityY=Math.abs(l)/o;this.currentDirectionY=l==0?0:l<0?-1:1}}}else if(this.processInertia){if(this.scrollX){this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*o;this.currentVelocityX*=0.94}if(this.scrollY){this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*o;this.currentVelocityY*=0.94}}o=l=0;if(this.scrollX){l=this.viewportTargetX-this.viewportX;this.viewportX+=l*(this.panningActive||
this.currentVelocityX>0?1:0.12)}if(this.scrollY){o=this.viewportTargetY-this.viewportY;this.viewportY+=o*(this.panningActive||this.currentVelocityY>0?1:0.12)}l=!this.scrollX||Math.abs(l)<0.5;o=!this.scrollY||Math.abs(o)<0.5;if(!this.panningActive&&l&&o){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,j,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=
F(this.onUpdateHandler,this.targetElement)},setPositionX:function(j,o){if(o){this.viewportTargetX=j||0;this.currentVelocityX=0;this.startUpdate()}else{this.stopUpdate();this.viewportTargetX=this.viewportX=j;this.updateElementPosition()}},setPositionY:function(j,o){if(o){this.viewportTargetY=j||0;this.currentVelocityY=0;this.startUpdate()}else{this.stopUpdate();this.viewportTargetY=this.viewportY=j;this.updateElementPosition()}},calcExpectedPosition:function(j){var o=0,l=j=="x"?this.currentVelocityX:
this.currentVelocityY,b=j=="x"?this.currentDirectionX:this.currentDirectionY;j=j=="x"?this.viewportTargetX:this.viewportTargetY;if(l){var d=Math.log(0.001/l)/Math.log(0.94);l=l;for(var a=0;a<d;a++){o+=b*l*15;l*=0.94}}return j+o},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),t=z(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',
init:function(j){basis.ui.Node.prototype.init.call(this,j);this.startProperty=this.type=="horizontal"?"left":"top";this.endProperty=this.type=="horizontal"?"right":"bottom";C(this.element).add(this.type)},recalcSize:function(j){x.display(this.element,j<1);var o=this.type=="horizontal"?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=o-o*j},updatePosition:function(j){var o=this.trackSize*j;j=this.trackSize-this.trackSize*j;if(o<0)o=0;if(j<0)j=0;var l={};l[this.startProperty]=o+"px";
l[this.endProperty]=j+"px";x.setStyle(this.tmpl.trackElement,l)}});z=z(basis.ui.Container,{useScrollbars:true,scrollX:true,scrollY:true,wheelDelta:40,event_realign:A.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(j){j=y.wheelDelta(j);if(this.scrollX)this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*j,true);
else this.scrollY&&this.scroller.setPositionY(this.scroller.viewportTargetY-this.wheelDelta*j,true)}},init:function(j){basis.ui.Node.prototype.init.call(this,j);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;j=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new w(j);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,
this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=new t({type:"horizontal",container:this.element});if(this.scrollY)this.vScrollbar=new t({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){C(this.element).add("scrollProcess")},finish:function(){C(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var j=this.scroller;j.panningActive||this.fixPosition();if(this.useScrollbars){this.scrollX&&this.hScrollbar.updatePosition(j.viewportX/
this.maxPositionX);this.scrollY&&this.vScrollbar.updatePosition(j.viewportY/this.maxPositionY)}},fixPosition:function(){var j=this.scroller;if(this.scrollX&&(j.viewportX<this.minPositionX||j.viewportX>this.maxPositionX))j.setPositionX(Math.min(this.maxPositionX,Math.max(this.minPositionX,j.viewportX)),true);if(this.scrollY&&(j.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))j.setPositionY(Math.min(this.maxPositionY,Math.max(this.minPositionY,j.viewportY)),true)},realign:function(){this.calcDimentions();
this.scrollUpdatePosition();this.event_realign()},calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var j=this.element.offsetWidth,o=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,o-j)}if(this.scrollY){var l=this.element.offsetHeight,b=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,b-l)}if(this.useScrollbars){this.scrollX&&this.hScrollbar.recalcSize(j/o);this.scrollY&&this.vScrollbar.recalcSize(l/b)}}},destroy:function(){this.scroller.destroy();
basis.ui.Node.prototype.destroy.call(this)}});basis.namespace("basis.ui.scroller").extend({Scroller:p,Scroller2:w,ScrollPanel:z})})(basis);
(function(r){var z=r.Class,x=r.dom,A=r.dom.event,y=r.cssom,C=r.dom.wrapper,I=r.ui.Container,H=r.animation.Modificator,B=z(r.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(p){p.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),E=z(I,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:B}}}),F=true,v=z(I,{behaviour:{click:function(p,w){w&&w.delegate.parentNode.scrollToNode(w.delegate)}},init:function(p){this.inherit(p);this.document=this;F&&A.addHandler(this.element,"mousewheel",function(w){try{this.owner.content.dispatchEvent(w)}catch(t){F=false;A.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}});z=z(C.Control,{childClass:E,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:true,init:function(p){this.inherit(Object.complete({childNodes:null},p));var w=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new w({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;y.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new C.ChildNodesDataset(this);
this.header=new v({container:this.element,childClass:w,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new v({container:this.element,childClass:w,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});x.hide(this.header.element);x.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new r.Animation.Thread({duration:400,interval:15});var t=this;this.modificator=new H(this.thread,function(j){t.content.scrollTop=parseInt(j);
t.recalc()},0,0,true);this.modificator.timeFunction=function(j){return Math.sin(Math.acos(1-j))};A.addHandler(this.content,"scroll",this.recalc,this);A.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",true);p.childNodes&&this.setChildNodes(p.childNodes);this.timer_=setInterval(function(){t.recalc()},500)},scrollToNode:function(p){if(p&&p.parentNode===this){p=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[x.index(p)]);if(this.thread){var w=
this.content.scrollTop;this.modificator.setRange(w,w);this.thread.stop();this.modificator.setRange(w,p);this.thread.start()}else this.content.scrollTop=p}},recalc:function(){var p=this.content,w=p.clientHeight,t=p.scrollHeight;p=p.scrollTop;var j=w==t;if(this.clientHeight_!=w||this.scrollHeight_!=t){this.clientHeight_=w;this.scrollHeight_=t;t=[];var o=[];if(!j){var l=this.meterElement.offsetHeight,b=0;w=l*this.childNodes.length-w;for(var d,a=0;d=this.childNodes[a];a++){d=d.element.offsetTop;t.push(d?
d-b:t[a-1]||0);o.push(d?d+w:o[a-1]||w);b+=l;w-=l}}this.topPoints=t;this.bottomPoints=o;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=j){this.isFit=j;x.display(this.header.element,!j);x.display(this.footer.element,!j)}if(!j)if(this.scrollTop_!=p){this.scrollTop_=p;if(j){this.lastTopPoint=0;this.lastBottomPoint=this.childNodes.length}else{var c=this.topPoints.binarySearchPos(p),e=this.bottomPoints.binarySearchPos(p);if(this.lastTopPoint!=c){this.lastTopPoint=c;this.header.childNodes.forEach(function(f,
i){f.element.style.display=i>=c?"none":""})}if(this.lastBottomPoint!=e){this.lastBottomPoint=e;this.footer.childNodes.forEach(function(f,i){f.element.style.display=i<e?"none":""})}}}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();A.removeHandler(this.content,"scroll",this.recalc,this);A.removeHandler(window,"resize",this.recalc,this);this.inherit()}});r.namespace("basis.ui.toc").extend({Control:z,
ControlItem:E,ControlItemHeader:B,ControlHeaderList:v})})(basis);
(function(r){var z=r.dom,x=r.dom.event,A=r.EventObject.createEvent,y=r.cssom.classList,C=r.dragdrop.DragDropElement,I=r.layout.Box,H=r.ui.Node,B=r.ui.Container,E=H.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(p){H.prototype.init.call(this,p);z.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&y(this.element).add("last");this.isRange&&y(this.element).add("range")}}),F=B.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:E,captionGetter:Function.$self,count:0,marks:null,init:function(p){B.prototype.init.call(this,p);this.apply()},apply:function(){var p=this.marks||[];if(this.count>0){var w=this;p.push.apply(p,Array.create(this.count,function(j){var o=this.closest((j+1)/w.count);return{pos:(o-this.min)/this.range_,caption:w.captionFormat(o),isLast:w.count==
j+1}},this.owner_))}var t=0;p=p.filter(Function.$isNotNull).sortAsObject("pos").map(function(j){var o=j.pos;j.width=j.pos-t;j.pos=t;t=o;return j},this);t!=1&&p.push({pos:t,width:1-t,isLast:true});this.setChildNodes(p)}}),v={move:function(){var p=this.tmpl.scrollbar;this.setValue_((x.mouseX(event)-(new I(p)).left)/p.offsetWidth*this.count_)}};A=H.subclass({event_change:A("change"),captionFormat:function(p){return Math.round(Number(p))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(p){var w=this.tmpl.scrollbar;this.setValue_((x.mouseX(p)-(new I(w)).left)/w.offsetWidth*this.count_)},focus:function(){z.focus(this.element)},step:function(p){var w=x.wheelDelta(p);if(w){z.focus(this.element);w<0?this.stepDown():this.stepUp()}else switch(x.key(p)){case x.KEY.DOWN:case x.KEY.LEFT:case 189:case 109:this.stepDown();break;case x.KEY.UP:case x.KEY.RIGHT:case 187:case 107:this.stepUp();break;case x.KEY.PAGEDOWN:this.stepDown(10);break;case x.KEY.PAGEUP:this.stepUp(10);
break;case x.KEY.HOME:this.setValue(this.min);break;case x.KEY.END:this.setValue(this.max);break}}},satelliteConfig:{marks:{instanceOf:B.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:F})}},marks:"auto",init:function(p){var w=this.step,t=this.value;this.step=0;this.value=this.min;this.value_=0;H.prototype.init.call(this,p);this.setProperties(this.min,this.max,w);this.setValue(isNaN(t)?this.min:t);this.scrollbarDD=new C({element:this.tmpl.scrollTrumb,handler:v,handlerContext:this})},
setProperties:function(p,w,t){if(p>w){var j=p;p=w;w=j}t=t||1;p=p||0;if(this.min!=p||this.max!=w||this.step!=t){this.count_=Math.ceil((w-p)/t);this.step=t;this.min=p;this.max=this.min+this.count_*this.step;this.range_=this.max-this.min;this.tmpl.minValue.nodeValue=this.captionFormat(this.min);this.tmpl.maxValue.nodeValue=this.captionFormat(this.max);y(this.element).bool("NoMax",this.max==this.min);if(this.marks)this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(o){if(typeof o!=
"object")o={count:o};o=Object.extend({captionFormat:this.captionFormat,owner_:this},o);if(o.count=="auto")o.count=Math.min(this.count_,20);return o},this));this.setValue(this.value||this.min)}},closest:function(p){return this.normalize(this.min+this.range_*p.fit(0,1)+this.step/2)},normalize:function(p){if(p<this.min)p=this.min;else if(p>this.max)p=this.max;return this.min+Math.floor(1.0E-5+(p-this.min)/this.step)*this.step},stepUp:function(p){this.setValue_(this.value_+parseInt(p||1))},stepDown:function(p){this.setValue_(this.value_-
parseInt(p||1))},setValue_:function(p){p=Math.round(p).fit(0,this.count_);if(this.value_!=p){this.value_=p;var w=this.value;this.value=this.normalize(this.min+p*this.step);this.tmpl.scrollTrumb.style.left=(100*(p/this.count_)).toFixed(4)+"%";this.event_change(this,w)}},setValue:function(p){this.setValue_((p-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;H.prototype.destroy.call(this)}});Object.extend(A,{MarkLayer:F,Mark:E});r.namespace("basis.ui.slider").extend({Slider:A})})(basis);
(function(r){function z(B,E){if(window.getComputedStyle){var F=document.defaultView.getComputedStyle(B,null);if(F)return F.getPropertyValue(E)}else if(B.currentStyle)return B.currentStyle[E]}var x=r.dom,A=r.cssom.classList,y=r.dragdrop.DragDropElement,C=r.cssom.cssRule("IFRAME"),I={width:"deltaX",height:"deltaY"},H={width:{"-1":"w-resize","1":"e-resize"},height:{"-1":"n-resize","1":"s-resize"}};y=y.subclass(function(B){return{factor:NaN,property:"width",event_prepare:function(){if(I[this.property])C.setProperty("pointerEvents",
"none");else{typeof console!="undefined"&&console.warn("Property to change `"+this.property+"` is unsupported");this.stop()}},event_start:function(E){B.event_start.call(this,E);E.delta=I[this.property];E.factor=this.factor;var F=this.element.parentNode,v=z(this.element,"float"),p=z(this.element,"position");if(E.delta=="deltaY"){F=F.clientHeight-parseFloat(z(F,"padding-top"))-parseFloat(z(F,"padding-bottom"));E.offsetStart=this.element.offsetHeight;if(isNaN(E.factor))E.factor=p!="static"&&z(this.element,
"bottom")!="auto"?-1:1}else{F=F.clientWidth-parseFloat(z(F,"padding-left"))-parseFloat(z(F,"padding-right"));E.offsetStart=this.element.offsetWidth;if(isNaN(E.factor))E.factor=v=="right"||p!="static"&&z(this.element,"right")!="auto"?-1:1}E.offsetStartInPercent=100/F;A(this.resizer).add("selected")},event_move:function(E){B.event_move.call(this,E);this.element.style[this.property]=E.offsetStartInPercent*(E.offsetStart+E.factor*E[E.delta])+"%"},event_over:function(E){B.event_over.call(this,E);A(this.resizer).remove("selected");
C.setProperty("pointerEvents","auto")},init:function(E){this.resizer=x.createElement(".Basis-Resizer");this.resizer.style.cursor=H[this.property][1];B.init.call(this,E)},setElement:function(E){var F=this.element;B.setElement.call(this,E,this.resizer);if(F!==this.element){F&&x.remove(this.resizer);this.element&&x.insert(this.element,this.resizer)}}}});r.namespace("basis.ui.resizer").extend({Resizer:y})})(basis);
(function(r){function z(v){return(100*v).toFixed(4)+"%"}function x(v){var p=v.childNodes.search(v.activePage_,"data.pageNumber");p?p.select():v.selection.clear()}var A=r.dom.event,y=r.EventObject.createEvent,C=r.cssom.classList,I=r.layout.Box,H=r.dragdrop.DragDropElement,B=r.ui.Control,E=r.ui.Node.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
templateUpdate:function(v){var p=this.pageGetter(this);v.pageNumber.nodeValue=p+1;v.link.href=this.urlGetter(p)},action:{click:function(v){A.kill(v);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))}}),F={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(v){v=((this.initOffset+v.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(v*(this.pageCount_-this.pageSpan_)));
this.tmpl.scrollTrumb.style.left=z(v)},over:function(){this.setSpanStartPage(this.spanStartPage_)}};y=B.subclass({childClass:E,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(v,p){var w=this.tmpl.scrollbar;w=(A.mouseX(p)-(new I(w)).left)/w.offsetWidth;this.setSpanStartPage(Math.floor(w*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(v){(v=A.wheelDelta(v))&&this.setSpanStartPage(this.spanStartPage_+v)}},event_activePageChanged:y("activePageChanged"),event_pageCountChanged:y("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(v){B.prototype.init.call(this,v);this.setProperties(v.pageCount||0,
v.pageSpan);this.setActivePage(Math.max(v.activePage-1,0),true);this.scrollbarDD=new H({element:this.tmpl.scrollTrumb,handler:F,handlerContext:this})},setProperties:function(v,p,w){v=v||1;p=Math.min(p||10,v);if(p!=this.pageSpan_){this.pageSpan_=p;this.setChildNodes(Array.create(p,function(o){return{data:{pageNumber:o}}}))}if(this.pageCount_!=v){this.pageCount_=v;var t=1/v;this.tmpl.activePageMark.style.width=z(t/(1-t));this.tmpl.activePageMarkWrapper.style.width=z(1-t);this.event_pageCountChanged(this.pageCount_)}t=
p/v;var j=t/(1-t);this.tmpl.scrollTrumbWrapper.style.width=z(1-t);this.tmpl.scrollTrumb.style.width=z(j);C(this.element).bool("Basis-Paginator-WithNoScroll",p>=v);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(arguments.length==3?w:this.activePage_)},setActivePage:function(v,p){v=v.fit(0,this.pageCount_-1);if(v!=this.activePage_){this.activePage_=Number(v);x(this);this.event_activePageChanged(v)}this.tmpl.activePageMark.style.left=z(v/Math.max(this.pageCount_-1,1));p&&this.spotlightPage(this.activePage_)},
spotlightPage:function(v){this.setSpanStartPage(v-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(v){v=v.fit(0,this.pageCount_-this.pageSpan_);if(v!=this.spanStartPage_){this.spanStartPage_=v;for(var p=this.childNodes.length;p-- >0;)this.childNodes[p].update({pageNumber:v+p});x(this)}this.tmpl.scrollTrumb.style.left=z((v/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;B.prototype.destroy.call(this)}});r.namespace("basis.ui.paginator").extend({Paginator:y})})(basis);
(function(r){var z="basis.ui.pageslider",x=r.dom,A=r.Class,y=r.cssom.classList;z="basis.ui";A=A(r.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(C,I){r.ui.tabs.PageControl.event_childNodesModified.call(this,C,I);for(var H=0,B;B=this.childNodes[H];H++)r.cssom.setStyle(B.element,{left:100*H+"%"})},init:function(C){var I="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=r.cssom.cssRule("."+I+" > .Basis-Page");this.constructor.superClass_.prototype.init.call(this,
C);y(this.element).add(I);this.scroller=new r.ui.Scroller({targetElement:this.element,preventScrollY:true,minScrollDelta:10,handler:{startInertia:function(B){var E=this.selection.pick();if(E){var F=E;if(B.currentDirectionX==0||B.currentDirectionX==1&&B.viewportX<E.element.offsetLeft||B.currentDirectionX==-1&&B.viewportX>E.element.offsetLeft){B.minScrollDeltaXReached=true;F=this.childNodes[Math.round(B.viewportX/E.element.offsetWidth)]}else F=B.currentDirectionX==1?E.nextSibling:E.previousSibling;
F||(F=E);F==E?this.slideToPage(E):F.select()}B.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var B=this.pick();B&&B.parentNode.slideToPage(B)}});if(this.selection.itemCount){var H=this;setTimeout(function(){H.slideToPage(H.selection.pick())},0)}},slideToPage:function(C){this.scroller.setTargetPosition(C.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);x.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});r.namespace(z).extend({PageSlider:A})})(basis);
(function(r){var z=r.dom.wrapper.Node,x=r.ui.Node,A=z.subclass({draw:function(C){C.save();C.fillStyle="red";C.fillRect(this.data.value*10,10,30,30);C.restore()},update:function(){var C=z.prototype.update.apply(this,arguments);if(C)for(var I=this.parentNode;I;){if(I instanceof y){I.updateCount++;break}I=I.parentNode}return C}}),y=x.subclass({template:"<canvas{canvas}><div>Canvas doesn't support.</div></canvas>",childFactory:function(C){return new this.childClass(C)},childClass:A,drawCount:0,lastDrawUpdateCount:-1,
init:function(C){x.prototype.init.call(this,C);this.element.width=this.width;this.element.height=this.height;this.updateCount=0;if((C=this.tmpl.canvas)&&C.getContext)this.context=C.getContext("2d");this.updateTimer_=setInterval(this.draw.bind(this),1E3/60)},reset:function(){this.element.width=this.element.clientWidth;this.element.height=this.element.clientHeight},isNeedToDraw:function(){return this.context&&(this.updateCount!=this.lastDrawUpdateCount||this.element.width!=this.lastDrawWidth||this.element.height!=
this.lastDrawHeight)},draw:function(){if(!this.isNeedToDraw())return false;this.lastDrawWidth=this.element.width;this.lastDrawHeight=this.element.height;this.lastDrawUpdateCount=this.updateCount;this.drawCount+=1;this.reset();this.drawFrame();return true},drawFrame:function(){for(var C=this.firstChild;C;C=C.nextSibling)C.draw(this.context)},destroy:function(){clearInterval(this.updateTimer_);x.prototype.destroy.call(this)}});r.namespace("basis.ui.canvas").extend({Canvas:y,Shape:A})})(basis);
(function(r){function z(C,I){for(var H=function(v){function p(b,d,a,c){o!=d&&w.push(v.substring(o,d).replace(y,'<span class="token-keyword">$1</span>'));o=a+1;w.push('<span class="token-'+b+'">'+v.substring(d,a+1)+"</span>"+(c||""))}for(var w=[],t=v.toArray(),j,o=0,l=0;l<t.length;l++)if(t[l]=="'")for(j=l;++l<t.length;){if(t[l]=="'"){p("string",j,l);break}if(t[l]=="\n")break;if(t[l]=="\\"){l++;if(t[l]=="\n"){p("string",j,l-1);j=l+1}}}else if(t[l]=='"')for(j=l;++l<t.length;){if(t[l]=='"'){p("string",
j,l);break}if(t[l]=="\n")break;if(t[l]=="\\"){l++;if(t[l]=="\n"){p("string",j,l-1);j=l}}}else if(t[l]=="/"){j=l;l++;if(t[l]=="/"){for(;++l<t.length;)if(t[l]=="\n")break;p("comment",j,l-1)}if(t[l]=="*")for(;++l<t.length;)if(t[l]=="*"&&t[l+1]=="/"){p("comment",j,++l);break}else if(t[l]=="\n"){p("comment",j,l-1,"\n");o=j=l+1}}w.push(v.substr(o).replace(y,'<span class="token-keyword">$1</span>'));return w}(function(v){v=v.trimRight().replace(/\r\n|\n\r|\r/g,"\n");I||(v=v.replace(/^(?:\s*[\n]+)+?([ \t]*)/,
"$1"));v=v.replace(/\n[ \t]+/g,function(o){return o.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!I){for(var p=1E3,w=v.split(/\n+/),t=Number(v.match(/^function/)!=null);t<w.length;t++){var j=w[t].match(/^\s*/);if(j[0].length<p)p=j[0].length;if(p==0)break}if(p>0)v=v.replace(new RegExp("(^|\\n) {"+p+"}","g"),"$1")}return v=v.replace(new RegExp("(^|\\n)( +)","g"),function(o,l,b){return l+"\u00a0".repeat(b.length)})}(C).replace(/</g,"&lt;")).join("").split("\n"),B=String(H.length>>1).length,
E=[],F=0;F<H.length;F++)E.push('<div class="line '+(F%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(F+1).lead(B)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(H[F]+"\r\n")+"</span></div>");return E.join("")}var x=r.Class,A=r.ui.Node,y=new RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+
")\\b","g");x=x(A,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',codeGetter:Function.getter("data.code"),normalize:true,templateUpdate:function(){var C=this.codeGetter(this);if(C!=this.code_){this.code_=C;this.tmpl.codeElement.innerHTML=z(C,!this.normalize)}}});r.namespace("basis.format.highlight").extend({highlight:z,SourceCodeNode:x})})(basis);
