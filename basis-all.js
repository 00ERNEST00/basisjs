/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(f){function l(a,b){for(var c in b)a[c]=b[c];return a}function i(a,b){for(var c in b)c in a==false&&(a[c]=b[c]);return a}function n(a){return a==null||a==void 0}function m(a){return a}function p(a){var b={};a.names=function(a){return Object.slice(b,typeof a=="string"?a.qw():a)};a.extend=function(a){i(b,a);l(this,a);return this};return a}function v(a,b){for(var c=a.split("."),h=f,d,j,e;c.length;)if(d=c.shift(),j=(j?j+".":"")+d,h[d]||(h[d]=p((!c.length?b:null)||function(){},j),e&&(e.namespaces_[j]=
h[d])),h=h[d],!e&&(e=h,!e.namespaces_))e.namespaces_={};return k[a]=h}l(Object,{extend:l,complete:i,keys:function(a){var b=[],c;for(c in a)b.push(c);return b},values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},slice:function(a,b){var c={};if(!b)return l(c,a);for(var h=0,d;d=b[h++];)d in a&&(c[d]=a[d]);return c},splice:function(a,b){var c={};if(!b)return l(c,a);for(var h=0,d;d=b[h++];)d in a&&(c[d]=a[d],delete a[d]);return c},iterate:function(a,b,c){var h=[],d;for(d in a)h.push(b.call(c,
d,a[d]));return h},coalesce:function(){for(var a=arguments,b=0;b<a.length;b++)if(a[b]!=null)return a[b]}});var t=function(){},u=function(){var a=1,b={},c={};a++;return function(h,d){var j,e;if(!d){if(h.getter)return h.getter;if(typeof h=="function")return h}if(typeof h!="function")c[h]?j=c[h]:(j=new Function("object","return object != null ? object."+h+" : object"),j.path=h,j.getterIdx_=a++,c[h]=j);else if(j=h,!j.getterIdx_)j.getterIdx_=a++;e=j.getterIdx_;var g=b[e];if(g)if(typeof d=="undefined"){if(g.nmg)return g.nmg}else for(e=
0;e<g.length;e++){if(g[e].modificator===d)return g[e].getter}else g=b[e]=[];var z=true;switch(d&&typeof d){case "string":e=function(a){return d.format(j(a))};break;case "function":e=function(a){return d(j(a))};break;case "object":z=false;e=function(a){return d[j(a)]};break;default:e=j.path?j:function(a){return j(a)}}if(z&&(g.push({getter:e,modificator:d}),typeof d=="undefined"))g.nmg=e;return e.getter=e}}();l(Function,{$undefined:function(a){return a==void 0},$defined:function(a){return a!=void 0},
$isNull:n,$isNotNull:function(a){return a!=null&&a!=void 0},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:m,$const:function(a){return function(){return a}},$false:function(){return false},$true:function(){return true},$null:function(){return null},$undef:t,getter:u,def:function(a,b,c){c=c||n;return function(h){h=a(h);return c(h)?b:h}},wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,h;return function(){c++||(h=a.apply(b||
this,arguments));return h}},lazyInitAndRun:function(a,b,c){var h=0,d;return function(){h++||(d=a.call(c||this));b.apply(d,arguments);return d}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}});i(Function.prototype,{bind:function(a){var b=this,c=Array.from(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});i(Array,{isArray:function(a){return Object.prototype.toString.call(a)===
"[object Array]"}});l(Array,{from:function(a,b){if(a!=null){var c=a.length;if(typeof c=="undefined")return[a];b||(b=0);if(c-b>0){for(var h=[],d=0,j=b;j<c;)h[d++]=a[j++];return h}}return[]},create:function(a,b,c){for(var h=[],d=typeof b=="function",j=0;j<a;j++)h[j]=d?b.call(c,j,h):b;return h}});i(Array.prototype,{indexOf:function(a,b){b=parseInt(b)||0;if(b<0)return-1;for(;b<this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){for(var c=this.length,b=parseInt(b),b=isNaN(b)||b>=
c?c-1:(b+c)%c;b>=0;b--)if(this[b]===a)return b;return-1},forEach:function(a,b){for(var c=0,h=this.length;c<h;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,h=this.length;c<h;c++)if(c in this&&!a.call(b,this[c],c,this))return false;return true},some:function(a,b){for(var c=0,h=this.length;c<h;c++)if(c in this&&a.call(b,this[c],c,this))return true;return false},filter:function(a,b){for(var c=[],h=0,d=this.length;h<d;h++)h in this&&a.call(b,this[h],h,this)&&c.push(this[h]);
return c},map:function(a,b){for(var c=[],h=0,d=this.length;h<d;h++)h in this&&(c[h]=a.call(b,this[h],h,this));return c},reduce:function(a,b){var c=this.length,h=arguments.length;if(c==0&&h==1)throw new TypeError;var d,j=0;h>1&&(d=b,j=1);for(h=0;h<c;h++)h in this&&(d=j++?a.call(null,d,this[h],h,this):this[h]);return d}});l(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[a>=
0?a:this.length+a]},search:function(a,b,c){Array.lastSearchIndex=-1;for(var b=Function.getter(b||m),c=parseInt(c)||0,h=this.length;c<h;c++)if(b(this[c])===a)return this[Array.lastSearchIndex=c]},lastSearch:function(a,b,c){Array.lastSearchIndex=-1;for(var b=Function.getter(b||m),h=this.length,c=isNaN(c)||c==null?h:parseInt(c),h=c>h?h:c;h-- >0;)if(b(this[h])===a)return this[Array.lastSearchIndex=h]},binarySearchPos:function(a,b,c,h,d,j){if(!this.length)return h?-1:0;var b=Function.getter(b||m),c=!!c,
e,d=isNaN(d)?0:d,g=isNaN(j)?this.length-1:j;do if(j=d+g>>1,e=b(this[j]),c?a>e:a<e)g=j-1;else if(c?a<e:a>e)d=j+1;else return a==e?j:h?-1:0;while(d<=g);return h?-1:j+(e<a^c)},binarySearch:function(a,b){return this.binarySearchPos(a,b,false,true)},add:function(a){return this.indexOf(a)==-1&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return a!=-1&&!!this.splice(a,1)},has:function(a){return this.indexOf(a)!=-1},merge:function(a){return this.reduce(l,a||{})},sortAsObject:function(a,b,c){a=Function.getter(a);
c=c?-1:1;return this.map(function(c,b){return{i:b,v:a(c)}}).sort(b||function(a,b){return c*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){if(this!==a)this.length=0,this.push.apply(this,a);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var w=Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);if(a.length<2)a[1]=this.length;return w.apply(this,a)}}var s={"<":">","[":"]","(":")",
"{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};i(String,{toLowerCase:function(a){return String(a).toLowerCase()},toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()},isEmpty:function(a){return a==
null||String(a)==""},isNotEmpty:function(a){return a!=null&&String(a)!=""}});i(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});l(String.prototype,{toObject:function(a){try{return Function("return 0,"+this)()}catch(b){if(a)throw b;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],b=this.length,c=0;c<b;c++)a[c]=this.charAt(c);return a},
repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,"\\$&")},format:function(a){for(var b={},c=0;c<arguments.length;c++)b[c]=arguments[c];typeof a=="object"&&l(b,a);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(a,c,j,d,e){a=c in b?b[c]:e?"":a;return j&&!isNaN(a)?(a=Number(a),j=="."?a.toFixed(d):a.lead(d)):a})},quote:function(a,
b){var a=a||'"',b=b||s[a]||a,c=(a.length==1?a:"")+(b.length==1?b:"");return a+(c?this.replace(RegExp("["+c.forRegExp()+"]","g"),"\\$&"):this)+b},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,b){return b.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});String.format=String.prototype.format;if("|||".split(/\|/).length+"|||".split(/(\|)/).length!=
11)String.prototype.split=function(a){if(a==""||a&&a.source=="")return this.toArray();var b=[],c=0,h;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));h=a.exec(this);)h[0]=this.substring(c,h.index),b.push.apply(b,h),c=a.lastIndex;else for(;(h=this.indexOf(a,c))!=-1;)b.push(this.substring(c,h)),c=h+a.length;b.push(this.substr(c));return b};if("12".substr(-1)!="2"){var o=String.prototype.substr;String.prototype.substr=function(a,b){return o.call(this,a<0?Math.max(0,
this.length+a):a,b)}}l(Number.prototype,{fit:function(a,b){return!isNaN(a)&&this<a?Number(a):!isNaN(b)&&this>b?Number(b):this},between:function(a,b){return!isNaN(this)&&this>=a&&this<=b},quote:function(a,b){return(this+"").quote(a,b)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,b){return(this+"").replace(/\d+/,function(c){return(a-=c.length-1)>1?Array(a).join(b||
0)+c:c})},group:function(a,b){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(h,d){return!d+(c.length-d)%(a||3)?h:(b||" ")+h})})},format:function(a,b,c,h,d){a=this.toFixed(a);if(b||d)a=a.replace(/(\d+)(\.?)/,function(a,c,h){return(b?Number(c).group(3,b):c)+(h?d||h:"")});c&&(a=a.replace(/^-?/,"$&"+(c||"")));return a+(h||"")}});i(Date,{now:function(){return+new Date}});(new Date).getYear()<1900&&l(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&
a<100?Number(a)+1900:a)}});var k={},q=function(){function a(a,c){for(var b=k[a],h=c?c.split(/\./):[];b&&h.length;)b=b[h.shift()];return b}var b=f.document?f.document.getElementsByTagName("SCRIPT"):null,c=(b?b[b.length-1].src:module.filename).replace(/[^\/]+$/,""),h={},d;typeof require=="function"?d=function(a){return require(requirePath+a.replace(/\./g,"/"))}:(d=function(b,e){var g=b.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],z=b.substr(g.length?g.length+1:0),C=a(g,z),r=/^basis\./.test(g)?
c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!k[g]||!C)if(/^https?:/.test(r))if(h[b])throw"Attempt to load namespace, probably cycle require";else{h[b]=1;var r=r+(e||"")+b.replace(/\./g,"/")+".js",i=new XMLHttpRequest;i.open("POST",r,false);i.send(null);if(i.status==200){try{(new Function(i.responseText)).call(f)}catch(B){throw B;}d.sequence.push(b.replace(/\./g,"/")+".js")}else if(i.status==404&&z)q(g);else throw"!";}else throw"Path `"+b+"` can't be resolved";return C||
a(g,z)},d.sequence=[]);return d}(),r=function(){function a(a){return typeof a=="function"&&a.basisClass_}var b=Function(),c=1,h={},d=function(){for(var a in{toString:1})return;return true}();l(b,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=t}},create:function(d){typeof d!="function"&&(d=b);var j=Function();j.prototype=
d.prototype;for(var j=new j,e={className:d.className+"._SubClass_",basisClass_:true,superClass_:d,extendConstructor_:!!d.extendConstructor_,__extend__:function(c){return c&&(typeof c=="object"||typeof c=="function"&&!a(c))&&c!==h?b.create.call(null,D,c):c},extend:b.extend,subclass:function(){return b.create.apply(null,[D].concat(Array.from(arguments)))},prototype:j},g=arguments,x=1;x<g.length;x++)e.extend(typeof g[x]=="function"&&!a(g[x])?g[x](d.prototype):g[x]);var y={},D=e.extendConstructor_?function(a,
b){this.eventObjectId=c++;var h,d;for(d in a)h=this[d],this[d]=h&&h.__extend__?h.__extend__(a[d]):a[d];this.init(b||y)}:function(){this.eventObjectId=c++;this.init.apply(this,arguments)};j.constructor=D;for(var k in j)j[k]===h&&(j[k]=D);l(D,e);return D},extend:function(a){var c=this.prototype;if(a.prototype)a=a.prototype;for(var b in a){var h=a[b],j=c[b];b=="className"||b=="extendConstructor_"?this[b]=h:c[b]=j&&j.__extend__?j.__extend__(h):h}if(d&&a[b="toString"]!==Object.prototype[b])c[b]=a[b];return this}});
var j=function(a,c){return{__extend__:function(a){var b=Function();b.prototype=this;b=new b;c(b,a);return b}}.__extend__(a)},e=function(a){return j(a,l)};return v("basis.Class",b.create).extend({SELF:h,BaseClass:b,create:b.create,isClass:a,CustomExtendProperty:j,ExtensibleProperty:e,NestedExtProperty:function(a){return j(a,function(a,c){for(var b in c){var h=a[b];a[b]=h&&h.__extend__?h.__extend__(c[b]):e(c[b])}})}})}(),g=function(){function a(a){var h=c[a];h||(h=c[a]=function(){var c=this.handlers_,
h,d;if(c&&c.length)for(var c=b.call(c),e=c.length;e-- >0;)h=c[e],d=h.handler[a],typeof d=="function"&&d.apply(h.thisObject,arguments)});return h}var b=Array.prototype.slice,c={},h,d=r(null,{handlers_:null,event_destroy:h=a("destroy","object"),listen:r.NestedExtProperty(),extendConstructor_:true,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,c){var b=this.handlers_;if(!b)b=this.handlers_=
[];c||(c=this);for(var h=b.length,d;h-- >0;)if(d=b[h],d.handler===a&&d.thisObject===c)return false;return!!b.push({handler:a,thisObject:c||this})},removeHandler:function(a,c){var b=this.handlers_;if(b){c||(c=this);for(var h=b.length,d;h-- >0;)if(d=b[h],d.handler===a&&d.thisObject===c)return!!b.splice(h,1);return false}},destroy:function(){if(this.handlers_)h.call(this,this),this.handlers_=null}});d.createEvent=a;d.event=c;return d}(),e=function(){var a=[];return{add:function(b){b!=null&&a.push(b)},
remove:function(b){a.remove(b)}}}();(function(){function a(a){if(b){if(a.source!=f||a.data!=c)return;basis.dom.event.kill(a)}h.length&&(a=h.shift(),delete d[a.key],a.fn())}var b=typeof addEventListener=="function"&&typeof postMessage=="function",c="zeroTimeoutMessage",h=[],d={},j=1;b&&f.addEventListener("message",a,true);var e=setTimeout;f.setTimeout=function(z,g){var k;g?k=e.call(f,z,g):(k={key:"z"+j++,fn:typeof z=="function"?z:new Function(z)},d[k.key]=k,h.push(k),b?postMessage(c,"*"):k.timer=e.call(f,
a,0),k=k.key);return k};var g=clearTimeout;f.clearTimeout=function(a){if(/z\d+/.test(a)){var c=d[a];c&&(clearTimeout(c.timer),h.remove(c),delete d[a])}else return g.call(f,a)}})();var d=function(){function a(){if(!f)if(j.length){var a=Date.now(),b=Math.max(j[0].eventTime,a);b<k&&(clearTimeout(z),z=setTimeout(c,(k=b)-a))}else z=clearTimeout(z),k=h}function b(c,b){var h=c.eventObjectId,d=g[b]&&g[b][h];d&&(j.remove(d),delete g[b][h],a())}function c(){var c=Date.now(),c=j.binarySearchPos(c+15,d);f=true;
j.splice(0,c).forEach(function(a){delete g[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});f=false;k=h;a()}var h=2E12,d=u("eventTime"),j=[],g={},k=h,z=null,f=false;e.add({destroy:function(){f=true;clearTimeout(z);j.length=0;g=null}});return{add:function(c,h,e){var D=c.eventObjectId,z=g[h];z||(z=g[h]={});var k=z[D];if(k){if(isNaN(e))return b(c,h);if(k.eventTime==e)return;j.remove(k);k.eventTime=e}else{if(isNaN(e))return;k=z[D]={eventName:h,object:c,eventTime:e,callback:c[h]}}j.splice(j.binarySearchPos(e,
d),0,k);a()},remove:b}}();v("basis").extend({namespace:v,platformFeature:{},EventObject:g,TimeEventManager:d,Cleaner:e,require:q});f.basis.locale={}})(this);
(function(f,l){function i(g){for(var e=1E6,g=String(g).split("."),d=0,a=0;d<4&&d<g.length;d++,e/=100)a+=g[d]*e;return a}function n(){for(var g=0;g<arguments.length;g++){var e=arguments[g].toLowerCase();if(e in p){if(p[e])return true}else{var d=e.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(d){p[e]=false;var a=d[1].toLowerCase(),b=i(d[3]),d=d[4]||"=";if(a=v[a])return p[e]=!b||d=="="&&a==b||d=="+"&&a>=b||d=="-"&&a<b}}}return false}var m="basis.ua",p={},v={},t=l.navigator&&l.navigator.userAgent,u="unknown",
w={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},s;for(s in w)if(!(s=="MSIE"&&l.opera)&&!(s=="Safari"&&t.match(/chrome/i))&&!(s=="AppleWebKit"&&t.match(/iphone/i))&&t.match(RegExp(s+".(\\d+(\\.\\d+)*)","i")))for(var o=
w[s],k=l.opera&&typeof l.opera.version=="function"?l.opera.version():RegExp.$1,q=i(k),u=o[0]+" "+k,k=0;k<o.length;k++)v[o[k].toLowerCase()]=q;f.platformFeature.datauri=false;t=typeof Image!="undefined"?new Image:{};t.onload=function(){f.platformFeature.datauri=true};t.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(n("IE7-"))try{document.execCommand("BackgroundImageCache",false,true)}catch(r){}m=f.namespace(m);m.toString=function(){return u};return m.extend({testImage:t,
prettyName:u,test:n,is:function(g){return n(g)},Cookies:{set:function(g,e,d,a){document.cookie=g+"="+(e==null?"":escape(e))+";path="+(a||(location.pathname.indexOf("/")==0?"":"/")+location.pathname)+(d?";expires="+(new Date(Date.now()+d*1E3)).toGMTString():"")},get:function(g){return(g=document.cookie.match(RegExp("(^|;)\\s*"+g+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(g[2])},remove:function(g,e){document.cookie=g+"=;expires="+(new Date(0)).toGMTString()+";path="+(e||(location.pathname.indexOf("/")==
0?"":"/")+location.pathname)}}})})(basis,this);
(function(f,l){function i(a,b,h){if(b!=null)return a.insertBefore(c(b)?b:v(b),h||null)}function n(a){return u("",a.cloneNode(true)).innerHTML}function m(a){return c(a)||a&&a.nodeType?a:typeof a=="string"?k.getElementById(a):null}function p(c,b,j){var x,y=[],j=typeof j=="string"?getter(j):j||Function.$true;b&26&&j(c)&&y.push(c);switch(b){case 1:case 2:for(x=c;(x=x[g])&&x!==c.document;)j(x)&&y.push(x);break;case 64:for(x=c[e];x;)j(x)&&y.push(x),x=x[d];break;case 4:case 8:c[e]&&(b=new h(c),b.nodes(j,
y));break;case 128:b=new h(c,j);for(b.cursor_=c[d]||c[g];x=b.next();)y.push(x);break;case 256:for(x=c;x=x[d];)j(x)&&y.push(x);break;case 32:j(c[g])&&y.push(c[g]);break;case 512:b=new h(c,j,h.BACKWARD);for(b.cursor_=c[a]||c[g];x=b.next();)y.push(x);break;case 1024:for(x=c;x=x[a];)j(x)&&y.push(x)}return y}function v(a){return k.createTextNode(a!=null?a:"")}function t(){for(var a=k.createDocumentFragment(),c=arguments.length,b=t.array=[],h=0;h<c;h++)b.push(i(a,arguments[h]));return a}function u(a,c){var b=
a!=void 0&&typeof a!="string",h=(b?a.description:a)||"",d="div",e=h.match(/^([a-z0-9\_\-]+)(.*)$/i);e&&(d=e[1],h=e[2]);if(h!=""){for(var g=[],y={},r;e=A.exec(h);){if(e[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+h+"\n\nProblem place:\n> "+h.substr(0,e.index)+"--\>"+h.substr(e.index)+"<--");r=e[1]||e[2]||e[3];e[1]?y.id=r:e[2]?g.push(r):r!="class"&&(y[r]=e[4]?o(e[5],e[6],e[7]):r)}j&&y.name&&/^(input|textarea|select)$/i.test(d)&&(d="<"+d+" name="+y.name+">")}h=
k.createElement(d);if(y){if(y.style&&x)h.style.cssText=y.style;for(var q in y)h.setAttribute(q,y[q],0)}if(g&&g.length)h.className=g.join(" ");arguments.length>1&&i(h,t.apply(0,Array.from(arguments,1).flatten()));if(b&&(a.css&&f.cssom&&f.cssom.setStyle(h,a.css),f.dom.event))for(var l in a)typeof a[l]=="function"?f.dom.event.addHandler(h,l,a[l],h):a[l]instanceof f.dom.event.Handler&&f.dom.event.addHandler(h,l,a[l].handler,a[l].thisObject);return h}function w(a,c){return a[g]?a[g].replaceChild(c,a):
a}function s(a){if(k.selection){var c=k.selection.createRange();c.compareEndPoints("StartToEnd",c)!=0&&c.collapse(a);return c.getBookmark().charCodeAt(2)-2}}var o=Object.coalesce,k=l.document,q=f.Class,r=k.createElement("div"),g="parentNode",e="firstChild",d="nextSibling",a="previousSibling",b;b=typeof r.compareDocumentPosition=="function"?function(a,c){return a.compareDocumentPosition(c)}:function(a,c){return a==c?0:a.document!=c.document?33:a.sourceIndex>c.sourceIndex?2|8*c.contains(childA):4|16*
a.contains(childB)};var c;if(typeof Node!="undefined"){if(c=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else c=function(a){return a&&a.ownerDocument===k};var h=q(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,c,b){this.setRoot(a);this.setDirection(b);if(typeof c=="function")this.filter=c},setDirection:function(c){Object.extend(this,c?{a:"lastChild",b:a,c:d,d:e}:{a:e,b:d,c:a,d:"lastChild"})},
setRoot:function(a){this.root_=a||k;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,c){var b;c||(c=[]);for(this.reset();b=this.next(a);)c.push(b);return c},next:function(a){var a=a||this.filter,c=this.cursor_||this.root_;do for(var b=c[this.a];!b;){if(c===this.root_)return this.cursor_=null;(b=c[this.b])||(c=c[g])}while(!a(c=b));return this.cursor_=c},prev:function(a){var a=a||
this.filter,c=this.cursor_,b=this.c,h=this.d;do{var d=c?c[b]:this.root_[h];if(d){for(;d[h];)d=d[h];c=d}else c&&(c=c[g]);if(!c||c===this.root_){c=null;break}}while(!a(c));return this.cursor_=c},destroy:function(){this.cursor_=this.root_=null}});h.BACKWARD=true;var y="textContent innerText nodeValue".qw(),j=function(){var a=k.createElement("input");a.name="a";return!/name/.test(n(a))}(),x;r.setAttribute("style","color: red");x=r.style.color!=="red";var A=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return f.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:h,outerHTML:n,textContent:function(a){for(var c=0,b;b=y[c++];)if(a[b]!=null)return a[b];return p(a,4,function(a){return a.nodeType==3}).map(getter("nodeValue")).join("")},get:m,tag:function(a,c){a=m(a)||k;return c=="*"&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(c||"*"))},axis:p,findAncestor:function(a,c,b){for(;a&&a!==b;){if(c(a))return a;a=a.parentNode}},createElement:u,createText:v,createFragment:t,insert:function(a,
b,h,j){a=m(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(h){case void 0:case "end":j=null;break;case "begin":j=a[e];break;case "before":break;case "after":j=j[d];break;default:j=Number(h).between(0,a.childNodes.length)?a.childNodes[h]:null}h=!c(a);if(!b||!Array.isArray(b))h=h?b&&a.insertBefore(b,j):i(a,b,j);else if(h)for(var h=[],g=0,D=b.length;g<D;g++)h[g]=a.insertBefore(b[g],j);else a.insertBefore(t.apply(0,b),j),h=t.array;return h},remove:function(a){return a[g]?
a[g].removeChild(a):a},replace:w,swap:function(a,c){if(a===c||b(a,c)&25)return false;w(a,r);w(c,a);w(r,c);return true},clone:function(a,c){var b=a.cloneNode(!c);b.attachEvent&&p(b,8).forEach(Event.clearHandlers);return b},clear:function(a){for(a=m(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,c,b){var h=[],b=Function.getter(b||Function.$self),d;for(d in c)for(var j=0;j<a.length;j++){var e=b(a[j]);h[j]=c[d](a[j],j,e)?u(d,e):a[j]}return h},setAttribute:function(a,c,b){b==null?
a.removeAttribute(c):a.setAttribute(c,b)},parentOf:function(a,c){return a.contains(c)},isInside:function(a,c){return a==c||c.contains(a)},focus:function(a,c){try{a=m(a),a.focus(),c&&a.select&&a.select()}catch(b){}},setSelectionRange:function(a,c,b){arguments.length<3&&(b=c);if(a.setSelectionRange)a.setSelectionRange(c,b);else if(a.createTextRange){var h=a.createTextRange();h.collapse(true);h.moveStart("character",c);h.moveEnd("character",b-c);h.select()}},getSelectionStart:function(a){return typeof a.selectionStart!=
"undefined"?a.selectionStart:s(true)},getSelectionEnd:function(a){return typeof a.selectionEnd!="undefined"?a.selectionEnd:s(false)}})})(basis,this);
(function(f,l){function i(a){return a||l.event}function n(a){return typeof a=="string"?o.get(a):a}function m(a){a=i(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=true}function p(a){a=i(a);a.preventDefault?a.preventDefault():a.returnValue=false}function v(a){var b=Array.from(g[a.type]);if(b)for(var c=b.length;c-- >0;){var h=b[c];h.handler.call(h.thisObject,a)}}function t(a,b,c,h){a=n(a);if(!a)throw Error("Event.addHandler: can't attach event listener to undefined");if(typeof c!="function")throw Error("Event.addHandler: handler must be a function");
a[q]||(a[q]={});var d={handler:c,thisObject:h},j=a[q],g=j[b];if(g){for(a=0;b=g[a];a++)if(b.handler===c&&b.thisObject===h)return;g.push(d)}else g=j[b]=[d],g.fireEvent=function(a){a=i(a);if(e&&a&&typeof a.returnValue=="undefined"){v(a);if(a.cancelBubble===true)return;if(typeof a.returnValue=="undefined")a.returnValue=true}for(var c=0,b;b=g[c++];)b.handler.call(b.thisObject,a)},a.addEventListener?a.addEventListener(b,g.fireEvent,false):a.attachEvent("on"+b,g.fireEvent)}function u(a,b,c,h){var a=n(a),
d=a[q];if(d&&(d=d[b]))for(var j=0,e;e=d[j];j++)if(e.handler===c&&e.thisObject===h){d.splice(j,1);d.length||w(a,b);break}}function w(a,b){var a=n(a),c=a[q];if(c)if(typeof b!="string")for(b in c)w(a,b);else{var h=c[b];h&&(a.removeEventListener?a.removeEventListener(b,h.fireEvent,false):a.detachEvent("on"+b,h.fireEvent),delete c[b])}}var s=l.document,o=f.dom,k=Function.$null,q="__basisEvents",r={mousewheel:["mousewheel","DOMMouseScroll"]},g={},e=!s.addEventListener,d=function(){function a(){b++||setTimeout(function(){for(var a=
0;a<c.length;a++)c[a].callback.call(c[a].thisObject)},10)}var b=false,c=[];if(f.ua.is("ie7-"))(function(){var c="_"+Date.now();s.write('<script id="'+c+'" defer src="//:"><\/script>');n(c).onreadystatechange=function(){this.readyState=="complete"&&(o.remove(this),a())}})();else if(f.ua.is("safari525-"))var h=setInterval(function(){/loaded|complete/.test(s.readyState)&&(clearInterval(h),a())},15);else t(s,"DOMContentLoaded",a,false);t(s,"load",a,false);t(l,"load",a,false);return function(a,h){b||c.push({callback:a,
thisObject:h})}}();return f.namespace("basis.dom.event",i).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return r[a]||[a]},Handler:function(a,b){this.handler=a;this.thisObject=b},sender:function(a){a=i(a);return a.target||a.srcElement},cancelBubble:m,
cancelDefault:p,kill:function(a,b){(b=n(b))?t(b,a,Event.kill):(p(a),m(a))},key:function(a){a=i(a);return a.keyCode||a.which||0},charCode:function(a){a=i(a);return a.charCode||a.keyCode||0},mouseButton:function(a,b){a=i(a);return typeof a.which=="number"?a.which==b.VALUE:a.button&b.BIT},mouseX:function(a){a=i(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(s.documentElement.scrollLeft||s.body.scrollLeft)},mouseY:function(a){a=i(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(s.documentElement.scrollTop||s.body.scrollTop)},wheelDelta:function(a){a=i(a);return"wheelDelta"in a?a.wheelDelta/120:a.type=="DOMMouseScroll"?-a.detail/3:0},addGlobalHandler:function(a,b,c){var h=g[a];if(h)for(a=h.length;a-- >0;){var d=h[a];if(d.handler===b&&d.thisObject===c)return}else s.addEventListener?s.addEventListener(a,v,true):t(s,a,k),h=g[a]=[];h.push({handler:b,thisObject:c})},removeGlobalHandler:function(a,b,c){var h=g[a];if(h)for(var d=0,j;j=h[d];d++)if(j.handler===
b&&j.thisObject===c){h.splice(d,1);h.length||(delete g[a],s.removeEventListener?s.removeEventListener(a,v,true):u(s,a,k));break}},addHandler:t,addHandlers:function(a,b,c){var a=n(a),h;for(h in b)t(a,h,b[h],c)},removeHandler:u,clearHandlers:w,fireEvent:function(a,b){var a=n(a),c=a[q];c&&c[b]&&c[b].fireEvent()},onLoad:d,onUnload:function(a,b){t(l,"unload",a,b)}})})(basis,this);
(function(){function f(a,b,c){for(var h=1,d;b;)b&1&&(d=k[h],c&h?(a.addHandler(d.handler,d.context),d.action(d.context.add,a)):(a.removeHandler(d.handler,d.context),d.action(d.context.remove,a))),b>>=1,h<<=1}function l(a){return Array.isArray(a)?a.map(l):{data:a}}var i=basis.Class,n=basis.EventObject,m=Object.values,p=Function.$self,v=n.createEvent,t=n.event,u={},w=[],s={},o={PRIORITY:[],values_:{},add:function(a,b){var c=a.toUpperCase(),h=a.toLowerCase();this[c]=h;s[h]=true;b&&(b=this.indexOf(b),
b==-1?this.PRIORITY.push(h):this.PRIORITY.splice(b,0,h))}};o.add("READY");o.add("DEPRECATED");o.add("UNDEFINED");o.add("ERROR");o.add("PROCESSING");var k={},q=1,r={NONE:0,MASK:0,add:function(a,b,c){k[q]={handler:b,action:c,context:{add:function(c,b){if(b){var d=r[a]+"_"+c.eventObjectId;if(!b.subscribers_)b.subscribers_={};if(!b.subscribers_[d]){var e=b.subscriberCount;b.subscribers_[d]=c;b.subscriberCount+=1;b.event_subscribersChanged(b,e)}}},remove:function(c,b){if(b){var d=r[a]+"_"+c.eventObjectId;
if(b.subscribers_[d]){var e=b.subscriberCount;delete b.subscribers_[d];b.subscriberCount-=1;b.event_subscribersChanged(b,e)}}}}};r[a]=q;r.MASK|=q;q<<=1}};r.add("DELEGATE",{delegateChanged:function(a,b){this.remove(a,b);this.add(a,a.delegate)}},function(a,b){a(b,b.delegate)});r.add("TARGET",{targetChanged:function(a,b){this.remove(a,b);this.add(a,a.target)}},function(a,b){a(b,b.target)});var g=i(n,{state:o.READY,data:null,canHaveDelegate:true,delegate:null,root:null,cascadeDestroy:false,isTarget:false,
target:null,active:false,subscribeTo:r.DELEGATE+r.TARGET,subscriberCount:0,subscribers_:null,event_update:v("update","object","delta"),event_stateChanged:v("stateChanged","object","oldState"),event_delegateChanged:v("delegateChanged","object","oldDelegate"),event_rootChanged:v("rootChanged","object","oldRoot"),event_targetChanged:v("targetChanged","object","oldTarget")&&function(a,b){var c=this.listen.target;c&&(b&&b.removeHandler(c,this),this.target&&this.target.addHandler(c,this));t.targetChanged.call(this,
a,b)},event_subscribersChanged:v("subscribersChanged","object"),event_activeChanged:v("activeChanged","object"),listen:{delegate:{update:function(a,b){this.data=a.data;this.event_update(this,b)},stateChanged:function(a,b){this.state=a.state;this.event_stateChanged(this,b)},targetChanged:function(a,b){this.target=a.target;this.event_targetChanged(this,b)},rootChanged:function(a,b){this.data=a.data;this.event_rootChanged(this,b)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},
init:function(a){n.prototype.init.call(this,a);if(a=this.delegate)this.delegate=null,this.data=a.data,this.state=a.state,this.setDelegate(a);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&f(this,this.subscribeTo,r.MASK)},isConnected:function(a){if(a instanceof g){for(;a&&a!==this&&a!==a.delegate;)a=a.delegate;return a===this}return false},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},setDelegate:function(a){if(this.canHaveDelegate&&
a&&a instanceof g){if(a.delegate&&this.isConnected(a))return false}else a=null;if(this.delegate!==a){var b=this.state,c=this.data,h=this.delegate,d=this.target,j=this.root,e={};h&&h.removeHandler(this.listen.delegate,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;this.state=a.state;this.target=a.target;a.addHandler(this.listen.delegate,this);for(var k in a.data)k in c===false&&(e[k]=void 0);for(k in c)c[k]!==a.data[k]&&(e[k]=c[k])}else for(k in this.target=this.delegate=null,this.root=
this,this.data={},c)this.data[k]=c[k];this.event_delegateChanged(this,h);this.root!==j&&this.event_rootChanged(this,j);this.target!==d&&this.event_targetChanged(this,d);if(a){for(k in e){this.event_update(this,e);break}b!==this.state&&(String(b)!=this.state||b.data!==this.state.data)&&this.event_stateChanged(this,b)}return true}return false},setState:function(a,b){var c=this.target||this.getRootDelegate();if(c!==this)return c.setState(a,b);c=String(a);if(!s[c])throw Error("Wrong state value");if(this.state!=
c||this.state.data!=b){var d=this.state;this.state=Object(c);this.state.data=b;this.event_stateChanged(this,d);return true}return false},deprecate:function(){this.state!=o.PROCESSING&&this.setState(o.DEPRECATED)},update:function(a){var b=this.target||this.getRootDelegate();if(b!==this)return b.update(a);if(a){var b={},c=0,d;for(d in a)this.data[d]!==a[d]&&(c++,b[d]=this.data[d],this.data[d]=a[d]);if(c)return this.event_update(this,b),b}return false},setActive:function(a){a=!!a;return this.active!=
a?(this.active=a,this.event_activeChanged(this),f(this,this.subscribeTo,r.MASK*a),true):false},setSubscription:function(a){a&=r.MASK;var b=this.subscribeTo^a;return b?(this.subscribeTo=a,this.active&&f(this,b,a),true):false},destroy:function(){this.active&&f(this,this.subscribeTo,0);this.delegate&&this.setDelegate();n.prototype.destroy.call(this);this.data=u;this.state=o.UNDEFINED;this.target=this.root=null}}),p=i(null,{itemClass:g,keyGetter:p,map_:null,extendConstructor_:true,init:function(){this.map_=
{};basis.Cleaner.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a){var b={};a instanceof g?b.delegate=a:b.data={id:a,title:a};return new this.itemClass(b)},get:function(a,b){var c=a instanceof g?a.eventObjectId:a,d=this.map_[c];!d&&b&&(d=this.map_[c]=this.create(a,b),d.addHandler({destroy:function(){delete this.map_[c]}},this));return d},destroy:function(){basis.Cleaner.remove(this);for(var a=m(this.map_),b=0,c;c=a[b++];)c.destroy()}}),e=i(g,{state:o.UNDEFINED,
itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:v("datasetChanged","dataset","delta")&&function(a,b){var c,d=0,e=0,j;if(c=b.inserted)for(;j=c[d];)this.item_[j.eventObjectId]=j,d++;if(c=b.deleted)for(;j=c[e];)delete this.item_[j.eventObjectId],e++;this.itemCount+=d-e;this.cache_=null;t.datasetChanged.call(this,a,b)},init:function(a){g.prototype.init.call(this,a);this.memberMap_={};this.item_={}},has:function(a){return!(!a||!this.item_[a.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=
m(this.item_);return this.cache_},pick:function(){for(var a in this.item_)return this.item_[a];return null},top:function(a){var b=[];if(a)for(var c in this.item_)if(b.push(this.item_[c])>=a)break;return b},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();g.prototype.destroy.call(this);this.cache_=w;this.itemCount=0;this.item_=this.memberMap_=null}}),d=i(e,{listen:{item:{destroy:function(a){this.memberMap_[a.eventObjectId]&&
this.remove([a])}}},init:function(a){e.prototype.init.call(this,a);if(a=this.items)this.set(a),this.items=null},add:function(a){for(var b,c=this.memberMap_,d=[],e=0;e<a.length;e++){var j=a[e];if(j instanceof g){var x=j.eventObjectId;c[x]||(c[x]=j,j.addHandler(this.listen.item,this),d.push(j))}}d.length&&this.event_datasetChanged(this,b={inserted:d});return b},remove:function(a){for(var b,c=this.memberMap_,d=[],e=0;e<a.length;e++){var j=a[e];if(j instanceof g){var x=j.eventObjectId;c[x]&&(j.removeHandler(this.listen.item,
this),delete c[x],d.push(j))}}d.length&&this.event_datasetChanged(this,b={deleted:d});return b},set:function(a){if(!this.itemCount)return this.add(a);if(!a.length)return this.clear();for(var b=this.memberMap_,c={},d=[],e=[],j,x,k,z=0;z<a.length;z++)if(j=a[z],j instanceof g)x=j.eventObjectId,c[x]=j,b[x]||(b[x]=j,j.addHandler(this.listen.item,this),e.push(j));for(x in b)c[x]||(j=b[x],j.removeHandler(this.listen.item,this),delete b[x],d.push(j));var f;var a={},r;if(e&&e.length)r=a.inserted=e;if(d&&d.length)r=
a.deleted=d;r&&(f=a);(k=f)&&this.event_datasetChanged(this,k);return k},sync:function(a,b){if(a){d.setAccumulateState(true);for(var c=this.memberMap_,h,e,j={},x=[],k,z=0;z<a.length;z++)if(h=a[z],h instanceof g)e=h.eventObjectId,j[e]=h,c[e]||x.push(h);for(e in this.item_)j[e]||this.item_[e].destroy();b&&x.length&&(k=this.add(x));d.setAccumulateState(false);return k}},clear:function(){var a,b=this.getItems();if(b.length){for(a=b.length;a-- >0;)b[a].removeHandler(this.listen.item,this);this.event_datasetChanged(this,
a={deleted:b});this.memberMap_={}}return a}});d.setAccumulateState=function(){function a(a){var c=a.dataset;g.call(c,c,a)}function b(c,b){var d=c.eventObjectId,h=b.inserted,j=b.deleted,e=k[d];if(h&&j)return e&&(delete k[d],a(e)),g.call(c,c,b);if(e){var x=e[h?"inserted":"deleted"];if(x)return x.push.apply(x,h||j);else a(e)}k[d]=b;b.dataset=c}function c(){j=1;setAccumulateState(false)}var d=e.prototype,g=d.event_datasetChanged,j=0,x,k={};return function(e){if(e){if(j==0)d.event_datasetChanged=b,x=setTimeout(c,
0);j++}else if(j-=j>0,j==0)clearTimeout(x),d.event_datasetChanged=g,e=k,k={},m(e).forEach(a)}}();basis.namespace("basis.data",l).extend({STATE:o,SUBSCRIPTION:r,Object:g,DataObject:g,KeyObjectMap:p,AbstractDataset:e,Dataset:d})})(basis,this);
(function(f,l){function i(a,c,d,k){for(var c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),j=g(),x,f=0;f<c.length;f++)f%2?(x=c[f].split(/\|/),a.getters[x[0]]=d+"childNodes["+k+"]",x=x.length>1?x[1]:x[0]):x=c[f].length?c[f]:null,x!=null&&(r&&(j.lastChild&&j.appendChild(t.createComment("")),k++),j.appendChild(e(x)),k++);return j}function n(a){return function(c){if(!c||!(c.type=="click"&&c.which==3)){var d=f.dom.event.sender(c),e,j;do if(e=d.getAttributeNode&&d.getAttributeNode(a))break;while(d=d.parentNode);
if(d&&e){do if(j=d.basisObjectId)if((j=o[j])&&j.templateAction){d=e.nodeValue.qw();e=0;for(var g;g=d[e++];)j.templateAction(g,f.dom.event(c));break}while(d=d.parentNode)}}}}function m(a,c,d){c=c.trim();if(!c)return"";for(var e="",j;j=q.exec(c);){var g=j[2],k=j[4]||j[5]||g;j[3]&&(a.getters[j[3]]=d+'.getAttributeNode("'+g+'")');if(j=g.match(/^event-([a-z]+)/i)){var z=j[1];if(!s[z]){s[z]=true;j=0;for(var z=f.dom.event.browserEvents(z),r;r=z[j++];)f.dom.event.addGlobalHandler(r,n(g))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,c){var a=f.dom.event(a),b=this,d;do if(d=b.basisObjectId)if((d=o[d])&&d.templateAction){for(var b=c.qw(),h=0,e;e=b[h++];)d.templateAction(e,f.dom.event(a));break}while(b=b.parentNode)}}e+=g=="class"?k.trim().replace(/^(.)|\s+/g,".$1"):"["+g+(k?"="+k.quote('"'):"")+"]"}return e}function p(a,c){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;c||(c=".");for(var d=g(),e,j=0,x,f=a.stack;x=k.exec(a.str);){e=RegExp.leftContext;a.str=a.str.substr(e.length+x[0].length);if(e.length)d.appendChild(i(a,
e,c,j)),j=d.childNodes.length;if(x[5])if(x[5]==f[f.length-1])return f.pop(),d;else throw"Wrong end tag";if(x[6])x[7]&&(a.getters[x[7]]=c+"childNodes["+j+"]"),d.appendChild(t.createComment(x[6]));else{e=x[1];var z=x[2],r=!!x[4],q=c+"childNodes["+j+"]";x=u.createElement(e+m(a,x[3],q));z&&(a.getters[z]=q);r||(f.push(e),x.appendChild(p(a,q+".")));d.appendChild(x)}j++}a.str.length&&d.appendChild(i(a,a.str,c,j));if(f.length)throw"No end tag for "+f.reverse();return d}function v(a){if(!this.proto){a=this.source;
if(typeof a=="function")this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},c=p(a),a=Object.iterate(a.getters,function(a,b){for(var d=a.split(/\|/).map(String.format,"obj_.{0}"),e=b.split(/(\.?childNodes\[(\d+)\])/),h=c,j=0;j<e.length;j+=3){var g=e[j+2];if(!g)break;e[j+2]="";h=h.childNodes[g];h.previousSibling?h.nextSibling||(e[j+1]=".lastChild"):e[j+1]=".firstChild"}return{name:d[0],alias:d.join("="),path:"dom_"+e.join("")}}).sortAsObject("path"),d=0;d<a.length;d++)for(var e=
RegExp("^"+a[d].path.forRegExp()),j=d+1,g;g=a[j++];)g.path=g.path.replace(e,a[d].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,c){obj_=a||{};dom_=proto_.cloneNode(true);_code_();if(c&&obj_.element){var b=obj_.element.basisObjectId=map_.seed++;map_[b]=c}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(c,o);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(o)}}var t=l.document,u=f.dom,w=f.Class,s={},o={seed:1},k=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,q=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;u.createFragment();var r=u.createElement("","a","b").cloneNode(true).childNodes.length==1,g=u.createFragment,
e=u.createText,d=w(null,{__extend__:function(a){return a instanceof d?a:new d(a)},init:function(a){this.source=a},createInstance:function(a,c){v.call(this);return this.createInstance(a,c)},clearInstance:function(){v.call(this)}}),a=t.createElement("DIV");return f.namespace("basis.html").extend({Template:d,escape:function(a){return u.createElement("DIV",u.createText(a)).innerHTML},unescape:function(b){a.innerHTML=b;return a.firstChild.nodeValue},string2Html:function(b){a.innerHTML=b;return u.createFragment.apply(null,
Array.from(a.childNodes))}})})(basis,this);
(function(f){function l(a){return a.sortingValue||0}function i(a,c){a=a.sortingValue||0;c=c.sortingValue||0;return+(a>c)||-(a<c)}function n(a,c){a=a.sortingValue||0;c=c.sortingValue||0;return-(a>c)||+(a<c)}function m(a){return a.childNodes.sort(a.localSortingDesc?n:i)}function p(a,c){var b=c.length-1;a.childNodes=c;a.firstChild=c[0]||null;a.lastChild=c[b]||null;for(var d=b;b=c[d];d--)b.nextSibling=c[d+1]||null,b.previousSibling=c[d-1]||null,a.insertBefore(b,b.nextSibling)}function v(a,c){var b=a.childFactory||
a.document&&a.document.childFactory,d,c=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},c);if(b&&(d=b.call(a,c),d instanceof a.childClass))return d;if(!d)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(d&&d.constructor&&d.constructor.className)+")";}function t(){return f.ui.apply(this,arguments)}var u=f.Class,w=f.dom,s=f.data,o=s.SUBSCRIPTION,k=s.DataObject,
q=s.AbstractDataset,r=s.Dataset,g=w.AXIS_DESCENDANT,e=w.AXIS_DESCENDANT_OR_SELF,d=Function.getter,a=Object.complete,b=w.axis,s=f.EventObject.createEvent,c=f.EventObject.event;o.add("DATASOURCE",{dataSourceChanged:function(a,c){this.remove(a,c);this.add(a,a.dataSource)}},function(a,c){a(c,c.dataSource)});var h=u.ExtensibleProperty(),y={ownerChanged:function(){},destroy:function(a){w.replace(a.element,this)}},j=function(){var a=this.key,c=this.config,b=this.owner,d=typeof c.existsIf!="function"||c.existsIf(b),
e=b.satellite[a];if(d){var d="delegate"in c,h="dataSource"in c,j=typeof c.delegate=="function"?c.delegate(b):null,g=typeof c.dataSource=="function"?c.dataSource(b):null;if(e)d&&e.setDelegate(j),h&&e.setDataSource(g);else{var x=b.tmpl[c.replace||a],e={owner:b};if(d)e.delegate=j;if(h)e.dataSource=g;c.config&&Object.complete(e,typeof c.config=="function"?c.config(b):c.config);e=new c.instanceOf(e);b.satellite[a]=e;x&&e instanceof f.ui.Node&&e.element&&(w.replace(x,e.element),e.addHandler(y,x))}}else if(e)e.destroy(),
e.owner=null,delete b.satellite[a]},x=u.CustomExtendProperty({update:true},function(a,c){for(var b in c)a[b]=c[b]?j:null}),A=u(k,{event_update:function(a,c){k.prototype.event_update.call(this,a,c);var b=this.parentNode;b&&(b.matchFunction&&(this.match(),this.match(b.matchFunction)),b.insertBefore(this,this.nextSibling))},event_childNodesModified:s("childNodesModified","node","delta"),event_dataSourceChanged:s("dataSourceChanged","node","oldDataSource"),event_localGroupingChanged:s("localGroupingChanged",
"node","oldGroupingNode"),event_localSortingChanged:s("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:s("ownerChanged","node","oldOwner"),event_satellitesChanged:s("satellitesChanged","node","delta"),subscribeTo:k.prototype.subscribeTo+o.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:false,nodeType:"DOMWrapperNode",canHaveChildren:false,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:true,document:null,
parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:false,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:h,satellite:null,owner:null,init:function(a){var c=this.dataSource,b=this.childNodes,d=this.localGrouping;if(c)this.dataSource=null;k.prototype.init.call(this,a);if(d)this.localGrouping=null,this.setLocalGrouping(d);if(this.canHaveChildren)this.childNodes=[],c?(this.dataSource=null,this.setDataSource(c)):
b&&this.setChildNodes(b);else{if(b)this.childNodes=null;if(c)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==h)for(var e in this.satelliteConfig)if(a=this.satelliteConfig[e],u.isClass(a)&&(a={instanceOf:a}),typeof a=="object"){c={key:e,owner:this,config:a};a=a.hook?x.__extend__(a.hook):x;for(e in a)if(a[e]===j){this.addHandler(a,c);break}j.call(c)}if(e=this.owner)this.owner=null,this.setOwner(e)},appendChild:function(){},insertBefore:function(){},removeChild:function(){},
replaceChild:function(){},clear:function(){},hasChildNodes:function(){return this.childNodes.length>0},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||a instanceof A==false)a=null;if(this.owner!==a){var c=this.owner;c&&c.removeHandler(this.listen.owner,this);(this.owner=a)&&a.addHandler(this.listen.owner,this);this.event_ownerChanged(this,c)}},destroy:function(){k.prototype.destroy.call(this);this.dataSource?
this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var c=this.satellite[a];c.destroy();c.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),z=u(A,{autoDestroyIfEmpty:false,nodes:null,first:null,last:null,
init:function(a){this.nodes=[];A.prototype.init.call(this,a)},insert:function(a,c){var b=this.nodes,d=c?b.indexOf(c):-1;d==-1?(b.push(a),this.last=a):b.splice(d,0,a);this.first=b[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var c=this.nodes;if(c.remove(a))this.first=c[0]||null,this.last=c[c.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=
this.nodes,c=a.length;c-- >0;)a[c].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){A.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),C={canHaveChildren:true,childClass:A,childFactory:null,listen:{dataSource:{datasetChanged:function(a,c){var b={},d=[];if(c.deleted)if(b.deleted=d,this.childNodes.length==c.deleted.length){d.push.apply(d,this.childNodes);var e=this.dataSource;
this.dataSource=null;this.clear(true);this.dataSource=e;this.colMap_={}}else for(var e=0,h;h=c.deleted[e];e++){h=h.eventObjectId;var j=this.colMap_[h];delete this.colMap_[h];j.canHaveDelegate=true;this.removeChild(j);d.push(j)}if(c.inserted){b.inserted=[];for(e=0;h=c.inserted[e];e++)j=v(this,{cascadeDestroy:false,delegate:h}),j.canHaveDelegate=false,this.colMap_[h.eventObjectId]=j,b.inserted.push(j),this.firstChild&&this.insertBefore(j)}this.firstChild?this.event_childNodesModified(this,b):this.setChildNodes(b.inserted);
if(this.destroyDataSourceMember&&d.length)for(e=0;h=d[e];e++)h.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,c){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var d=this;do if(d==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(d=d.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";
a instanceof this.childClass==false&&(a=v(this,a instanceof k?{delegate:a}:a));var e=a.parentNode===this,h=a.groupNode,j=this.localGrouping,x=this.localSorting,f,y=this.childNodes,r,z,B=null,d=-1,q=false,i;if(e)i=a.nextSibling,z=a.previousSibling;if(x&&(c=null,f=this.localSortingDesc,r=x(a)||0,e))if(r===a.sortingValue)q=true;else if((!i||(f?i.sortingValue<=r:i.sortingValue>=r))&&(!z||(f?z.sortingValue>=r:z.sortingValue<=r)))a.sortingValue=r,q=true;if(j){B=j.getGroupNode(a);z=B.nodes;if(h===B&&(q||
e&&i===c))return a;x?q?d=i&&i.groupNode===B?z.indexOf(i):z.length:(d=z.binarySearchPos(r,l,f),a.sortingValue=r):d=c&&c.groupNode===B?z.indexOf(c):z.length;if(d<z.length)c=z[d];else if(B.last)c=B.last.nextSibling;else{d=B;for(c=null;d=d.nextSibling;)if(c=d.first)break}if(a===c||e&&a.nextSibling===c)return h!==B&&(h&&h.remove(a),B.insert(a)),a;d=-1}else if(x){if(q)return a;d=y.binarySearchPos(r,l,f);c=y[d];a.sortingValue=r;if(a===c||e&&i===c)return a}else{if(c&&c.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
if(e){if(i===c)return a;if(a===c)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}e?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=null,a.nextSibling=null,d==-1?y.remove(a):(f=y.indexOf(a),y.splice(f,1),f<d&&d--),h&&(h.remove(a),h=null)):a.parentNode&&a.parentNode.removeChild(a);h!=B&&B.insert(a,c);if(c){d==
-1&&(d=y.indexOf(c));if(d==-1)throw"basis.dom.wrapper: Node was not found";a.nextSibling=c;y.splice(d,0,a)}else d=y.length,y.push(a),c={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=c.previousSibling;d==0?this.firstChild=a:c.previousSibling.nextSibling=a;c.previousSibling=a;var A=false,o=false,m=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)A=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==
m)a.contextSelection=m,o=!a.selection,a.selected&&m.add([a]);a.firstChild&&(A||o)&&b(a,g).forEach(function(a){if(A&&!a.document)a.document=A;if(o&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=m});e||(a.match&&a.match(this.matchFunction),a.autoDelegateParent&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,{inserted:[a]}));return a},removeChild:function(a){if(a==null||a.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(a instanceof this.childClass==
false)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(a))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(a),1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.document===
this.document&&b(a,e).forEach(function(a){if(a.document==this.document)a.document=null},this);if(a.contextSelection){for(var c=a.contextSelection,d=a,h=[];d;){if(d.contextSelection===c)d.selected&&h.push(d),d.contextSelection=null;if(!d.selection&&d.firstChild)d=d.firstChild;else if(d.nextSibling)d=d.nextSibling;else for(;d=d.parentNode;)if(d.nextSibling){d=d.nextSibling;break}}c.remove(h)}a.groupNode&&a.groupNode.remove(a);this.dataSource||this.event_childNodesModified(this,{deleted:[a]});a.autoDelegateParent&&
a.setDelegate();return a},replaceChild:function(a,c){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(c==null||c.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,c);return this.removeChild(c)},clear:function(a){if(this.dataSource)this.setDataSource();else if(this.firstChild){var c=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:c});for(var d=
c.length;d-- >0;){var e=c[d];e.parentNode=null;e.groupNode=null;a?((e.selection||e.document)&&b(e,w.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),e.nextSibling=null,e.previousSibling=null,e.autoDelegateParent&&e.setDelegate()):e.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(d=a.length-1;c=a[d];d--)c.clear()}}},setChildNodes:function(a,
c){this.dataSource||this.clear(!!c);if(a&&("length"in a==false&&(a=[a]),a.length)){var b=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var d=0,e=a.length;d<e;d++)this.insertBefore(a[d]);this.event_childNodesModified=b;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.canHaveChildren||a instanceof q==false)a=null;if(this.dataSource!==a){var c=this.dataSource;if(c)this.colMap_=this.dataSource=null,c.removeHandler(this.listen.dataSource,
this),c.itemCount&&this.clear();if(a)this.dataSource=a,this.colMap_={},a.addHandler(this.listen.dataSource,this),a.itemCount&&this.listen.dataSource.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_dataSourceChanged(this,c)}},setLocalGrouping:function(a){if(typeof a=="function"||typeof a=="string")a={groupGetter:d(a)};a instanceof F==false&&(a=a!=null&&typeof a=="object"?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var c=this.localGrouping,b;if(this.localGrouping){if(!a&&
(this.localGrouping=null,this.firstChild)){b=this.localSorting?m(this):this.childNodes;for(var e=b.length;e-- >0;)b[e].groupNode=null;p(this,b)}c.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){b=this.localSorting?m(this):this.childNodes;for(e=0;a=b[e];e++)a.groupNode=this.localGrouping.getGroupNode(a);for(e=0;a=b[e];e++)a.groupNode.nodes.push(a);b.length=0;for(e=this.localGrouping.nullGroup;e;e=e.nextSibling)a=e.nodes,e.first=a[0]||null,e.last=a[a.length-1]||null,b.push.apply(b,
a),e.event_childNodesModified(e,{inserted:a});p(this,b)}this.event_localGroupingChanged(this,c)}},setLocalSorting:function(a,c){a&&(a=d(a));if(this.localSorting!=a||this.localSortingDesc!=!!c){var b=this.localSorting,e=this.localSortingDesc;this.localSortingDesc=!!c;this.localSorting=a||null;if(a&&this.firstChild){var h=[],j;for(j=this.firstChild;j;j=j.nextSibling)j.sortingValue=a(j)||0;if(this.localGrouping)for(var g=this.localGrouping.nullGroup;g;g=g.nextSibling)j=g.nodes=m({childNodes:g.nodes,
localSortingDesc:this.localSortingDesc}),g.first=j[0]||null,g.last=j[j.length-1]||null,h.push.apply(h,j);else h=m(this);p(this,h)}this.event_localSortingChanged(this,b,e)}},setMatchFunction:function(a){if(this.matchFunction!=a){var c=this.matchFunction;this.matchFunction=a;for(var b=this.lastChild;b;b=b.previousSibling)b.match(a);this.event_matchFunctionChanged(this,c)}}},o=u(A,{event_enable:s("enable","node"),event_disable:s("disable","node"),event_select:s("select","node"),event_unselect:s("unselect",
"node"),event_match:s("match","node"),event_unmatch:s("unmatch","node"),event_matchFunctionChanged:s("matchFunctionChanged","node","oldMatchFunction"),selectable:true,selected:false,selection:null,contextSelection:null,matchFunction:null,matched:true,disabled:false,init:function(a){if(this.selection&&this.selection instanceof q==false)this.selection=new B(this.selection);A.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=false,this.select(true)},setSelection:function(a){if(this.selection==
a)return false;var c=this.selection;b(this,g,function(b){if(b.contextSelection==c)b.selected&&c&&c.remove([b]),b.contextSelection=a});this.selection=a;return true},hasOwnSelection:function(){return!!this.selection},select:function(a){var c=this.selected,b=this.contextSelection;if(b)a?c?b.remove([this]):b.add([this]):this.selectable&&b.set([this]);else if(!c&&this.selectable&&!this.isDisabled())this.selected=true,this.event_select(this);return this.selected!=c},unselect:function(){var a=this.selected;
if(a){var c=this.contextSelection;c?c.remove([this]):(this.selected=false,this.event_unselect(this))}return this.selected!=a},enable:function(){if(this.disabled)this.disabled=false,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=true,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!w.findAncestor(this,d("disabled"))},match:function(a){if(typeof a!="function")if(this.matched){if(this.underMatch_)this.underMatch_(this,
true),this.underMatch_=null}else this.matched=true,this.event_match(this);else if(a(this)){if(this.underMatch_=a,!this.matched)this.matched=true,this.event_match(this)}else if(this.underMatch_=null,this.matched)this.matched=false,this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();A.prototype.destroy.call(this)}}),E=u(o,C,{}),F=u(A,C,{event_childNodesModified:function(a,b){c.childNodesModified.call(this,
a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var d=this.owner,e=Array.from(this.nullGroup.nodes),h=e.length;h-- >0;)d.insertBefore(e[h],e[h].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,true);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);c.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:true,
autoDestroyEmptyGroups:true,titleGetter:d("data.title"),groupGetter:Function.$undef,childClass:z,childFactory:function(c){return new this.childClass(a(c,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?false:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new z({autoDestroyIfEmpty:false});A.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),c=a instanceof k,b=this.map_[c?a.eventObjectId:a];!b&&!this.dataSource&&(b=this.appendChild(c?
{delegate:a}:{data:{id:a,title:a}}));return b||this.nullGroup},insertBefore:function(a,c){a=C.insertBefore.call(this,a,c);if("groupId_"in a==false)a.groupId_=a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=a;if(a.first){var b=this.owner,d=b.childNodes,e=a.first,h=a.last,j,g,x;for(j=a;j=j.previousSibling;)if(x=j.last)break;if(!x)x=this.nullGroup.last;for(j=a;j=j.nextSibling;)if(g=j.first)break;if(e.previousSibling!==x||h.nextSibling!==g){if(e.previousSibling)e.previousSibling.nextSibling=
h.nextSibling;if(h.nextSibling)h.nextSibling.previousSibling=e.previousSibling;j=d.splice(d.indexOf(e),a.nodes.length);var k=d.indexOf(g);j.unshift(k!=-1?k:d.length,0);d.splice.apply(d,j);e.previousSibling=x;h.nextSibling=g;if(x)x.nextSibling=e;if(g)g.previousSibling=h;b.firstChild=d[0];b.lastChild=d[d.length-1]}}return a},removeChild:function(a){C.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){C.clear.call(this);this.map_={}},destroy:function(){this.setOwner();A.prototype.destroy.call(this);
this.map_=null}});A.prototype.localGroupingClass=F;var s=u(q,{autoDestroy:true,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,c){var b=this.memberMap_,d={},e=0,h=0,j=c.inserted,g=c.deleted;if(j&&j.length)for(d.inserted=j;a=j[e];)b[a.eventObjectId]=a,e++;if(g&&g.length)for(d.deleted=g;a=g[h];)delete b[a.eventObjectId],h++;(e||h)&&this.event_datasetChanged(this,d)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:s("sourceNodeChanged")&&
function(a,b){c.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:false,init:function(a,c){q.prototype.init.call(this,c);a&&this.setSourceNode(a)},setSourceNode:function(a){a instanceof A==false&&(a=null);if(a!==this.sourceNode){var c=this.sourceNode;c&&(c.removeHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,c,{deleted:c.childNodes}));a&&(a.addHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,
a,{inserted:a.childNodes}));this.sourceNode=a;this.event_sourceNodeChanged(this,c)}},destroy:function(){this.setSourceNode();q.prototype.destroy.call(this)}}),B=u(r,{multiple:false,event_datasetChanged:function(a,c){r.prototype.event_datasetChanged.call(this,a,c);if(c.inserted)for(var b=0,d;d=c.inserted[b];b++)if(!d.selected)d.selected=true,d.event_select();if(c.deleted)for(b=0;d=c.deleted[b];b++)if(d.selected)d.selected=false,d.event_unselect()},add:function(a){if(!this.multiple)if(this.itemCount)return this.set(a);
else a.splice(1);for(var c=[],b=0,d;d=a[b];b++)d.contextSelection==this&&d.selectable&&c.push(d);return r.prototype.add.call(this,c)},set:function(a){for(var c=[],b=0,d;d=a[b];b++)d.contextSelection==this&&d.selectable&&c.push(d);this.multiple||a.splice(1);return r.prototype.set.call(this,c)}});f.namespace("basis.dom.wrapper",t).extend({AbstractNode:A,InteractiveNode:o,Node:E,GroupingNode:F,PartitionNode:z,simpleTemplate:t,ChildNodesDataset:s,Selection:B})})(basis);
(function(f,l){function i(a,c){return p(c,true).getRule(a,true)}function n(a,c){var b=a.match(/^([^{]+)\{(.*)\}\s*$/);if(b){for(var d=b[1].trim().split(/\s*,\s*/),e=0;e<d.length;e++)this.addRule(d[e],b[2]||null,c++);return c-1}}function m(a,c){var b=g.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:c?"alternate ":"",url:a.quote('"')}));g.tag(null,"HEAD")[0].appendChild(b);b=b.sheet||b.styleSheet;try{if(!b.cssRules)b.cssRules=b.rules}catch(d){}if(!b.insertRule)b.insertRule=
n;if(!b.deleteRule)b.deleteRule=b.removeRule;return b}function p(a,c){a||(a="DefaultGenericStyleSheet");h[a]||c&&(h[a]=new x(m()));return h[a]}function v(a,c,b,d){for(var d=d||{},c=c.qw(),e=0,h;h=c[e];e++)if(typeof j.style[h]!="undefined"){b&&(f.platformFeature["css-"+a]=h);y[a]={key:h,getter:d[h]};break}}function t(a,c){var b=y[a];if(a=b?b.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:b&&b.getter?b.getter(c):c}}function u(a,c,b){if(typeof a.setProperty=="function")return a.setProperty(c,
b);if(c=t(c,b))return a.style[c.key]=c.value}function w(a,c){for(var b in c)u(a,b,c[b]);return a}function s(a,c){return u(a,"display",typeof c=="string"?c:c?"":"none")}function o(a,c){return u(a,"visibility",c?"":"hidden")}function k(a){return F[a]||(F[a]=RegExp("\\s*\\b"+a+"\\b"))}function q(a,c){var b=(c?"g":"s")+a;return D[b]||(D[b]=RegExp((c?"":"\\s*")+"\\b"+a+".*\\b"))}var r=l.document,g=f.dom,e=f.dom.event,d=f.Class,a=/\s*!important/i,b=String("important"),c=1,h={},y={},j=g.createElement("DIV");
v("opacity","opacity MozOpacity KhtmlOpacity filter",true,{fitler:function(a){return"alpha(opacity:"+parseInt(a*100)+")"}});v("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",true);v("float","cssFloat styleFloat");var x=d(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,c){if(!this.map_[a]&&c){for(var b=this.styleSheet,d=this.rules.length,e=b.insertRule(a+"{}",d),h=d;h<=e;h++)this.rules.push(new A(b.cssRules[h]));this.map_[a]=
d!=e?new z(this.rules.splice(d)):this.rules[d]}return this.map_[a]},deleteRule:function(a){var c=this.map_[a];if(c){for(var c=c.rules||[c],b=0;b<c.length;b++){var d=this.rules.indexOf(c[b]);this.stylesheet.deleteRule(d);this.rules.splice(d,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),A=d(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(c,d){var e,h=!!a.test(d),j=this.rule.style;if(h||j.getPropertyPriority&&j.getPropertyPriority(c)==
b){if(d=d.replace(a,""),e=t(c,d)){var g=e.key;j.setProperty?(h||j.removeProperty(g),j.setProperty(g,e.value,h?b:"")):j.cssText=j.cssText.replace(RegExp(j[g]?g+"\\s*:\\s*"+j[g]+"(\\s*!"+b+")?\\s*;?":"^","i"),g+": "+e.value+(h?" !"+b:"")+";")}}else u(this.rule,c,d)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),z=d(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});
["setProperty","setStyle","clear"].forEach(function(a){z.prototype[a]=function(){for(var c,b=0;c=this.rules[b];b++)c[a].apply(c,arguments)}});var C={};["em","ex","px","%"].forEach(function(a){C[a=="%"?"percent":a]=function(c){return c==0||isNaN(c)?"0":c+a}});var E,F={},B=d(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,c,b){b=b||"";typeof a!="undefined"&&this.remove(b+a);typeof c!=
"undefined"&&this.add(b+c)},bool:function(a,c){c?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(k(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(k(a))||(this.element.className+=" "+a)},remove:function(a){var c=this.element.className,a=c.replace(k(a),"");if(a!=c)this.element.className=a},toggle:function(a){var c=this.contains(a);c?this.remove(a):this.add(a);
return!c}}),D={},I=d(null,{delim:"-",init:function(a,c){this.classList=c;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(q(this.prefix,true))},set:function(a){var c=this.items(),a=typeof a!="undefined"?this.prefix+a:"",b=this.classList;if(c)if(c.length==1){if(c[0]===a)return;b.remove(c[0])}else this.clear();a&&b.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});l.DOMTokenList&&r.documentElement.classList?(d=B.prototype,Object.extend(l.DOMTokenList.prototype,{set:d.set,replace:d.replace,bool:d.bool,clear:function(){for(var a=this.length;a-- >0;)this.remove(this[a])},setPrefixToken:d.setPrefixToken}),E=function(a){return(typeof a=="string"?g.get(a):a).classList}):E=function(a){return new B(typeof a=="string"?g.get(a):a)};e.onLoad(function(){E(r.body).bool("opacity-not-support",!f.platformFeature["css-opacity"])});g.extend({setStyleProperty:u,
setStyle:w,display:s,show:function(a){return s(a,1)},hide:function(a){return s(a)},visibility:o,visible:function(a){return o(a,1)},invisible:function(a){return o(a)}});return f.namespace("basis.cssom").extend({setStyleProperty:u,setStyle:w,classList:function(a,c){return c?new I(c,E(a)):E(a)},uniqueRule:function(a){var b="genericRule-"+c++;a&&E(a).add(b);a=i("."+b);a.token=b;return a},cssRule:i,getStyleSheet:p,addStyleSheet:m,CssStyleSheetWrapper:x,CssRuleWrapper:A,CssRuleWrapperSet:z}).extend(C)})(basis,
this);
(function(f){function l(e){return!(e%400&&(!(e%100)||e%4))}function i(e,d){return e==1?28+l(d):v[e]}function n(e,d){return d.replace(q,function(a,b){return o[b](e)})}function m(e,d,a,b,c,h,g){return new Date(e,d-1,a,b||0,c||0,h||0,g||0)}var p=Function.getter,v=[31,28,31,30,31,30,31,31,30,31,30,31],t={day:864E5,hour:36E5,minute:6E4,second:1E3},u="year month day hour minute second millisecond".qw(),w={},s={};Object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",
millisecond:"Milliseconds"},function(e,d){w[e]=p("get"+d+"()");s[e]=new Function("d,v","d.set"+d+"(v)")});var o={y:p("getFullYear().toString().substr(2)"),Y:p("getFullYear()"),d:p("getDate()"),D:p("getDate()","{0:02}"),m:p("getMonth() + 1"),M:p("getMonth() + 1","{0:02}"),h:p("getHours()"),H:p("getHours()","{0:02}"),i:p("getHours() % 12 || 12","{0:02}"),p:p("getHours() > 12",{"true":"pm","false":"am"}),P:p("getHours() > 12",{"true":"PM","false":"AM"}),I:p("getMinutes()","{0:02}"),s:p("getSeconds()"),
S:p("getSeconds()","{0:02}"),z:p("getMilliseconds()"),Z:p("getMilliseconds()","{0:03}")},k=/^(\d{1,4})-(\d\d?)-(\d\d?)(?:[T ](\d\d?):(\d\d?):(\d\d?)(?:\.(\d{1,3}))?)?$/,q=/%([ymdhiszp])/ig;Object.extend(Date.prototype,{isLeapYear:function(){return l(this.getFullYear())},getMonthDayCount:function(){return i(this.getMonth(),this.getFullYear())},add:function(e,d){var a=w[e];if(!a)throw Error("Unknown date part: "+e);var b;if(e=="year"||e=="month")b=this.getDate(),b>28&&this.setDate(1);s[e](this,a(this)+
d);b>28&&(a=this.getMonthDayCount(),b>a&&this.setDate(a));return this},diff:function(e,d){if(e=="year"||e=="month"){var a=Number(this)-Number(d)>0?-1:1,b=a>0?this:d,c=a>0?d:this,h=b.getFullYear(),h=c.getFullYear()-h;if(e=="year")return a*h;b=b.getMonth();c=c.getMonth();return a*(h?(h>1?(h-1)*12:0)+(11-b)+(c+1):c-b)}else return a=Math.floor((d-this)/t[e]),a+Number(w[e](new Date(d-a*t[e]))-w[e](this)!=0)},set:function(e,d){var a=s[e];if(!a)throw Error("Unknown date part: "+e);var b;if(e=="year"||e==
"month")b=this.getDate(),b>28&&this.setDate(1);a(this,d);b>28&&(a=this.getMonthDayCount(),b>a&&this.setDate(a));return this},get:function(e){if(w[e])return w[e](this);throw Error("Unknown date part: "+e);},toISODateString:function(){return n(this,"%Y-%M-%D")},toISOTimeString:function(){return n(this,"%H:%I:%S.%Z")},fromDate:function(e){e instanceof Date&&(this.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),this.setTime(e.getTime()));return this},toFormat:function(e){return n(this,e)}});var r=
Date.prototype.toISOString;if(r&&(new Date).toISOString().match(/Z/i))Date.prototype.toISOString=function(){return r.call(this).replace(/Z/i,"")};Object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()},fromISOString:function(e){var d=String(e).match(k);if(!d)throw Error("Value of date isn't in ISO format: "+e);d[2]-=1;for(var e=0,a;a=u[e];e++)this.set(a,d[e+1]||0);return this}});Object.extend(Date.prototype,{toODBCDate:Date.prototype.toISODateString,
toODBCTime:Date.prototype.toISOTimeString,toODBC:Date.prototype.toISOString,fromODBC:Date.prototype.fromISOString});var g=/\D/;Date.fromISOString=function(e){return e?m.apply(null,String(e).split(g)):null};Date.timer=function(e){var d=e||new Date;d.measure=function(a){return a?((new Date-d)/1E3).toFixed(3):new Date-d};return d};f.namespace("basis.date").extend({isLeapYear:l,getMonthDayCount:i,format:n})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.html.Template,m=f.cssom.classList,p=Function.getter,v=f.Cleaner,t=f.dom.wrapper.Node,u=f.dom.wrapper.PartitionNode,w=f.dom.wrapper.GroupingNode,s=l.ExtensibleProperty(),o=function(k){return{template:new n("<div/>"),action:s,cssClassName:null,event_update:function(f,g){k.event_update.call(this,f,g);this.templateUpdate(this.tmpl,"update",g)},event_select:function(f){k.event_select.call(this,f);m(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(f){k.event_unselect.call(this,f);m(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(f){k.event_disable.call(this,f);m(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(f){k.event_enable.call(this,f);m(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(f){k.event_match.call(this,f);i.display(this.element,true)},event_unmatch:function(f){k.event_unmatch.call(this,f);i.display(this.element,
false)},init:function(f){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&i.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=i.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;k.init.call(this,f);if(this.id)this.element.id=
this.id;if(f=this.cssClassName){typeof f=="string"&&(f={element:f});for(var g in f){var e=this.tmpl[g];if(e)for(var e=m(e),d=String(f[g]).qw(),a=0,b;b=d[a++];)e.add(b)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&i.insert(this.container,this.element)},templateAction:function(k,g){var e=this.action[k];e&&e.call(this,g)},templateUpdate:function(){},destroy:function(){var f=this.element;k.destroy.call(this);f&&f.parentNode&&f.parentNode.removeChild(f);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},t=l(t,o,{}),p=l(u,o,{titleGetter:p("data.title"),templateUpdate:function(k){if(k.titleText)k.titleText.nodeValue=String(this.titleGetter(this))}}),o=function(k){return{insertBefore:function(f,g){var f=k.insertBefore.call(this,f,g),e=f.groupNode||this,d=f.nextSibling,e=e.childNodesElement||e.element||this.childNodesElement||this.element,a=f.element,d=(d&&d.element.parentNode==e?d.element:null)||e.insertPoint||null;(a.parentNode!==e||a.nextSibling!==
d)&&e.insertBefore(a,d);return f},removeChild:function(f){k.removeChild.call(this,f);var g=f.element,e=g.parentNode;e&&e.removeChild(g);return f},clear:function(f){if(f)for(var g=this.firstChild;g;){var e=g.element;e.parentNode&&e.parentNode.removeChild(e);g=g.nextSibling}k.clear.call(this,f)},setChildNodes:function(f,g){var e=i.createFragment(),d=this.localGrouping||this,a=d.childNodesElement||d.element;d.childNodesElement=e;k.setChildNodes.call(this,f,g);a.insertBefore(e,a.insertPoint||null);d.childNodesElement=
a}}},u=l(w,o,{childClass:p,localGroupingClass:l.SELF,event_ownerChanged:function(k,f){var g=this,e=this.owner,d=null;e&&(d=e.tmpl&&e.tmpl.groupsElement||e.childNodesElement||e.element,d.appendChild(this.nullElement));do g.element=g.childNodesElement=d;while(g=g.localGrouping);w.prototype.event_ownerChanged.call(this,k,f)},init:function(k){this.element=this.childNodesElement=this.nullElement=i.createFragment();w.prototype.init.call(this,k)}}),k=l(t,o,{childClass:t,childFactory:function(k){return new this.childClass(k)},
localGroupingClass:u}),l=l(k,{selection:{},init:function(f){this.document=this;k.prototype.init.call(this,f);v.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;k.prototype.destroy.call(this);v.remove(this)}}),o=function(k,f){for(var g=k.match(/\{(this_[^\}]+)\}/g)||[],e=[],d=0;d<g.length;d++){var a=g[d].match(/\{(this_[^\|\}]+)\}/)[1];e.push("this.tmpl."+a+".nodeValue = "+a.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(c,d,e){a.templateUpdate.call(this,c,d,e);_code_()}},config_)}.toString().replace("_code_()",e.join(";\n")))(new n(k),f)};f.namespace("basis.ui",o).extend({simpleTemplate:o,Node:t,Container:k,PartitionNode:p,GroupingNode:u,Control:l})})(basis);
(function(f,l){function i(a,c){if(j)try{return parseFloat(v.getComputedStyle(a,null)[c])}catch(b){return 0}else return 0}function n(a,c){return j?i(a,"height"):(o.setStyle(c,{borderTop:a.currentStyle.borderTopWidth+" solid red",borderBottom:a.currentStyle.borderBottomWidth+" solid red",paddingTop:a.currentStyle.paddingTop,paddingBottom:a.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"}),a.offsetHeight-c.offsetHeight)}function m(a,c){if(y)k(a).add("Basis-Layout-OnResizeElement"),
a.onresize=c;else{var b=u.createElement({description:"IFRAME.Basis-Layout-OnResizeFrame",css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});u.insert(a,b);b.onload=function(){(b.contentWindow.onresize=c)()}}}for(var p=l.document,v=p.defaultView,t=f.Class,u=f.dom,w=f.ua,s=Object.extend,o=f.cssom,k=f.cssom.classList,q=f.ui.Container,r=w.test("IE"),g=w.test("IE7+"),e=false,d=u.createElement(""),a=["","-webkit-"],b=0;b<a.length;b++)try{var c=a[b]+"box";
d.style.display=c;if(d.style.display==c){e=a[b];break}}catch(h){}var y=typeof d.onresize!="undefined",j=v&&v.getComputedStyle,d=function(){return u.createElement({css:{position:"absolute",top:0,left:0,width:0,height:0,padding:0,margin:0,border:0}})};d.className="basis.Layout.Helper";var x={top:Number.NaN,left:Number.NaN,bottom:Number.NaN,right:Number.NaN,width:Number.NaN,height:Number.NaN,defined:false},A=t(null,{init:function(a,c,b){this.reset();this.setElement(a,c,b)},setElement:function(a,c,b){this.element=
u.get(a);this.offsetElement=b;c||this.recalc(this.offsetElement)},copy:function(a){"top,left,bottom,right,height,width,defined".split(",").forEach(function(c){this[c]=a[c]},this)},reset:function(){s(this,x)},set:function(a,c){if(this.defined){switch(a.toLowerCase()){case "left":this.left=c;this.right=this.left+this.width;break;case "right":this.right=c;this.left=this.right-this.width;break;case "width":this.width=c;this.right=this.left+this.width;break;case "top":this.top=c;this.bottom=this.top+this.height;
break;case "bottom":this.bottom=c;this.top=this.bottom-this.height;break;case "height":this.height=c,this.bottom=this.top+this.height}(this.width<=0||this.height<=0)&&this.reset()}return this},recalc:function(a){this.reset();var c=this.element;if(c){var b=c,d=p.documentElement;if(c.getBoundingClientRect)b=c.getBoundingClientRect(),this.top=b.top,this.left=b.left,r&&(g?(this.top+=d.scrollTop-d.clientTop,this.left+=d.scrollLeft-d.clientLeft):c!=p.body&&(this.top-=p.body.clientTop-p.body.scrollTop,this.left-=
p.body.clientLeft-p.body.scrollLeft)),a&&(a=new A(a),this.top-=a.top,this.left-=a.left,a.destroy());else if(p.getBoxObjectFor){var e=p.getBoxObjectFor(d),b=p.getBoxObjectFor(c);this.top=b.screenY-e.screenY;this.left=b.screenX-e.screenX;if(w.test("FF1.5-")){if(b=c.offsetParent)this.top-=b.scrollTop,this.left-=b.scrollLeft;b!=p.body&&(this.top+=d.scrollTop,this.left+=d.scrollLeft)}if(w.test("FF2+")){if(this.top&&(b=d.scrollTop,b>2)){for(var e=0,h=Math.floor(Math.log(b)/Math.LN2);h>=0;h-=3)e+=1<<h;b>
e&&(this.top-=1)}this.left&&(this.left-=d.scrollLeft>1)}a&&(a=new A(a),this.top-=a.top,this.left-=a.left,a.destroy())}else if(c!=a){this.top=c.offsetTop;this.left=c.offsetLeft;this.top-=p.body.clientTop-p.body.scrollTop;for(this.left-=p.body.clientLeft-p.body.scrollLeft;(b=b.offsetParent)&&b!=a;)this.top+=b.offsetTop+b.clientTop-b.scrollTop,this.left+=b.offsetLeft+b.clientLeft-b.scrollLeft}else this.top=this.left=0;this.width=c.offsetWidth;this.height=c.offsetHeight;this.bottom=this.top+this.height;
this.right=this.left+this.width;this.defined=true}return this.defined},intersection:function(a){if(!this.defined)return false;a instanceof A==false&&(a=new A(a));return a.defined&&a.right>this.left&&a.left<this.right&&a.bottom>this.top&&a.top<this.bottom},inside:function(a){if(!this.defined)return false;a instanceof A==false&&(a=new A(a));return a.defined&&a.left>=this.left&&a.right<=this.right&&a.bottom>=this.bottom&&a.top<=this.top},point:function(a){if(!this.defined)return false;var c=a.left||
a.x||0,a=a.top||a.y||0;return c>=this.left&&c<this.right&&a>=this.top&&a<this.bottom},power:function(a){if(!this.defined)return false;if(a=u.get(a)||this.element)return u.setStyle(a,{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px"}),true},destroy:function(){delete this.element}}),a=t(A,{init:function(a,c,b){this.setBoxes(a,c,b)},setBoxes:function(a,c,b){this.boxA=a instanceof A?a:new A(a,true);this.boxB=c instanceof A?c:new A(c,true);b||this.recalc()},recalc:function(){this.reset();
if(!this.boxA.recalc()||!this.boxB.recalc())return false;if(this.boxA.intersection(this.boxB))this.top=Math.max(this.boxA.top,this.boxB.top),this.left=Math.max(this.boxA.left,this.boxB.left),this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom),this.right=Math.min(this.boxA.right,this.boxB.right),this.width=this.right-this.left,this.height=this.bottom-this.top,this.width<=0||this.height<=0?this.reset():this.defined=true;return this.defined}}),b=t(A,{recalc:function(){this.reset();var a=this.element;
if(a){var c=a;this.width=a.clientWidth;this.height=a.clientHeight;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();this.top=b.top;for(this.left=b.left;c=c.offsetParent;)this.top-=c.scrollTop,this.left-=c.scrollLeft}else if(p.getBoxObjectFor){b=p.getBoxObjectFor(a);this.top=b.y;for(this.left=b.x;c=c.offsetParent;)this.top-=c.scrollTop,this.left-=c.scrollLeft}else b=new A(a),this.top=b.top+a.clientTop,this.left=b.left+a.clientLeft;this.bottom=this.top+this.height;this.right=this.left+this.width;
this.defined=true}return this.defined}});o.cssRule(".Basis-VerticalPanel").setStyle({position:"relative"});c=o.cssRule(".Basis-VerticalPanelStack");c.setStyle({overflow:"hidden"});e!==false&&(c.setProperty("display",e+"box"),c.setProperty(e+"box-orient","vertical"));c=t(q,{template:'<div class="Basis-VerticalPanel"/>',flex:0,init:function(a){q.prototype.init.call(this,a);this.flex?e!==false&&o.setStyleProperty(this.element,e+"box-flex",this.flex):e===false&&m(this.element,function(){this.parentNode&&
this.parentNode.realign()}.bind(this))}});t=t(q,{childClass:c,template:'<div class="Basis-VerticalPanelStack">'+(e?"":'<div{ruller} style="position: absolute; visibility: hidden; top: -1000px; width: 10px;"/>')+"</div>",init:function(a){this.cssRule=o.uniqueRule();this.ruleClassName=this.cssRule.token;this.cssRule.setProperty("overflow","auto");q.prototype.init.call(this,a);e===false&&(this.realign(),m(this.childNodesElement,function(){this.realign()}.bind(this)))},insertBefore:function(a,c){if(a=
q.prototype.insertBefore.call(this,a,c))return a.flex&&this.cssRule&&k(a.element).add(this.ruleClassName),this.realign(),a},removeChild:function(a){if(q.prototype.removeChild.call(this,a))return a.flex&&this.cssRule&&k(a.element).remove(this.ruleClassName),this.realign(),a},realign:function(){if(e===false){var a=this.element,c=this.lastChild.element,b=this.tmpl.ruller,d=(new A(c,false,a)).bottom-i(a,"paddingTop")-i(a,"borderTopWidth")||0,a=n(a,b);if(j)d+=i(c,"marginBottom");else{var h=b.offsetHeight;
b.style.height=c.currentStyle.marginBottom;d+=b.offsetHeight-h}if(d=a-d){for(a=c=0;h=this.childNodes[a];a++)h.flex&&(c++,d+=n(h.element,b));c&&this.cssRule.setProperty("height",Math.max(0,d/c)+"px")}}}});f.namespace("basis.layout").extend({Box:A,Intersection:a,Viewport:b,VerticalPanel:c,VerticalPanelStack:t,Helper:d,addBlockResizeHandler:m})})(basis,this);
(function(f){var l=f.Class,i=f.dom.event,n=f.dom,m=Function.getter,p=f.cssom.classList,v=i.addGlobalHandler,t=i.removeGlobalHandler,u=f.EventObject,w=u.createEvent,s=f.layout,o=f.ua,k=f.ua.is("IE9-"),q,r={start:function(e){q&&r.over();q={dde:this,run:false,event:{initX:i.mouseX(e),initY:i.mouseY(e),deltaX:0,deltaY:0}};v("mousemove",r.move,q);v("mouseup",r.over,q);v("mousedown",r.over,q);i.cancelDefault(e);this.event_prepare(q.event)},move:function(e){var d=q.dde;if(!q.run)q.run=true,d.draging=true,
d.event_start(q.event);if(d.axisX)q.event.deltaX=d.axisXproxy(i.mouseX(e)-q.event.initX);if(d.axisY)q.event.deltaY=d.axisYproxy(i.mouseY(e)-q.event.initY);d.event_move(q.event)},over:function(e){var d=q.dde;t("mousemove",r.move,q);t("mouseup",r.over,q);t("mousedown",r.over,q);d.draging=false;q.run&&d.event_over(q.event);q=null;i.kill(e)}},g=l(u,{containerGetter:m("element"),element:null,trigger:null,baseElement:null,fixTop:true,fixRight:true,fixBottom:true,fixLeft:true,axisX:true,axisY:true,axisXproxy:Function.$self,
axisYproxy:Function.$self,event_prepare:w("prepare"),event_start:w("start"),event_move:w("move"),event_over:w("over"),init:function(e){u.prototype.init.call(this,e);var e=this.element,d=this.trigger;this.trigger=this.element=null;this.setElement(e,d);this.setBase(this.baseElement);f.Cleaner.add(this)},setElement:function(e,d){e=e&&n.get(e);d=d&&n.get(d)||e;if(this.trigger!=d&&(this.trigger&&(i.removeHandler(this.trigger,"mousedown",r.start,this),k&&i.removeHandler(this.trigger,"selectstart",r.start,
this)),this.trigger=d))i.addHandler(this.trigger,"mousedown",r.start,this),k&&i.addHandler(this.trigger,"selectstart",r.start,this);if(this.element!=e)this.element&&p(this.element).remove("Basis-Dragable"),(this.element=e)&&p(this.element).add("Basis-Dragable")},setBase:function(e){this.baseElement=n.get(e)||(o.is("IE7-")?document.body:document.documentElement)},isDraging:function(){return!!(q&&q.dde==this)},start:function(e){this.isDraging()||r.start.call(this,e)},stop:function(){this.isDraging()&&
r.over()},destroy:function(){f.Cleaner.remove(this);this.stop();u.prototype.destroy.call(this);this.setElement();this.setBase()}}),l=l(g,{event_start:function(e){var d=this.containerGetter(this,e.initX,e.initY);if(d){var a=new s.Box(d),b=new s.Viewport(this.baseElement);p(d).add("Basis-DragDrop-DragElement");e.element=d;e.box=a;e.viewport=b}g.prototype.event_start.call(this,e)},event_move:function(e){if(e.element){if(this.axisX){var d=e.box.left+e.deltaX;this.fixLeft&&d<0?d=0:this.fixRight&&d+e.box.width>
e.viewport.width&&(d=e.viewport.width-e.box.width);e.element.style.left=d+"px"}if(this.axisY)d=e.box.top+e.deltaY,this.fixTop&&d<0?d=0:this.fixBottom&&d+e.box.height>e.viewport.height&&(d=e.viewport.height-e.box.height),e.element.style.top=d+"px";g.prototype.event_move.call(this,e)}},event_over:function(e){e.element&&(p(e.element).remove("Basis-DragDrop-DragElement"),g.prototype.event_over.call(this,e))}});f.namespace("basis.dragdrop").extend({DragDropElement:g,MoveableElement:l})})(basis);
(function(){function f(a){if(a instanceof g)return a.set;a=a.nodeType;if(isNaN(a)==false)return a==1?r:"nodeValue"}var l=basis.Class,i=basis.dom,n=basis.Cleaner,m=Function.getter,p=basis.cssom.classList,v=basis.EventObject,t=basis.TimeEventManager,u=v.createEvent,w=basis.data,s=w.DataObject,o=w.STATE,k=l(s,{event_change:u("change"),locked:false,lockValue_:null,extendConstructor_:false,updateCount:0,init:function(a,b,c){s.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy=typeof c=="function"?
c:Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,b){var c=this.value,d=this.proxy?this.proxy(a):d,e=false;if(d!==c)this.value=d,e=true,this.updateCount+=1;!this.locked&&(e||b)&&this.event_change(d,c);return e},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=true},unlock:function(){if(this.locked)this.locked=false,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,b){return this.set(a,b)},reset:function(){this.set(this.initValue)},
destroy:function(){s.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),q={destroy:function(a){this.removeLink(a)}},r=function(a){i.insert(i.clear(this),a)},g=l(k,{links_:null,event_change:function(a,b){k.prototype.event_change.call(this,a,b);if(this.links_.length&&!n.globalDestroy)for(var c=0,d;d=this.links_[c++];)this.power_(d,b)},init:function(a,b,c){k.prototype.init.call(this,a,b,c);this.links_=[];n.add(this)},addLink:function(a,b,
c){if(typeof a!="object"&&a instanceof Object==false)throw Error("basis.data.property: Link to undefined object ignored");b==null&&(b=f(a));typeof c!="function"&&(c=m(Function.$self,c));b={object:a,format:c,field:b,isEventObject:a instanceof v};this.links_.push(b);b.isEventObject&&a.addHandler(q,this);this.power_(b);return a},addLinkShortcut:function(a,b,c){return this.addLink(a,g.shortcut[b],c)},removeLink:function(a,b){if(this.links_!=null){var c=arguments.length<2;!c&&b==null&&(b=f(a));for(var d=
0,e=0,j;j=this.links_[e];e++)j.object===a&&(c||b==j.field)?j.isEventObject&&j.object.removeHandler(q,this):this.links_[d++]=j;this.links_.length=d}},clear:function(){for(var a=0,b;b=this.links_[a];a++)b.isEventObject&&b.object.removeHandler(q,this);this.links_.clear()},power_:function(a,b){var c=a.field;if(c!=null){var d=a.format(this.value),e=a.object;typeof c=="function"?c.call(e,d,arguments.length<2?d:a.format(b)):e[c]=d}},destroy:function(){this.clear();k.prototype.destroy.call(this);this.links_=
null;n.remove(this)}});g.shortcut={className:function(a,b){p(this).replace(b,a)},show:function(a){i.display(this,!!a)},hide:function(a){i.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var e=o.PRIORITY,d={stateChanged:function(){this.fire(false,true)},update:function(){this.fire(true)},change:function(){this.fire(true)},destroy:function(a){this.remove(a)}},l=l(g,{calculateValue:function(){return this.value+1},objects:[],timer_:null,valueChanged_:false,
stateChanged_:true,state:o.UNDEFINED,extendConstructor_:true,init:function(){var a=this.handler;delete this.handler;g.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();n.add(this)},add:function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a];if(c instanceof s)this.objects.add(c)&&c.addHandler(d,
this);else throw Error("basis.data.property: Instance of DataObject required");}this.fire(true,true)},remove:function(a){this.objects.remove(a)&&a.removeHandler(d,this);this.fire(true,true)},clear:function(){for(var a=0,b;b=this.objects[a];a++)b.removeHandler(d,this);this.objects.clear();this.fire(true,true)},fire:function(a,b){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=
true,t.add(this,"update",Date.now())},lock:function(){this.locked=true},unlock:function(){this.locked=false},update:function(){delete this.timer_;t.remove(this,"update");if(!n.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var a=this.objects.length;if(a){for(var b=-2,c,d=0;d<a;d++){var g=this.objects[d],j=e.indexOf(String(g.state));j>b&&(c=g,b=j)}c&&this.setState(c.state,c.state.data)}else this.setState(o.UNDEFINED)}this.stateChanged_=this.valueChanged_=false},
destroy:function(){this.lock();this.clear();t.remove(this,"update");g.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:l,AbstractProperty:k,Property:g,PropertySet:l})})();
(function(f){function l(f,i){var l=Date.now()-f;return l>=i?1:l/i}var i=f.Class,n=f.dom,m=f.data.property.Property,p=f.EventObject.createEvent,v=i(m,{duration:1E3,interval:50,startTime:0,timer:null,started:false,event_start:p("start"),event_finish:p("finish"),event_invert:p("invert"),event_change:function(f,i){f==0&&this.event_start();m.prototype.event_change.call(this,f,i);f==1&&this.event_finish()},extendConstructor_:true,init:function(f){this.run=this.run.bind(this);m.prototype.init.call(this,
f)},start:function(f){this.started?f&&this.invert():(this.startTime=Date.now(),this.started=true,this.run())},run:function(){clearTimeout(this.timer);if(this.started){var f=l(this.startTime,this.duration);f>=1?this.stop():(this.set(f),this.timer=setTimeout(this.run,this.interval))}},invert:function(){this.event_invert();if(this.started){var f=l(this.startTime,this.duration);this.startTime=Date.now()-this.duration*(1-f);this.run()}},stop:function(){clearTimeout(this.timer);if(this.started)this.started=
false,this.set(1)},destroy:function(){this.stop();this.clear();m.prototype.destroy.call()}}),t=i(null,{thread:null,setter:Function.$null,notRevert:false,timeFunction:Function.$self,init:function(f,i,l,o,k){this.thread=f instanceof v?f:new v(f);this.setRange(l,o);this.setter=i;this.notInvert=k;this.thread.addHandler({start:function(){},invert:function(){this.start+=this.range;this.range*=-1},change:function(k){this.setter(this.start+this.range*this.timeFunction(k))},finish:function(){this.notInvert||
(this.start+=this.range,this.range*=-1)},destroy:this.destroy},this)},setRange:function(f,i){this.start=f;this.range=i-f},destroy:function(){delete this.thread}});f.namespace("basis.animation").extend({Thread:v,Modificator:t,FX:{CSS:{FadeIn:function(f,i){return new t(f,function(f){n.setStyle(i,{opacity:f})},0,1)},FadeOut:function(f,i){return new t(f,function(f){n.setStyle(i,{opacity:f})},1,0)}}}})})(basis);
(function(f){function l(a,d,e){return e?b?a.createElementNS(e,d):a.createNode(1,d,e):a.createElement(d)}function i(a,d,e,j){a=e?b?a.createAttributeNS(e,d):a.createNode(2,d,e):a.createAttribute(d);a.nodeValue=j;return a}function n(a,b){return a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b)}function m(a,b,e){n(a,i(a.ownerDocument,d.PREFIX+(b?":"+b:""),d.NAMESPACE,e))}function p(a,b){return a.createTextNode(String(b))}function v(a,b){var d=a.nodeType,j=a.attributes,g=a.firstChild;
if(g){if(g.nodeType!=o&&g===a.lastChild)return g.nodeValue}else{var k=j&&j[0];if(d==o){if(!k)return"";if(j.length==1&&(k.baseName||k.localName)==e&&k.namespaceURI==r)return null}else if(!k)return null}var d={},k=[],f=0,i,l,q;if(g){do f=k.push(g);while(g=g.nextSibling)}if(j)for(g=0;q=j[g];g++)k.push(q);b||(b={});for(var g=0,B;B=k[g];g++){j=B.nodeName;i=g<f;q=b[j];if(i)i=v(B,b);else{if(j=="xmlns")continue;i=B.nodeValue}for(;q;)if(q.storeName&&(i[q.storeName]=j),q.rename)j=q.rename,q=b[j];else{q.format&&
(i=q.format(i));!d[j]&&q.forceArray&&(i=[i]);break}j in d?(l=d[j])&&l.push?l.push(i):d[j]=[l,i]:d[j]=i}return d}function t(a,b,g,j){if(String(b).charAt(0)=="@")return j==null?j:i(a,b.substr(1),"",String(j));else{b=l(a,b.toString(),j&&j.xmlns||b.namespace||g);if(typeof j=="undefined"||j===null)n(b,i(a,e,r,"true"));else if(typeof j=="string"||typeof j=="number"||typeof j=="function"||typeof j=="boolean"||j.constructor===Date||j.constructor===RegExp)b.appendChild(p(a,j));else{g=j.xmlns||g;j.xmlns&&d.BAD_SUPPORT&&
m(b,"",g);for(var f in j){var q=j[f];if(!(f=="xmlns"||typeof q=="function"))if(q&&Array.isArray(q))for(var o=0;o<q.length;o++)b.appendChild(t(a,f,g,q[o]));else q&&typeof q=="object"&&q.toString!==Object.prototype.toString&&(q=q.toString()),(q=t(a,f,g,q))&&(q.nodeType==k?n(b,q):b.appendChild(q))}}return b}}var u=f.dom,w=f.Class,s=f.ua,o=u.ELEMENT_NODE,k=u.ATTRIBUTE_NODE,w=w(null,{init:function(a,b,d){this.localpart=a;this.namespace=b||"";this.prefix=d||""},toString:function(){return this.prefix?this.prefix+
":"+this.localpart:this.localpart}}),q=String("http://www.w3.org/2001/XMLSchema"),r=String("http://www.w3.org/2001/XMLSchema-instance"),g=String("http://www.w3.org/2000/xmlns/"),e="nil",d={PREFIX:"xmlns",NAMESPACE:g,BAD_SUPPORT:s.test("webkit528.16-")||s.test("opera9-")},a="native",b=true,s=function(){var c=document.implementation;if(c&&c.createDocument)return function(a,b){var d=c.createDocument(a,b,null);if(d.charset&&d.charset!=document.charset)d.charset=document.charset;return d};if(window.ActiveXObject)for(var d=
["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"],e=0;e<d.length;e++)try{if(new ActiveXObject(d[e]))return a=d[e],b=false,function(c,b){var d=new ActiveXObject(a);d.documentElement=l(d,b,c);return d}}catch(j){}throw Error("Browser doesn't support for XML document!");}();f.namespace("basis.xml").extend({NAMESPACE:{XMLShema:q,XMLShemaInstance:r,Namespace:g},XMLNS:d,QName:w,getElementsByTagNameNS:function(a,b,d){if(a.getElementsByTagNameNS)return a.getElementsByTagNameNS(d,b);var e=[];a.ownerDocument.setProperty("SelectionNamespaces",
'xmlns:x="'+d+'"');for(var a=a.selectNodes("//x:"+b),b=0,g;g=a[b++];)g.namespaceURI==d&&e.push(g);return e},addNamespace:m,createDocument:s,createElementNS:l,createAttributeNS:i,setAttributeNodeNS:n,createText:p,createCDATA:function(a,b){return a.createCDATASection(b)},XML2Object:v,XML2String:function(a){if(typeof XMLSerializer!="undefined")return(new XMLSerializer).serializeToString(a);if(typeof a.xml=="string")return a.xml;if(a.nodeType==u.DOCUMENT_NODE)a=a.documentElement;return u.outerHTML(a)},
Object2XML:t})})(basis);
(function(f){function l(k,f){return k<<f|k>>>32-f}function i(k){var f=[];do f.push((k&15).toString(16)),k>>=4;while(k);f.length&1&&f.push("0");return f.reverse().join("")}function n(k){if(typeof k=="number")return i(k);var f=[],f=Array.isArray(k)?k.map(n):String(k).toArray().map(function(f){return i(f.charCodeAt(0))});return f.join("")}f.namespace("basis.crypt",function(f){s=f||"";return o});var m=Array.create(255,function(f){return String.fromCharCode(f)}),p=function(){function k(f){for(var g="",
e=f.length,d=0;d<e;d++){var a=f.charCodeAt(d);g+=a<128?m[a]:a<2048?m[a>>6|192]+m[a&63|128]:m[a>>12|224]+m[a>>6&63|128]+m[a&63|128]}return g}function i(f){for(var g="",e=f.length,d,a,b,c=0;c<e;)d=f.charCodeAt(c++),d<128?g+=m[d]:(a=f.charCodeAt(c++),d&32?(b=f.charCodeAt(c++),g+=String.fromCharCode((d&15)<<12|(a&63)<<6|b&63)):g+=String.fromCharCode((d&31)<<6|a&63));return g}return f.namespace("basis.crypt.UTF16").extend({toBytes:function(f){for(var g=[],e=f.length,d=0;d<e;d++){var a=f.charCodeAt(d);
g.push(a&255,a>>8)}return g},fromBytes:function(f){for(var g="",e=f.length,d,a,b=0;b<e;)d=f[b++]||0,a=f[b++]||0,g+=String.fromCharCode(a<<8|d);return g},toUTF8:k,fromUTF8:i,toUTF8Bytes:function(f){return v.toBytes(k(f))},fromUTF8Bytes:function(f){return i(v.fromBytes(f))}})}(),v=function(){return f.namespace("basis.crypt.UTF8").extend({toBytes:function(f){for(var i=f.length,r=Array(i),g=0;g<i;g++)r[g]=f.charCodeAt(g);return r},fromBytes:function(f){for(var i=f.length,r="",g=0;g<i;g++)r+=m[f[g]];return r},
toUTF16:function(f){return p.fromUTF8(f)},fromUTF16:function(f){return p.toUTF8(f)},toUTF16Bytes:function(f){return p.toBytes(p.fromUTF8(f))},fromUTF16Bytes:function(f){return p.toUTF8(p.fromBytes(f))}})}(),t=function(){var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".toArray(),i={};k.forEach(function(f,g){i[f]=g});return f.namespace("basis.crypt.Base64").extend({encode:function(f,g){f.constructor!=Array&&(f=g?p.toUTF8Bytes(f):p.toBytes(f));for(var e=f.length,d=0,a="",b,c,
h,i,j,x;d<e;)b=f[d++],c=f[d++],h=f[d++],i=b>>2,b=(b&3)<<4|c>>4,j=(c&15)<<2|h>>6,x=h&63,c==void 0?j=x=64:h==void 0&&(x=64),a+=k[i]+k[b]+k[j]+k[x];return a},decode:function(f,g){for(var e=[],d,a,b,c,h,k=0,f=f.replace(/[^a-z0-9\+\/]/ig,""),j=f.length;k<j;)d=i[f.charAt(k++)],a=i[f.charAt(k++)],c=i[f.charAt(k++)],h=i[f.charAt(k++)],d=d<<2|a>>4,a=(a&15)<<4|c>>2,b=(c&3)<<6|h,e.push(d,a,b);(c==null||c==64)&&e.pop();(h==null||h==64)&&e.pop();return g?p.fromUTF8Bytes(e):p.fromBytes(e)}})}(),u=function(){function f(g){for(var e=
[],d=3;d>=0;d--)e.push(g>>d*8&255);return e}var i=[1518500249,1859775393,2400959708,3395469782],o=[function(g,e,d){return d^g&(e^d)},function(g,e,d){return g^e^d},function(g,e,d){return g&e|d&(g|e)},function(g,e,d){return e^g^d}];return function(g,e){g.constructor!=Array&&(g=e?p.toUTF8Bytes(g):p.toBytes(g));for(var d=g.length,a=[],b=0;b<d;b++)a[b>>2]|=g[b]<<(3-(b&3)<<3);d&3?a[d>>2]|=Math.pow(2,(4-(d&3)<<3)-1):a[d>>2]=2147483648;a.push.apply(a,Array.create(((a.length&15)>14?30:14)-(a.length&15),0));
a.push(d>>>29);a.push(d<<3&4294967295);a.reverse();for(var d=[1732584193,4023233417,2562383102,271733878,3285377520],c=Array.from(d),h,y=a.length>>4,j=Array(80);y--;){for(b=0;b<16;b++)j[b]=a.pop();for(b=16;b<80;b++)j[b]=l(j[b-3]^j[b-8]^j[b-14]^j[b-16],1);for(b=0;b<80;b++)h=Math.floor(b/20),d[4]=l(d[0],5)+o[h](d[1],d[2],d[3])+d[4]+j[b]+i[h]&4294967295,d[1]=l(d[1],30),d.unshift(d.pop());for(b=0;b<5;b++)d[b]=c[b]=d[b]+c[b]&4294967295}return d.map(f).flatten()}}(),w=function(){function f(a){for(var c=
arguments,d=c.length,e=a&65535,j=a>>16,g=1;g<d;g++){var k=c[g];e+=k&65535;j+=(k>>16)+(e>>16);e&=65535}return j<<16|e&65535}function i(a){for(var c=[],d=0;d<4;d++)c.push(a>>d*8&255);return c}var o=Math.pow(2,32),g,e=[],d=[],a=[function(a,c,d){return d^a&(c^d)},function(a,c,d){return c^d&(c^a)},function(a,c,d){return a^c^d},function(a,c,d){return c^(a|~d)}];return function(b,c){if(!g){g=[[7,12,17,22].repeat(4),[5,9,14,20].repeat(4),[4,11,16,23].repeat(4),[6,10,15,21].repeat(4)].flatten();for(var h=
0;h<64;h++)switch(e[h]=Math.floor(Math.abs(Math.sin(h+1))*o),h>>4){case 0:d[h]=h;break;case 1:d[h]=h*5+1&15;break;case 2:d[h]=h*3+5&15;break;case 3:d[h]=h*7&15}}b.constructor!=Array&&(b=c?p.toUTF8Bytes(b):p.toBytes(b));for(var h=[],y=b.length,j=0;j<y;j++)h[j>>2]|=b[j]<<((j&3)<<3);h[y>>2]|=128<<((y&3)<<3);h.push.apply(h,Array(((h.length&15)>14?30:14)-(h.length&15)));h.push(y<<3&4294967295);h.push(y>>>29);for(var y=[1732584193,4023233417,2562383102,271733878],x=Array.from(y),m=h.length>>4;m--;){for(j=
0;j<64;j++)y[0]=f(l(f(y[0],a[j>>4](y[1],y[2],y[3]),h[d[j]],e[j]),g[j]),y[1]),y.unshift(y.pop());for(j=0;j<4;j++)y[j]=x[j]=f(y[j],x[j])}return y.map(i).flatten()}}(),s="",o={};Object.iterate({sha1:function(f){return u(this,f)},sha1hex:function(f){return n(u(this,f))},md5:function(f){return w(this,f)},md5hex:function(f){return n(w(this,f))},base64:function(f){return t.encode(this,f)},base64decode:function(f){return t.encode(this,f)},hex:function(){return n(this)}},function(f,i){o[f]=function(f){f=i.call(s,
f);return s=Object.extend(typeof f!="object"?Object(f):f,o)}});f.namespace("basis.crypt").extend({HEX:n,SHA1:u,MD5:w})})(basis);
(function(){function f(e,d){var a={},b;if(e&&e.length)b=a.inserted=e;if(d&&d.length)b=a.deleted=d;if(b)return a}var l=basis.Class,i=Object.extend,n=Function.$self,m=Function.$true,p=Function.$false,v=basis.EventObject.createEvent,t=basis.data.SUBSCRIPTION,u=basis.data.DataObject,w=basis.data.KeyObjectMap,s=basis.data.AbstractDataset,o=basis.data.Dataset;t.add("SOURCE",{sourceChanged:function(e,d){this.remove(e,d);this.add(e,e.source)},sourcesChanged:function(e,d){var a;if(a=d.inserted)for(var b=a.length;b-- >
0;)this.add(e,a[b]);if(a=d.deleted)for(b=a.length;b-- >0;)this.remove(e,a[b])}},function(e,d){for(var a=d.sources||[d.source],b=0,c;c=a[b++];)e(d,c)});t.add("MINUEND",{operandsChanged:function(e,d){this.minuend!==d&&(this.remove(e,d),this.add(e,e.minuend))}},function(e,d){e(d,d.minuend)});t.add("SUBTRAHEND",{operandsChanged:function(e,d,a){this.subtrahend!==a&&(this.remove(e,a),this.add(e,e.subtrahend))}},function(e,d){e(d,d.subtrahend)});var k=l(s,{subscribeTo:t.SOURCE,event_sourcesChanged:v("sourcesChanged",
"dataset","delta"),sources:null,rule:function(e){return e>0},listen:{source:{datasetChanged:function(e,d){var a=this.memberMap_,b={},c,h;if(d.inserted)for(var g=0;c=d.inserted[g];g++)h=c.eventObjectId,a[h]?a[h].count++:a[h]={count:1,object:c},b[h]=a[h];if(d.deleted)for(g=0;c=d.deleted[g];g++)h=c.eventObjectId,b[h]=a[h],a[h].count--;this.applyRule(b)},destroy:function(e){this.removeSource(e)}}},init:function(e){s.prototype.init.call(this,e);e=this.sources;this.sources=[];e&&e.forEach(this.addSource,
this)},setRule:function(e){if(typeof e!="function")e=k.UNION;if(this.rule!==e)this.rule=e,this.applyRule()},applyRule:function(e){var d=this.memberMap_,a=this.rule,b=this.sources.length,c=[],h=[],g,j,k;e||(e=d);for(var i in e)g=d[i],j=b&&g.count&&a(g.count,b),j!=!!this.item_[i]&&(j?c:h).push(g.object),g.count==0&&delete d[i];(k=f(c,h))&&this.event_datasetChanged(this,k)},addSource:function(e){if(e instanceof s&&this.sources.add(e)){e.addHandler(this.listen.source,this);var d=this.memberMap_,a;for(a in e.item_)d[a]?
d[a].count++:d[a]={count:1,object:e.item_[a]};this.applyRule();this.event_sourcesChanged(this,{inserted:[e]});return true}},removeSource:function(e){if(this.sources.remove(e)){e.removeHandler(this.listen.source,this);var d=this.memberMap_,a;for(a in e.item_)d[a].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[e]});return true}},setSources:function(e){for(var d=Array.from(this.sources),a=0,b;b=e[a];a++)b instanceof s&&(d.remove(b)||this.addSource(b));d.forEach(this.removeSource,this)},
clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){s.prototype.destroy.call(this);this.sources=null}});k.UNION=k.prototype.rule;k.INTERSECTION=function(e,d){return e==d};k.DIFFERENCE=function(e){return e==1};k.MORE_THAN_ONE_INCLUDE=function(e,d){return d==1||e>1};k.AT_LEAST_ONE_EXCLUDE=function(e,d){return d==1||e<d};var q=function(e){return!this.has(e)},r=l(s,{subscribeTo:t.MINUEND+t.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:v("operandsChanged",
"dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(e,d){if(this.subtrahend){var a=f(d.inserted&&d.inserted.filter(q,this.subtrahend),d.deleted&&d.deleted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(e,d){if(this.minuend){var a=f(d.deleted&&d.deleted.filter(q,this),d.inserted&&d.inserted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(this.minuend,
null)}}},init:function(e){s.prototype.init.call(this,e);var e=this.minuend,d=this.subtrahend;this.subtrahend=this.minuend=null;(e||d)&&this.setOperands(e,d)},setOperands:function(e,d){var a,b=false;e instanceof s==false&&(e=null);d instanceof s==false&&(d=null);var c=this.minuend,h=this.subtrahend;if(c!==e)b=true,c&&c.removeHandler(this.listen.minuend,this),(this.minuend=e)&&e.addHandler(this.listen.minuend,this);if(h!==d)b=true,h&&h.removeHandler(this.listen.subtrahend,this),(this.subtrahend=d)&&
d.addHandler(this.listen.subtrahend,this);if(!b)return false;this.event_operandsChanged(this,c,h);if(!e||!d)this.itemCount&&this.event_datasetChanged(this,a={deleted:this.getItems()});else{var b=[],c=[],g;for(g in this.item_)(!e.item_[g]||d.item_[g])&&b.push(this.item_[g]);for(g in e.item_)!this.item_[g]&&!d.item_[g]&&c.push(e.item_[g]);(a=f(c,b))&&this.event_datasetChanged(this,a)}return a},clear:function(){this.setOperands()}}),g=l(s,{subscribeTo:t.SOURCE,source:null,event_sourceChanged:v("sourceChanged",
"dataset","oldSource"),map:n,reduce:p,rule:p,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:{update:function(e){var d=this.map?this.map(e):e;if(d instanceof u==false||this.reduce(d))d=null;var a=this.sourceMap_[e.eventObjectId],b=a.member;if(b!=d){var c=this.memberMap_,h,g,j;a.member=d;if(b)a=b.eventObjectId,this.removeMemberRef&&this.removeMemberRef(b,e),--c[a]==0&&(delete c[a],j=[b]);if(d)b=d.eventObjectId,this.addMemberRef&&this.addMemberRef(d,e),c[b]?c[b]++:(c[b]=
1,g=[d]);(h=f(g,j))&&this.event_datasetChanged(this,h)}}},source:{datasetChanged:function(e,d){var a=this.sourceMap_,b=this.memberMap_,c=[],h=[],g,j,k;o.setAccumulateState(true);if(d.inserted)for(var i=0;g=d.inserted[i];i++){k=this.map?this.map(g):g;if(k instanceof u==false||this.reduce(k))k=null;g.addHandler(this.listen.sourceObject,this);a[g.eventObjectId]={sourceObject:g,member:k};if(k)j=k.eventObjectId,b[j]?b[j]++:(b[j]=1,c.push(k)),this.addMemberRef&&this.addMemberRef(k,g)}if(d.deleted)for(i=
0;g=d.deleted[i];i++)if(j=g.eventObjectId,k=a[j].member,g.removeHandler(this.listen.sourceObject,this),delete a[j],k)j=k.eventObjectId,--b[j]==0&&(delete b[j],h.push(k)),this.removeMemberRef&&this.removeMemberRef(k,g);o.setAccumulateState(false);(d=f(c,h))&&this.event_datasetChanged(this,d)},destroy:function(){this.setSource()}}},init:function(e){s.prototype.init.call(this,e);this.sourceMap_={};if(e=this.source)this.source=null,this.setSource(e)},setRule:function(e){typeof e!="function"&&(e=m);if(this.rule!==
e)return this.rule=e,this.applyRule()},setMap:function(e){typeof e!="function"&&(e=n);if(this.map!==e)return this.map=e,this.applyRule()},setSource:function(e){e instanceof s==false&&(e=null);if(this.source!==e){var d=this.source;d&&(d.removeHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,d,{deleted:d.getItems()}));if(this.source=e)e.addHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,e,{inserted:e.getItems()});this.event_sourceChanged(this,
d)}},applyRule:function(){var e=this.sourceMap_,d=this.memberMap_,a,b,c,h,g,j=[],k=[],i,o;for(o in e){g=e[o];h=g.sourceObject;a=g.member;b=this.map?this.map(h):h;if(b instanceof u==false||this.reduce(b))b=null;if(a!=b){g.member=b;if(a)c=a.eventObjectId,this.removeMemberRef&&this.removeMemberRef(a,h),d[c]--;if(b)a=b.eventObjectId,this.addMemberRef&&this.addMemberRef(b,h),a in d?d[a]++:(d[a]=1,j.push(b))}}for(c in this.item_)d[c]==0&&(delete d[c],k.push(this.item_[c]));(i=f(j,k))&&this.event_datasetChanged(this,
i);return i},clear:function(){this.setSource()},destroy:function(){s.prototype.destroy.call(this);this.sourceMap_=null}}),p=l(g,{reduce:function(e){return!this.rule(e)},rule:m}),l=l(g,{map:function(e){return this.keyMap.resolve(e)},rule:m,subsetClass:s,keyMap:null,addMemberRef:function(e,d){e.event_datasetChanged(e,{inserted:[d]})},removeMemberRef:function(e,d){e.event_datasetChanged(e,{deleted:[d]})},init:function(e){if(!this.keyMap||this.keyMap instanceof w==false)this.keyMap=new w(i({keyGetter:this.rule,
itemClass:this.subsetClass},this.keyMap));g.prototype.init.call(this,e)},getSubset:function(e,d){return this.keyMap.get(e,d)},destroy:function(){g.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:k,Subtract:r,MapReduce:g,Subset:p,Split:l})})(basis,this);
(function(f){function l(a,c){if(!a.length)return 0;var b,d,e=0,h=a.length-1;do if(b=e+h>>1,d=a[b]||0,c<d)h=b-1;else if(c>d)e=b+1;else return c==d?b:0;while(e<=h);return b+(d<c)}function i(a,c){if(!a.length)return 0;var b,d,e,h=0,g=a.length-1;do if(b=h+g>>1,e=a[b].value||0,e===d?(e=a[b].object.eventObjectId,d=c.object.eventObjectId):d=c.value||0,d<e)g=b-1;else if(d>e)h=b+1;else return d==e?b:0;while(h<=g);return b+(e<d)}function n(){for(var a=Object.slice(this.item_),c=this.index_.slice(this.offset,
this.offset+this.limit),b=[],d,e=0,h;h=c[e];e++){var g=h.object.eventObjectId;a[g]?delete a[g]:b.push(h.object)}(d=getDelta(b,values(a)))&&o.prototype.event_datasetChanged.call(this,this,d)}function m(a,c){var a=Function.getter(a),b=c+"_"+a.getterIdx_,d=r[b];if(!d)d=r[b]=this,this.indexType=c,this.indexClass=q[c],this.getter=a,this.key=b,this.createInstance=function(a){if(a instanceof o){var c=a.indexes&&a.indexes[this.key];if(!c)c=new this.indexClass(this.getter),c.addHandler(y,a),c.key=this.key;
return c}};return d}function p(a,c,b){var d=a.indexCache_;a.lock();if(c)for(var e=0,h;h=c[e++];){var g=a.valueGetter(h);d[h.eventObjectId]=g;a.add(h,g)}if(b)for(e=0;h=b[e++];)a.remove(h,d[h.eventObjectId]),delete d[h.eventObjectId];a.unlock()}var v=f.Class,t=f.TimeEventManager,u=f.data,w=u.KeyObjectMap,s=u.property.Property,o=u.AbstractDataset,k=u.dataset.MapReduce,u=v(o,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(a,c){var b;if(b=c.inserted)for(var d=0;d<
b.length;d++){var e=b[d],e={value:this.valueGetter(e),object:e},h=i(this.index_,e);this.index_.splice(h,0,e)}if(b=c.deleted)for(d=0;d<b.length;d++)e=b[d],e={value:this.valueGetter(e),object:e},h=i(this.index_,e),this.index_.splice(h,1);n.call(this)},init:function(a){this.index_=[];o.prototype.init.call(this,a)},setRange:function(a,c){this.offset=a;this.limit=c;n.call(this)}}),q=v(s,{autoDestroy:true,valueGetter:Function.$null,dataSource:null,init:function(a){s.prototype.init.call(this,this.value||
0);this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},upd:function(){}});q.Sum=v(q,{add:function(a,c){this.value+=c},remove:function(a,c){this.value-=c},upd:function(a,c,b){this.set(this.value+c-b)}});q.Avg=v(q,{sum_:0,count_:0,add:function(a,c){this.sum_+=c;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,c){this.sum_-=c;this.count_-=1;this.value=this.count_?this.sum_/this.count_:0},upd:function(a,c,b){this.sum_+=c-b;this.set(this.sum_/this.count_)}});
q.Count=v(q,{valueGetter:Function.$true,add:function(a,c){c&&(this.value+=1)},remove:function(a,c){c&&(this.value-=1)},upd:function(a,c){this.set(this.value+(c?1:-1))}});q.Max=v(q,{init:function(a,c){this.stack=[];q.prototype.init.call(this,a,c)},add:function(a,c){this.stack.splice(l(this.stack,c),0,c);this.value=this.stack[this.stack.length-1]},remove:function(a,c){this.stack.remove(c);this.value=this.stack[this.stack.length-1]},upd:function(a,c,b){this.stack.splice(l(this.stack,b),1);this.stack.splice(l(this.stack,
c),0,c);this.set(this.stack[this.stack.length-1])}});q.Min=v(q,{init:function(a,c){this.stack=[];q.prototype.init.call(this,a,c)},add:function(a,c){this.stack.splice(l(this.stack,c),0,c);this.value=this.stack[0]},remove:function(a,c){this.stack.remove(c);this.value=this.stack[0]},upd:function(a,c,b){this.stack.splice(l(this.stack,b),1);this.stack.splice(l(this.stack,c),0,c);this.set(this.stack[0])}});var r={},g=function(a){return function(c){return new m(c,a)}},e=g("Sum"),d=g("Avg"),a=g("Count"),
b=g("Min"),g=g("Max"),c={update:function(a){var c,b,d,e=a.eventObjectId,h;for(h in this.indexes)d=this.indexes[h],c=d.indexCache_[e],b=d.valueGetter(a),b!==c&&(d.upd(a,b,c),d.indexCache_[e]=b)}},h={datasetChanged:function(a,b){if(b.inserted)for(var d=0;a=b.inserted[d++];)a.addHandler(c,this);if(b.deleted)for(d=0;a=b.deleted[d++];)a.removeHandler(c,this);for(var e in this.indexes)p(this.indexes[e],b.inserted,b.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},y={destroy:function(a){this.removeIndex(a)}};
o.prototype.createIndex=function(a){if(a instanceof m!=false){if(!this.indexes)this.indexes={},this.addHandler(h),h.datasetChanged.call(this,this,{inserted:this.getItems()});var c=a.key;this.indexes[c]||(a=a.createInstance(this),this.indexes[c]=a,p(a,this.getItems()));return this.indexes[c]}};o.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var c in this.indexes)return;this.removeHandler(h);delete this.indexes}};v=v(k,{calcs:null,
indexes:null,indexes_:null,timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,c){k.prototype.event_sourceChanged.call(this,a,c);var b,d;for(d in this.indexes_)b=this.indexes_[d],c&&(this.removeIndex(d),c.removeIndex(this.indexes[d])),this.source&&this.addIndex(d,this.source.createIndex(b))},listen:{sourceObject:{update:function(a,c){k.prototype.listen.sourceObject.update.call(this,a,c);this.sourceMap_[a.eventObjectId].updated=true;this.fireUpdate()}},index:{change:function(a){var c=
this.indexMap;c.indexValues[this.key]=a;c.indexUpdated=true;c.fireUpdate()}},member:{subscribersChanged:function(a,c){a.subscriberCount>0&&c==0&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,true)},addMemberRef:function(a,c){this.memberSourceMap[a.eventObjectId]=c.eventObjectId;a.addHandler(this.listen.member,this);this.sourceMap_[c.eventObjectId].updated=true;a.subscriberCount>0&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];a.removeHandler(this.listen.member,
this)},init:function(a){this.indexUpdated=false;this.indexesBind_={};this.memberSourceMap={};var c=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||this.keyMap instanceof w==false)this.keyMap=new w(Object.complete({create:function(a,c){return new this.itemClass(c)}},this.keyMap));k.prototype.init.call(this,a);Object.iterate(c,this.addIndex,this)},addIndex:function(a,c){if(!this.indexes[a]){if(c instanceof m)if(this.indexes_[a])return;else this.indexes_[a]=
c,c=this.source&&this.source.createIndex(c);if(c instanceof q)this.indexValues[a]=c.value,this.indexes[a]=c,this.indexesBind_[a]={key:a,indexMap:this},c.addHandler(this.listen.index,this.indexesBind_[a]),this.listen.index.change.call(this.indexesBind_[a],c.value)}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},
addCalc:function(a,c){this.calcs[a]=c;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=true,t.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=false},calcMember:function(a){var c=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(c.updated||this.indexUpdated)){c.updated=false;var b={},d,e,h;for(h in this.calcs)if(d=this.calcs[h](c.sourceObject.data,this.indexValues),a.data[h]!==d&&(!isNaN(d)||!isNaN(a.data[h])))b[h]=d,e=true;e&&a.update(b)}},getMember:function(a){return this.keyMap.get(a,true)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);k.prototype.destroy.call(this)}});
f.namespace("basis.data.index").extend({IndexedDataset:u,IndexConstructor:m,Index:q,Sum:e,Avg:d,Count:a,Max:g,Min:b,IndexMap:v})})(basis);
(function(f){function l(a){j[a]=j[a]||0;return a+j[a]++}function i(){var a=Array.from(arguments),c=a.pop();typeof c!="function"&&console.warn("Last argument for calculate field constructor must be a function");for(var b=[],d=[],e=0,h;e<a.length;e++)h=a[e].quote('"'),b.push(h+" in delta"),d.push("data["+h+"]");c=(new Function("calc","return function(delta, data, oldValue){"+(b.length?"if ("+b.join(" || ")+")":"")+"return calc("+d.join(", ")+");"+(b.length?"return oldValue;":"")+"}"))(c);c.args=a;c.isCalcField=
true;return c}function n(){return i.apply(null,Array.from(arguments).concat(function(){for(var a=[],c=arguments.length;c-- >0;){if(arguments[c]==null)return null;a.push(arguments[c])}return a.join("-")}))}var m=f.Class,p=f.Cleaner,v=Object.extend,t=Function.$self,u=Function.getter,w=f.data,s=f.EventObject,o=w.Dataset,k=w.dataset.Subset,q=w.dataset.Split,r=w.DataObject,g=w.STATE,e={},d={string:1,number:1},a=[],b=function(a){return isNaN(a)?null:Number(a)},c=function(a){return isNaN(a)?null:Number(a)},
h=function(a){return isNaN(a)?null:parseInt(a)},y=function(a){return a==null?null:String(a)},j={},x=f.Class(null,{init:function(a){var c=this.index={};this.normalize=a;this.valueWrapper=function(b,d){var e=a(b,d);return e!==d&&c[e]?d:e};this.calcWrapper=function(b,d){var e=a(b,d);if(e!==d&&c[e])throw"Duplicate value for index "+d+" => "+b;return e};p.add(this)},get:function(a,c){var b=this.index[a];if(b&&(!c||b instanceof c))return b},add:function(a,c){var b=this.index[a];if(c&&(!b||b===c))return this.index[a]=
c,true},remove:function(a,c){if(this.index[a]===c)return delete this.index[a],true},destroy:function(){this.index=null}}),w=function(a,c){return function(b){return a.prototype[c].call(this,b&&b.map(this.wrapper))}},A=function(a,c){return function(b){if(!this.name)this.name=l(c);a.prototype.init.call(this,b)}},z=function(a){return function(c,b){o.setAccumulateState(true);c=(c||[]).map(this.wrapper);o.setAccumulateState(false);return a.prototype.sync.call(this,c,b)}},C=m(o,{wrapper:Function.$self,init:A(o,
"EntitySet"),sync:z(o),set:w(o,"set"),add:w(o,"add"),remove:w(o,"remove"),destroy:function(){o.prototype.destroy.call(this);delete this.wrapper}}),E=m(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),F=m(k,{init:A(k,"EntityCollection"),sync:z(k)});F.sourceHandler=k.sourceHandler;var B=m(q,{subsetClass:E,init:A(q,"EntityGrouping"),sync:z(q),getSubset:function(a,c){var b=q.prototype.getSubset.call(this,a,c);if(b)b.wrapper=this.wrapper;return b}}),D=function(a){if(this instanceof
D){var c=new I(a||t);return function(a,b){return a!=null?(b instanceof C||(b=c.createEntitySet()),b.set(a instanceof o?a.getItems():Array.from(a)),b):null}}};D.className="basis.entity.EntitySetWrapper";var I=m(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),H=function(a){if(this instanceof H){var c=function(a,c){if(a!=null){if(a===c||a.entityType===b)return a;var j,
f=b.idField;if(d[typeof a]){if(!f)return;j=a;a={};a[f]=j}else if(b.compositeKey)j=b.compositeKey(a,a);else if(f)j=a[f];else if(g&&(c=b.singleton,!c))return b.singleton=new h(a);j!=null&&e&&(c=e.get(j,b.entityClass));c&&c.entityType===b?c.update(a):c=new h(a);return c}else return b.singleton},b=new M(a||{},c),e=b.index__,h=b.entityClass,g=b.isSingleton;v(c,{toString:function(){return this.typeName+"()"},entityType:b,type:c,typeName:b.name,index:e,reader:function(a){return b.reader(a)},get:function(a){return b.get(a)},
addField:function(a,c){b.addField(a,c)},all:b.all,createCollection:function(a,d,e){var h=b.collection_[a];return!h&&d?b.collection_[a]=new F({wrapper:c,source:e||b.all,rule:d}):h},getCollection:function(a){return b.collection_[a]},createGrouping:function(a,d,e){var h=b.grouping_[a];return!h&&d?b.grouping_[a]=new B({wrapper:c,source:e||b.all,rule:d}):h},getGrouping:function(a){return b.grouping_[a]},getSlot:function(a,c){return b.getSlot(a,c)}});return c}};H.className="basis.entity.EntityTypeWrapper";
var L=u("singleton"),G={};m(r,{});var M=m(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:false,index__:null,slot_:null,init:function(c,b){this.name=c.name||l(this.name);this.index__=c.index;this.idFields={};a.push(this);this.isSingleton=c.isSingleton;this.wrapper=b;this.all=new E(Object.extend(c.all||{},{wrapper:b}));this.slot_={};if(c.extensible)this.extensible=true;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(c.fields,this.addField,this);c.constrains&&
c.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=L;c.aliases&&Object.iterate(c.aliases,this.addAlias,this);this.collection_={};if(c.collections)for(var d in c.collections)this.collection_[d]=new F({name:d,wrapper:b,source:this.all,rule:c.collections[d]||Function.$true});this.grouping_={};if(c.groupings)for(d in c.groupings)this.grouping_[d]=new B({name:d,wrapper:b,source:this.all,rule:c.groupings[d]||Function.$true});this.entityClass=K(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:b,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var c={};if(d[typeof a])return this.idField?(c[this.idField]=a,c):null;if(!a||a==null)return null;for(var b in a){var e=b in this.aliases?this.aliases[b]:"";e&&e in this.fields&&(c[e]=this.fields[e].reader?this.fields[e].reader(a[b]):a[b])}return c},addAlias:function(a,c){c in this.fields&&a in this.aliases==false&&(this.aliases[a]=c)},addField:function(a,
d){if(!this.all.itemCount){this.aliases[a]=a;typeof d=="function"&&(d={type:d});if("type"in d&&typeof d.type!="function")d.type=t;var e=d.type||t;if([b,c,h,y].has(e))d.id=true;if(d.id){if(!this.index__)this.index__=new x(String);this.idFields[a]=true;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=n.apply(null,Object.keys(this.idFields))):this.idField=a}d.calc?this.addCalcField(a,d.calc,void 0):this.fields[a]=e;this.defaults[a]="defValue"in d?d.defValue:e();this.getters["get_"+
a]=function(){return this.data[a]};G[a]||(G[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,c,b){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var d={args:c.args,wrapper:!b?c:function(a,d,e){return b(c(a,d,e))}},e=this.calcs.length,h=0,g=0;g<this.calcs.length;g++)c.args.has(this.calcs[g].key)&&(h=g+1);if(a){d.key=a;for(g=0;g<this.calcs.length;g++)if(this.calcs[g].args.has(a)){e=g;break}if(h>e)return;if(this.idField&&a==this.idField)this.compositeKey=c;this.fields[a]=
function(a,c){typeof console!="undefined"&&console.log("Calculate fields are readonly");return c}}else e=h;this.calcs.splice(Math.min(e,h),0,d)}},get:function(a){a=this.getId(a);if(a!=null)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&a!=null){if(d[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof r)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var c=this.getId(a);if(c!=
null){var b=this.slot_[c];b||(d[typeof a]&&(b={},this.idField&&!this.compositeKey&&(b[this.idField]=a),a=b),b=this.slot_[c]=new r({delegate:this.get(c),data:a}));return b}}}),J=m(r,{init:s.prototype.init,event_rollbackUpdate:s.createEvent("rollbackUpdate")}),K=function(a,c,b,d,h,j,f){function k(c,b,d){var e=false,h=a.calcs,g=c.__id__,j=c.data;try{if(h)for(var f=0,x;x=h[f++];){var o=x.key;if(o){var l=j[o];j[o]=x.wrapper(b,j,j[o]);j[o]!==l&&(b[o]=l,e=true)}else x.wrapper(b,j)}if(a.compositeKey)c.__id__=
a.compositeKey(b,j,c.__id__);else if(B&&B in b)c.__id__=j[B];c.__id__!==g&&a.index__.calcWrapper(c.__id__)}catch(q){c.__id__=g;for(var m in b)c.data[m]=b[m];if(d)for(m in d)if(!c.modified)c.modified=d;e=false}c.__id__!==g&&i(c,g,c.__id__);return e}function i(a,c,e){c!=null&&(b.remove(c,a),d[c]&&d[c].setDelegate());e!=null&&(b.add(e,a),d[e]&&d[e].setDelegate(a))}var B=a.idField;return m(J,f,{canHaveDelegate:false,modified:null,isTarget:true,extendConstructor_:false,init:function(a){J.prototype.init.call(this);
this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var b,d={},e;for(e in h)e in a?(d[e]=j[e],b=h[e](a[e])):b=j[e],b&&b!==this&&b instanceof s&&b.addHandler(G[e],this)&&(this.fieldHandlers_[e]=true),this.data[e]=b;k(this,d);c.event_datasetChanged(c,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(c,b,d,e){var g=h[c];if(!g){if(!a.extensible)return;g=t}var j,f=this.modified,
b=g(b,this.data[c]),g=this.data[c];if(b!==g&&(!b||!g||b.constructor!==Date||g.constructor!==Date||+b!==+g))a:{j={};if(c!=B)if(d){if(!f)this.modified=f={};if(c in f===false)j.rollback={key:c,value:void 0},f[c]=g;else if(f[c]===b&&(j.rollback={key:c,value:b},delete f[c],!Object.keys(f).length))this.modified=null}else if(f&&c in f)if(f[c]!==b){j.rollback={key:c,value:f[c]};f[c]=b;break a}else return false;this.data[c]=b;this.fieldHandlers_[c]&&(g.removeHandler(G[c],this),this.fieldHandlers_[c]=false);
b&&b!==this&&b instanceof s&&b.addHandler(G[c],this)&&(this.fieldHandlers_[c]=true);j.key=c;j.value=g;j.delta={};j.delta[c]=g}else if(!d&&f&&c in f&&(j={rollback:{key:c,value:f[c]}},delete f[c],!Object.keys(f).length))this.modified=null;if(!e&&j){var d=j.key,c=j.delta||{},i;if(j.rollback)i={},i[j.rollback.key]=j.rollback.value;k(this,c,i)&&(d=true);if(d)this.event_update(this,c),j.delta=c;i&&this.event_rollbackUpdate(this,i)}return j||false},update:function(a,c){if(a){var b,d={},e,h={},g,j;for(j in a)if(g=
this.set(j,a[j],c,true)){if(g.key)b=true,d[g.key]=g.value;if(g.rollback)e=true,h[g.rollback.key]=g.rollback.value}k(this,d,h)&&(b=true);b&&this.event_update(this,d);e&&this.event_rollbackUpdate(this,h)}return b?d:false},reset:function(){this.update(j)},clear:function(){var a={},c;for(c in this.data)a[c]=void 0;return this.update(a)},commit:function(a){if(this.modified){var c=this.modified;this.modified=null}this.update(a);c&&this.event_rollbackUpdate(this,c)},rollback:function(){if(this.state!=g.PROCESSING){if(this.modified){var a=
this.modified;this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(g.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.data[a].removeHandler(G[a],this);this.fieldHandlers_=e;this.__id__&&i(this,this.__id__,null);r.prototype.destroy.call(this);c.event_datasetChanged(c,{deleted:[this]});this.data=e;this.modified=null}})};f.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof K},NumericId:b,NumberId:c,IntId:h,StringId:y,Index:x,CalculateField:i,
EntityType:H,Entity:K,BaseEntity:J,EntitySetType:D,EntitySet:C,ReadOnlyEntitySet:E,Collection:F,Grouping:B})})(basis);
(function(f){var l=f.Class,i=Object.extend,n=f.EventObject,m=n.createEvent;f.ua.Cookies.get("DEBUG_MODE");var p,v,t=false,u={},w=Date.now,s=i(new n,{event_sessionOpen:m("sessionOpen"),event_sessionClose:m("sessionClose"),event_sessionFreeze:m("sessionFreeze"),event_sessionUnfreeze:m("sessionUnfreeze"),isOpened:function(){return!!p},getTimestamp:function(){if(p)return v},open:function(f,l){var m;u[f]||(u[f]=new o(f));m=u[f];p===m?t&&this.unfreeze():(this.close(),p=m,v=w(),l&&i(m.data,l),this.event_sessionOpen(this))},
close:function(){p&&(t&&this.unfreeze(),this.event_sessionClose(this),v=p=null)},freeze:function(){p&&!t&&(this.event_sessionFreeze(this),t=true,v=null)},unfreeze:function(){p&&t&&(t=false,v=w(),this.event_sessionUnfreeze(this))},storeData:function(f,i){if(p)return p.storeData(f,i);else throw Error("No opened session");},getData:function(f){if(p)return p.getData(f);else throw Error("No opened session");},destroy:function(){for(var f=Object.keys(u),i;i=f.pop();)u[i].destroy();n.prototype.destroy.call(this)}}),
o=l(n,{event_destroy:function(){p==this&&s.close();delete u[this.key]},extendConstructor_:false,init:function(f){n.prototype.init.call(this);this.key=f;this.data={}},storeData:function(f,i){if(t)throw Error("Session is frozen");return this.data[f]=i},getData:function(f){if(t)throw Error("Session is frozen");return this.data[f]},destroy:function(){n.prototype.destroy.call(this);for(var f=Object.keys(this.data),i;i=f.pop();){var o=this.data[i];o!=null&&typeof o.destroy=="function"&&o.destroy();delete this.data[i]}}});
f.namespace("basis.session").extend({SessionManager:s})})(basis);
(function(f){function l(d){var a=f.EventObject.createEvent(d),b=[d];return function(){e.dispatch.apply(this,b.concat(arguments));a.apply(this,arguments)}}function i(d,a){var b={"JS-Framework":"Basis"};q.test(a.method)?(b["Content-Type"]=a.contentType+(a.encoding?";charset="+a.encoding:""),t.test("gecko")&&(b.Connection="close")):t.test("ie")&&(b["If-Modified-Since"]=(new Date(0)).toGMTString());Object.iterate(Object.extend(b,a.headers),function(a,b){b!=null&&this.setRequestHeader(a,b)},d)}function n(d){var a=
this.transport;if(a){if(typeof d!="number")d=a.readyState;if(d!=this.prevReadyState_)if(this.prevReadyState_=d,this.event_readyStateChanged(d),d==4){w.remove(this,"timeoutAbort");var d=k.UNDEFINED,b;this.progress=false;a.onreadystatechange=Function.$undef;if(this.aborted){var c=this.abortedByTimeout_;c&&this.event_timeout();this.event_abort(c)}else d=this.responseIsSuccess(),this.update({text:a.responseText,xml:a.responseXML}),d?(this.event_success(a),d=k.READY):(this.event_failure(a),d=k.ERROR,b=
this.getRequestError(a)),this.event_httpStatus(a,a.status);this.event_complete(a);this.setState(d,b)}else this.setState(k.PROCESSING)}}function m(d){w.remove(this,"timeoutAbort");this.abortedByTimeout_=this.aborted=this.progress=false;this.prevReadyState_=-1;if(t.test("gecko1.8.1-")&&d.asynchronous)this.transport=g();var a=this.transport;this.asynchronous?a.onreadystatechange=n.bind(this):n.call(this,0);a.open(d.method,d.location,d.asynchronous);this.progress=true;this.abortedByTimeout_=this.aborted=
false;i(a,d);this.event_start();if(this.aborted)n.call(this,4);else if(!this.aborted&&this.progress){this.requestStartTime=Date.now();w.add(this,"timeoutAbort",this.requestStartTime+this.timeout);var b=d.postBody;if(d.method=="POST"&&t.test("ie9-"))if(typeof b=="object"&&typeof b.documentElement!="undefined"&&typeof b.xml=="string")b=b.xml;else if(typeof b=="string")b=b.replace(/\r/g,"");else if(b==null||b=="")b="[empty request]";a.send(b);return true}}var p=f.Class,v=f.dom.event,t=f.ua,u=f.Cleaner,
w=f.TimeEventManager,s=f.data,o=s.DataObject,k=s.STATE,q=/POST/i,s=f.ua.Cookies.get("DEBUG_AJAX");(function(){for(var d=192;d<=255;d++)d.toHex(),String.fromCharCode(d+848),(d+848).toHex(),d.toHex()})();var r="native",g=function(){if(window.XMLHttpRequest)return function(){return new XMLHttpRequest};var d=window.ActiveXObject;if(d)for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;r=a[b];b++)try{if(new d(r))return function(){return new d(r)}}catch(c){}throw Error(r=
"Browser doesn't support for XMLHttpRequest!");}(),e=function(){var d=[],a=[{handler:{start:function(){d.add(this)},complete:function(){d.remove(this)}}}];v.onUnload(function(){a.clear()});return{addHandler:function(b,c){for(var d=0,e;e=a[d];d++)if(e.handler===b&&e.thisObject===c)return false;a.push({handler:b,thisObject:c});return true},removeHandler:function(b,c){for(var d=0,e;e=a[d];d++)if(e.handler===b&&e.thisObject===c)return a.splice(d,1),true;return false},dispatch:function(b){if(a.length)for(var c=
Array.prototype.slice.call(arguments,1),d,e,g=a.length-1;d=a[g];g--)e=d.handler[b],typeof e=="function"&&e.apply(d.thisObject||this,c)},abort:function(){for(var a=Array.from(d),c=0;c<a.length;c++)a[c].abort();return a}}}(),p=p(o,{state:k.UNDEFINED,event_start:l("start"),event_readyStateChanged:l("readyStateChanged"),event_timeout:l("timeout"),event_abort:l("abort"),event_success:l("success"),event_failure:l("failure"),event_httpStatus:l("httpStatus"),event_complete:l("complete"),event_stateChanged:function(d,
a){o.prototype.event_stateChanged.call(this,d,a);for(var b=0;b<this.influence.length;b++)this.influence[b].setState(this.state,this.state.data)},influence:null,debug:s,progress:false,aborted:false,abortedByTimeout_:false,abortCalled:false,timeout:3E4,requestStartTime:0,requestData_:null,asynchronous:true,method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,init:function(d){var a=this.influence;this.transport=g();this.requestHeaders={};this.influence=[];this.params={};a&&this.setInfluence.apply(this,
a);u.add(this);o.prototype.init.call(this,d);this.callback&&this.addHandler(this.callback,this)},setInfluence:function(){for(var d=Array.from(arguments),a=0;a<d.length;a++)d[a].setState(this.state,this.state.data);this.influence.set(d)},clearInfluence:function(){this.influence.clear()},setParam:function(d,a){this.params[d]=a},setParams:function(d){this.clearParams();for(var a in d)this.setParam(a,d[a])},removeParam:function(d){delete this.params[d]},clearParams:function(){for(var d in this.params)delete this.params[d]},
timeoutAbort:function(){this.abortedByTimeout_=true;this.abort()},abort:function(){this.aborted=true;if(this.progress)w.remove(this,"timeoutAbort"),this.progress=false,this.transport.abort(),this.asynchronous&&this.transport.onreadystatechange&&this.transport.onreadystatechange!==Function.$undef&&n.call(this,4)},request:function(d){var d=d||this.url,a=this.method.toUpperCase(),b,c;if(!this.transport)throw Error("Transport is not allowed");if(!d)throw Error("URL is not defined");this.abort();delete this.requestData_;
this.update({responseText:"",responseXml:null});this.abortedByTimeout_=this.aborted=this.progress=false;b=Object.iterate(this.params,function(a,c){return c==null||c&&typeof c.toString=="function"&&c.toString()==null?null:a+"="+String(c.toString()).replace(/[\%\=\&\<\>\s\+]/g,function(a){a=a.charCodeAt(0).toHex();return"%"+(a.length<2?"0":"")+a})}).filter(Function.$isNotNull).join("&");q.test(a)?c=this.postBody||b||"":b&&(d+=(d.indexOf("?")==-1?"?":"&")+b);this.requestData_={method:a,location:d,contentType:this.contentType,
encoding:this.encoding,asynchronous:this.asynchronous,headers:Object.extend({},this.requestHeaders),postBody:c};return m.call(this,this.requestData_)},repeat:function(){if(this.requestData_)return this.abort(),m.call(this,this.requestData_)},get:function(){this.request.apply(this,arguments)},responseIsSuccess:function(){try{if(!this.aborted){var d=this.transport.status;return d==void 0||d==0||d>=200&&this.transport.status<300}}catch(a){}return false},getRequestError:function(d){return{code:"SERVER_ERROR",
msg:d.responseText}},destroy:function(){this.destroy=Function.$undef;delete this.requestData_;this.transport.onreadystatechange=Function.$undef;this.transport.abort();this.clearInfluence();o.prototype.destroy.call(this);delete this.transport;u.remove(this)}});f.namespace("basis.net.ajax").extend({Transport:p,TransportDispatcher:e,createEvent:l})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.net.ajax,m=f.xml,p=n.Transport,v=m.QName,t=m.addNamespace,u=m.XML2Object,w=m.Object2XML,s=m.createElementNS,o=m.NAMESPACE,k=String("http://schemas.xmlsoap.org/soap/envelope/"),q=String("http://schemas.xmlsoap.org/soap/encoding/"),r=l(null,{url:null,namespace:null,init:function(a,b){this.url=a;this.namespace=b},call:function(a,b){a=this.createMethodCall(a,b,false);a.transport.abort();a.invoke(b.header,b.body,b.callback,b.mapping)},createMethodCall:function(a,
b,d){return new g(this,new v(a,this.namespace),b,d)}}),g=l(null,{service:null,transport:null,method:null,envelope:null,body:null,init:function(a,b,g,j){g=g||{};this.method=b;this.envelope=new d;this.url=a.url;this.transport=new e(b,g.callback);this.transport.requestHeaders={SOAPAction:b.namespace+(!/\/$/.test(b.namespace)?"/":"")+b};this.transport.requestEnvelope=this.envelope;this.transport.postBody=this.envelope.document;this.transport.url={toString:function(){return a.url}};g.mapping&&this.transport.setMapping(g.mapping);
g.callback&&this.transport.setCallback(g.callback);if(j)this.body=g.body||{}},repeatCall:function(){this.transport.get()},call:function(a){return this.invoke(null,a||this.body)},invoke:function(a,b,d,e){this.transport.abort();this.envelope.getBody(true).setValue(this.method,b);a&&this.envelope.getHeader(true).setValue(a,this.method.namespace);d&&this.transport.setCallback(d);e&&this.transport.setMapping(e);this.transport.get()},destroy:function(){this.destroy=Function.$undef;this.transport.destroy();
this.envelope.destroy();this.contructor.prototype.destroy.call(this)}}),e=l(p,{callback:{},mapping:null,method:"POST",contentType:"text/xml",encoding:"utf-8",event_success:function(a){var b=a.responseXML;if(b===void 0||b.documentElement===void 0)this.event_failure(this);else{var e=Array.from(arguments);b.xml&&DOMParser&&(b=(new DOMParser).parseFromString(b.xml,"text/xml"));this.responseEnvelope=new d(b.documentElement);e.push(this.getResponseData(),this.getRequestData());p.prototype.event_success.apply(this,
e)}},event_failure:function(a){var b=Array.from(arguments),d=this.state.data||this.getRequestError(a);d.isSoapFailure&&this.event_soapfailure(a,d.code,d.msg);b.push(d.code,d.msg);p.prototype.event_failure.apply(this,b)},event_soapfailure:n.createEvent("soapfailure"),requestDataGetter:Function.$self,responseDataGetter:Function.$self,errorCodeGetter:function(a){return i.tag(a,"code")[0]},errorMessageGetter:function(a){return i.tag(a,"message")[0]},extendConstructor_:false,init:function(a){p.prototype.init.call(this);
this.soapMethod=a},setCallback:function(a){typeof a=="object"&&this.addHandler(a)},setMapping:function(a){this.mapping=a},getRequestData:function(){return this.requestDataGetter(this.requestEnvelope.getBody().getValue())},getResponseData:function(){var a=this.responseEnvelope&&this.responseEnvelope.getBody();if(a)return this.responseDataGetter(a.getValue(this.mapping))},getRequestError:function(a){var b,e,g=false,a=a.responseXML;if(a!=void 0&&a.documentElement!=void 0)b=a.documentElement,g=this.errorCodeGetter(b),
e=this.errorMessageGetter(b),this.responseEnvelope=new d(b),b=g?g.firstChild.nodeValue:"UNKNOWN_ERROR",e=e?e.firstChild.nodeValue:"Unknown error",console.log("SoapError:",b.quote("("),e),g=true;return{code:b||"TRANSPORT_ERROR",msg:e,isSoapFailure:g}}}),d=l(null,{header:null,body:null,init:function(a){if(!a)a=m.createDocument(k,"soap:Envelope").documentElement,t(a,"xsd",o.XMLShema),t(a,"xsi",o.XMLShemaInstance),m.XMLNS.BAD_SUPPORT&&t(a,"soap",k);this.document=a.ownerDocument;this.element=a;this.body=
this.getBody(true)},getElementByName:function(a){return m.getElementsByTagNameNS(this.element,a,k)[0]},getHeader:function(c){var b=this.header;if(!b){var d=this.getElementByName("Header");if(d||c)b=this.header=new a(d,this.document),d||this.element.insertBefore(b.element,this.element.firstChild)}return b},setHeaderSection:function(a,b){this.getHeader(true).setSection(a,b)},getBody:function(a){var d=this.body;if(!d){var e=this.getElementByName("Body");if(e||a)d=this.body=new b(e,this.document),e||
this.element.appendChild(d.element)}return d},destroy:function(){this.header&&(this.header.destroy(),delete this.header);this.body&&(this.body.destroy(),delete this.body);delete this.element;delete this.document}}),a=l(null,{init:function(a,b){this.element=a||s(b,"Header",k)},getValue:function(){return u(this.element)},setValue:function(a,b){i.clear(this.element);this.appendChild(a,b)},appendChild:function(a,b){if(a)for(var d in a){var e=this.element.appendChild(w(this.element.ownerDocument,d,b,a[d]));
m.XMLNS.BAD_SUPPORT&&t(e,"",b)}},setSection:function(a,b){var d=m.getElementsByTagNameNS(this.element,a,a.namespace)[0];d&&i.remove(d);this.appendChild(Function.wrapper(a)(b),a.namespace)}}),b=l(null,{init:function(a,b){this.element=a||s(b,"Body",k)},getValue:function(a){return u(this.element,a)},setValue:function(a,b,d){i.clear(this.element);this.appendChild(a,b,d)},appendChild:function(a,b,d){b=w(this.element.ownerDocument,a,a.namespace,Function.$defined(b)?b:{});this.element.appendChild(b);m.XMLNS.BAD_SUPPORT&&
t(b.element,"",a.namespace);d&&m.setAttributeNodeNS(b,m.createAttributeNS(document,"encodingStyle",q,d))}});f.namespace("basis.net.soap").extend({Service:r,ServiceCall:g,ServiceCallTransport:e,Envelope:d,EnvelopeHeader:a,EnvelopeBody:b})})(basis);
(function(f){var l=Function.getter,i=f.Class,n=f.dom,m=f.ui.Node,p=f.ui.Control,v=i(m,{captionGetter:l("caption"),caption:"[no caption]",groupId:0,name:null,template:'<button{buttonElement} class="Basis-Button" event-click="click"><span class="Basis-Button-Back"/><div class="Basis-Button-Caption">{captionText}</div></button>',action:{click:function(){this.isDisabled()||this.click()}},click:function(){},event_select:function(){m.prototype.event_select.call(this);n.focus(this.element)},event_disable:function(){m.prototype.event_disable.call(this);
this.tmpl.buttonElement.disabled=true},event_enable:function(){m.prototype.event_enable.call(this);this.tmpl.buttonElement.disabled=false},init:function(f){m.prototype.init.call(this,f);this.setCaption(this.caption)},setCaption:function(f){this.caption=f;this.tmpl.captionText.nodeValue=this.captionGetter(this)}}),i=i(p,{template:'<div class="Basis-ButtonPanel"><div{childNodesElement|content} class="Basis-ButtonPanel-Content"/></div>',childClass:v,getButtonByName:function(f){return this.childNodes.search(f,
l("name"))},localGrouping:{},localGroupingClass:{groupGetter:function(f){return f.groupId||-f.eventObjectId},childClass:{template:'<div class="Basis-ButtonGroup"/>'}}});f.namespace("basis.ui.button").extend({Button:v,ButtonPanel:i})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.html.Template,m=Function.getter,p=f.EventObject.createEvent,v=f.data.STATE,t=f.ui.Node,u=new n('<div{element|content} class="Basis-Label-State"/>'),w=new n('<div{element|content} class="Basis-Label-Processing"/>'),s=new n('<div{element|content} class="Basis-Label-Error"/>'),o=l(t,{cascadeDestroy:true,show_:false,visible_:false,visibilityGetter:Function.$false,insertPoint:i.INSERT_END,content:"[no text]",event_delegateChanged:function(a,c){(c?c.element==this.container:
!this.container)&&this.setContainer(this.delegate&&this.delegate.element)},event_visibilityChanged:p("visibilityChanged"),init:function(a){var c=this.container;this.container=null;t.prototype.init.call(this,a);if(c)this.container=c;this.traceChanges_();return a},traceChanges_:function(){this.container&&this.visible_?this.container!=this.element.parentNode&&i.insert(this.container,this.tmpl.element,this.insertPoint):i.remove(this.element)},setContainer:function(a){if(this.container!=a)this.container=
a,this.traceChanges_()},setVisibility:function(a){if(this.visible_!=a)this.visible_=a,this.traceChanges_(),this.event_visibilityChanged(this.visible_)},destroy:function(){delete this.container;t.prototype.destroy.call(this)}}),k=l(o,{template:u,init:function(a){if(this.visibleStates&&!this.visibilityGetter){for(var c={},d,e=0;d=this.visibleStates[e++];)c[d]=true;this.visibilityGetter=m(Function.$self,c)}o.prototype.init.call(this,a)}}),p=l(k,{event_delegateChanged:function(a,c){k.prototype.event_delegateChanged.call(this,
a,c);this.delegate&&this.event_stateChanged(this)},event_stateChanged:function(a,c){k.prototype.event_stateChanged.call(this,a,c);this.setVisibility(this.visibilityGetter(this.state,c))}}),q=l(p,{visibilityGetter:function(a){return a==v.PROCESSING},content:"Processing...",template:w}),s=l(p,{visibilityGetter:function(a){return a==v.ERROR},content:"Error",template:s}),r={stateChanged:function(a,c){this.setVisibility(this.visibilityGetter(a.state,c))}},g={dataSourceChanged:function(a,c){c&&c.removeHandler(r,
this);a.dataSource&&(a.dataSource.addHandler(r,this),r.stateChanged.call(this,a.dataSource,a.dataSource.state))}},u=l(k,{event_delegateChanged:function(a,c){k.prototype.event_delegateChanged.call(this,a,c);c&&c.removeHandler(g,this);this.delegate&&(this.delegate.addHandler(g,this),g.dataSourceChanged.call(this,this.delegate,c&&c.dataSource))},template:u}),w=l(u,{visibilityGetter:function(a){return a==v.PROCESSING},content:"Processing...",template:w}),e=function(){this.setVisibility(this.visibilityGetter(this.delegate?
this.delegate.childNodes.length:0,this.delegate))},d={stateChanged:function(a){this.setVisibility(this.visibilityGetter(a.itemCount,this.delegate))}},a={childNodesModified:e,dataSourceStateChanged:e,stateChanged:e,dataSourceChanged:function(a,c){c&&c.removeHandler(d,this);a.dataSource&&(a.dataSource.addHandler(d,this),d.stateChanged.call(this,a.dataSource,a.dataSource.state))}},n=l(o,{event_delegateChanged:function(b,c){o.prototype.event_delegateChanged.call(this,b,c);c&&c.removeHandler(a,this);this.delegate&&
(this.delegate.addHandler(a,this),a.dataSourceChanged.call(this,this.delegate));e.call(this)},template:new n('<div{element|content} class="Basis-CountLabel"/>')}),l=l(n,{visibilityGetter:function(a,c){var d=c.dataSource?c.dataSource.state:c.state;return!a&&d==v.READY},content:"Empty"});f.namespace("basis.ui.label").extend({NodeLabel:o,State:k,ObjectState:p,Processing:q,Error:s,DataSourceState:u,DataSourceProcessing:w,ChildCount:n,IsEmpty:l})})(basis);
(function(f){function l(g){typeof g.expand=="function"&&g.expand()}function i(g){typeof g.collapse=="function"&&g.collapse()}var n=f.Class,m=f.dom,p=f.dom.event,v=f.cssom.classList,t=Function.getter,u=f.EventObject.createEvent,w=f.ui.Container,s=f.ui.Control,o=f.ui.PartitionNode,k=f.ui.GroupingNode,q={expandAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,l)},collapseAll:function(){m.axis(this,m.AXIS_DESCENDANT_OR_SELF,i)},expand:Function(),collapse:Function(),toggle:Function()},o=n(o,{template:'<li{element} class="Basis-TreePartitionNode"><div class="Basis-TreePartitionNode-Title"><span>{titleText}</span></div><ul{childNodesElement} class="Basis-TreePartitionNode-Content"/></li>'}),
k=n(k,{childClass:o}),r=n(w,q,{canHaveChildren:false,childFactory:null,event_collapse:u("collapse"),event_expand:u("expand"),template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title"><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div></li>',templateUpdate:function(g){g.titleText.nodeValue=String(this.titleGetter(this))||"[no title]"},action:{select:function(g){this.isDisabled()||this.select(p(g).ctrlKey)},toggle:function(){this.toggle()}},
titleGetter:t("data.title")}),t=n(r,{canHaveChildren:true,childClass:r,localGroupingClass:k,event_expand:function(){r.prototype.event_expand.call(this);v(this.element).remove("collapsed")},event_collapse:function(){r.prototype.event_collapse.call(this);v(this.element).add("collapsed")},template:'<li{element} class="Basis-TreeNode"><div{content} class="Basis-TreeNode-Title Basis-TreeNode-CanHaveChildren"><div{expander} class="Basis-TreeNode-Expander" event-click="toggle"/><span{title} class="Basis-TreeNode-Caption" event-click="select">{titleText}</span></div><ul{childNodesElement} class="Basis-TreeNode-Content"/></li>',
collapsable:true,collapsed:false,init:function(g){r.prototype.init.call(this,g);this.collapsed&&this.collapsable&&this.event_collapse()},expand:function(){if(this.collapsed)return this.collapsed=false,this.event_expand(),true},collapse:function(){if(!this.collapsed&&this.collapsable)return this.collapsed=true,this.event_collapse(),true},toggle:function(){this.collapsed?this.expand():this.collapse()}}),n=n(s,q,{childClass:r,localGroupingClass:k,template:'<ul class="Basis-Tree"/>'});f.namespace("basis.ui").extend({Tree:n});
f.namespace("basis.ui.tree").extend({Tree:n,Node:r,Folder:t,GroupingNode:k,PartitionNode:o})})(basis);
(function(){var f=basis.Class,l=basis.dom,i=basis.dom.event,n=basis.cssom,m=Function.getter,p=basis.cssom.classList,v=basis.Cleaner,t=basis.layout,u=basis.EventObject.createEvent,w=basis.ui.Node,s=basis.ui.Container,o=basis.ui.Control,k=basis.ui.PartitionNode,q=basis.ui.GroupingNode,r={VERTICAL:"V",HORIZONTAL:"H"},g=String("LTRTRBLBLCCTRCCBCCCCCCCC"),e={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},d={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},a={finish:function(){this.visible||
(l.remove(this.element),this.event_cleanup(this))}},u=f(s,{template:'<div{element|selected} class="Basis-Popup"><div{closeButton} class="Basis-Popup-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Popup-Content"/></div>',event_beforeShow:u("beforeShow"),event_show:u("show"),event_hide:u("hide"),event_realign:u("realign"),event_cleanup:u("cleanup"),event_layoutChanged:u("layoutChanged","oldOrientation","oldDir")&&function(a,c){var b=(a+"-"+c.qw().slice(2,4).join("-")).toLowerCase(),
d=(this.orientation+"-"+this.dir.qw().slice(2,4).join("-")).toLowerCase();p(this.element).replace(b,d,this.cssLayoutPrefix)},visible:false,autorotate:false,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:r.VERTICAL,hideOnAnyClick:true,hideOnKey:false,ignoreClickFor:[],cssLayoutPrefix:"popup-",init:function(c){s.prototype.init.call(this,c);this.cssRule=n.uniqueRule(this.element);this.ignoreClickFor=Array.from(this.ignoreClickFor);if(this.dir)this.defaultDir=this.dir.toUpperCase();this.setLayout(this.defaultDir,
this.orientation);this.thread&&this.thread.addHandler(a,this);v.add(this)},setLayout:function(a,c,b){var d=this.dir,e=this.orientation;if(typeof a=="string")this.dir=a.toUpperCase();if(typeof c=="string")this.orientation=c;if(d!=this.dir||e!=this.orientation)this.event_layoutChanged(e,d),b||this.realign()},flip:function(a){var c=this.dir.qw(),a=a==r.VERTICAL;c[0+a]=d[c[0+a]];c[2+a]=d[c[2+a]];this.setLayout(c.join(" "))},rotate:function(a){var c=this.dir.qw(),a=(a%4+4)%4,b=[];if(!a)return c;var d=
c[0].charAt(0),h=c[1].charAt(0),f=g.indexOf(d+h)>>1,d=(f&252)+((f&3)+a&3)<<1;b.push(e[g.charAt(d)],e[g.charAt(d+1)]);d=c[2].charAt(0);h=c[3].charAt(0);f=g.indexOf(d+h)>>1;a=d!="C"&&h!="C"&&c[0]==c[2]!=(c[1]==c[3])?-a+4:a;d=(f&252)+((f&3)+a&3)<<1;b.push(e[g.charAt(d)],e[g.charAt(d+1)]);return b},isFitToViewport:function(a){if(this.visible&&this.relElement){var c=new t.Box(this.relElement,false,this.element.offsetParent),b=new t.Viewport(this.element.offsetParent),d=this.element.offsetWidth,e=this.element.offsetHeight,
a=String(a||this.dir).toUpperCase().qw(),g=a[0]=="CENTER"?c.left+(c.width>>1):c[a[0].toLowerCase()],c=a[1]=="CENTER"?c.top+(c.height>>1):c[a[1].toLowerCase()];return(a[2]!="LEFT")*(g<d>>(a[2]=="CENTER"))||(a[2]!="RIGHT")*(b.width-g<d>>(a[2]=="CENTER"))?false:(a[3]!="TOP")*(c<e>>(a[3]=="CENTER"))||(a[3]!="BOTTOM")*(b.height-c<e>>(a[3]=="CENTER"))?false:{x:g,y:c}}},realign:function(){if(this.visible&&this.relElement){for(var a=this.dir.qw(),c,b=0,d=a,e=a[2],g=a[3],h=typeof this.autorotate=="number"||
!this.autorotate.length?3:this.autorotate.length;this.autorotate&&b<=h;){if(c=this.isFitToViewport(d.join(" "))){e=d[2];g=d[3];this.setLayout(d.join(" "),null,true);break}if(b==h)break;Array.isArray(this.autorotate)?(d=this.autorotate[b++],d=typeof d=="string"?d.toUpperCase().split(" "):this.rotate(d)):d=this.rotate(++b*this.autorotate)}c||(c=new t.Box(this.relElement,false,this.element.offsetParent),c={x:a[0]=="CENTER"?c.left+(c.width>>1):c[a[0].toLowerCase()],y:a[1]=="CENTER"?c.top+(c.height>>1):
c[a[1].toLowerCase()]});a=new t.Box(this.element.offsetParent);b={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(e){case "LEFT":b.left=c.x+"px";break;case "CENTER":b.left=Math.round(c.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":b.right=a.width-c.x+"px"}switch(g){case "TOP":b.top=c.y+"px";break;case "CENTER":b.top=Math.round(c.y-this.element.offsetHeight/2)+"px";break;case "BOTTOM":b.bottom=a.height-c.y+"px"}this.cssRule.setStyle(b);this.event_realign()}},show:function(a,c,b){this.relElement=
l.get(a)||this.relElement;this.setLayout(c||this.defaultDir,b);if(this.visible)this.realign();else if(this.relElement)p(this.element).remove("pre-transition"),l.visibility(this.element,false),y.appendChild(this),this.event_beforeShow(),this.visible=true,this.realign(),this.thread&&this.thread.start(1),l.visibility(this.element,true),p(this.element).add("pre-transition"),this.event_show()},hide:function(){if(this.visible)l.parentOf(document.body,this.element)&&(this.thread?this.thread.start(1):(l.remove(this.element),
this.event_cleanup(this))),this.visible=false,this.parentNode&&y.removeChild(this),this.event_hide()},hideAll:function(){y.clear()},destroy:function(){if(this.thread)this.thread.removeHandler(a,this),this.thread=null;this.hide();s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;v.remove(this)}}),b=f(u,{cssLayoutPrefix:"mode-",template:'<div{element|selected} class="Basis-Balloon" event-click="click"><div class="Basis-Balloon-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/><div class="tail"/></div><div class="Basis-Balloon-Layout"><div{closeButton} class="Basis-Balloon-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Balloon-Content"/></div></div>'}),
c=f(s,{template:'<div{element} class="Basis-Menu-Item" event-click="click"><a{content|selected} href="#"><span>{captionText}</span></a></div>',action:{click:function(a){this.click();i.kill(a)}},event_childNodesModified:function(a,c){p(this.element).bool("hasSubItems",this.hasChildNodes());s.prototype.event_childNodesModified.call(this,a,c)},groupId:0,caption:"[untitled]",captionGetter:m("caption"),handler:null,defaultHandler:function(a){this.parentNode&&this.parentNode.defaultHandler(a)},init:function(a){s.prototype.init.call(this,
a);this.setCaption(this.caption)},setCaption:function(a){this.caption=a;if(this.tmpl.captionText)this.tmpl.captionText.nodeValue=this.captionGetter(this)},click:function(){!this.isDisabled()&&!(this instanceof h)&&(this.handler?this.handler(this):this.defaultHandler(this))}});c.prototype.childClass=c;var h=f(c,{event_childNodesModified:w.prototype.event_childNodesModified,template:'<div class="Basis-Menu-ItemSet"/>'}),w=f(k,{template:'<div{element} class="Basis-Menu-ItemGroup"><div{childNodesElement|content} class="Basis-Menu-ItemGroup-Content"></div></div>'}),
q=f(q,{childClass:w}),f=f(u,{childClass:c,defaultDir:"LEFT BOTTOM LEFT TOP",subMenu:null,localGroupingClass:q,localGrouping:m("groupId"),defaultHandler:function(){this.hide()},template:'<div{element|selected} class="Basis-Menu"><div{closeButton} class="Basis-Menu-CloseButton"><span>Close</span></div><div{content|childNodesElement} class="Basis-Menu-Content"/></div>'}),y=new o({id:"Basis-PopupStack",handheldMode:false,childClass:u,event_childNodesModified:function(a,c){if(c.deleted)for(var b=c.deleted.length-
1,d;d=c.deleted[b];b--)d.hide();if(c.inserted&&!c.deleted&&this.childNodes.length==c.inserted.length)p(this.element).add("IsNotEmpty"),document.body.className=document.body.className,i.addGlobalHandler("click",this.hideByClick,this),i.addGlobalHandler("keydown",this.hideByKey,this),i.addGlobalHandler("scroll",this.hideByScroll,this),i.addHandler(window,"resize",this.realignAll,this);this.lastChild?this.lastChild.select():(p(this.element).remove("IsNotEmpty"),document.body.className=document.body.className,
i.removeGlobalHandler("click",this.hideByClick,this),i.removeGlobalHandler("keydown",this.hideByKey,this),i.removeGlobalHandler("scroll",this.hideByScroll,this),i.removeHandler(window,"resize",this.realignAll,this));o.prototype.event_childNodesModified.call(this,a,c)},insertBefore:function(a,c){var b=document.documentElement.scrollTop,d=document.body.scrollTop;if(o.prototype.insertBefore.call(this,a,c)){a.documentST_=b;a.bodyST_=d;if(this.handheldMode)document.documentElement.scrollTop=0,document.body.scrollTop=
0;a.element.style.zIndex=basis.ui.Window?basis.ui.Window.getWindowTopZIndex():2001}},removeChild:function(a){if(a&&(a.hideOnAnyClick&&a.nextSibling&&this.removeChild(a.nextSibling),o.prototype.removeChild.call(this,a),this.handheldMode))document.documentElement.scrollTop=a.documentST_,document.body.scrollTop=a.bodyST_},realignAll:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(a){for(var a=
i.sender(a),c,b=this.childNodes.filter(Function.getter("hideOnAnyClick")).reverse(),d=0,e;e=b[d];d++){if(a===e.tmpl.closeButton||l.parentOf(e.tmpl.closeButton,a)){this.removeChild(e);return}c||(c=l.axis(a,l.AXIS_ANCESTOR_OR_SELF));if(c.has(e.element)||c.some(Array.prototype.has,e.ignoreClickFor)){this.removeChild(b[d-1]);return}}this.removeChild(b.pop())},hideByKey:function(a){var a=i.key(a),c=this.lastChild;if(c&&c.hideOnKey){var b=false;typeof c.hideOnKey=="function"?b=c.hideOnKey(a):Array.isArray(c.hideOnKey)&&
(b=c.hideOnKey.has(a));b&&c.hide()}},hideByScroll:function(a){a=i.sender(a);if(!l.parentOf(a,this.element))for(var c=this.lastChild;c;){var b=c.previousSibling;c.relElement&&c.offsetParent!==a&&l.parentOf(a,c.relElement)&&c.hide();c=b}}});i.onLoad(function(){l.insert(document.body,y.element,l.INSERT_BEGIN);y.realignAll()});basis.namespace("basis.ui.popup").extend({ORIENTATION:r,setHandheldMode:function(a){y.handheldMode=!!a},Popup:u,Balloon:b,Menu:f,MenuGroupControl:q,MenuPartitionNode:w,MenuItem:c,
MenuItemSet:h})})(basis);
(function(f){var l=f.Class,i=f.dom.event,n=f.dom,m=f.html.Template,p=f.cssom.classList,v=f.dom.wrapper,t=v.GroupingNode,u=v.PartitionNode,w=f.ui.Node,s=f.ui.Container,o=f.ui.Control,k=f.ui.PartitionNode,q=f.ui.GroupingNode,r=l(w,{template:new m('<th{element|selected} class="Basis-Table-Header-Cell"><div class="Basis-Table-Sort-Direction"></div><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title">{titleText}</span></div></th>'),templateUpdate:function(a){a.titleText.nodeValue=
this.titleGetter(this)}}),g=l(t,{event_ownerChanged:function(a,b){b&&n.remove(this.headerRow);if(this.owner&&this.owner.element){var d=this,e=this.owner.element;do n.insert(e,d.headerRow,n.INSERT_BEGIN);while(d=d.localGrouping)}t.prototype.event_ownerChanged.call(this,a,b)},childClass:{init:function(a){u.prototype.init.call(this,a);this.cell=new r({titleGetter:this.titleGetter,delegate:this})},event_childNodesModified:function(a,b){var d=0;if(this.nodes[0]&&this.nodes[0]instanceof this.constructor)for(var e=
0,g;g=this.nodes[e];e++)d+=g.cell.element.colSpan;else d=this.nodes.length;this.cell.element.colSpan=d;this.groupNode&&this.groupNode.event_childNodesModified.call(this.groupNode,this.groupNode,{});u.prototype.event_childNodesModified.call(this,a,b)},destroy:function(){u.prototype.destroy.call(this);this.cell.destroy()}},init:function(a){t.prototype.init.call(this,a);this.element=this.childNodesElement=this.headerRow=n.createElement("tr.Basis-Table-Header-GroupContent")},insertBefore:function(a,b){a=
t.prototype.insertBefore.call(this,a,b);n.insert(this.headerRow,a.cell.element,n.INSERT_BEFORE,a.nextSibling&&a.nextSibling.cell.element);return a},removeChild:function(a){n.remove(a.cell.element);t.prototype.removeChild.call(a)},destroy:function(){t.prototype.destroy.call(this);this.headerRow=null}});g.prototype.localGroupingClass=g;var v=l(w,{sorting:null,defaultOrder:false,groupId:0,template:new m('<th{element|selected} class="Basis-Table-Header-Cell" event-click="click"><div class="Basis-Table-Sort-Direction"/><div class="Basis-Table-Header-Cell-Content"><span{content} class="Basis-Table-Header-Cell-Title"/></div></th>'),
action:{click:function(){if(this.selected){var a=this.parentNode&&this.parentNode.owner;a&&a.setLocalSorting(a.localSorting,!a.localSortingDesc)}else this.select()}},init:function(a){w.prototype.init.call(this,a);this.selectable=!!this.sorting;if(this.sorting)this.sorting=Function.getter(this.sorting),this.defaultOrder=this.defaultOrder=="desc",p(this.element).add("sortable")},select:function(){if(!this.selected)this.order=this.defaultOrder;w.prototype.select.call(this)}}),e=l(s,{childClass:v,localGroupingClass:g,
template:new m('<thead{element} class="Basis-Table-Header"><tr{groupsElement} class="Basis-Table-Header-GroupContent" /><tr{childNodesElement|content} /></thead>'),listen:{owner:{localSortingChanged:function(a){var b=this.childNodes.search(a.localSorting,"sorting");b?(b.select(),b.order=a.localSortingDesc,p(this.tmpl.content).bool("sort-order-desc",b.order)):this.selection.clear()}}},init:function(a){this.selection={owner:this,handlerContext:this,handler:{datasetChanged:function(a){(a=a.pick())&&
this.owner&&this.owner.setLocalSorting(a.sorting,a.order)}}};s.prototype.init.call(this,a);this.applyConfig_(this.structure)},applyConfig_:function(a){a&&this.setChildNodes(a.map(function(a){var c=a.header,b=Object.slice(a,["sorting","defaultOrder","groupId"]);b.content=(c==null||typeof c!="object"?c:c.content)||String.Entity.nbsp;if(typeof b.content=="function")b.content=b.content.call(this);b.cssClassName=(c.cssClassName||"")+" "+(a.cssClassName||"");return b},this))}}),d=l(w,{colSpan:1,template:new m('<td{element} class="Basis-Table-Footer-Cell"><div{content}>\u00a0</div></td>'),
setColSpan:function(a){this.element.colSpan=this.colSpan=a||1}}),a=l(s,{childClass:d,childFactory:function(a){return new this.childClass(a)},template:new m('<tfoot{element} class="Basis-Table-Footer"><tr{content|childNodesElement}></tr></tfoot>'),init:function(a){s.prototype.init.call(this,a);this.applyConfig_(this.structure);this.useFooter&&n.insert(this.container||this.owner.element,this.element,1)},applyConfig_:function(a){if(a){var b=null;this.clear();this.useFooter=false;for(var e=0;e<a.length;e++){var g=
a[e],f;g.footer?(f=g.footer.content,typeof f=="function"&&(f=f.call(this)),this.useFooter=true,f=this.appendChild({cssClassName:(g.cssClassName||"")+" "+(g.footer.cssClassName||""),content:f,template:g.footer.template||d.prototype.template})):b?b.setColSpan(b.colSpan+1):f=this.appendChild({});f&&(b=f)}}}}),b=l(w,{canHaveChildren:false,repaintCount:0,getters:[],classNames:[],template:'<tr class="Basis-Table-Row" event-click="select"><\!--{cells}--\></tr>',action:{select:function(a){this.select(i(a).ctrlKey)}},
templateUpdate:function(){this.repaintCount+=1;for(var a=0,b;b=this.updaters[a];a++){var d=this.element.childNodes[b.cellIndex];b=b.getter.call(this,this,d);if(this.repaintCount>1)d.innerHTML="";if(!b||!Array.isArray(b))b=[b];for(var e=0;e<b.length;e++){var g=b[e];d.appendChild(g&&g.nodeType?g:n.createText(g!=null&&(typeof g!="string"||g!="")?g:" "))}}}}),k=l(k,{template:'<tbody class="Basis-Table-Body" event-click="click"><tr class="Basis-Table-GroupHeader"><td{content} colspan="100"><span class="expander"/>{titleText}</td></tr><\!-- {childNodesHere} --\></tbody>',
action:{click:function(){p(this.element).toggle("collapsed")}}}),l=l(o,{canHaveChildren:true,childClass:b,localGroupingClass:l(q,{childClass:k}),template:new m('<table{element|groupsElement} class="Basis-Table" cellspacing="0" event-click="click"><\!-- {headerElement} --\><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody><\!-- {footerElement} --\></table>'),templateAction:function(a,b){o.prototype.templateAction.call(this,a,b)},init:function(c){this.applyConfig_(this.structure);o.prototype.init.call(this,
c);this.headerConfig=this.header;this.footerConfig=this.footer;this.header=new e(Object.extend({owner:this,structure:this.structure},this.header));this.footer=new a(Object.extend({owner:this,structure:this.structure},this.footer));n.replace(this.tmpl.headerElement,this.header.element);!this.localSorting&&this.structure&&this.structure.search(true,function(a){return a.sorting&&"autosorting"in a})&&(c=this.structure[Array.lastSearchIndex],this.setLocalSorting(c.sorting,c.defaultOrder=="desc"))},applyConfig_:function(a){if(a){var d=
[],e="";this.firstChild&&this.clear();for(var g=0;g<a.length;g++){var f=a[g],k=f.body||{};if(typeof k=="function"||typeof k=="string")k={content:k};var f=[f.cssClassName||"",k.cssClassName||""].join(" ").trim(),i=k.content;e+="<td"+(k.templateRef?k.templateRef.quote("{"):"")+(f?' class="'+f+'"':"")+">"+(typeof i=="string"?k.content:"")+"</td>";typeof i=="function"&&d.push({cellIndex:g,getter:i})}this.childClass=this.childClass.subclass({satelliteConfig:this.rowSatellite,template:new m(this.childClass.prototype.template.source.replace("<\!--{cells}--\>",
e)),updaters:d});if(this.rowBehaviour){var o=this.rowBehaviour;Object.keys(o).forEach(function(a){this.childClass.prototype[a]=function(){o[a].apply(this,arguments);b.prototype[a].apply(this,arguments)}},this)}}},loadData:function(a){this.setChildNodes(a.map(Function.wrapper("data")))},destroy:function(){o.prototype.destroy.call(this);this.header.destroy();this.header=null;this.footer.destroy();this.footer=null}});f.namespace("basis.ui.table").extend({Table:l,Body:k,Header:e,HeaderCell:v,Row:b,Footer:a});
f.namespace("basis.ui").extend({Table:l})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.dom.event,m=f.cssom,p=f.TimeEventManager,v=f.ui.table.Table,t=f.layout.Box,u=f.layout.Viewport,w=f.ui.table,s=17;n.onLoad(function(){var f=i.createElement("");i.setStyle(f,{height:"100px",overflow:"scroll"});i.insert(document.body,f);s=(new t(f)).width-(new u(f)).width;m.cssRule(".ScrollBarWidthOwner").setStyle({width:s+"px"});i.remove(f)});l=l(v,{template:'<div{element} class="Basis-Table Basis-ScrollTable"><div{headerFooterContainer} class="Basis-ScrollTable-HeaderFooterContainer"><table{head} cellspacing="0" border="0" class="Basis-ScrollTable-Header"><\!-- {headerElement} --\></table><table{foot} cellspacing="0" border="0" class="Basis-ScrollTable-Footer"></table></div><div{scrollContainer} class="Basis-ScrollTable-ScrollContainer"><div{tableWrapperElement} class="Basis-ScrollTable-TableWrapper"><table{tableElement|groupsElement} class="Basis-Table" cellspacing="0"><tbody{content|childNodesElement} class="Basis-Table-Body"></tbody></table></div></div></div>',event_childNodesModified:function(f,
k){v.prototype.event_childNodesModified.call(this,f,k);p.add(this,"adjust",Date.now())},init:function(f){v.prototype.init.call(this,f);this.headerClone=new w.Header(Object.extend({owner:this.header.owner,container:this.tmpl.tableElement,structure:this.structure},this.headerConfig));this.originalCells=this.header.childNodes;if(this.header.groupControl)this.originalCells=this.originalCells.concat(this.header.groupControl.childNodes);this.clonedCells=this.headerClone.childNodes;if(this.headerClone.groupControl)this.clonedCells=
this.clonedCells.concat(this.headerClone.groupControl.childNodes);this.headerExpandCell=i.insert(this.element,i.createElement(".Basis-ScrollTable-ExpandHeaderCell",i.createElement(".Basis-ScrollTable-ExpandCell-Content")));this.headerBox=new t(this.header.element);if(this.footer.useFooter)i.insert(this.tmpl.foot,this.footer.element),this.footerClone=new w.Footer(Object.extend({owner:this.footer.owner,container:this.tmpl.tableElement,structure:this.structure},this.footerConfig)),this.originalCells=
this.originalCells.concat(this.footer.childNodes),this.clonedCells=this.clonedCells.concat(this.footerClone.childNodes),i.setStyle(this.footerClone.element,{visibility:"hidden"}),this.footerBox=new t(this.footer.element),this.footerExpandCell=i.insert(this.element,i.createElement(".Basis-ScrollTable-ExpandFooterCell"));this.cellsAdjustmentInfo=[];for(var f=0,k,l;k=this.originalCells[f];f++)l=this.clonedCells[f],this.cellsAdjustmentInfo.push({element:l.element,boxChangeListener:k.element,contentSource:k.content,
contentDestination:l.content});this.tableBox=new t(this.tmpl.tableElement);this.lastScrollLeftPosition=0;n.addHandler(this.tmpl.scrollContainer,"scroll",this.onScroll.bind(this));n.addHandler(window,"resize",this.adjust.bind(this));this.sync();p.add(this,"adjust",Date.now())},onScroll:function(){var f=this.tmpl.scrollContainer.scrollLeft;if(f!=this.lastScrollLeftPosition)i.setStyleProperty(this.tmpl.headerFooterContainer,"left",-f+"px"),this.lastScrollLeftPosition=f},adjust:function(){this.onScroll();
this.tableBox.recalc();var f=this.tableBox.width||0;this.tmpl.tableWrapperElement.scrollWidth>this.tmpl.scrollContainer.clientWidth?(i.setStyleProperty(this.tmpl.tableWrapperElement,"width",f+"px"),i.setStyleProperty(this.tmpl.headerFooterContainer,"width",f+s+"px")):(i.setStyleProperty(this.tmpl.tableWrapperElement,"width","100%"),i.setStyleProperty(this.tmpl.headerFooterContainer,"width","100%"));this.cellsAdjustmentInfo.forEach(this.adjustCell);f=Math.max(0,this.tmpl.tableWrapperElement.clientWidth-
this.tmpl.tableElement.offsetWidth+s);this.headerBox.recalc();var k=this.headerBox.height||0;m.setStyleProperty(this.element,"paddingTop",k+"px");m.setStyleProperty(this.tmpl.tableElement,"marginTop",-k+"px");m.setStyle(this.headerExpandCell,{width:f+"px",height:k+"px"});this.footer.useFooter&&(this.footerBox.recalc(),k=this.footerBox.height||0,m.setStyleProperty(this.element,"paddingBottom",k+"px"),m.setStyleProperty(this.tmpl.tableElement,"marginBottom",-k+"px"),m.setStyle(this.footerExpandCell,
{width:f+"px",height:k+"px"}))},sync:function(){this.adjust()},adjustCell:function(f){var k;k=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(f.element,null).width:f.element.clientWidth+"px";m.setStyleProperty(f.boxChangeListener,"width",k)}});f.namespace("basis.ui.scrolltable").extend({ScrollTable:l})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.dom.event,m=f.cssom,p=f.cssom.classList,v=f.Cleaner,t=f.EventObject.createEvent,u=f.dragdrop,w=f.ui.Node,s=f.ui.Container,o=f.ui.Control,k=f.ui.button.ButtonPanel,q=l(w,{captureElement:null,template:'<div class="Basis-Blocker"><div{content} class="Basis-Blocker-Mate"/></div>',init:function(e){w.prototype.init.call(this,e);i.setStyle(this.element,{display:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%"});v.add(this)},capture:function(e,d){if(this.captureElement=
i.get(e||document.body))i.insert(this.captureElement,this.element),this.element.style.zIndex=d||1E3,i.show(this.element)},release:function(){if(this.captureElement)this.element.parentNode==this.captureElement&&i.remove(this.element),this.captureElement=null,i.hide(this.element)},destroy:function(){this.release();w.prototype.destroy.call(this);v.remove(this)}}),l=l(s,{template:'<div class="Basis-Window" event-mousedown="mousedown" event-keypress="keypress"><div class="Basis-Window-Canvas"><div class="corner-left-top"/><div class="corner-right-top"/><div class="side-top"/><div class="side-left"/><div class="side-right"/><div class="content"/><div class="corner-left-bottom"/><div class="corner-right-bottom"/><div class="side-bottom"/></div><div class="Basis-Window-Layout"><div{ddtrigger} class="Basis-Window-Title"><div{title} class="Basis-Window-TitleCaption"/></div><div{content} class="Basis-Window-Content"><\!-- {childNodesHere} --\></div></div></div>',
action:{close:function(){this.close()},mousedown:function(){this.activate()},keypress:function(e){var d=n.key(e);d==n.KEY.ESCAPE?this.closeOnEscape&&this.close(0):d==n.KEY.ENTER&&n.sender(e).tagName!="TEXTAREA"&&n.kill(e)}},event_beforeShow:t("beforeShow"),event_open:t("open"),event_close:t("close"),event_active:t("active"),closeOnEscape:true,autocenter:true,autocenter_:false,modal:false,closed:true,moveable:true,title:"[no title]",init:function(e){s.prototype.init.call(this,e);i.hide(this.element);
e=this.tmpl.title.parentNode;this.setTitle(this.title);this.cssRule=m.uniqueRule(this.element);if(this.moveable&&u)this.dde=new u.MoveableElement({element:this.element,trigger:this.tmpl.ddtrigger||e,fixRight:false,fixBottom:false}),this.dde.addHandler({move:function(){this.autocenter=false;this.element.style.margin=0},over:function(){this.cssRule.setStyle(Object.slice(this.element.style,"left top".qw()));i.setStyle(this.element,{top:"",left:""})}},this);var d=Array.from(this.buttons).map(function(a){return Object.complete({click:(a.click||
this.close).bind(this)},a)},this),a=Object.slice(this,["buttonOk","buttonCancel"]),b;for(b in a){var c=a[b];d.push({name:b=="buttonOk"?"ok":"cancel",caption:c.caption||c.title||c,click:(c.click||this.close).bind(this)})}if(d.length)this.buttonPanel=new k({cssClassName:"Basis-Window-ButtonPlace",container:this.tmpl.content,childNodes:d});if(!this.titleButton||this.titleButton.close!==false)p(e).add("Basis-Window-Title-ButtonPlace-Close"),i.insert(e,i.createElement("SPAN.Basis-Window-Title-ButtonPlace",
i.createElement('A[href=#].Basis-Window-Title-CloseButton[event-click="close"]',i.createElement("SPAN","Close"))),i.INSERT_BEGIN);if(this.autocenter!==false)this.autocenter=this.autocenter_=true;this.thread&&this.thread.addHandler({finish:function(){this.closed&&i.remove(this.element)}},this);v.add(this)},setTitle:function(e){i.insert(i.clear(this.tmpl.title),e)},realign:function(){if(this.autocenter)this.element.style.margin="",this.cssRule.setStyle(this.element.offsetWidth?{left:"50%",top:"50%",
marginLeft:-this.element.offsetWidth/2+"px",marginTop:-this.element.offsetHeight/2+"px"}:{left:0,top:0})},activate:function(){this.select()},open:function(e){this.closed?(i.visibility(this.element,false),i.show(this.element),g.appendChild(this),this.closed=false,this.realign(),this.thread&&this.thread.start(true),this.event_beforeShow(e),i.visibility(this.element,true),this.buttonPanel&&this.buttonPanel.firstChild&&this.buttonPanel.firstChild.select(),this.event_open(e),this.event_active(e)):this.realign()},
close:function(e){if(!this.closed)this.thread?this.thread.start(1):i.remove(this.element),g.removeChild(this),this.autocenter=this.autocenter_,this.closed=true,this.event_close(e)},destroy:function(){this.dde&&(this.dde.destroy(),delete this.dde);s.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null;v.remove(this)}}),r=new q,g=new o({id:"Basis-WindowStack",childClass:l});g.addHandler({childNodesModified:function(){p(this.element).bool("IsNotEmpty",this.firstChild);var e=-1;if(this.lastChild){for(var d=
0,a;a=this.childNodes[d];d++)a.element.style.zIndex=2001+d*2,a.modal&&(e=d);this.lastChild.select()}e!=-1?r.capture(this.element,2E3+e*2):r.release()}});g.selection.addHandler({datasetChanged:function(){var e=this.pick(),d=g.lastChild;e?e.parentNode==g&&e!=d&&(g.insertBefore(e),g.event_childNodesModified({})):d&&this.add([d])}});n.onLoad(function(){i.insert(document.body,g.element,i.INSERT_BEGIN);for(var e=g.firstChild;e;e=e.nextSibling)e.realign()});f.namespace("basis.ui.window").extend({Window:l,
Blocker:q,getWindowTopZIndex:function(){return g.childNodes.length*2+2001}})})(basis);
(function(f){function l(g){g.selection&&!g.selection.itemCount&&(g=g.childNodes.search(false,"disabled"))&&g.select()}var i=f.Class,n=f.dom,m=Function.getter,p=f.cssom.classList,v=f.EventObject.createEvent,t=f.EventObject.event,u=f.ui.Node,w=f.ui.Container,s=f.ui.Control,v=i(s,{canHaveChildren:true,childClass:u,event_childEnabled:v("childEnabled","document","node")&&function(g,e){this.selection&&!this.selection.itemCount&&child.select();t.childEnabled.call(this,g,e)},event_childDisabled:v("childDisabled",
"document","node")&&function(g,e){l(this);t.childDisabled.call(this,g,e)},event_childNodesModified:function(g,e){l(this);s.prototype.event_childNodesModified.call(this,g,e)},item:function(g){g=isNaN(g)?this.indexOf(g):parseInt(g);return g.between(0,this.childNodes.length-1)?this.childNodes[g]:null},indexOf:function(g){return g instanceof this.childClass?this.childNodes.indexOf(g):this.childNodes.search(g,"name")?Array.lastSearchIndex:-1}}),o=i(w,{canHaveChildren:false,event_disable:function(){w.prototype.event_disable.call(this);
this.unselect();this.document&&this.document.event_childDisabled(this.document,this)},event_enable:function(){w.prototype.event_enable.call(this);this.document&&this.document.event_childEnabled(this.document,this)},template:'<div{element|selected} class="Basis-Tab" event-click="select"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{content}/>',templateUpdate:function(){var g=this.tmpl.titleText,
e=this.titleGetter(this);g.nodeValue=e==null||String(e)==""?"[no title]":e},action:{select:function(){this.isDisabled()||this.select()}},titleGetter:m("data.title"),groupId:0}),k=i(v,{childClass:o,localGroupingClass:{childClass:{template:'<div class="Basis-TabControl-TabGroup"/>'}},template:'<div class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div>'}),m=i(w,{event_select:function(){p(this.element).remove("Basis-Page-Hidden");
w.prototype.event_select.call(this)},event_unselect:function(){p(this.element).add("Basis-Page-Hidden");w.prototype.event_unselect.call(this)},template:'<div{element|selected} class="Basis-Page Basis-Page-Hidden"><div{content|childNodesElement} class="Basis-Page-Content"/></div>'}),q=i(v,{childClass:m,template:'<div class="Basis-PageControl"/>'}),u=i(o,{canHaveChildren:true,childClass:u,event_select:function(){o.prototype.event_select.call(this);p(this.tmpl.pageElement).remove("Basis-Page-Hidden")},
event_unselect:function(){o.prototype.event_unselect.call(this);p(this.tmpl.pageElement).add("Basis-Page-Hidden")},template:'<div{element|selected} class="Basis-TabSheet" event-click="select"><div{tabElement} class="Basis-Tab"><span class="Basis-Tab-Start"/><span class="Basis-Tab-Content"><span class="Basis-Tab-Caption">{titleText}</span></span><span class="Basis-Tab-End"/></div><div{pageElement} class="Basis-Page Basis-Page-Hidden"><div{content|pageContent|childNodesElement} class="Basis-Page-Content"/></div></div>',
destroy:function(){n.remove(this.tmpl.pageElement);o.prototype.destroy.call(this)}}),r=i(k,{childClass:u,template:'<div class="Basis-AccordionControl"><div{content|childNodesElement} class="Basis-AccordionControl-Content"/></div>'}),i=i(k,{childClass:u,template:'<div class="Basis-TabSheetControl"><div{tabsElement} class="Basis-TabControl"><div class="Basis-TabControl-Start"/><div{content|childNodesElement} class="Basis-TabControl-Content"/><div class="Basis-TabControl-End"/></div><div{pagesElement} class="Basis-PageControl"/></div>',
insertBefore:function(g,e){if(g=k.prototype.insertBefore.call(this,g,e))return this.tmpl.pagesElement&&this.tmpl.pagesElement.insertBefore(g.tmpl.pageElement,this.nextSibling?this.nextSibling.tmpl.pageElement:null),g},removeChild:function(g){if(g=k.prototype.removeChild.call(this,g))return this.tmpl.pagesElement&&g.element.appendChild(g.tmpl.pageElement),g},clear:function(g){this.childNodes.forEach(function(e){e.element.appendChild(e.tmpl.pageElement)});k.prototype.clear.call(this,g)}});f.namespace("basis.ui.tabs").extend({AbstractTabsControl:v,
TabControl:k,Tab:o,PageControl:q,Page:m,AccordionControl:r,TabSheetControl:i,TabSheet:u})})(basis);
(function(f){function l(a){return{hour:a.getHours(),day:a.getDate()-1,month:a.getMonth(),year:a.getFullYear()}}function i(a,b){var e={},g=d[a];if(g){var f=b.getFullYear(),k=b.getMonth(),i=b.getDate();f-=f%g[1];k=g[2]?k-k%g[2]:0;i=g[3]?i:1;e.periodStart=new Date(f,k,i);e.periodEnd=new Date(new Date(f+g[4],k+g[5],i+g[6])-1)}else e.periodStart=new Date(e.periodEnd=new Date(b));return e}var n=f.Class,m=f.dom,p=f.dom.event,v=Function.getter,t=f.cssom.classList,u=f.EventObject.createEvent,w=f.html.Template,
s=f.data.property.Property,o=f.ui.Node,k=f.ui.Container,q=f.ui.Control,r=function(a){var b=f.locale["ui.calendar"];return b?b[a]:a},g={};(function(){for(var a=32,b=2147483647;--a;)g[a]=b,b>>=1})();var e={century:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},decade:function(a){return a.periodStart.getFullYear()+" - "+a.periodEnd.getFullYear()},year:function(a){return a.periodStart.getFullYear()},quarter:function(a){return r("QUARTER").toLowerCase().format(1+a.periodStart.getMonth().base(3)/
3)},month:function(a){return r("MONTH").SHORT[a.periodStart.getMonth()].toLowerCase()},day:function(a){return a.periodStart.getDate()}},d={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},a=n(o,{canHaveChildren:false,template:new w('<a{element} class="Basis-Calendar-Node" event-click="click">{title|-}</a>'),templateAction:function(a,b){a=="click"?this.document.templateAction(a,
b,this):o.prototype.templateAction.call(this,a,b)},templateUpdate:function(a,b,d){if(!b||"periodStart"in d||"periodEnd"in d)this.tmpl.title.nodeValue=this.titleGetter(this.data),this.parentNode&&(a=t(this.element),a.bool("before",this.data.periodStart<this.parentNode.data.periodStart),a.bool("after",this.data.periodEnd>this.parentNode.data.periodEnd))},event_select:function(){o.prototype.event_select.call(this);m.focus(this.element)}}),b=n(k,{childClass:a,template:new w('<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"/></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'),
event_select:function(){k.prototype.event_select.call(this);t(this.tmpl.tabElement).add("selected")},event_unselect:function(){k.prototype.event_unselect.call(this);t(this.tmpl.tabElement).remove("selected")},event_update:function(a,b){k.prototype.event_update.call(this,a,b);var d=this.data,g;if("periodStart"in b||"periodEnd"in b){this.tmpl.titleText.nodeValue=this.getTitle(d.periodStart)||"-";this.firstChild||(g=[]);for(var f=i(this.nodePeriodName,(new Date(d.periodStart)).add(this.nodePeriodUnit,
-this.nodePeriodUnitCount*(this.getInitOffset(d.periodStart)||0))),l=0;l<this.nodeCount;l++)g?g.push({cssClassName:this.nodePeriodName,titleGetter:e[this.nodePeriodName],data:f}):this.childNodes[l].update(f),f=i(this.nodePeriodName,(new Date(f.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount));g&&this.setChildNodes(g);this.minDate=this.firstChild.periodStart;this.maxDate=this.lastChild.periodEnd}this.tmpl.tabTitleText.nodeValue=this.getTabTitle(d.selectedDate)||"-";(g=this.getNodeByDate(d.selectedDate))?
g.select():d.selectedDate&&this.minDate<=d.selectedDate&&d.selectedDate<=this.maxDate?this.setViewDate(d.selectedDate):this.selection.clear()},minDate:new Date,maxDate:new Date,isPrevPeriodEnabled:true,isNextPeriodEnabled:true,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:{},init:function(a){k.prototype.init.call(this,a);t(this.element).add("Basis-Calendar-Section-"+this.sectionName);p.addHandler(this.tmpl.tabElement,"click",this.select.bind(this,
false))},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(a){if(a&&this.data.periodStart<=a&&a<=this.data.periodEnd){a:{var b=this.childNodes;if(b.length){var d,e,g=0,f=b.length,k;do if(e=b[d=g+f>>1],a<(k=e.data.periodStart))f=d-1;else if(a>(e=e.data.periodEnd))g=d+1;else{a=a>=k&&a<=e?d:-1;break a}while(g<=f)}a=-1}if(a!=-1)return this.childNodes[a]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.update(i(this.periodName,new Date(+this.data.periodStart-1)))},
nextPeriod:function(){this.isNextPeriodEnabled&&this.update(i(this.periodName,new Date(+this.data.periodEnd+1)))},setViewDate:function(a){this.update(i(this.periodName,a))},getInitOffset:Function.$null});b.Month=n(b,{sectionName:"Month",periodName:"month",template:new w(Function.lazyInit(function(){return'<div{element|selected} class="Basis-Calendar-Section"><div class="Basis-Calendar-SectionTitle">{titleText}</div><div{content|childNodesElement} class="Basis-Calendar-SectionContent"><div class="Basis-Calendar-MonthWeekDays">'+
r("DAY").SHORT2.map(String.format,'<span class="Basis-Calendar-MonthWeekDays-Day">{0}</span>').join("")+'</div></div></div><div{tabElement} class="Basis-Calendar-SectionTab" event-click="select">{tabTitleText}</div>'})),nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:v("getDate()"),getTitle:function(a){return r("MONTH").FULL[a.getMonth()]+" "+a.getFullYear()},getInitOffset:function(a){return 1+((new Date(a)).set("day",1).getDay()+5)%7}});b.Year=n(b,{sectionName:"Year",periodName:"year",
nodePeriodName:"month",nodePeriodUnit:"month",getTabTitle:v("getMonth()",function(a){return r("MONTH").FULL[a]}),getTitle:v("getFullYear()")});b.YearDecade=n(b,{sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:v("getFullYear()"),getTitle:function(a){return a.getFullYear()+" - "+this.data.periodEnd.getFullYear()}});b.Century=n(b,{sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",
nodePeriodUnitCount:10,getTabTitle:function(a){if(a)return a=a.getFullYear(),a-=a%10,a+"-"+(Number(a.toString().substr(-2))+9).lead(2)},getInitOffset:function(){return 1}});b.YearQuarters=n(b,{sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});b.Quarter=n(b,{sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",getTitle:function(a){return[Math.floor(1+a.getMonth().base(3)/3),
r("QUARTER").toLowerCase(),a.getFullYear()].join(" ")}});n=n(q,{childClass:b,childFactory:Function(),template:new w(Function.lazyInit(function(){return'<div{element} class="Basis-Calendar"><div class="Basis-Calendar-Header"><div{sectionTabs} class="Basis-Calendar-SectionTabs" /></div><div class="Basis-Calendar-Body"><span event-click="move_prev" class="Basis-Calendar-ButtonPrevPeriod"><span>\u2039</span><span class="over"></span></span><span event-click="move_next" class="Basis-Calendar-ButtonNextPeriod"><span>\u203a</span><span class="over"></span></span><div{content|childNodesElement} class="Basis-Calendar-Content"/></div><div class="Basis-Calendar-Footer"><div class="Basis-Calendar-Footer-Date"><span class="Basis-Calendar-Footer-Label">'+
r("TODAY")+':</span><span event-click="select_today" class="Basis-Calendar-Footer-Value">{todayText}</span></div></div></div>'})),event_change:u("change"),event_childNodesModified:function(a,b){if(b.inserted)for(var d=0,e;e=b.inserted[d++];)e.setViewDate(this.date.value),e.update({selectedDate:this.selectedDate.value});q.prototype.event_childNodesModified.call(this,a,b);m.insert(m.clear(this.tmpl.sectionTabs),this.childNodes.map(v("tmpl.tabElement")));!this.selection.itemCount&&this.firstChild&&this.firstChild.select()},
templateAction:function(b,d,e){q.prototype.templateAction.call(this,b,d);if(e instanceof a)b=e.data.periodStart,d=this.selection.pick(),this.selectedDate.set((new Date(this.selectedDate.value)).add(d.nodePeriodUnit,this.selectedDate.value.diff(d.nodePeriodUnit,b))),this.nextSection(false);else if(!t(p.sender(d)).contains("disabled"))switch(b){case "select_today":this.selectedDate.set(new Date);break;case "select_current":this.selectDate(this.date.value);break;case "move_prev":this.selection.pick().prevPeriod();
break;case "move_next":this.selection.pick().nextPeriod();break;case "move_up":this.nextSection(true)}},date:null,minDate:null,maxDate:null,map:null,periodEnableByDefault:true,sections:["Month","Year","YearDecade"],init:function(a){this.todayDate=new s(new Date);this.selectedDate=new s(new Date(this.date||new Date));this.date=new s(new Date(this.date||new Date));this.selection={selectedDate:this.selectedDate,event_datasetChanged:function(a,b){this.constructor.prototype.event_datasetChanged.call(this,
a,b);var c=this.pick();c&&c.update({selectedDate:this.selectedDate.value})}};q.prototype.init.call(this,a);this.selectedDate.addHandler({change:function(a){for(var b=this.firstChild;b;b=b.nextSibling)b.update({selectedDate:a})}},this);this.todayDate.addLink(this.tmpl.todayText,null,v("toFormat('%D.%M.%Y')"));this.sections&&m.insert(this,this.sections.map(function(a){return new b[a]},this))},setSection:function(a){(a=this.childNodes.search("sectionName",a))&&a.select()},nextSection:function(a){var b=
this.selection.pick();(b=a?b.nextSibling:b.previousSibling)?(b.select(),b.setViewDate(this.selectedDate.value)):a||this.event_change()},selectDate:function(a){a-this.date.value!=0&&this.date.set(a)},getNextPeriod:function(a,b){if(!this.isNextPeriodEnabled(a,b))return false;if(this.map){var d=b?1:-1,e=b?"start":"till",f=b?"till":"start",k=(new Date(a)).add("millisecond",d),m=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(m){var o=i("year",k);for(o.periodEnd.getFullYear()==k.getFullYear()&&
(o[e]=k);!this.isPeriodEnabled(o.periodStart,o.periodEnd);)o=i("year",k.add("year",d));for(o[f]=i("month",o[e])[f];!this.isPeriodEnabled(o.periodStart,o.periodEnd);)o=i("month",k.add("month",d));var q=l(o[e]),f=l(o[f]);if(m=m[f.year]&&m[f.year][f.month]){this.periodEnableByDefault&&(e=g[o.periodEnd.getMonthDayCount()],m=m&e^e);for(e=q.day;e!=f.day+d;e+=d)if(m>>e&1){k=new Date(q.year,q.month,e+1);break}}else return i("day",o[e])}}return i("day",k)},isNextPeriodEnabled:function(a,b){if(!b&&this.minDate&&
this.minDate>a)return false;if(b&&this.maxDate&&this.maxDate<a)return false;if(this.map)if(this.periodEnableByDefault){if(!b&&this.minDate)return this.isPeriodEnabled(this.minDate,a);if(b&&this.maxDate)return this.isPeriodEnabled(a,this.maxDate)}else{var d=b?1:-1,e=a.getFullYear(),g=(new Date(a)).add("millisecond",d),f=g.getFullYear(),k=Object.keys(this.map.enable).filter(function(a){return d*a>=d*f}),l=k.length;if(l)for(var k=k.sort(function(a,b){return d*(a>b)||-d*(a<b)}),o=0;o<l;o++){var m=i("year",
new Date(k[o],0));if(this.isPeriodEnabled(b&&k[o]==e?g:m.periodStart,!b&&k[o]==e?g:m.periodEnd))return true}return false}return true},isPeriodEnabled:function(a,b){if(this.minDate&&this.minDate>b)return false;if(this.maxDate&&this.maxDate<a)return false;var d=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(d){var e=l(a),f=l(b),k,i,o,m=e.month,q=new Date(e.year,e.month),B=11-e.month,r=B+1+(f.year-e.year-1)*12+(f.month+1)-1;if(this.periodEnableByDefault){if(r==0)return!(k=d[e.year])||
!(i=k[e.month])||(i^2147483647)>>e.day&g[f.day-e.day+1];for(var p=0;p<=r;p++){if(!p||B==p%12)if(k=d[q.getFullYear()],!k)return true;i=k[m=q.getMonth()];if(!i)return true;o=g[q.getMonthDayCount()];if(p/r?p/r==1?(i&o^o)&g[f.day+1]:i&o^o:(i&o^o)>>e.day)return true;q.setMonth(m+1)}}else{if(r==0)return(k=d[e.year])&&(i=k[e.month])&&i>>e.day&g[f.day-e.day+1];for(p=0;p<=r;p++){if(!p||B==p%12||!k)if(k=d[q.getFullYear()],!k){p+=12;q.setMonth(m+12);continue}if((i=k[m=q.getMonth()])&&(p/r?p/r==1?i&g[f.day+1]:
i:i>>e.day))return true;q.setMonth(m+1)}}return false}return true},destroy:function(){q.prototype.destroy.call(this);this.date.destroy();this.todayDate.destroy()}});f.namespace("basis.ui.calendar").extend({Calendar:n,CalendarSection:b})})(basis);
(function(f){function l(a,b){return new p(a.source.replace("<\!-- {fieldPlace} --\>",b))}var i=f.Class,n=f.dom.event,m=f.dom,p=f.html.Template,v=f.Cleaner,t=Object.complete,u=Function.getter,w=f.cssom.classList,s=f.data.property.Property,o=f.EventObject,k=f.dom.wrapper.Selection,q=f.ui.Control,r=f.ui.Node,g=f.ui.Container,e=o.createEvent,d=new p('<div{element|selected|sampleContainer} class="Basis-Field"><div class="Basis-Field-Title"><label><span{title}>{titleText}</span></label></div><div{content} class="Basis-Field-Container"><\!-- {fieldPlace} --\></div></div>'),
a=i(r,{canHaveChildren:false,template:d,nextFieldOnEnter:true,serializable:true,event_select:function(){m.focus(this.tmpl.field,true);r.prototype.event_select.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");r.prototype.event_disable.call(this)},event_input:e("input"),event_change:e("change"),event_keydown:e("keydown"),event_keypress:e("keypress"),event_keyup:e("keyup")&&
function(a){if(this.nextFieldOnEnter){var b=n.key(a);b==n.KEY.ENTER||b==n.KEY.CTRL_ENTER?(n.cancelDefault(a),this.nextFieldFocus()):this.setValid()}o.event.keyup.call(this,a)},event_focus:e("focus")&&function(a){this.valid&&this.setValid();o.event.focus.call(this,a)},event_blur:e("blur")&&function(a){this.validate(true);o.event.blur.call(this,a)},init:function(a){r.prototype.init.call(this,a);this.name=this.name||"";if(this.tmpl.titleText)this.tmpl.titleText.nodeValue=this.title||"";if(this.tmpl.field){n.addHandler(this.tmpl.field,
"keydown",this.keydown,this);n.addHandler(this.tmpl.field,"keyup",this.keyup,this);n.addHandler(this.tmpl.field,"keypress",this.keypress,this);n.addHandler(this.tmpl.field,"blur",this.blur,this);n.addHandler(this.tmpl.field,"focus",this.focus,this);n.addHandler(this.tmpl.field,"change",this.change,this);n.addHandler(this.tmpl.field,"input",this.input,this);if(this.name)this.tmpl.field.name=this.name;if(this.size)this.tmpl.field.size=this.size}if(!this.validators)this.validators=[];this.setSample(this.sample);
this.minLength&&this.setMinLength(this.minLength);this.maxLength&&this.setMaxLength(this.maxLength);this.readOnly&&this.setReadOnly(this.readOnly);if(this.defaultValue!==this.value)this.defaultValue=this.value,this.setDefaultValue()},setReadOnly:function(a){a?this.tmpl.field.setAttribute("readonly","readonly",0):this.tmpl.field.removeAttribute("readonly",0)},setDefaultValue:function(){this.setValue(this.defaultValue);this.setValid()},setSample:function(a){if(this.tmpl.sampleContainer&&a)this.sampleElement?
m.insert(m.clear(this.sampleElement),a):m.insert(this.tmpl.sampleContainer,this.sampleElement=m.createElement("SPAN.Basis-Field-Sample",a));else if(this.sampleElement)m.remove(this.sampleElement),this.sampleElement=null},getValue:function(){return this.tmpl.field.value},setValue:function(a){a=a||"";if(this.tmpl.field.value!=a)this.tmpl.field.value=a,this.event_change()},setMaxLength:function(a){this.maxLength=a},setMinLength:function(a){this.minLength=a},attachValidator:function(a,b){this.validators.add(a)&&
b&&this.validate()},detachValidator:function(a,b){this.validators.remove(a)&&b&&this.validate()},change:function(a){this.event_change(a)},input:function(a){this.event_input(a)},keydown:function(a){this.event_keydown(a)},keyup:function(a){this.event_keyup(a)},keypress:function(a){this.event_keypress(a)},blur:function(a){this.event_blur(a)},focus:function(a){this.event_focus(a)},select:function(){this.unselect();r.prototype.select.apply(this,arguments)},setValid:function(a,b){var c=w(this.element);
typeof a=="boolean"?(c.bool("invalid",!a),c.bool("valid",a),b?this.element.title=b:this.element.removeAttribute("title")):(c.remove("invalid"),c.remove("valid"),this.element.removeAttribute("title"));this.valid=a},validate:function(a){var b;this.setValid();for(var c=0;c<this.validators.length;c++)if(b=this.validators[c](this))return a||this.setValid(false,b.message),b;this.getValue()!=""&&this.setValid(true)},nextFieldFocus:function(){var a=m.axis(this,m.AXIS_FOLLOWING_SIBLING).search(true,"selectable");
a?a.select():this.parentNode&&this.parentNode.submit&&this.parentNode.submit()},destroy:function(){n.clearHandlers(this.element);this.tmpl.field&&n.clearHandlers(this.tmpl.field);this.button&&(n.clearHandlers(this.button),delete this.button);this.validators.clear();r.prototype.destroy.call(this);delete this.sampleElement;delete this.sampleContainer;delete this.defaultValue}});a.create=function(b,c){b={radiogroup:"RadioGroup",checkgroup:"CheckGroup"}[b.toLowerCase()]||b.capitalize();if(a[b])return new a[b](c);
else throw Error("Wrong field type `{0}`".format(b));};a.Hidden=i(a,{selectable:false,template:new p('<input{element|field} type="hidden"/>')});a.Text=i(a,{template:l(d,'<input{field} type="text"/>'),init:function(b){a.prototype.init.call(this,b);this.minLength&&this.attachValidator(A.MinLength);this.autocomplete&&this.tmpl.field.setAttribute("autocomplete",this.autocomplete)},setMaxLength:function(b){this.tmpl.field.setAttribute("maxlength",b,0);a.prototype.setMaxLength.call(this,b)}});a.Password=
i(a.Text,{template:l(d,'<input{field} type="password"/>')});a.File=i(a,{template:l(d,'<input{field} type="file"/>')});a.Textarea=i(a,{nextFieldOnEnter:false,template:l(d,"<textarea{field}/>"),init:function(b){this.counter=m.createElement(".counter",a.LOCALE.Textarea.SYMBOLS_LEFT+": ",m.createText(0));a.prototype.init.call(this,b);this.minLength&&this.attachValidator(A.MinLength);this.maxLength&&this.attachValidator(A.MaxLength);n.addHandler(this.tmpl.field,"keyup",this.updateCounter,this);n.addHandler(this.tmpl.field,
"input",this.updateCounter,this);window.opera&&n.addHandler(this.tmpl.field,"focus",function(){this.contentEditable=true;this.contentEditable=false})},updateCounter:function(){var a=this.maxLength-this.getValue().length;this.counter.lastChild.nodeValue=a>=0?a:0},setValue:function(b){a.prototype.setValue.call(this,b);this.updateCounter()},setMaxLength:function(b){a.prototype.setMaxLength.call(this,b);b?(this.updateCounter(),m.insert(this.tmpl.sampleContainer,this.counter)):m.remove(this.counter)},
destroy:function(){delete this.counter;a.prototype.destroy.call(this)}});a.Checkbox=i(a,{value:false,template:new p('<div{element} class="Basis-Field Basis-Field-Checkbox"><div{content} class="Basis-Field-Container"><label><input{field} type="checkbox"/><span>{titleText}</span></label></div></div>'),invert:function(){this.setValue(!this.getValue())},setValue:function(a){var b=this.tmpl.field.checked;this.tmpl.field.checked=!!a;b!=this.tmpl.field.checked&&this.event_change()},getValue:function(){return this.tmpl.field.checked}});
a.Label=i(a,{cssClassName:"Basis-Field-Label",template:l(d,"<label{field}>{fieldValueText}</label>"),valueGetter:Function.$self,event_change:function(){a.prototype.event_change.apply(this,arguments);this.tmpl.fieldValueText.nodeValue=this.valueGetter(this.getValue())}});var b=i(r,{canHaveChildren:false,titleGetter:function(a){return a.title||a.getValue()},valueGetter:u("value"),getTitle:function(){return this.titleGetter(this)},getValue:function(){return this.valueGetter(this)}}),c={datasetChanged:function(){this.event_change()}},
h=i(a,g,{childClass:b,template:a.prototype.template,multipleSelect:false,init:function(b){this.selection=new k({multiple:!!this.multipleSelect});this.selection.addHandler(c,this);a.prototype.init.call(this,b);v.add(this)},getValue:function(){var a=this.selection.getItems().map(u("getValue()"));return!this.selection.multiple?a[0]:a},setValue:function(a){var b={};(this.multipleSelect?Array.from(a):[a]).forEach(function(a){b[a]=true});for(var a=[],c=this.firstChild;c;c=c.nextSibling)b[c.getValue()]&&
a.push(c);this.selection.set(a)},destroy:function(){a.prototype.destroy.call(this);v.remove(this)}});h.Item=b;g=i(b,{event_select:function(){this.tmpl.field.checked=true;b.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;b.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");r.prototype.event_disable.call(this)},
template:new p('<label{element} class="Basis-RadioGroup-Item" event-click="select"><input{field} type="radio" class="radio"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,c,d){b.prototype.templateUpdate.call(this,a,c,d);a.field.value=this.getValue();a.titleText.nodeValue=this.getTitle()},templateAction:function(a,c){a=="select"&&!this.isDisabled()&&this.select();b.prototype.templateAction.call(this,a,c)}});a.RadioGroup=i(h,{childClass:g,template:l(d,'<div{field|childNodesElement} class="Basis-RadioGroup"></div>'),
childFactory:function(a){a=h.prototype.childFactory.call(this,a);if(this.name)a.tmpl.field.name=this.name;return a}});a.RadioGroup.Item=g;g=i(b,{event_select:function(){this.tmpl.field.checked=true;b.prototype.event_select.call(this)},event_unselect:function(){this.tmpl.field.checked=false;b.prototype.event_unselect.call(this)},event_enable:function(){this.tmpl.field.removeAttribute("disabled");r.prototype.event_enable.call(this)},event_disable:function(){this.tmpl.field.setAttribute("disabled","disabled");
r.prototype.event_disable.call(this)},template:new p('<label{element} event-click="click"><input{field} type="checkbox"/><span{content}>{titleText}</span></label>'),templateUpdate:function(a,c,d){b.prototype.templateUpdate.call(this,a,c,d);this.tmpl.field.value=this.getValue();this.tmpl.titleText.nodeValue=this.getTitle()},templateAction:function(a,c){a=="click"&&!this.isDisabled()&&(this.select(this.parentNode.multipleSelect),n.sender(c).tagName!="INPUT"&&n.kill(c));b.prototype.templateAction.call(this,
a,c)}});a.CheckGroup=i(h,{childClass:g,multipleSelect:true,template:l(d,'<div{field|childNodesElement} class="Basis-CheckGroup"></div>')});a.CheckGroup.Item=g;g=i(b,{event_select:function(){this.parentNode&&this.parentNode.setValue(this.getValue())},event_unselect:function(){this.parentNode&&this.parentNode.setValue()},template:new p("<option{element|field}>{titleText}</option>"),templateUpdate:function(a,c,d){b.prototype.templateUpdate.call(this,a,c,d);a.field.value=this.getValue();a.field.text=
this.getTitle()}});a.Select=i(h,{childClass:g,template:l(d,"<select{field|childNodesElement}/>"),event_keyup:function(a,b){this.change();h.prototype.event_keyup.call(this,a,b)},setValue:function(a){(a=this.childNodes.search(a,"getValue()"))?this.selection.set([a]):this.selection.clear()}});a.Select.Item=g;var y={show:function(){w(this.tmpl.field).add("Basis-DropdownList-Opened")},hide:function(){w(this.tmpl.field).remove("Basis-DropdownList-Opened")}},g=i(b,{template:new p('<div{element} class="Basis-Combobox-Item" event-click="click">{titleText}</div>'),
templateUpdate:function(a,c,d){b.prototype.templateUpdate.call(this,a,c,d);a.titleText.nodeValue=this.getTitle()},templateAction:function(a,c){a=="click"&&!this.isDisabled()&&(this.select(),this.parentNode&&this.parentNode.hide(),n.kill(c));b.prototype.templateAction.call(this,a,c)}}),j={keyup:function(a){var b=n.key(a),c=this.selection.pick();switch(b){case n.KEY.DOWN:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=m.axis(c?c:this.firstChild,m.AXIS_FOLLOWING_SIBLING).search(false,
"disabled");break;case n.KEY.UP:if(a.altKey)return this.popup.visible?this.hide():!this.isDisabled()?this.show():null;c=c?m.axis(c,m.AXIS_PRESCENDING_SIBLING).search(false,"disabled"):this.firstChild}c&&(c.select(),m.focus(this.tmpl.field))},keydown:function(a){var b=n.key(a);b==n.KEY.DOWN||b==n.KEY.UP?n.kill(a):b==n.KEY.ENTER&&(this.popup.visible&&this.hide(),n.kill(a))}};a.Combobox=i(h,{childClass:g,event_enable:function(){this.delegate&&this.delegate.select&&this.delegate.select();h.prototype.event_enable.call(this)},
event_change:function(){h.prototype.event_change.call(this);var a=this.getValue();this.property&&this.property.set(a);if(this.hidden)this.hidden.value=a;this.satellite&&this.satellite.captionItem.setDelegate(this.selection.pick())},caption:null,popup:null,property:null,template:l(d,'<span{field} class="Basis-DropdownList" event-click="click" tabindex="0"><span class="Basis-DropdownList-Caption"><\!--{captionItem}--\></span><span class="Basis-DropdownList-Trigger"/></span><div{content|childNodesElement} class="Basis-DropdownList-PopupContent"/>'),
templateAction:function(a,b){a=="click"&&(this.isDisabled()||this.popup.visible?this.hide():this.show({}),n.kill(b));h.prototype.templateAction.call(this,a,b)},init:function(a){if(!f.ui.popup)throw Error("basis.ui.popup required for DropDownList");if(this.property)this.value=this.property.value;this.satelliteConfig={captionItem:{instanceOf:this.childClass,delegate:Function.getter("selection.pick()"),config:{getTitle:function(){return this.delegate&&this.delegate.getTitle()},getValue:function(){return this.delegate&&
this.delegate.getValue()},handler:{delegateChanged:function(){this.event_update(this,{})}}}}};h.prototype.init.call(this,a);this.satellite.captionItem.setDelegate(this.selection.pick());n.addHandlers(this.tmpl.field,j,this);if(this.name)m.insert(this.tmpl.field,this.hidden=m.createElement("INPUT[type=hidden][name={0}]".format(String(this.name).quote())));this.popup=new f.ui.popup.Popup(t({cssClassName:"Basis-DropdownList-Popup",autorotate:1,ignoreClickFor:[this.tmpl.field],thread:this.thread,content:this.childNodesElement,
handler:y,handlerContext:this},this.popup));this.property&&this.property.addLink(this,this.setValue)},show:function(){this.popup.show(this.tmpl.field);this.select()},hide:function(){this.popup.hide()},getTitle:function(){var a=this.selection.pick();return a&&a.getTitle()},getValue:function(){var a=this.selection.pick();return a&&a.getValue()},setValue:function(a){this.getValue()!=a&&((a=this.childNodes.search(a,"getValue()"))&&!a.isDisabled()?this.selection.set([a]):this.selection.clear())},destroy:function(){if(this.property)this.property.removeLink(this),
this.property=null;this.popup.destroy();this.popup=null;h.prototype.destroy.call(this)}});a.Combobox.Item=g;var x=i(null,{init:function(a,b){this.field=a;this.message=b}}),A={NO_LOCALE:"There is no locale for this error",RegExp:function(a){a.constructor!=RegExp&&(a=RegExp(a));return function(b){var c=b.getValue();if(c!=""&&!c.match(a))return new x(b,A.LOCALE.RegExp.WRONG_FORMAT||A.NO_LOCALE)}},Required:function(a){var b=a.getValue();if(Function.$isNull(b)||b=="")return new x(a,A.LOCALE.Required.MUST_BE_FILLED||
A.NO_LOCALE)},Number:function(a){var b=a.getValue();if(isNaN(b))return new x(a,A.LOCALE.Number.WRONG_FORMAT||A.NO_LOCALE)},Currency:function(a){var b=a.getValue();if(isNaN(b))return new x(a,A.LOCALE.Currency.WRONG_FORMAT||A.NO_LOCALE);if(b<=0)return new x(a,A.LOCALE.Currency.MUST_BE_GREATER_ZERO||A.NO_LOCALE)},Email:function(a){var b=a.getValue().trim();if(b!=""&&!b.match(/^[a-z0-9\.\-\_]+\@(([a-z][a-z0-9\-]*\.)+[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})$/i))return new x(a,A.LOCALE.Email.WRONG_FORMAT||A.NO_LOCALE)},
Url:function(a){var b=a.getValue().trim();if(b!=""&&!b.match(/^(https?\:\/\/)?((\d{1,3}\.){3}\d{1,3}|([a-zA-Z][a-zA-Z\d\-]+\.)+[a-zA-Z]{2,6})(:\d+)?(\/[^\?]*(\?\S(\=\S*))*(\#\S*)?)?$/i))return new x(a,A.LOCALE.Url.WRONG_FORMAT||A.NO_LOCALE)},MinLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?b.length:String(b).length)<a.minLength)return new x(a,(A.LOCALE.MinLength.MUST_BE_LONGER_THAN||A.NO_LOCALE).format(a.minLength))},MaxLength:function(a){var b=a.getValue();if((Function.$isNotNull(b.length)?
b.length:String(b).length)>a.maxLength)return new x(a,(A.LOCALE.MaxLength.MUST_BE_SHORTER_THAN||A.NO_LOCALE).format(a.maxLength))}},e=i(q,{canHaveChildren:true,childClass:a,childFactory:function(b){return a.create(b.type||"text",b)},onSubmit:Function.$false,event_reset:e("reset"),event_disable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_disable();q.prototype.event_disable.call(this)},event_enable:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.disabled||a.event_enable();
q.prototype.event_enable.call(this)},template:new p('<div{element} class="Basis-FormContent"/>'),getFieldByName:function(a){return this.childNodes.search(a,"name")},getFieldById:function(a){return this.childNodes.search(a,"id")},serialize:function(){for(var a={},b=this.firstChild;b;b=b.nextSibling)b.serializable&&b.name&&(a[b.name]=b.getValue());return a},setData:function(a,b){this.loadData(a,b)},loadData:function(a,b){for(var c=Object.keys(a),d=this.firstChild;d;d=d.nextSibling)c.indexOf(d.name)!=
-1?d.setValue(a[d.name]):d.setDefaultValue(),d.setValid();b||this.validate()},setDefaultState:function(){this.reset()},reset:function(){for(var a=this.firstChild;a;a=a.nextSibling)a.setDefaultValue();this.event_reset()},validate:function(){for(var a,b=[],c=this.firstChild;c;c=c.nextSibling)(a=c.validate())&&b.push(a);return b.length?(b[0].field.select(),b):true},submit:function(){if(this.validate()===true&&this.onSubmit)this.onSubmit(this.serialize())}}),g=i(e,{template:new p('<form{element|formElement} class="Basis-Form"><div{content|childNodesElement} class="Basis-FormContent"/></form>'),
method:"POST",init:function(a){this.selection=false;q.prototype.init.call(this,a);if(this.target)this.formElement.target=this.target;if(this.action)this.formElement.action=this.action;if(this.enctype)this.formElement.enctype=this.enctype;n.addHandler(this.formElement,"submit",this.submit,this);this.formElement.onsubmit=this.submit;this.setMethod(this.method)},setMethod:function(a){this.formElement.method=a?a.toUpperCase():"POST"},submit:function(){if(this.validate()===true&&!this.onSubmit())if(this.tagName==
"FORM")return false;else this.formElement.submit();return true}}),z=i(s,{matchFunction:function(a,b){if(!b){var c=a._m||this.textNodeGetter(a);c.constructor!=Array&&(c=[c]);for(var d=false,e=0;e<c.length;e++){var g=c[e];if(g){var f=false,h=g.nodeValue.split(this.rx);if(h.length>1){if(!a._x)a._x=[];if(!a._m)a._m=[];m.replace(a._x[e]||g,a._x[e]=m.createElement("SPAN.matched",m.wrap(h,this.map)));a._m[e]=g;f=d=true}a._x&&a._x[e]&&!f&&(m.replace(a._x[e],a._m[e]),a._x[e]=a._m[e])}}return d}if(a._x){for(e=
0;e<a._x.length;e++)a._x[e]&&m.replace(a._x[e],a._m[e]);delete a._x;delete a._m}return false},event_change:function(a){this.rx=this.regexpGetter(a);s.prototype.event_change.call(this,a)},extendConstructor_:true,init:function(){var a=this.startPoints||"";this.textNodeGetter=u(this.textNodeGetter||"tmpl.titleText");if(typeof this.regexpGetter!="function")this.regexpGetter=function(b){return RegExp("("+a+")("+b.forRegExp()+")","i")};this.map={};this.map[this.wrapElement||"SPAN.match"]=function(a,b){return b%
3==2};s.prototype.init.call(this,"",this.handlers,String.trim)}}),C={childNodesModified:function(a,b){if(b.inserted)for(var c=0,d;d=b.inserted[c];c++)this.matchFunction(d,this.value=="")}},E=i(z,{event_change:function(a){z.prototype.event_change.call(this,a);this.match()},init:function(a){z.prototype.init.call(this,a);this.node.addHandler(C,this)},match:function(){for(var a=this.node.firstChild;a;a=a.nextSibling)this.matchFunction(a,this.value=="")}}),F=i(z,{event_change:function(a){z.prototype.event_change.call(this,
a);this.node.setMatchFunction(a?this.matchFunction.bind(this):null)}}),i=i(a.Text,{cssClassName:"Basis-MatchInput",matchFilterClass:F,event_keyup:function(b){this.matchFilter.set(this.tmpl.field.value);a.Text.prototype.event_keyup.call(this,b)},event_change:function(b){this.matchFilter.set(this.tmpl.field.value);a.Text.prototype.event_change.call(this,b)},init:function(b){a.Text.prototype.init.call(this,b);this.matchFilter=new this.matchFilterClass(this.matchFilter)}});f.namespace("basis.ui.form").extend({createFieldTemplate:function(a){return l(d,
a)},FormContent:e,Form:g,Field:a,Validator:A,ValidatorError:x,RadioGroup:a.RadioGroup,CheckGroup:a.CheckGroup,Combobox:a.Combobox,ComplexField:h,Matcher:E,MatchFilter:F,MatchInput:i})})(basis);
(function(){function f(g,e){if(window[g])return window[g];for(var g=g.charAt(0).toUpperCase()+g.substr(1),d=0,a;a=w[d++];)if(window[a+g])return window[a+g];return e}var l=basis.Class,i=basis.dom,n=basis.EventObject,m=basis.dom.event,p=basis.cssom.classList,v=false,t=false,u;(function(){function g(d,a){for(var b;b=a.shift();)if(typeof d.style[b]!="undefined")return b;return false}var e=i.createElement("");(u=g(e,["transform","WebkitTransform","msTransform","MozTransform","OTransform"]))&&(v=true);
if(v&&(g(e,["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])||"webkitPerspective"in document.documentElement.style))t=true})();var w=["webkit","moz","o","ms"],s=f("requestAnimationFrame",function(g){return window.setTimeout(g,15)}),o=f("cancelRequestAnimFrame",clearInterval),k=l(n,{minScrollDelta:0,preventScrollX:false,preventScrollY:false,scrollPropertyType:"style",event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),
event_startInertia:n.createEvent("startInertia","scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(g){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=this.viewportY=this.viewportX=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=
this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;n.prototype.init.call(this,g);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.scrollPropertyType=="scroll"?(i.setStyle(this.targetElement,{overflow:"hidden"}),this.updateElementPosition=this.updatePosition_scrollTopLeft,this.calcDimentions=
this.calcDimentions_scrollTopLeft):(i.setStyle(this.targetElement,{position:"relative"}),this.updateElementPosition=v?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft,this.calcDimentions=this.calcDimentions_styleTopLeft);if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_scrollTopLeft:function(){if(this.scrollX)this.targetElement.scrollLeft=this.viewportX;if(this.scrollY)this.targetElement.scrollTop=this.viewportY},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=
-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var g=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",e=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px",d={};d[u]="translate("+g+", "+e+")"+(t?" translateZ(0)":"");i.setStyle(this.targetElement,d)},calcDimentions_scrollTopLeft:function(){this.minPositionX=0;this.maxPositionX=this.targetElement.scrollWidth-this.targetElement.offsetWidth;
this.scrollX=!this.preventScrollX&&this.maxPositionX>0;this.minPositionY=0;this.maxPositionY=this.targetElement.scrollHeight-this.targetElement.offsetHeight;this.scrollY=!this.preventScrollY&&this.maxPositionY>0},calcDimentions_styleTopLeft:function(){this.minPositionY=this.minPositionX=0;var g=this.targetElement.offsetParent;if(g)this.maxPositionX=this.targetElement.scrollWidth-g.offsetWidth,this.scrollX=!this.preventScrollX&&this.maxPositionX>0,this.maxPositionY=this.targetElement.scrollHeight-
g.offsetHeight,this.scrollY=!this.preventScrollY&&this.maxPositionY>0},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating)this.targetElement.offsetWidth&&
this.calcDimentions(),this.startViewportX=this.viewportX,this.startViewportY=this.viewportY,this.isUpdating=true,this.updateFrameHandle=this.nextFrame(),this.startTime=this.lastUpdateTime=Date.now(),this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=false,o(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(g){this.stopUpdate();this.panningActive=true;this.lastMouseX=m.mouseX(g);this.lastMouseY=m.mouseY(g);
this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,this);m.addHandler(document,"touchend",this.onMouseUp,this);m.cancelDefault(g)},onMouseMove:function(g){(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var e=Date.now(),d=e-this.lastMotionUpdateTime;this.lastMotionUpdateTime=e;if(d){if(this.minScrollDeltaXReached||
!this.minScrollDeltaYReached)e=m.mouseX(g),d=this.lastMouseX-e,this.lastMouseX=e,this.viewportTargetX+=d;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)g=m.mouseY(g),e=this.lastMouseY-g,this.lastMouseY=g,this.viewportTargetY+=e;if(this.minScrollDelta>0&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=
true;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var g=Date.now()-this.lastMotionUpdateTime,g=Math.max(10,g);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,g/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,g/100)));m.removeHandler(document,
"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(g){g||(g=Date.now());var e=g-this.lastUpdateTime;this.lastUpdateTime=g;if(e){if(this.panningActive){var d;if(this.scrollX&&(d=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,d))this.currentVelocityX=Math.abs(d)/
e,this.currentDirectionX=d==0?0:d<0?-1:1;if(this.scrollY&&(d=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,d))this.currentVelocityY=Math.abs(d)/e,this.currentDirectionY=d==0?0:d<0?-1:1}else if(this.processInertia){if(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*e,this.currentVelocityX*=0.94,this.currentVelocityX<0.0010||this.viewportX<this.minPositionX||this.viewportX>this.maxPositionX))this.viewportTargetX=Math.min(this.maxPositionX,
Math.max(this.minPositionX,this.viewportTargetX)),this.currentVelocityX=0;if(this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*e,this.currentVelocityY*=0.94,this.currentVelocityY<0.0010||this.viewportY<this.minPositionY||this.viewportY>this.maxPositionY))this.viewportTargetY=Math.min(this.maxPositionY,Math.max(this.minPositionY,this.viewportTargetY)),this.currentVelocityY=0;if(this.currentVelocityX==0&&this.currentVelocityY==0)this.processInertia=false}e=d=0;this.scrollX&&
(d=this.viewportTargetX-this.viewportX,this.viewportX+=d*(this.panningActive||this.currentVelocityX>0?1:0.12));this.scrollY&&(e=this.viewportTargetY-this.viewportY,this.viewportY+=e*(this.panningActive||this.currentVelocityY>0?1:0.12));d=!this.scrollX||this.currentVelocityX<0.0010&&Math.abs(d)<0.1;e=!this.scrollY||this.currentVelocityY<0.0010&&Math.abs(e)<0.1;if(!this.panningActive&&d&&e){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();
this.event_updatePosition(this,g,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,this.targetElement)},setPosition:function(g,e){this.viewportX=g;this.viewportY=e;this.isUpdating?this.stopUpdate():(this.resetVariables(),this.updateElementPosition())},setTargetPosition:function(g,e){this.viewportTargetX=g||0;this.viewportTargetY=e||0;this.startUpdate();this.processInertia=true},calcExpectedPosition:function(g){var e=
0,d=g=="x"?this.currentVelocityX:this.currentVelocityY,a=g=="x"?this.currentDirectionX:this.currentDirectionY,b=g=="x"?this.viewportTargetX:this.viewportTargetY,c=g=="x"?this.minPositionX:this.minPositionY,g=g=="x"?this.maxPositionX:this.maxPositionY;if(d)for(var f=Math.log(0.0010/d)/Math.log(0.94),k=0;k<f;k++)e+=a*d*15,d*=0.94;return Math.max(c,Math.min(g,b+e))},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),
q=l(n,{minScrollDelta:0,scrollX:true,scrollY:true,event_start:n.createEvent("start","scrollerObject"),event_finish:n.createEvent("finish","scrollerObject"),event_startInertia:n.createEvent("startInertia","scrollerObject"),event_updatePosition:n.createEvent("updatePosition","scrollerObject","scrollPosition"),init:function(g){this.startTime=this.lastUpdateTime=this.lastMotionUpdateTime=this.updateFrameHandle=this.lastViewportTargetY=this.lastViewportTargetX=this.viewportTargetY=this.viewportTargetX=
this.viewportY=this.viewportX=this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=this.lastMouseY=this.lastMouseX=0;this.panningActive=this.processInertia=false;n.prototype.init.call(this,g);this.targetElement&&(m.addHandler(this.targetElement,"mousedown",this.onMouseDown,this),m.addHandler(this.targetElement,"touchstart",this.onMouseDown,this));this.onUpdateHandler=this.onUpdate.bind(this);this.updateElementPosition=v?this.updatePosition_styleTransform:this.updatePosition_styleTopLeft;
if(this.minScrollDelta==0)this.minScrollDeltaXReached=this.minScrollDeltaYReached=true},updatePosition_styleTopLeft:function(){if(this.scrollX)this.targetElement.style.left=-this.viewportX+"px";if(this.scrollY)this.targetElement.style.top=-this.viewportY+"px"},updatePosition_styleTransform:function(){var g=-(this.isUpdating?this.viewportX:Math.round(this.viewportX))+"px",e=-(this.isUpdating?this.viewportY:Math.round(this.viewportY))+"px";this.targetElement.style[u]="translate("+g+", "+e+")"+(t?" translateZ(0)":
"")},resetVariables:function(){this.viewportTargetX=this.viewportX;this.viewportTargetY=this.viewportY;this.lastViewportTargetX=this.viewportTargetX;this.lastViewportTargetY=this.viewportTargetY;this.currentDirectionY=this.currentDirectionX=this.currentVelocityY=this.currentVelocityX=0;this.processInertia=this.minScrollDeltaYReached=this.minScrollDeltaXReached=false},startUpdate:function(){if(!this.isUpdating)this.isUpdating=true,this.updateFrameHandle=this.nextFrame(),this.lastUpdateTime=Date.now(),
this.event_start(this)},stopUpdate:function(){if(this.isUpdating)this.resetVariables(),this.isUpdating=false,o(this.updateFrameHandle),this.updateElementPosition(),this.event_finish(this)},onMouseDown:function(g){this.stopUpdate();this.panningActive=true;this.lastMouseX=m.mouseX(g);this.lastMouseY=m.mouseY(g);this.lastMotionUpdateTime=Date.now();m.addHandler(document,"mousemove",this.onMouseMove,this);m.addHandler(document,"touchmove",this.onMouseMove,this);m.addHandler(document,"mouseup",this.onMouseUp,
this);m.addHandler(document,"touchend",this.onMouseUp,this);m.cancelDefault(g)},onMouseMove:function(g){(this.minScrollDelta==0||this.minScrollDeltaYReached||this.minScrollDeltaXReached)&&this.startUpdate();var e=Date.now(),d=e-this.lastMotionUpdateTime;this.lastMotionUpdateTime=e;if(d){if(this.minScrollDeltaXReached||!this.minScrollDeltaYReached)e=m.mouseX(g),d=this.lastMouseX-e,this.lastMouseX=e,this.viewportTargetX+=d;if(this.minScrollDeltaYReached||!this.minScrollDeltaXReached)g=m.mouseY(g),e=
this.lastMouseY-g,this.lastMouseY=g,this.viewportTargetY+=e;if(this.minScrollDelta>0&&!this.minScrollDeltaXReached&&!this.minScrollDeltaYReached){if(Math.abs(this.viewportTargetX-this.viewportX)>this.minScrollDelta)this.minScrollDeltaXReached=true;if(Math.abs(this.viewportTargetY-this.viewportY)>this.minScrollDelta)this.minScrollDeltaYReached=true;if(this.minScrollDeltaYReached)this.viewportTargetX=this.viewportX,this.currentDirectionX=0;if(this.minScrollDeltaXReached)this.viewportTargetY=this.viewportY,
this.currentDirectionY=0}}},onMouseUp:function(){this.panningActive=false;this.processInertia=true;var g=Date.now()-this.lastMotionUpdateTime,g=Math.max(10,g);this.lastMotionUpdateTime=0;this.scrollX&&(this.currentVelocityX*=1-Math.min(1,Math.max(0,g/100)));this.scrollY&&(this.currentVelocityY*=1-Math.min(1,Math.max(0,g/100)));m.removeHandler(document,"mousemove",this.onMouseMove,this);m.removeHandler(document,"touchmove",this.onMouseMove,this);m.removeHandler(document,"mouseup",this.onMouseUp,this);
m.removeHandler(document,"touchend",this.onMouseUp,this);this.event_startInertia(this)},onUpdate:function(g){g||(g=Date.now());var e=g-this.lastUpdateTime;this.lastUpdateTime=g;if(e){if(this.panningActive){var d;if(this.scrollX&&(d=this.viewportTargetX-this.lastViewportTargetX,this.lastViewportTargetX=this.viewportTargetX,d))this.currentVelocityX=Math.abs(d)/e,this.currentDirectionX=d==0?0:d<0?-1:1;if(this.scrollY&&(d=this.viewportTargetY-this.lastViewportTargetY,this.lastViewportTargetY=this.viewportTargetY,
d))this.currentVelocityY=Math.abs(d)/e,this.currentDirectionY=d==0?0:d<0?-1:1}else this.processInertia&&(this.scrollX&&(this.viewportTargetX+=this.currentDirectionX*this.currentVelocityX*e,this.currentVelocityX*=0.94),this.scrollY&&(this.viewportTargetY+=this.currentDirectionY*this.currentVelocityY*e,this.currentVelocityY*=0.94));e=d=0;this.scrollX&&(d=this.viewportTargetX-this.viewportX,this.viewportX+=d*(this.panningActive||this.currentVelocityX>0?1:0.12));this.scrollY&&(e=this.viewportTargetY-
this.viewportY,this.viewportY+=e*(this.panningActive||this.currentVelocityY>0?1:0.12));d=!this.scrollX||Math.abs(d)<0.5;e=!this.scrollY||Math.abs(e)<0.5;if(!this.panningActive&&d&&e){if(this.scrollX)this.viewportX=this.viewportTargetX;if(this.scrollY)this.viewportY=this.viewportTargetY;this.stopUpdate()}this.updateElementPosition();this.event_updatePosition(this,g,this.viewportX,this.viewportY)}this.nextFrame()},nextFrame:function(){if(this.isUpdating)this.updateFrameHandle=s(this.onUpdateHandler,
this.targetElement)},setPositionX:function(g,e){e?(this.viewportTargetX=g||0,this.currentVelocityX=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetX=this.viewportX=g,this.updateElementPosition())},setPositionY:function(g,e){e?(this.viewportTargetY=g||0,this.currentVelocityY=0,this.startUpdate()):(this.stopUpdate(),this.viewportTargetY=this.viewportY=g,this.updateElementPosition())},calcExpectedPosition:function(g){var e=0,d=g=="x"?this.currentVelocityX:this.currentVelocityY,a=g=="x"?this.currentDirectionX:
this.currentDirectionY,g=g=="x"?this.viewportTargetX:this.viewportTargetY;if(d)for(var b=Math.log(0.0010/d)/Math.log(0.94),c=0;c<b;c++)e+=a*d*15,d*=0.94;return g+e},calcExpectedPositionX:function(){return this.calcExpectedPosition("x")},calcExpectedPositionY:function(){return this.calcExpectedPosition("y")}}),r=l(basis.ui.Node,{cssClassName:"Basis-ScrollPanel-Scrollbar",template:'<div class="Basis-Scrollbar"><div{trackElement} class="Basis-Scrollbar-Track"></div></div>',init:function(g){basis.ui.Node.prototype.init.call(this,
g);this.startProperty=this.type=="horizontal"?"left":"top";this.endProperty=this.type=="horizontal"?"right":"bottom";p(this.element).add(this.type)},recalcSize:function(g){i.display(this.element,g<1);var e=this.type=="horizontal"?this.element.offsetWidth:this.element.offsetHeight;this.trackSize=e-e*g},updatePosition:function(g){var e=this.trackSize*g,g=this.trackSize-this.trackSize*g;e<0&&(e=0);g<0&&(g=0);var d={};d[this.startProperty]=e+"px";d[this.endProperty]=g+"px";i.setStyle(this.tmpl.trackElement,
d)}}),l=l(basis.ui.Container,{useScrollbars:true,scrollX:true,scrollY:true,wheelDelta:40,event_realign:n.createEvent("realign"),template:'<div{element} class="Basis-ScrollPanel" event-mousewheel="onwheel"><div{scrollElement|childNodesElement|content} class="Basis-ScrollPanel-Content"></div></div>',action:{onwheel:function(g){g=m.wheelDelta(g);this.scrollX?this.scroller.setPositionX(this.scroller.viewportTargetX-this.wheelDelta*g,true):this.scrollY&&this.scroller.setPositionY(this.scroller.viewportTargetY-
this.wheelDelta*g,true)}},init:function(g){basis.ui.Node.prototype.init.call(this,g);this.oldOffsetHeight=this.oldOffsetWidth=this.maxPositionY=this.maxPositionX=this.minPositionY=this.minPositionX=0;g=Object.extend(this.scroller||{},{targetElement:this.tmpl.scrollElement,scrollX:this.scrollX,scrollY:this.scrollY});this.scroller=new q(g);this.scroller.addHandler({updatePosition:this.scrollUpdatePosition},this);basis.layout.addBlockResizeHandler(this.tmpl.scrollElement,this.realign.bind(this));if(this.useScrollbars){if(this.scrollX)this.hScrollbar=
new r({type:"horizontal",container:this.element});if(this.scrollY)this.vScrollbar=new r({type:"vertical",container:this.element});this.scroller.addHandler({start:function(){p(this.element).add("scrollProcess")},finish:function(){p(this.element).remove("scrollProcess")}},this)}},scrollUpdatePosition:function(){var g=this.scroller;g.panningActive||this.fixPosition();this.useScrollbars&&(this.scrollX&&this.hScrollbar.updatePosition(g.viewportX/this.maxPositionX),this.scrollY&&this.vScrollbar.updatePosition(g.viewportY/
this.maxPositionY))},fixPosition:function(){var g=this.scroller;if(this.scrollX&&(g.viewportX<this.minPositionX||g.viewportX>this.maxPositionX)){var e=Math.min(this.maxPositionX,Math.max(this.minPositionX,g.viewportX));g.setPositionX(e,true)}if(this.scrollY&&(g.viewportY<this.minPositionY||this.scroller.viewportY>this.maxPositionY))e=Math.min(this.maxPositionY,Math.max(this.minPositionY,g.viewportY)),g.setPositionY(e,true)},realign:function(){this.calcDimentions();this.scrollUpdatePosition();this.event_realign()},
calcDimentions:function(){if(this.element.parentNode){if(this.scrollX){var g=this.element.offsetWidth,e=this.tmpl.scrollElement.scrollWidth;this.maxPositionX=Math.max(0,e-g)}if(this.scrollY){var d=this.element.offsetHeight,a=this.tmpl.scrollElement.scrollHeight;this.maxPositionY=Math.max(0,a-d)}this.useScrollbars&&(this.scrollX&&this.hScrollbar.recalcSize(g/e),this.scrollY&&this.vScrollbar.recalcSize(d/a))}},destroy:function(){this.scroller.destroy();basis.ui.Node.prototype.destroy.call(this)}});
basis.namespace("basis.ui.scroller").extend({Scroller:k,Scroller2:q,ScrollPanel:l})})(basis);
(function(f){var l=f.Class,i=f.dom,n=f.dom.event,m=f.cssom,p=f.dom.wrapper,v=f.ui.Container,t=f.animation.Modificator,u=l(f.ui.Node,{template:'<div class="TocControl-Item-Header" event-click="scrollTo"><span>{titleText}</span></div>',action:{scrollTo:function(){this.owner&&this.owner.parentNode&&this.owner.parentNode.scrollToNode(this.owner)}},templateUpdate:function(f){f.titleText.nodeValue=this.titleGetter(this)||"[no title]"},titleGetter:Function.getter("data.title")}),w=l(v,{template:'<div class="TocControl-Item"><span{header}/><div{content|childNodesElement} class="TocControl-Item-Content"/></div>',
satelliteConfig:{header:{delegate:Function.$self,instanceOf:u}}}),s=true,o=l(v,{behaviour:{click:function(f,i){i&&i.delegate.parentNode.scrollToNode(i.delegate)}},init:function(f){this.inherit(f);this.document=this;s&&n.addHandler(this.element,"mousewheel",function(f){try{this.owner.content.dispatchEvent(f)}catch(k){s=false,n.removeHandler(this.element,"mousewheel")}},this);this.addEventListener("click")}}),l=l(p.Control,{childClass:w,template:'<div{element} class="TocControl"><div{content|childNodesElement} class="TocControl-Content"/></div>',
behaviour:{childNodesModified:function(){this.recalc()}},clientHeight_:-1,scrollHeight_:-1,scrollTop_:-1,lastTopPoint:-1,lastBottomPoint:-1,isFit:true,init:function(k){this.inherit(Object.complete({childNodes:null},k));var l=this.childClass.prototype.satelliteConfig.header.instanceOf;this.meterHeader=new l({container:this.element,data:{title:"meter"}});this.meterElement=this.meterHeader.element;m.setStyle(this.meterElement,{position:"absolute",visibility:"hidden"});this.childNodesDataset=new p.ChildNodesDataset(this);
this.header=new o({container:this.element,childClass:l,collection:this.childNodesDataset,cssClassName:"TocControlHeader"});this.footer=new o({container:this.element,childClass:l,collection:this.childNodesDataset,cssClassName:"TocControlFooter"});i.hide(this.header.element);i.hide(this.footer.element);this.header.owner=this;this.footer.owner=this;this.thread=new f.Animation.Thread({duration:400,interval:15});var r=this;this.modificator=new t(this.thread,function(g){r.content.scrollTop=parseInt(g);
r.recalc()},0,0,true);this.modificator.timeFunction=function(g){return Math.sin(Math.acos(1-g))};n.addHandler(this.content,"scroll",this.recalc,this);n.addHandler(window,"resize",this.recalc,this);this.addEventListener("click","click",true);k.childNodes&&this.setChildNodes(k.childNodes);this.timer_=setInterval(function(){r.recalc()},500)},scrollToNode:function(f){if(f&&f.parentNode===this)if(f=Math.min(this.content.scrollHeight-this.content.clientHeight,this.topPoints[i.index(f)]),this.thread){var o=
this.content.scrollTop;this.modificator.setRange(o,o);this.thread.stop();this.modificator.setRange(o,f);this.thread.start()}else this.content.scrollTop=f},recalc:function(){var f=this.content,o=f.clientHeight,l=f.scrollHeight,f=f.scrollTop,g=o==l;if(this.clientHeight_!=o||this.scrollHeight_!=l){this.clientHeight_=o;this.scrollHeight_=l;var l=[],e=[];if(!g)for(var d=this.meterElement.offsetHeight,a=0,o=d*this.childNodes.length-o,b,c=0;b=this.childNodes[c];c++)b=b.element.offsetTop,l.push(b?b-a:l[c-
1]||0),e.push(b?b+o:e[c-1]||o),a+=d,o-=d;this.topPoints=l;this.bottomPoints=e;this.lastBottomPoint=this.lastTopPoint=this.scrollTop_=-1}if(this.isFit!=g)this.isFit=g,i.display(this.header.element,!g),i.display(this.footer.element,!g);if(!g&&this.scrollTop_!=f)if(this.scrollTop_=f,g)this.lastTopPoint=0,this.lastBottomPoint=this.childNodes.length;else{var h=this.topPoints.binarySearchPos(f),m=this.bottomPoints.binarySearchPos(f);if(this.lastTopPoint!=h)this.lastTopPoint=h,this.header.childNodes.forEach(function(a,
b){a.element.style.display=b>=h?"none":""});if(this.lastBottomPoint!=m)this.lastBottomPoint=m,this.footer.childNodes.forEach(function(a,b){a.element.style.display=b<m?"none":""})}},destroy:function(){clearInterval(this.timer_);this.thread.destroy();this.modificator.destroy();this.header.destroy();this.footer.destroy();this.childNodesDataset.destroy();n.removeHandler(this.content,"scroll",this.recalc,this);n.removeHandler(window,"resize",this.recalc,this);this.inherit()}});f.namespace("basis.ui.toc").extend({Control:l,
ControlItem:w,ControlItemHeader:u,ControlHeaderList:o})})(basis);
(function(f){var l=f.dom,i=f.dom.event,n=f.EventObject.createEvent,m=f.cssom.classList,p=f.dragdrop.DragDropElement,v=f.layout.Box,t=f.ui.Node,u=f.ui.Container,w=t.subclass({pos:0,caption:String.Entity.nbsp,template:'<div class="Basis-Slider-Mark"><span class="Basis-Slider-Mark-CaptionWrapper"><span class="Basis-Slider-Mark-Caption">{text}</span></span></div>',init:function(f){t.prototype.init.call(this,f);l.setStyle(this.element,{left:100*this.pos+"%",width:100*this.width+"%"});this.tmpl.text.nodeValue=
this.caption;this.isLast&&m(this.element).add("last");this.isRange&&m(this.element).add("range")}}),s=u.subclass({template:'<div class="Basis-Slider-MarkLayer"/>',childClass:w,captionGetter:Function.$self,count:0,marks:null,init:function(f){u.prototype.init.call(this,f);this.apply()},apply:function(){var f=this.marks||[];if(this.count>0){var i=this;f.push.apply(f,Array.create(this.count,function(g){var e=this.closest((g+1)/i.count);return{pos:(e-this.min)/this.range_,caption:i.captionFormat(e),isLast:i.count==
g+1}},this.owner_))}var o=0,f=f.filter(Function.$isNotNull).sortAsObject("pos").map(function(g){var e=g.pos;g.width=g.pos-o;g.pos=o;o=e;return g},this);o!=1&&f.push({pos:o,width:1-o,isLast:true});this.setChildNodes(f)}}),o={move:function(){var f=this.tmpl.scrollbar;this.setValue_((i.mouseX(event)-(new v(f)).left)/f.offsetWidth*this.count_)}},n=t.subclass({event_change:n("change"),captionFormat:function(f){return Math.round(Number(f))},min:0,max:100,step:1,value:NaN,value_:NaN,template:'<div{element} class="Basis-Slider Basis-Slider-MinMaxInside" event-mousewheel="step" event-keyup="step" event-mousedown="focus" tabindex="0"><div class="Basis-Slider-MinLabel"><span class="caption">{minValue}</span></div><div class="Basis-Slider-MaxLabel"><span class="caption">{maxValue}</span></div><div{scrollbarContainer} class="Basis-Slider-ScrollbarContainer" event-click="jumpTo"><div{marks} class="Basis-Slider-MarkLayers"/><div{scrollbar} class="Basis-Slider-Scrollbar"><div{scrollTrumb} class="Basis-Slider-ScrollbarSlider"></div></div></div></div>',
action:{jumpTo:function(f){var o=this.tmpl.scrollbar;this.setValue_((i.mouseX(f)-(new v(o)).left)/o.offsetWidth*this.count_)},focus:function(){l.focus(this.element)},step:function(f){var o=i.wheelDelta(f);if(o)l.focus(this.element),o<0?this.stepDown():this.stepUp();else switch(i.key(f)){case i.KEY.DOWN:case i.KEY.LEFT:case 189:case 109:this.stepDown();break;case i.KEY.UP:case i.KEY.RIGHT:case 187:case 107:this.stepUp();break;case i.KEY.PAGEDOWN:this.stepDown(10);break;case i.KEY.PAGEUP:this.stepUp(10);
break;case i.KEY.HOME:this.setValue(this.min);break;case i.KEY.END:this.setValue(this.max)}}},satelliteConfig:{marks:{instanceOf:u.subclass({template:'<div class="Basis-Slider-MarkLayers"/>',childClass:s})}},marks:"auto",init:function(f){var i=this.step,l=this.value;this.step=0;this.value=this.min;this.value_=0;t.prototype.init.call(this,f);this.setProperties(this.min,this.max,i);this.setValue(isNaN(l)?this.min:l);this.scrollbarDD=new p({element:this.tmpl.scrollTrumb,handler:o,handlerContext:this})},
setProperties:function(f,i,o){if(f>i)var g=f,f=i,i=g;o=o||1;f=f||0;if(this.min!=f||this.max!=i||this.step!=o)this.count_=Math.ceil((i-f)/o),this.step=o,this.min=f,this.max=this.min+this.count_*this.step,this.range_=this.max-this.min,this.tmpl.minValue.nodeValue=this.captionFormat(this.min),this.tmpl.maxValue.nodeValue=this.captionFormat(this.max),m(this.element).bool("NoMax",this.max==this.min),this.marks&&this.satellite.marks.setChildNodes((Array.isArray(this.marks)?this.marks:[this.marks]).map(function(e){typeof e!=
"object"&&(e={count:e});e=Object.extend({captionFormat:this.captionFormat,owner_:this},e);if(e.count=="auto")e.count=Math.min(this.count_,20);return e},this)),this.setValue(this.value||this.min)},closest:function(f){return this.normalize(this.min+this.range_*f.fit(0,1)+this.step/2)},normalize:function(f){if(f<this.min)f=this.min;else if(f>this.max)f=this.max;return this.min+Math.floor(1.0E-5+(f-this.min)/this.step)*this.step},stepUp:function(f){this.setValue_(this.value_+parseInt(f||1))},stepDown:function(f){this.setValue_(this.value_-
parseInt(f||1))},setValue_:function(f){f=Math.round(f).fit(0,this.count_);if(this.value_!=f){this.value_=f;var i=this.value;this.value=this.normalize(this.min+f*this.step);this.tmpl.scrollTrumb.style.left=(100*(f/this.count_)).toFixed(4)+"%";this.event_change(this,i)}},setValue:function(f){this.setValue_((f-this.min)/this.step)},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;t.prototype.destroy.call(this)}});Object.extend(n,{MarkLayer:s,Mark:w});f.namespace("basis.ui.slider").extend({Slider:n})})(basis);
(function(f){function l(f,i){if(window.getComputedStyle){var l=document.defaultView.getComputedStyle(f,null);if(l)return l.getPropertyValue(i)}else if(f.currentStyle)return f.currentStyle[i]}var i=f.dom,n=f.cssom.classList,m=f.dragdrop.DragDropElement,p=f.cssom.cssRule("IFRAME"),v={width:"deltaX",height:"deltaY"},t={width:{"-1":"w-resize",1:"e-resize"},height:{"-1":"n-resize",1:"s-resize"}},m=m.subclass(function(f){return{factor:NaN,property:"width",event_prepare:function(){v[this.property]?p.setProperty("pointerEvents",
"none"):(typeof console!="undefined"&&console.warn("Property to change `"+this.property+"` is unsupported"),this.stop())},event_start:function(i){f.event_start.call(this,i);i.delta=v[this.property];i.factor=this.factor;var m=this.element.parentNode,o=l(this.element,"float"),k=l(this.element,"position");if(i.delta=="deltaY"){if(m=m.clientHeight-parseFloat(l(m,"padding-top"))-parseFloat(l(m,"padding-bottom")),i.offsetStart=this.element.offsetHeight,isNaN(i.factor))i.factor=k!="static"&&l(this.element,
"bottom")!="auto"?-1:1}else if(m=m.clientWidth-parseFloat(l(m,"padding-left"))-parseFloat(l(m,"padding-right")),i.offsetStart=this.element.offsetWidth,isNaN(i.factor))i.factor=o=="right"||k!="static"&&l(this.element,"right")!="auto"?-1:1;i.offsetStartInPercent=100/m;n(this.resizer).add("selected")},event_move:function(i){f.event_move.call(this,i);this.element.style[this.property]=i.offsetStartInPercent*(i.offsetStart+i.factor*i[i.delta])+"%"},event_over:function(i){f.event_over.call(this,i);n(this.resizer).remove("selected");
p.setProperty("pointerEvents","auto")},init:function(l){this.resizer=i.createElement(".Basis-Resizer");this.resizer.style.cursor=t[this.property][1];f.init.call(this,l)},setElement:function(l){var m=this.element;f.setElement.call(this,l,this.resizer);m!==this.element&&(m&&i.remove(this.resizer),this.element&&i.insert(this.element,this.resizer))}}});f.namespace("basis.ui.resizer").extend({Resizer:m})})(basis);
(function(f){function l(f){return(100*f).toFixed(4)+"%"}function i(f){var i=f.childNodes.search(f.activePage_,"data.pageNumber");i?i.select():f.selection.clear()}var n=f.dom.event,m=f.EventObject.createEvent,p=f.cssom.classList,v=f.layout.Box,t=f.dragdrop.DragDropElement,u=f.ui.Control,w=f.ui.Node.subclass({pageGetter:Function.getter("data.pageNumber"),urlGetter:Function.$self,template:'<td{element} class="Basis-PaginatorNode"><span><a{link|selected} event-click="click" href="#">{pageNumber}</a></span></td>',
templateUpdate:function(f){var i=this.pageGetter(this);f.pageNumber.nodeValue=i+1;f.link.href=this.urlGetter(i)},action:{click:function(f){n.kill(f);this.isDisabled()||this.click()}},click:function(){this.parentNode&&this.parentNode.setActivePage(this.pageGetter(this))}}),s={start:function(){this.initOffset=this.tmpl.scrollTrumb.offsetLeft},move:function(f){f=((this.initOffset+f.deltaX)/this.tmpl.scrollTrumbWrapper.offsetWidth).fit(0,1);this.setSpanStartPage(Math.round(f*(this.pageCount_-this.pageSpan_)));
this.tmpl.scrollTrumb.style.left=l(f)},over:function(){this.setSpanStartPage(this.spanStartPage_)}},m=u.subclass({childClass:w,template:'<div{element} class="Basis-Paginator" event-mousewheel="scroll"><table><tbody><tr{childNodesElement}/></tbody></table><div{scrollbarContainer} class="Basis-Paginator-ScrollbarContainer"><div{scrollbar} class="Basis-Paginator-Scrollbar" event-click="jumpTo"><div{activePageMarkWrapper}><div{activePageMark} class="Basis-Paginator-ActivePageMark"><div/></div></div><div{scrollTrumbWrapper}><div{scrollTrumb} class="Basis-Paginator-ScrollbarSlider"><div{scrollTrumbElement}><span/></div></div></div></div></div></div>',
action:{jumpTo:function(f,i){var l=this.tmpl.scrollbar,l=(n.mouseX(i)-(new v(l)).left)/l.offsetWidth;this.setSpanStartPage(Math.floor(l*this.pageCount_)-Math.floor(this.pageSpan_/2))},scroll:function(f){(f=n.wheelDelta(f))&&this.setSpanStartPage(this.spanStartPage_+f)}},event_activePageChanged:m("activePageChanged"),event_pageCountChanged:m("pageCountChanged"),pageSpan_:0,pageCount_:0,activePage_:0,spanStartPage_:-1,init:function(f){u.prototype.init.call(this,f);this.setProperties(f.pageCount||0,
f.pageSpan);this.setActivePage(Math.max(f.activePage-1,0),true);this.scrollbarDD=new t({element:this.tmpl.scrollTrumb,handler:s,handlerContext:this})},setProperties:function(f,i,m){f=f||1;i=Math.min(i||10,f);if(i!=this.pageSpan_)this.pageSpan_=i,this.setChildNodes(Array.create(i,function(e){return{data:{pageNumber:e}}}));if(this.pageCount_!=f){this.pageCount_=f;var n=1/f;this.tmpl.activePageMark.style.width=l(n/(1-n));this.tmpl.activePageMarkWrapper.style.width=l(1-n);this.event_pageCountChanged(this.pageCount_)}var n=
i/f,g=n/(1-n);this.tmpl.scrollTrumbWrapper.style.width=l(1-n);this.tmpl.scrollTrumb.style.width=l(g);p(this.element).bool("Basis-Paginator-WithNoScroll",i>=f);this.setSpanStartPage(this.spanStartPage_);this.setActivePage(arguments.length==3?m:this.activePage_)},setActivePage:function(f,k){f=f.fit(0,this.pageCount_-1);if(f!=this.activePage_)this.activePage_=Number(f),i(this),this.event_activePageChanged(f);this.tmpl.activePageMark.style.left=l(f/Math.max(this.pageCount_-1,1));k&&this.spotlightPage(this.activePage_)},
spotlightPage:function(f){this.setSpanStartPage(f-Math.round(this.pageSpan_/2)+1)},setSpanStartPage:function(f){f=f.fit(0,this.pageCount_-this.pageSpan_);if(f!=this.spanStartPage_){this.spanStartPage_=f;for(var k=this.childNodes.length;k-- >0;)this.childNodes[k].update({pageNumber:f+k});i(this)}this.tmpl.scrollTrumb.style.left=l((f/Math.max(this.pageCount_-this.pageSpan_,1)).fit(0,1))},destroy:function(){this.scrollbarDD.destroy();this.scrollbarDD=null;u.prototype.destroy.call(this)}});f.namespace("basis.ui.paginator").extend({Paginator:m})})(basis);
(function(f){var l="basis.ui.pageslider",i=f.dom,n=f.Class,m=f.cssom.classList,l="basis.ui",n=n(f.ui.tabs.PageControl,{template:'<div class="Basis-PageControl Basis-PageSlider"><div/></div>',event_childNodesModified:function(i,l){f.ui.tabs.PageControl.event_childNodesModified.call(this,i,l);for(var m=0,n;n=this.childNodes[m];m++)f.cssom.setStyle(n.element,{left:100*m+"%"})},init:function(i){var l="gerericRule_"+this.eventObjectId;this.pageSliderCssRule=f.cssom.cssRule("."+l+" > .Basis-Page");this.constructor.superClass_.prototype.init.call(this,
i);m(this.element).add(l);this.scroller=new f.ui.Scroller({targetElement:this.element,preventScrollY:true,minScrollDelta:10,handler:{startInertia:function(f){var i=this.selection.pick();if(i){var l=i;f.currentDirectionX==0||f.currentDirectionX==1&&f.viewportX<i.element.offsetLeft||f.currentDirectionX==-1&&f.viewportX>i.element.offsetLeft?(f.minScrollDeltaXReached=true,l=this.childNodes[Math.round(f.viewportX/i.element.offsetWidth)]):l=f.currentDirectionX==1?i.nextSibling:i.previousSibling;l||(l=i);
l==i?this.slideToPage(i):l.select()}f.currentVelocityX=0}},handlerContext:this});this.selection.addHandler({datasetChanged:function(){var f=this.pick();f&&f.parentNode.slideToPage(f)}});if(this.selection.itemCount){var n=this;setTimeout(function(){n.slideToPage(n.selection.pick())},0)}},slideToPage:function(f){this.scroller.setTargetPosition(f.element.offsetLeft)},destroy:function(){this.constructor.superClass_.prototype.init.call(this,config);i.Style.getStyleSheet().removeCssRule(this.pageSliderCssRule.rule);
this.pageSliderCssRule=null;this.scroller.destroy()}});f.namespace(l).extend({PageSlider:n})})(basis);
(function(f){var l=f.dom.wrapper.Node,i=f.ui.Node,n=l.subclass({draw:function(f){f.save();f.fillStyle="red";f.fillRect(this.data.value*10,10,30,30);f.restore()},update:function(){var f=l.prototype.update.apply(this,arguments);if(f)for(var i=this.parentNode;i;){if(i instanceof m){i.updateCount++;break}i=i.parentNode}return f}}),m=i.subclass({template:"<canvas{canvas}><div>Canvas doesn't support.</div></canvas>",childFactory:function(f){return new this.childClass(f)},childClass:n,drawCount:0,lastDrawUpdateCount:-1,
init:function(f){i.prototype.init.call(this,f);this.element.width=this.width;this.element.height=this.height;this.updateCount=0;if((f=this.tmpl.canvas)&&f.getContext)this.context=f.getContext("2d");this.updateTimer_=setInterval(this.draw.bind(this),1E3/60)},reset:function(){this.element.width=this.element.clientWidth;this.element.height=this.element.clientHeight},isNeedToDraw:function(){return this.context&&(this.updateCount!=this.lastDrawUpdateCount||this.element.width!=this.lastDrawWidth||this.element.height!=
this.lastDrawHeight)},draw:function(){if(!this.isNeedToDraw())return false;this.lastDrawWidth=this.element.width;this.lastDrawHeight=this.element.height;this.lastDrawUpdateCount=this.updateCount;this.drawCount+=1;this.reset();this.drawFrame();return true},drawFrame:function(){for(var f=this.firstChild;f;f=f.nextSibling)f.draw(this.context)},destroy:function(){clearInterval(this.updateTimer_);i.prototype.destroy.call(this)}});f.namespace("basis.ui.canvas").extend({Canvas:m,Shape:n})})(basis);
(function(f){function l(f,i){for(var l=function(f){function i(a,b,c,d){e!=b&&l.push(f.substring(e,b).replace(m,'<span class="token-keyword">$1</span>'));e=c+1;l.push('<span class="token-'+a+'">'+f.substring(b,c+1)+"</span>"+(d||""))}for(var l=[],n=f.toArray(),g,e=0,d=0;d<n.length;d++)if(n[d]=="'")for(g=d;++d<n.length;){if(n[d]=="'"){i("string",g,d);break}if(n[d]=="\n")break;n[d]=="\\"&&(d++,n[d]=="\n"&&(i("string",g,d-1),g=d+1))}else if(n[d]=='"')for(g=d;++d<n.length;){if(n[d]=='"'){i("string",g,
d);break}if(n[d]=="\n")break;n[d]=="\\"&&(d++,n[d]=="\n"&&(i("string",g,d-1),g=d))}else if(n[d]=="/"){g=d;d++;if(n[d]=="/"){for(;++d<n.length;)if(n[d]=="\n")break;i("comment",g,d-1)}if(n[d]=="*")for(;++d<n.length;)if(n[d]=="*"&&n[d+1]=="/"){i("comment",g,++d);break}else n[d]=="\n"&&(i("comment",g,d-1,"\n"),e=g=d+1)}l.push(f.substr(e).replace(m,'<span class="token-keyword">$1</span>'));return l}(function(f){f=f.trimRight().replace(/\r\n|\n\r|\r/g,"\n");i||(f=f.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));
f=f.replace(/\n[ \t]+/g,function(e){return e.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!i){for(var k=1E3,l=f.split(/\n+/),m=Number(f.match(/^function/)!=null);m<l.length;m++){var g=l[m].match(/^\s*/);if(g[0].length<k)k=g[0].length;if(k==0)break}k>0&&(f=f.replace(RegExp("(^|\\n) {"+k+"}","g"),"$1"))}return f=f.replace(RegExp("(^|\\n)( +)","g"),function(e,d,a){return d+"\u00a0".repeat(a.length)})}(f).replace(/</g,"&lt;")).join("").split("\n"),n=String(l.length>>1).length,w=[],s=0;s<l.length;s++)w.push('<div class="line '+
(s%2?"odd":"even")+'"><span class="lineContent"><input class="lineNumber" value="'+(s+1).lead(n)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>'+(l[s]+"\r\n")+"</span></div>");return w.join("")}var i=f.Class,n=f.ui.Node,m=RegExp("\\b("+"break case catch continue default delete do else false for function if in instanceof new null return super switch this throw true try typeof var while with".qw().join("|")+")\\b","g"),i=i(n,{template:'<pre{element|codeElement} class="Basis-SyntaxHighlight"/>',
codeGetter:Function.getter("data.code"),normalize:true,templateUpdate:function(){var f=this.codeGetter(this);if(f!=this.code_)this.code_=f,this.tmpl.codeElement.innerHTML=l(f,!this.normalize)}});f.namespace("basis.format.highlight").extend({highlight:l,SourceCodeNode:i})})(basis);
