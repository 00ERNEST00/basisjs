
<!doctype html>

<html>

<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf08" />
  <title>Basis Source Viewer</title>

  <link rel="stylesheet" type="text/css" title="Default Style" href="../plugins/style/highlight/style.css" media="screen" />

  <script type="text/javascript" src="../basis.js"></script>
  <script type="text/javascript" src="../data.js"></script>
  <script type="text/javascript" src="../ajax.js"></script>
  <script type="text/javascript" src="../dom_wrapper.js"></script>
  <script type="text/javascript" src="../plugins/highlight.js"></script>

  <style type="text/css">
    BODY
    {
      color: black;
      font-size: small;
    }
    .selected
    {
      background: gold !important;
    }
  </style>
</head>

<body>
  <script type="text/javascript">
    var line = parseInt((location.hash || '').replace(/^#/, ''));
    var filename = ((location.search || '').match(/[\?\&]file=([^&]+)/) || [])[1];
    if (filename)
    {
      var transport = new Basis.Ajax.Transport({
        url: '../' + filename,
        handlers: {
          success: function(req){
            //t = new Date;
            var node = new Basis.Plugin.SyntaxHighlight.SourceCodeNode({
              container: document.body,
              normalize: false,
              info: {
                code: req.responseText//.replace(/^\s*\n/, function(m){ return '.' + m })
              }
            });
            //alert(new Date - t)
            if (!isNaN(line))
            {
              var lineElement = node.element.childNodes[line - 1];
              lineElement.className += ' selected';
              setTimeout(function(){
                document.documentElement.scrollTop =
                document.body.scrollTop = lineElement.offsetTop - 200;
              }, 15);
            }
          }
        }
      });
      transport.get();
    }
  </script>
</body>

</html>