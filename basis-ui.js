/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

(function(k){function p(a,b){for(var c in b)a[c]=b[c];return a}function v(a,b){for(var c in b)c in a==false&&(a[c]=b[c]);return a}function A(a){return a==null||a==void 0}function x(a){return a}function B(a){var b={};a.names=function(a){return Object.slice(b,typeof a=="string"?a.qw():a)};a.extend=function(a){v(b,a);p(this,a);return this};return a}function y(a,b){for(var c=a.split("."),d=k,i,e,h;c.length;)if(i=c.shift(),e=(e?e+".":"")+i,d[i]||(d[i]=B((!c.length?b:null)||function(){},e),h&&(h.namespaces_[e]=
d[i])),d=d[i],!h&&(h=d,!h.namespaces_))h.namespaces_={};return q[a]=d}p(Object,{extend:p,complete:v,keys:function(a){var b=[],c;for(c in a)b.push(c);return b},values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},slice:function(a,b){var c={};if(!b)return p(c,a);for(var d=0,i;i=b[d++];)i in a&&(c[i]=a[i]);return c},splice:function(a,b){var c={};if(!b)return p(c,a);for(var d=0,i;i=b[d++];)i in a&&(c[i]=a[i],delete a[i]);return c},iterate:function(a,b,c){var d=[],i;for(i in a)d.push(b.call(c,
i,a[i]));return d},coalesce:function(){for(var a=arguments,b=0;b<a.length;b++)if(a[b]!=null)return a[b]}});var r=function(){},u=function(){var a=1,b={},c={};a++;return function(d,i){var e,h;if(!i){if(d.getter)return d.getter;if(typeof d=="function")return d}if(typeof d!="function")c[d]?e=c[d]:(e=new Function("object","return object != null ? object."+d+" : object"),e.path=d,e.getterIdx_=a++,c[d]=e);else if(e=d,!e.getterIdx_)e.getterIdx_=a++;h=e.getterIdx_;var w=b[h];if(w)if(typeof i=="undefined"){if(w.nmg)return w.nmg}else for(h=
0;h<w.length;h++){if(w[h].modificator===i)return w[h].getter}else w=b[h]=[];var n=true;switch(i&&typeof i){case "string":h=function(a){return i.format(e(a))};break;case "function":h=function(a){return i(e(a))};break;case "object":n=false;h=function(a){return i[e(a)]};break;default:h=e.path?e:function(a){return e(a)}}if(n&&(w.push({getter:h,modificator:i}),typeof i=="undefined"))w.nmg=h;return h.getter=h}}();p(Function,{$undefined:function(a){return a==void 0},$defined:function(a){return a!=void 0},
$isNull:A,$isNotNull:function(a){return a!=null&&a!=void 0},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:x,$const:function(a){return function(){return a}},$false:function(){return false},$true:function(){return true},$null:function(){return null},$undef:r,getter:u,def:function(a,b,c){c=c||A;return function(d){d=a(d);return c(d)?b:d}},wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,d;return function(){c++||(d=a.apply(b||
this,arguments));return d}},lazyInitAndRun:function(a,b,c){var d=0,i;return function(){d++||(i=a.call(c||this));b.apply(i,arguments);return i}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}});v(Function.prototype,{bind:function(a){var b=this,c=Array.from(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});v(Array,{isArray:function(a){return Object.prototype.toString.call(a)===
"[object Array]"}});p(Array,{from:function(a,b){if(a!=null){var c=a.length;if(typeof c=="undefined")return[a];b||(b=0);if(c-b>0){for(var d=[],i=0,e=b;e<c;)d[i++]=a[e++];return d}}return[]},create:function(a,b,c){for(var d=[],i=typeof b=="function",e=0;e<a;e++)d[e]=i?b.call(c,e,d):b;return d}});v(Array.prototype,{indexOf:function(a,b){b=parseInt(b)||0;if(b<0)return-1;for(;b<this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){for(var c=this.length,b=parseInt(b),b=isNaN(b)||b>=
c?c-1:(b+c)%c;b>=0;b--)if(this[b]===a)return b;return-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return false;return true},some:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&a.call(b,this[c],c,this))return true;return false},filter:function(a,b){for(var c=[],d=0,i=this.length;d<i;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);
return c},map:function(a,b){for(var c=[],d=0,i=this.length;d<i;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c},reduce:function(a,b){var c=this.length,d=arguments.length;if(c==0&&d==1)throw new TypeError;var i,e=0;d>1&&(i=b,e=1);for(d=0;d<c;d++)d in this&&(i=e++?a.call(null,i,this[d],d,this):this[d]);return i}});p(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[a>=
0?a:this.length+a]},search:function(a,b,c){Array.lastSearchIndex=-1;for(var b=Function.getter(b||x),c=parseInt(c)||0,d=this.length;c<d;c++)if(b(this[c])===a)return this[Array.lastSearchIndex=c]},lastSearch:function(a,b,c){Array.lastSearchIndex=-1;for(var b=Function.getter(b||x),d=this.length,c=isNaN(c)||c==null?d:parseInt(c),d=c>d?d:c;d-- >0;)if(b(this[d])===a)return this[Array.lastSearchIndex=d]},binarySearchPos:function(a,b,c,d,i,e){if(!this.length)return d?-1:0;var b=Function.getter(b||x),c=!!c,
h,i=isNaN(i)?0:i,w=isNaN(e)?this.length-1:e;do if(e=i+w>>1,h=b(this[e]),c?a>h:a<h)w=e-1;else if(c?a<h:a>h)i=e+1;else return a==h?e:d?-1:0;while(i<=w);return d?-1:e+(h<a^c)},binarySearch:function(a,b){return this.binarySearchPos(a,b,false,true)},add:function(a){return this.indexOf(a)==-1&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return a!=-1&&!!this.splice(a,1)},has:function(a){return this.indexOf(a)!=-1},merge:function(a){return this.reduce(p,a||{})},sortAsObject:function(a,b,c){a=Function.getter(a);
c=c?-1:1;return this.map(function(b,c){return{i:c,v:a(b)}}).sort(b||function(a,b){return c*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){if(this!==a)this.length=0,this.push.apply(this,a);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var z=Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);if(a.length<2)a[1]=this.length;return z.apply(this,a)}}var m={"<":">","[":"]","(":")",
"{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};v(String,{toLowerCase:function(a){return String(a).toLowerCase()},toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()},isEmpty:function(a){return a==
null||String(a)==""},isNotEmpty:function(a){return a!=null&&String(a)!=""}});v(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});p(String.prototype,{toObject:function(a){try{return Function("return 0,"+this)()}catch(b){if(a)throw b;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],b=this.length,c=0;c<b;c++)a[c]=this.charAt(c);return a},
repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,"\\$&")},format:function(a){for(var b={},c=0;c<arguments.length;c++)b[c]=arguments[c];typeof a=="object"&&p(b,a);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(a,c,e,h,w){a=c in b?b[c]:w?"":a;return e&&!isNaN(a)?(a=Number(a),e=="."?a.toFixed(h):a.lead(h)):a})},quote:function(a,
b){var a=a||'"',b=b||m[a]||a,c=(a.length==1?a:"")+(b.length==1?b:"");return a+(c?this.replace(RegExp("["+c.forRegExp()+"]","g"),"\\$&"):this)+b},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,b){return b.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});String.format=String.prototype.format;if("|||".split(/\|/).length+"|||".split(/(\|)/).length!=
11)String.prototype.split=function(a){if(a==""||a&&a.source=="")return this.toArray();var b=[],c=0,d;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));d=a.exec(this);)d[0]=this.substring(c,d.index),b.push.apply(b,d),c=a.lastIndex;else for(;(d=this.indexOf(a,c))!=-1;)b.push(this.substring(c,d)),c=d+a.length;b.push(this.substr(c));return b};if("12".substr(-1)!="2"){var o=String.prototype.substr;String.prototype.substr=function(a,b){return o.call(this,a<0?Math.max(0,
this.length+a):a,b)}}p(Number.prototype,{fit:function(a,b){return!isNaN(a)&&this<a?Number(a):!isNaN(b)&&this>b?Number(b):this},between:function(a,b){return!isNaN(this)&&this>=a&&this<=b},quote:function(a,b){return(this+"").quote(a,b)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,b){return(this+"").replace(/\d+/,function(c){return(a-=c.length-1)>1?Array(a).join(b||
0)+c:c})},group:function(a,b){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(d,i){return!i+(c.length-i)%(a||3)?d:(b||" ")+d})})},format:function(a,b,c,d,i){a=this.toFixed(a);if(b||i)a=a.replace(/(\d+)(\.?)/,function(a,c,d){return(b?Number(c).group(3,b):c)+(d?i||d:"")});c&&(a=a.replace(/^-?/,"$&"+(c||"")));return a+(d||"")}});v(Date,{now:function(){return+new Date}});(new Date).getYear()<1900&&p(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&
a<100?Number(a)+1900:a)}});var q={},s=function(){function a(a,b){for(var c=q[a],n=b?b.split(/\./):[];c&&n.length;)c=c[n.shift()];return c}var b=k.document?k.document.getElementsByTagName("SCRIPT"):null,c=(b?b[b.length-1].src:module.filename).replace(/[^\/]+$/,""),d={},i;typeof require=="function"?i=function(a){return require(requirePath+a.replace(/\./g,"/"))}:(i=function(b,h){var w=b.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],n=b.substr(w.length?w.length+1:0),C=a(w,n),f=/^basis\./.test(w)?
c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!q[w]||!C)if(/^https?:/.test(f))if(d[b])throw"Attempt to load namespace, probably cycle require";else{d[b]=1;var f=f+(h||"")+b.replace(/\./g,"/")+".js",g=new XMLHttpRequest;g.open("POST",f,false);g.send(null);if(g.status==200){try{(new Function(g.responseText)).call(k)}catch(j){throw j;}i.sequence.push(b.replace(/\./g,"/")+".js")}else if(g.status==404&&n)s(w);else throw"!";}else throw"Path `"+b+"` can't be resolved";return C||
a(w,n)},i.sequence=[]);return i}(),l=function(){function a(a){return typeof a=="function"&&a.basisClass_}var b=Function(),c=1,d={},i=function(){for(var a in{toString:1})return;return true}();p(b,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=r}},create:function(e){typeof e!="function"&&(e=b);var n=Function();n.prototype=
e.prototype;for(var n=new n,h={className:e.className+"._SubClass_",basisClass_:true,superClass_:e,extendConstructor_:!!e.extendConstructor_,__extend__:function(c){return c&&(typeof c=="object"||typeof c=="function"&&!a(c))&&c!==d?b.create.call(null,t,c):c},extend:b.extend,subclass:function(){return b.create.apply(null,[t].concat(Array.from(arguments)))},prototype:n},i=arguments,f=1;f<i.length;f++)h.extend(typeof i[f]=="function"&&!a(i[f])?i[f](e.prototype):i[f]);var g={},t=h.extendConstructor_?function(a,
b){this.eventObjectId=c++;var t,e;for(e in a)t=this[e],this[e]=t&&t.__extend__?t.__extend__(a[e]):a[e];this.init(b||g)}:function(){this.eventObjectId=c++;this.init.apply(this,arguments)};n.constructor=t;for(var J in n)n[J]===d&&(n[J]=t);p(t,h);return t},extend:function(a){var b=this.prototype;if(a.prototype)a=a.prototype;for(var c in a){var e=a[c],d=b[c];c=="className"||c=="extendConstructor_"?this[c]=e:b[c]=d&&d.__extend__?d.__extend__(e):e}if(i&&a[c="toString"]!==Object.prototype[c])b[c]=a[c];return this}});
var e=function(a,b){return{__extend__:function(a){var c=Function();c.prototype=this;c=new c;b(c,a);return c}}.__extend__(a)},h=function(a){return e(a,p)};return y("basis.Class",b.create).extend({SELF:d,BaseClass:b,create:b.create,isClass:a,CustomExtendProperty:e,ExtensibleProperty:h,NestedExtProperty:function(a){return e(a,function(a,b){for(var c in b){var e=a[c];a[c]=e&&e.__extend__?e.__extend__(b[c]):h(b[c])}})}})}(),j=function(){function a(a){var d=c[a];d||(d=c[a]=function(){var c=this.handlers_,
n,d;if(c&&c.length)for(var c=b.call(c),h=c.length;h-- >0;)n=c[h],d=n.handler[a],typeof d=="function"&&d.apply(n.thisObject,arguments)});return d}var b=Array.prototype.slice,c={},d,i=l(null,{handlers_:null,event_destroy:d=a("destroy","object"),listen:l.NestedExtProperty(),extendConstructor_:true,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,b){var c=this.handlers_;if(!c)c=this.handlers_=
[];b||(b=this);for(var n=c.length,d;n-- >0;)if(d=c[n],d.handler===a&&d.thisObject===b)return false;return!!c.push({handler:a,thisObject:b||this})},removeHandler:function(a,b){var c=this.handlers_;if(c){b||(b=this);for(var d=c.length,i;d-- >0;)if(i=c[d],i.handler===a&&i.thisObject===b)return!!c.splice(d,1);return false}},destroy:function(){if(this.handlers_)d.call(this,this),this.handlers_=null}});i.createEvent=a;i.event=c;return i}(),f=function(){var a=[];return{add:function(b){b!=null&&a.push(b)},
remove:function(b){a.remove(b)}}}();(function(){function a(a){if(b){if(a.source!=k||a.data!=c)return;basis.dom.event.kill(a)}d.length&&(a=d.shift(),delete i[a.key],a.fn())}var b=typeof addEventListener=="function"&&typeof postMessage=="function",c="zeroTimeoutMessage",d=[],i={},e=1;b&&k.addEventListener("message",a,true);var h=setTimeout;k.setTimeout=function(n,f){var g;f?g=h.call(k,n,f):(g={key:"z"+e++,fn:typeof n=="function"?n:new Function(n)},i[g.key]=g,d.push(g),b?postMessage(c,"*"):g.timer=h.call(k,
a,0),g=g.key);return g};var f=clearTimeout;k.clearTimeout=function(a){if(/z\d+/.test(a)){var b=i[a];b&&(clearTimeout(b.timer),d.remove(b),delete i[a])}else return f.call(k,a)}})();var g=function(){function a(){if(!C)if(e.length){var a=Date.now(),b=Math.max(e[0].eventTime,a);b<g&&(clearTimeout(n),n=setTimeout(c,(g=b)-a))}else n=clearTimeout(n),g=d}function b(b,c){var d=b.eventObjectId,t=h[c]&&h[c][d];t&&(e.remove(t),delete h[c][d],a())}function c(){var b=Date.now(),b=e.binarySearchPos(b+15,i);C=true;
e.splice(0,b).forEach(function(a){delete h[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});C=false;g=d;a()}var d=2E12,i=u("eventTime"),e=[],h={},g=d,n=null,C=false;f.add({destroy:function(){C=true;clearTimeout(n);e.length=0;h=null}});return{add:function(c,d,n){var t=c.eventObjectId,f=h[d];f||(f=h[d]={});var D=f[t];if(D){if(isNaN(n))return b(c,d);if(D.eventTime==n)return;e.remove(D);D.eventTime=n}else{if(isNaN(n))return;D=f[t]={eventName:d,object:c,eventTime:n,callback:c[d]}}e.splice(e.binarySearchPos(n,
i),0,D);a()},remove:b}}();y("basis").extend({namespace:y,platformFeature:{},EventObject:j,TimeEventManager:g,Cleaner:f,require:s});k.basis.locale={}})(this);
(function(k,p){function v(j){for(var f=1E6,j=String(j).split("."),g=0,a=0;g<4&&g<j.length;g++,f/=100)a+=j[g]*f;return a}function A(){for(var j=0;j<arguments.length;j++){var f=arguments[j].toLowerCase();if(f in B){if(B[f])return true}else{var g=f.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(g){B[f]=false;var a=g[1].toLowerCase(),b=v(g[3]),g=g[4]||"=";if(a=y[a])return B[f]=!b||g=="="&&a==b||g=="+"&&a>=b||g=="-"&&a<b}}}return false}var x="basis.ua",B={},y={},r=p.navigator&&p.navigator.userAgent,u="unknown",
z={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},m;for(m in z)if(!(m=="MSIE"&&p.opera)&&!(m=="Safari"&&r.match(/chrome/i))&&!(m=="AppleWebKit"&&r.match(/iphone/i))&&r.match(RegExp(m+".(\\d+(\\.\\d+)*)","i")))for(var o=
z[m],q=p.opera&&typeof p.opera.version=="function"?p.opera.version():RegExp.$1,s=v(q),u=o[0]+" "+q,q=0;q<o.length;q++)y[o[q].toLowerCase()]=s;k.platformFeature.datauri=false;r=typeof Image!="undefined"?new Image:{};r.onload=function(){k.platformFeature.datauri=true};r.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(A("IE7-"))try{document.execCommand("BackgroundImageCache",false,true)}catch(l){}x=k.namespace(x);x.toString=function(){return u};return x.extend({testImage:r,
prettyName:u,test:A,is:function(j){return A(j)},Cookies:{set:function(j,f,g,a){document.cookie=j+"="+(f==null?"":escape(f))+";path="+(a||(location.pathname.indexOf("/")==0?"":"/")+location.pathname)+(g?";expires="+(new Date(Date.now()+g*1E3)).toGMTString():"")},get:function(j){return(j=document.cookie.match(RegExp("(^|;)\\s*"+j+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(j[2])},remove:function(j,f){document.cookie=j+"=;expires="+(new Date(0)).toGMTString()+";path="+(f||(location.pathname.indexOf("/")==
0?"":"/")+location.pathname)}}})})(basis,this);
(function(k,p){function v(a,b,e){if(b!=null)return a.insertBefore(c(b)?b:y(b),e||null)}function A(a){return u("",a.cloneNode(true)).innerHTML}function x(a){return c(a)||a&&a.nodeType?a:typeof a=="string"?q.getElementById(a):null}function B(b,c,e){var h,i=[],e=typeof e=="string"?getter(e):e||Function.$true;c&26&&e(b)&&i.push(b);switch(c){case 1:case 2:for(h=b;(h=h[j])&&h!==b.document;)e(h)&&i.push(h);break;case 64:for(h=b[f];h;)e(h)&&i.push(h),h=h[g];break;case 4:case 8:b[f]&&(c=new d(b),c.nodes(e,
i));break;case 128:c=new d(b,e);for(c.cursor_=b[g]||b[j];h=c.next();)i.push(h);break;case 256:for(h=b;h=h[g];)e(h)&&i.push(h);break;case 32:e(b[j])&&i.push(b[j]);break;case 512:c=new d(b,e,d.BACKWARD);for(c.cursor_=b[a]||b[j];h=c.next();)i.push(h);break;case 1024:for(h=b;h=h[a];)e(h)&&i.push(h)}return i}function y(a){return q.createTextNode(a!=null?a:"")}function r(){for(var a=q.createDocumentFragment(),b=arguments.length,c=r.array=[],e=0;e<b;e++)c.push(v(a,arguments[e]));return a}function u(a,b){var c=
a!=void 0&&typeof a!="string",d=(c?a.description:a)||"",i="div",t=d.match(/^([a-z0-9\_\-]+)(.*)$/i);t&&(i=t[1],d=t[2]);if(d!=""){for(var f=[],D={},g;t=w.exec(d);){if(t[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+d+"\n\nProblem place:\n> "+d.substr(0,t.index)+"--\>"+d.substr(t.index)+"<--");g=t[1]||t[2]||t[3];t[1]?D.id=g:t[2]?f.push(g):g!="class"&&(D[g]=t[4]?o(t[5],t[6],t[7]):g)}e&&D.name&&/^(input|textarea|select)$/i.test(i)&&(i="<"+i+" name="+D.name+">")}d=
q.createElement(i);if(D){if(D.style&&h)d.style.cssText=D.style;for(var I in D)d.setAttribute(I,D[I],0)}if(f&&f.length)d.className=f.join(" ");arguments.length>1&&v(d,r.apply(0,Array.from(arguments,1).flatten()));if(c&&(a.css&&k.cssom&&k.cssom.setStyle(d,a.css),k.dom.event))for(var j in a)typeof a[j]=="function"?k.dom.event.addHandler(d,j,a[j],d):a[j]instanceof k.dom.event.Handler&&k.dom.event.addHandler(d,j,a[j].handler,a[j].thisObject);return d}function z(a,b){return a[j]?a[j].replaceChild(b,a):
a}function m(a){if(q.selection){var b=q.selection.createRange();b.compareEndPoints("StartToEnd",b)!=0&&b.collapse(a);return b.getBookmark().charCodeAt(2)-2}}var o=Object.coalesce,q=p.document,s=k.Class,l=q.createElement("div"),j="parentNode",f="firstChild",g="nextSibling",a="previousSibling",b;b=typeof l.compareDocumentPosition=="function"?function(a,b){return a.compareDocumentPosition(b)}:function(a,b){return a==b?0:a.document!=b.document?33:a.sourceIndex>b.sourceIndex?2|8*b.contains(childA):4|16*
a.contains(childB)};var c;if(typeof Node!="undefined"){if(c=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else c=function(a){return a&&a.ownerDocument===q};var d=s(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,b,c){this.setRoot(a);this.setDirection(c);if(typeof b=="function")this.filter=b},setDirection:function(b){Object.extend(this,b?{a:"lastChild",b:a,c:g,d:f}:{a:f,b:g,c:a,d:"lastChild"})},
setRoot:function(a){this.root_=a||q;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,b){var c;b||(b=[]);for(this.reset();c=this.next(a);)b.push(c);return b},next:function(a){var a=a||this.filter,b=this.cursor_||this.root_;do for(var c=b[this.a];!c;){if(b===this.root_)return this.cursor_=null;(c=b[this.b])||(b=b[j])}while(!a(b=c));return this.cursor_=b},prev:function(a){var a=a||
this.filter,b=this.cursor_,c=this.c,e=this.d;do{var d=b?b[c]:this.root_[e];if(d){for(;d[e];)d=d[e];b=d}else b&&(b=b[j]);if(!b||b===this.root_){b=null;break}}while(!a(b));return this.cursor_=b},destroy:function(){this.cursor_=this.root_=null}});d.BACKWARD=true;var i="textContent innerText nodeValue".qw(),e=function(){var a=q.createElement("input");a.name="a";return!/name/.test(A(a))}(),h;l.setAttribute("style","color: red");h=l.style.color!=="red";var w=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return k.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:d,outerHTML:A,textContent:function(a){for(var b=0,c;c=i[b++];)if(a[c]!=null)return a[c];return B(a,4,function(a){return a.nodeType==3}).map(getter("nodeValue")).join("")},get:x,tag:function(a,b){a=x(a)||q;return b=="*"&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(b||"*"))},axis:B,findAncestor:function(a,b,c){for(;a&&a!==c;){if(b(a))return a;a=a.parentNode}},createElement:u,createText:y,createFragment:r,insert:function(a,
b,e,d){a=x(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(e){case void 0:case "end":d=null;break;case "begin":d=a[f];break;case "before":break;case "after":d=d[g];break;default:d=Number(e).between(0,a.childNodes.length)?a.childNodes[e]:null}e=!c(a);if(!b||!Array.isArray(b))e=e?b&&a.insertBefore(b,d):v(a,b,d);else if(e)for(var e=[],h=0,t=b.length;h<t;h++)e[h]=a.insertBefore(b[h],d);else a.insertBefore(r.apply(0,b),d),e=r.array;return e},remove:function(a){return a[j]?
a[j].removeChild(a):a},replace:z,swap:function(a,c){if(a===c||b(a,c)&25)return false;z(a,l);z(c,a);z(l,c);return true},clone:function(a,b){var c=a.cloneNode(!b);c.attachEvent&&B(c,8).forEach(Event.clearHandlers);return c},clear:function(a){for(a=x(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,b,c){var e=[],c=Function.getter(c||Function.$self),d;for(d in b)for(var t=0;t<a.length;t++){var h=c(a[t]);e[t]=b[d](a[t],t,h)?u(d,h):a[t]}return e},setAttribute:function(a,b,c){c==null?
a.removeAttribute(b):a.setAttribute(b,c)},parentOf:function(a,b){return a.contains(b)},isInside:function(a,b){return a==b||b.contains(a)},focus:function(a,b){try{a=x(a),a.focus(),b&&a.select&&a.select()}catch(c){}},setSelectionRange:function(a,b,c){arguments.length<3&&(c=b);if(a.setSelectionRange)a.setSelectionRange(b,c);else if(a.createTextRange){var e=a.createTextRange();e.collapse(true);e.moveStart("character",b);e.moveEnd("character",c-b);e.select()}},getSelectionStart:function(a){return typeof a.selectionStart!=
"undefined"?a.selectionStart:m(true)},getSelectionEnd:function(a){return typeof a.selectionEnd!="undefined"?a.selectionEnd:m(false)}})})(basis,this);
(function(k,p){function v(a){return a||p.event}function A(a){return typeof a=="string"?o.get(a):a}function x(a){a=v(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=true}function B(a){a=v(a);a.preventDefault?a.preventDefault():a.returnValue=false}function y(a){var b=Array.from(j[a.type]);if(b)for(var c=b.length;c-- >0;){var d=b[c];d.handler.call(d.thisObject,a)}}function r(a,b,c,d){a=A(a);if(!a)throw Error("Event.addHandler: can't attach event listener to undefined");if(typeof c!="function")throw Error("Event.addHandler: handler must be a function");
a[s]||(a[s]={});var i={handler:c,thisObject:d},e=a[s],h=e[b];if(h){for(a=0;b=h[a];a++)if(b.handler===c&&b.thisObject===d)return;h.push(i)}else h=e[b]=[i],h.fireEvent=function(a){a=v(a);if(f&&a&&typeof a.returnValue=="undefined"){y(a);if(a.cancelBubble===true)return;if(typeof a.returnValue=="undefined")a.returnValue=true}for(var b=0,c;c=h[b++];)c.handler.call(c.thisObject,a)},a.addEventListener?a.addEventListener(b,h.fireEvent,false):a.attachEvent("on"+b,h.fireEvent)}function u(a,b,c,d){var a=A(a),
i=a[s];if(i&&(i=i[b]))for(var e=0,h;h=i[e];e++)if(h.handler===c&&h.thisObject===d){i.splice(e,1);i.length||z(a,b);break}}function z(a,b){var a=A(a),c=a[s];if(c)if(typeof b!="string")for(b in c)z(a,b);else{var d=c[b];d&&(a.removeEventListener?a.removeEventListener(b,d.fireEvent,false):a.detachEvent("on"+b,d.fireEvent),delete c[b])}}var m=p.document,o=k.dom,q=Function.$null,s="__basisEvents",l={mousewheel:["mousewheel","DOMMouseScroll"]},j={},f=!m.addEventListener,g=function(){function a(){b++||setTimeout(function(){for(var a=
0;a<c.length;a++)c[a].callback.call(c[a].thisObject)},10)}var b=false,c=[];if(k.ua.is("ie7-"))(function(){var b="_"+Date.now();m.write('<script id="'+b+'" defer src="//:"><\/script>');A(b).onreadystatechange=function(){this.readyState=="complete"&&(o.remove(this),a())}})();else if(k.ua.is("safari525-"))var d=setInterval(function(){/loaded|complete/.test(m.readyState)&&(clearInterval(d),a())},15);else r(m,"DOMContentLoaded",a,false);r(m,"load",a,false);r(p,"load",a,false);return function(a,e){b||c.push({callback:a,
thisObject:e})}}();return k.namespace("basis.dom.event",v).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return l[a]||[a]},Handler:function(a,b){this.handler=a;this.thisObject=b},sender:function(a){a=v(a);return a.target||a.srcElement},cancelBubble:x,
cancelDefault:B,kill:function(a,b){(b=A(b))?r(b,a,Event.kill):(B(a),x(a))},key:function(a){a=v(a);return a.keyCode||a.which||0},charCode:function(a){a=v(a);return a.charCode||a.keyCode||0},mouseButton:function(a,b){a=v(a);return typeof a.which=="number"?a.which==b.VALUE:a.button&b.BIT},mouseX:function(a){a=v(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(m.documentElement.scrollLeft||m.body.scrollLeft)},mouseY:function(a){a=v(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(m.documentElement.scrollTop||m.body.scrollTop)},wheelDelta:function(a){a=v(a);return"wheelDelta"in a?a.wheelDelta/120:a.type=="DOMMouseScroll"?-a.detail/3:0},addGlobalHandler:function(a,b,c){var d=j[a];if(d)for(a=d.length;a-- >0;){var i=d[a];if(i.handler===b&&i.thisObject===c)return}else m.addEventListener?m.addEventListener(a,y,true):r(m,a,q),d=j[a]=[];d.push({handler:b,thisObject:c})},removeGlobalHandler:function(a,b,c){var d=j[a];if(d)for(var i=0,e;e=d[i];i++)if(e.handler===
b&&e.thisObject===c){d.splice(i,1);d.length||(delete j[a],m.removeEventListener?m.removeEventListener(a,y,true):u(m,a,q));break}},addHandler:r,addHandlers:function(a,b,c){var a=A(a),d;for(d in b)r(a,d,b[d],c)},removeHandler:u,clearHandlers:z,fireEvent:function(a,b){var a=A(a),c=a[s];c&&c[b]&&c[b].fireEvent()},onLoad:g,onUnload:function(a,b){r(p,"unload",a,b)}})})(basis,this);
(function(){function k(a,b,c){for(var d=1,i;b;)b&1&&(i=q[d],c&d?(a.addHandler(i.handler,i.context),i.action(i.context.add,a)):(a.removeHandler(i.handler,i.context),i.action(i.context.remove,a))),b>>=1,d<<=1}function p(a){return Array.isArray(a)?a.map(p):{data:a}}var v=basis.Class,A=basis.EventObject,x=Object.values,B=Function.$self,y=A.createEvent,r=A.event,u={},z=[],m={},o={PRIORITY:[],values_:{},add:function(a,b){var c=a.toUpperCase(),d=a.toLowerCase();this[c]=d;m[d]=true;b&&(b=this.indexOf(b),
b==-1?this.PRIORITY.push(d):this.PRIORITY.splice(b,0,d))}};o.add("READY");o.add("DEPRECATED");o.add("UNDEFINED");o.add("ERROR");o.add("PROCESSING");var q={},s=1,l={NONE:0,MASK:0,add:function(a,b,c){q[s]={handler:b,action:c,context:{add:function(b,c){if(c){var e=l[a]+"_"+b.eventObjectId;if(!c.subscribers_)c.subscribers_={};if(!c.subscribers_[e]){var h=c.subscriberCount;c.subscribers_[e]=b;c.subscriberCount+=1;c.event_subscribersChanged(c,h)}}},remove:function(b,c){if(c){var e=l[a]+"_"+b.eventObjectId;
if(c.subscribers_[e]){var h=c.subscriberCount;delete c.subscribers_[e];c.subscriberCount-=1;c.event_subscribersChanged(c,h)}}}}};l[a]=s;l.MASK|=s;s<<=1}};l.add("DELEGATE",{delegateChanged:function(a,b){this.remove(a,b);this.add(a,a.delegate)}},function(a,b){a(b,b.delegate)});l.add("TARGET",{targetChanged:function(a,b){this.remove(a,b);this.add(a,a.target)}},function(a,b){a(b,b.target)});var j=v(A,{state:o.READY,data:null,canHaveDelegate:true,delegate:null,root:null,cascadeDestroy:false,isTarget:false,
target:null,active:false,subscribeTo:l.DELEGATE+l.TARGET,subscriberCount:0,subscribers_:null,event_update:y("update","object","delta"),event_stateChanged:y("stateChanged","object","oldState"),event_delegateChanged:y("delegateChanged","object","oldDelegate"),event_rootChanged:y("rootChanged","object","oldRoot"),event_targetChanged:y("targetChanged","object","oldTarget")&&function(a,b){var c=this.listen.target;c&&(b&&b.removeHandler(c,this),this.target&&this.target.addHandler(c,this));r.targetChanged.call(this,
a,b)},event_subscribersChanged:y("subscribersChanged","object"),event_activeChanged:y("activeChanged","object"),listen:{delegate:{update:function(a,b){this.data=a.data;this.event_update(this,b)},stateChanged:function(a,b){this.state=a.state;this.event_stateChanged(this,b)},targetChanged:function(a,b){this.target=a.target;this.event_targetChanged(this,b)},rootChanged:function(a,b){this.data=a.data;this.event_rootChanged(this,b)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},
init:function(a){A.prototype.init.call(this,a);if(a=this.delegate)this.delegate=null,this.data=a.data,this.state=a.state,this.setDelegate(a);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&k(this,this.subscribeTo,l.MASK)},isConnected:function(a){if(a instanceof j){for(;a&&a!==this&&a!==a.delegate;)a=a.delegate;return a===this}return false},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},setDelegate:function(a){if(this.canHaveDelegate&&
a&&a instanceof j){if(a.delegate&&this.isConnected(a))return false}else a=null;if(this.delegate!==a){var b=this.state,c=this.data,d=this.delegate,i=this.target,e=this.root,h={};d&&d.removeHandler(this.listen.delegate,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;this.state=a.state;this.target=a.target;a.addHandler(this.listen.delegate,this);for(var f in a.data)f in c===false&&(h[f]=void 0);for(f in c)c[f]!==a.data[f]&&(h[f]=c[f])}else for(f in this.target=this.delegate=null,this.root=
this,this.data={},c)this.data[f]=c[f];this.event_delegateChanged(this,d);this.root!==e&&this.event_rootChanged(this,e);this.target!==i&&this.event_targetChanged(this,i);if(a){for(f in h){this.event_update(this,h);break}b!==this.state&&(String(b)!=this.state||b.data!==this.state.data)&&this.event_stateChanged(this,b)}return true}return false},setState:function(a,b){var c=this.target||this.getRootDelegate();if(c!==this)return c.setState(a,b);c=String(a);if(!m[c])throw Error("Wrong state value");if(this.state!=
c||this.state.data!=b){var d=this.state;this.state=Object(c);this.state.data=b;this.event_stateChanged(this,d);return true}return false},deprecate:function(){this.state!=o.PROCESSING&&this.setState(o.DEPRECATED)},update:function(a){var b=this.target||this.getRootDelegate();if(b!==this)return b.update(a);if(a){var b={},c=0,d;for(d in a)this.data[d]!==a[d]&&(c++,b[d]=this.data[d],this.data[d]=a[d]);if(c)return this.event_update(this,b),b}return false},setActive:function(a){a=!!a;return this.active!=
a?(this.active=a,this.event_activeChanged(this),k(this,this.subscribeTo,l.MASK*a),true):false},setSubscription:function(a){a&=l.MASK;var b=this.subscribeTo^a;return b?(this.subscribeTo=a,this.active&&k(this,b,a),true):false},destroy:function(){this.active&&k(this,this.subscribeTo,0);this.delegate&&this.setDelegate();A.prototype.destroy.call(this);this.data=u;this.state=o.UNDEFINED;this.target=this.root=null}}),B=v(null,{itemClass:j,keyGetter:B,map_:null,extendConstructor_:true,init:function(){this.map_=
{};basis.Cleaner.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a){var b={};a instanceof j?b.delegate=a:b.data={id:a,title:a};return new this.itemClass(b)},get:function(a,b){var c=a instanceof j?a.eventObjectId:a,d=this.map_[c];!d&&b&&(d=this.map_[c]=this.create(a,b),d.addHandler({destroy:function(){delete this.map_[c]}},this));return d},destroy:function(){basis.Cleaner.remove(this);for(var a=x(this.map_),b=0,c;c=a[b++];)c.destroy()}}),f=v(j,{state:o.UNDEFINED,
itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:y("datasetChanged","dataset","delta")&&function(a,b){var c,d=0,i=0,e;if(c=b.inserted)for(;e=c[d];)this.item_[e.eventObjectId]=e,d++;if(c=b.deleted)for(;e=c[i];)delete this.item_[e.eventObjectId],i++;this.itemCount+=d-i;this.cache_=null;r.datasetChanged.call(this,a,b)},init:function(a){j.prototype.init.call(this,a);this.memberMap_={};this.item_={}},has:function(a){return!(!a||!this.item_[a.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=
x(this.item_);return this.cache_},pick:function(){for(var a in this.item_)return this.item_[a];return null},top:function(a){var b=[];if(a)for(var c in this.item_)if(b.push(this.item_[c])>=a)break;return b},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();j.prototype.destroy.call(this);this.cache_=z;this.itemCount=0;this.item_=this.memberMap_=null}}),g=v(f,{listen:{item:{destroy:function(a){this.memberMap_[a.eventObjectId]&&
this.remove([a])}}},init:function(a){f.prototype.init.call(this,a);if(a=this.items)this.set(a),this.items=null},add:function(a){for(var b,c=this.memberMap_,d=[],i=0;i<a.length;i++){var e=a[i];if(e instanceof j){var h=e.eventObjectId;c[h]||(c[h]=e,e.addHandler(this.listen.item,this),d.push(e))}}d.length&&this.event_datasetChanged(this,b={inserted:d});return b},remove:function(a){for(var b,c=this.memberMap_,d=[],i=0;i<a.length;i++){var e=a[i];if(e instanceof j){var h=e.eventObjectId;c[h]&&(e.removeHandler(this.listen.item,
this),delete c[h],d.push(e))}}d.length&&this.event_datasetChanged(this,b={deleted:d});return b},set:function(a){if(!this.itemCount)return this.add(a);if(!a.length)return this.clear();for(var b=this.memberMap_,c={},d=[],i=[],e,h,f,g=0;g<a.length;g++)if(e=a[g],e instanceof j)h=e.eventObjectId,c[h]=e,b[h]||(b[h]=e,e.addHandler(this.listen.item,this),i.push(e));for(h in b)c[h]||(e=b[h],e.removeHandler(this.listen.item,this),delete b[h],d.push(e));var l;var a={},k;if(i&&i.length)k=a.inserted=i;if(d&&d.length)k=
a.deleted=d;k&&(l=a);(f=l)&&this.event_datasetChanged(this,f);return f},sync:function(a,b){if(a){g.setAccumulateState(true);for(var c=this.memberMap_,d,i,e={},h=[],f,n=0;n<a.length;n++)if(d=a[n],d instanceof j)i=d.eventObjectId,e[i]=d,c[i]||h.push(d);for(i in this.item_)e[i]||this.item_[i].destroy();b&&h.length&&(f=this.add(h));g.setAccumulateState(false);return f}},clear:function(){var a,b=this.getItems();if(b.length){for(a=b.length;a-- >0;)b[a].removeHandler(this.listen.item,this);this.event_datasetChanged(this,
a={deleted:b});this.memberMap_={}}return a}});g.setAccumulateState=function(){function a(a){var b=a.dataset;i.call(b,b,a)}function b(b,c){var e=b.eventObjectId,d=c.inserted,h=c.deleted,t=g[e];if(d&&h)return t&&(delete g[e],a(t)),i.call(b,b,c);if(t){var f=t[d?"inserted":"deleted"];if(f)return f.push.apply(f,d||h);else a(t)}g[e]=c;c.dataset=b}function c(){e=1;setAccumulateState(false)}var d=f.prototype,i=d.event_datasetChanged,e=0,h,g={};return function(f){if(f){if(e==0)d.event_datasetChanged=b,h=setTimeout(c,
0);e++}else if(e-=e>0,e==0)clearTimeout(h),d.event_datasetChanged=i,f=g,g={},x(f).forEach(a)}}();basis.namespace("basis.data",p).extend({STATE:o,SUBSCRIPTION:l,Object:j,DataObject:j,KeyObjectMap:B,AbstractDataset:f,Dataset:g})})(basis,this);
(function(k,p){function v(a,c,d,i){for(var c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),e=j(),h,g=0;g<c.length;g++)g%2?(h=c[g].split(/\|/),a.getters[h[0]]=d+"childNodes["+i+"]",h=h.length>1?h[1]:h[0]):h=c[g].length?c[g]:null,h!=null&&(l&&(e.lastChild&&e.appendChild(r.createComment("")),i++),e.appendChild(f(h)),i++);return e}function A(a){return function(c){if(!c||!(c.type=="click"&&c.which==3)){var d=k.dom.event.sender(c),f,e;do if(f=d.getAttributeNode&&d.getAttributeNode(a))break;while(d=d.parentNode);
if(d&&f){do if(e=d.basisObjectId)if((e=o[e])&&e.templateAction){d=f.nodeValue.qw();f=0;for(var h;h=d[f++];)e.templateAction(h,k.dom.event(c));break}while(d=d.parentNode)}}}}function x(a,c,d){c=c.trim();if(!c)return"";for(var f="",e;e=s.exec(c);){var h=e[2],g=e[4]||e[5]||h;e[3]&&(a.getters[e[3]]=d+'.getAttributeNode("'+h+'")');if(e=h.match(/^event-([a-z]+)/i)){var n=e[1];if(!m[n]){m[n]=true;e=0;for(var n=k.dom.event.browserEvents(n),j;j=n[e++];)k.dom.event.addGlobalHandler(j,A(h))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,b){var a=k.dom.event(a),c=this,t;do if(t=c.basisObjectId)if((t=o[t])&&t.templateAction){for(var c=b.qw(),e=0,d;d=c[e++];)t.templateAction(d,k.dom.event(a));break}while(c=c.parentNode)}}f+=h=="class"?g.trim().replace(/^(.)|\s+/g,".$1"):"["+h+(g?"="+g.quote('"'):"")+"]"}return f}function B(a,c){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;c||(c=".");for(var d=j(),f,e=0,h,g=a.stack;h=q.exec(a.str);){f=RegExp.leftContext;a.str=a.str.substr(f.length+h[0].length);if(f.length)d.appendChild(v(a,
f,c,e)),e=d.childNodes.length;if(h[5])if(h[5]==g[g.length-1])return g.pop(),d;else throw"Wrong end tag";if(h[6])h[7]&&(a.getters[h[7]]=c+"childNodes["+e+"]"),d.appendChild(r.createComment(h[6]));else{f=h[1];var n=h[2],l=!!h[4],k=c+"childNodes["+e+"]";h=u.createElement(f+x(a,h[3],k));n&&(a.getters[n]=k);l||(g.push(f),h.appendChild(B(a,k+".")));d.appendChild(h)}e++}a.str.length&&d.appendChild(v(a,a.str,c,e));if(g.length)throw"No end tag for "+g.reverse();return d}function y(a){if(!this.proto){a=this.source;
if(typeof a=="function")this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},c=B(a),a=Object.iterate(a.getters,function(a,b){for(var e=a.split(/\|/).map(String.format,"obj_.{0}"),d=b.split(/(\.?childNodes\[(\d+)\])/),h=c,f=0;f<d.length;f+=3){var t=d[f+2];if(!t)break;d[f+2]="";h=h.childNodes[t];h.previousSibling?h.nextSibling||(d[f+1]=".lastChild"):d[f+1]=".firstChild"}return{name:e[0],alias:e.join("="),path:"dom_"+d.join("")}}).sortAsObject("path"),d=0;d<a.length;d++)for(var f=
RegExp("^"+a[d].path.forRegExp()),e=d+1,h;h=a[e++];)h.path=h.path.replace(f,a[d].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,b){obj_=a||{};dom_=proto_.cloneNode(true);_code_();if(b&&obj_.element){var c=obj_.element.basisObjectId=map_.seed++;map_[c]=b}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(c,o);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(o)}}var r=p.document,u=k.dom,z=k.Class,m={},o={seed:1},q=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,s=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;u.createFragment();var l=u.createElement("","a","b").cloneNode(true).childNodes.length==1,j=u.createFragment,
f=u.createText,g=z(null,{__extend__:function(a){return a instanceof g?a:new g(a)},init:function(a){this.source=a},createInstance:function(a,c){y.call(this);return this.createInstance(a,c)},clearInstance:function(){y.call(this)}}),a=r.createElement("DIV");return k.namespace("basis.html").extend({Template:g,escape:function(a){return u.createElement("DIV",u.createText(a)).innerHTML},unescape:function(b){a.innerHTML=b;return a.firstChild.nodeValue},string2Html:function(b){a.innerHTML=b;return u.createFragment.apply(null,
Array.from(a.childNodes))}})})(basis,this);
(function(k){function p(a){return a.sortingValue||0}function v(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return+(a>b)||-(a<b)}function A(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return-(a>b)||+(a<b)}function x(a){return a.childNodes.sort(a.localSortingDesc?A:v)}function B(a,b){var c=b.length-1;a.childNodes=b;a.firstChild=b[0]||null;a.lastChild=b[c]||null;for(var e=c;c=b[e];e--)c.nextSibling=b[e+1]||null,c.previousSibling=b[e-1]||null,a.insertBefore(c,c.nextSibling)}function y(a,b){var c=a.childFactory||
a.document&&a.document.childFactory,e,b=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},b);if(c&&(e=c.call(a,b),e instanceof a.childClass))return e;if(!e)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(e&&e.constructor&&e.constructor.className)+")";}function r(){return k.ui.apply(this,arguments)}var u=k.Class,z=k.dom,m=k.data,o=m.SUBSCRIPTION,q=m.DataObject,
s=m.AbstractDataset,l=m.Dataset,j=z.AXIS_DESCENDANT,f=z.AXIS_DESCENDANT_OR_SELF,g=Function.getter,a=Object.complete,b=z.axis,m=k.EventObject.createEvent,c=k.EventObject.event;o.add("DATASOURCE",{dataSourceChanged:function(a,b){this.remove(a,b);this.add(a,a.dataSource)}},function(a,b){a(b,b.dataSource)});var d=u.ExtensibleProperty(),i={ownerChanged:function(){},destroy:function(a){z.replace(a.element,this)}},e=function(){var a=this.key,b=this.config,c=this.owner,e=typeof b.existsIf!="function"||b.existsIf(c),
d=c.satellite[a];if(e){var e="delegate"in b,h="dataSource"in b,f=typeof b.delegate=="function"?b.delegate(c):null,g=typeof b.dataSource=="function"?b.dataSource(c):null;if(d)e&&d.setDelegate(f),h&&d.setDataSource(g);else{var E=c.tmpl[b.replace||a],d={owner:c};if(e)d.delegate=f;if(h)d.dataSource=g;b.config&&Object.complete(d,typeof b.config=="function"?b.config(c):b.config);d=new b.instanceOf(d);c.satellite[a]=d;E&&d instanceof k.ui.Node&&d.element&&(z.replace(E,d.element),d.addHandler(i,E))}}else if(d)d.destroy(),
d.owner=null,delete c.satellite[a]},h=u.CustomExtendProperty({update:true},function(a,b){for(var c in b)a[c]=b[c]?e:null}),w=u(q,{event_update:function(a,b){q.prototype.event_update.call(this,a,b);var c=this.parentNode;c&&(c.matchFunction&&(this.match(),this.match(c.matchFunction)),c.insertBefore(this,this.nextSibling))},event_childNodesModified:m("childNodesModified","node","delta"),event_dataSourceChanged:m("dataSourceChanged","node","oldDataSource"),event_localGroupingChanged:m("localGroupingChanged",
"node","oldGroupingNode"),event_localSortingChanged:m("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:m("ownerChanged","node","oldOwner"),event_satellitesChanged:m("satellitesChanged","node","delta"),subscribeTo:q.prototype.subscribeTo+o.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:false,nodeType:"DOMWrapperNode",canHaveChildren:false,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:true,document:null,
parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:false,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:d,satellite:null,owner:null,init:function(a){var b=this.dataSource,c=this.childNodes,f=this.localGrouping;if(b)this.dataSource=null;q.prototype.init.call(this,a);if(f)this.localGrouping=null,this.setLocalGrouping(f);if(this.canHaveChildren)this.childNodes=[],b?(this.dataSource=null,this.setDataSource(b)):
c&&this.setChildNodes(c);else{if(c)this.childNodes=null;if(b)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==d)for(var g in this.satelliteConfig)if(a=this.satelliteConfig[g],u.isClass(a)&&(a={instanceOf:a}),typeof a=="object"){b={key:g,owner:this,config:a};a=a.hook?h.__extend__(a.hook):h;for(g in a)if(a[g]===e){this.addHandler(a,b);break}e.call(b)}if(g=this.owner)this.owner=null,this.setOwner(g)},appendChild:function(){},insertBefore:function(){},removeChild:function(){},
replaceChild:function(){},clear:function(){},hasChildNodes:function(){return this.childNodes.length>0},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||a instanceof w==false)a=null;if(this.owner!==a){var b=this.owner;b&&b.removeHandler(this.listen.owner,this);(this.owner=a)&&a.addHandler(this.listen.owner,this);this.event_ownerChanged(this,b)}},destroy:function(){q.prototype.destroy.call(this);this.dataSource?
this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var b=this.satellite[a];b.destroy();b.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),n=u(w,{autoDestroyIfEmpty:false,nodes:null,first:null,last:null,
init:function(a){this.nodes=[];w.prototype.init.call(this,a)},insert:function(a,b){var c=this.nodes,e=b?c.indexOf(b):-1;e==-1?(c.push(a),this.last=a):c.splice(e,0,a);this.first=c[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var b=this.nodes;if(b.remove(a))this.first=b[0]||null,this.last=b[b.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=
this.nodes,b=a.length;b-- >0;)a[b].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){w.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),C={canHaveChildren:true,childClass:w,childFactory:null,listen:{dataSource:{datasetChanged:function(a,b){var c={},e=[];if(b.deleted)if(c.deleted=e,this.childNodes.length==b.deleted.length){e.push.apply(e,this.childNodes);var d=this.dataSource;
this.dataSource=null;this.clear(true);this.dataSource=d;this.colMap_={}}else for(var d=0,h;h=b.deleted[d];d++){h=h.eventObjectId;var f=this.colMap_[h];delete this.colMap_[h];f.canHaveDelegate=true;this.removeChild(f);e.push(f)}if(b.inserted){c.inserted=[];for(d=0;h=b.inserted[d];d++)f=y(this,{cascadeDestroy:false,delegate:h}),f.canHaveDelegate=false,this.colMap_[h.eventObjectId]=f,c.inserted.push(f),this.firstChild&&this.insertBefore(f)}this.firstChild?this.event_childNodesModified(this,c):this.setChildNodes(c.inserted);
if(this.destroyDataSourceMember&&e.length)for(d=0;h=e[d];d++)h.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,c){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var e=this;do if(e==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(e=e.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";
a instanceof this.childClass==false&&(a=y(this,a instanceof q?{delegate:a}:a));var d=a.parentNode===this,h=a.groupNode,f=this.localGrouping,g=this.localSorting,i,E=this.childNodes,n,w,k=null,e=-1,l=false,m;if(d)m=a.nextSibling,w=a.previousSibling;if(g&&(c=null,i=this.localSortingDesc,n=g(a)||0,d))if(n===a.sortingValue)l=true;else if((!m||(i?m.sortingValue<=n:m.sortingValue>=n))&&(!w||(i?w.sortingValue>=n:w.sortingValue<=n)))a.sortingValue=n,l=true;if(f){k=f.getGroupNode(a);w=k.nodes;if(h===k&&(l||
d&&m===c))return a;g?l?e=m&&m.groupNode===k?w.indexOf(m):w.length:(e=w.binarySearchPos(n,p,i),a.sortingValue=n):e=c&&c.groupNode===k?w.indexOf(c):w.length;if(e<w.length)c=w[e];else if(k.last)c=k.last.nextSibling;else{e=k;for(c=null;e=e.nextSibling;)if(c=e.first)break}if(a===c||d&&a.nextSibling===c)return h!==k&&(h&&h.remove(a),k.insert(a)),a;e=-1}else if(g){if(l)return a;e=E.binarySearchPos(n,p,i);c=E[e];a.sortingValue=n;if(a===c||d&&m===c)return a}else{if(c&&c.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
if(d){if(m===c)return a;if(a===c)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}d?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=null,a.nextSibling=null,e==-1?E.remove(a):(i=E.indexOf(a),E.splice(i,1),i<e&&e--),h&&(h.remove(a),h=null)):a.parentNode&&a.parentNode.removeChild(a);h!=k&&k.insert(a,c);if(c){e==
-1&&(e=E.indexOf(c));if(e==-1)throw"basis.dom.wrapper: Node was not found";a.nextSibling=c;E.splice(e,0,a)}else e=E.length,E.push(a),c={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=c.previousSibling;e==0?this.firstChild=a:c.previousSibling.nextSibling=a;c.previousSibling=a;var s=false,o=false,r=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)s=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==
r)a.contextSelection=r,o=!a.selection,a.selected&&r.add([a]);a.firstChild&&(s||o)&&b(a,j).forEach(function(a){if(s&&!a.document)a.document=s;if(o&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=r});d||(a.match&&a.match(this.matchFunction),a.autoDelegateParent&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,{inserted:[a]}));return a},removeChild:function(a){if(a==null||a.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(a instanceof this.childClass==
false)throw"basis.dom.wrapper: Child node has wrong class";if(this.dataSource&&this.dataSource.has(a))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(a),1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.document===
this.document&&b(a,f).forEach(function(a){if(a.document==this.document)a.document=null},this);if(a.contextSelection){for(var c=a.contextSelection,e=a,d=[];e;){if(e.contextSelection===c)e.selected&&d.push(e),e.contextSelection=null;if(!e.selection&&e.firstChild)e=e.firstChild;else if(e.nextSibling)e=e.nextSibling;else for(;e=e.parentNode;)if(e.nextSibling){e=e.nextSibling;break}}c.remove(d)}a.groupNode&&a.groupNode.remove(a);this.dataSource||this.event_childNodesModified(this,{deleted:[a]});a.autoDelegateParent&&
a.setDelegate();return a},replaceChild:function(a,b){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(b==null||b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,b);return this.removeChild(b)},clear:function(a){if(this.dataSource)this.setDataSource();else if(this.firstChild){var c=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:c});for(var e=
c.length;e-- >0;){var d=c[e];d.parentNode=null;d.groupNode=null;a?((d.selection||d.document)&&b(d,z.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),d.nextSibling=null,d.previousSibling=null,d.autoDelegateParent&&d.setDelegate()):d.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(e=a.length-1;c=a[e];e--)c.clear()}}},setChildNodes:function(a,
b){this.dataSource||this.clear(!!b);if(a&&("length"in a==false&&(a=[a]),a.length)){var c=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var e=0,d=a.length;e<d;e++)this.insertBefore(a[e]);this.event_childNodesModified=c;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.canHaveChildren||a instanceof s==false)a=null;if(this.dataSource!==a){var b=this.dataSource;if(b)this.colMap_=this.dataSource=null,b.removeHandler(this.listen.dataSource,
this),b.itemCount&&this.clear();if(a)this.dataSource=a,this.colMap_={},a.addHandler(this.listen.dataSource,this),a.itemCount&&this.listen.dataSource.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_dataSourceChanged(this,b)}},setLocalGrouping:function(a){if(typeof a=="function"||typeof a=="string")a={groupGetter:g(a)};a instanceof G==false&&(a=a!=null&&typeof a=="object"?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var b=this.localGrouping,c;if(this.localGrouping){if(!a&&
(this.localGrouping=null,this.firstChild)){c=this.localSorting?x(this):this.childNodes;for(var e=c.length;e-- >0;)c[e].groupNode=null;B(this,c)}b.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){c=this.localSorting?x(this):this.childNodes;for(e=0;a=c[e];e++)a.groupNode=this.localGrouping.getGroupNode(a);for(e=0;a=c[e];e++)a.groupNode.nodes.push(a);c.length=0;for(e=this.localGrouping.nullGroup;e;e=e.nextSibling)a=e.nodes,e.first=a[0]||null,e.last=a[a.length-1]||null,c.push.apply(c,
a),e.event_childNodesModified(e,{inserted:a});B(this,c)}this.event_localGroupingChanged(this,b)}},setLocalSorting:function(a,b){a&&(a=g(a));if(this.localSorting!=a||this.localSortingDesc!=!!b){var c=this.localSorting,e=this.localSortingDesc;this.localSortingDesc=!!b;this.localSorting=a||null;if(a&&this.firstChild){var d=[],h;for(h=this.firstChild;h;h=h.nextSibling)h.sortingValue=a(h)||0;if(this.localGrouping)for(var f=this.localGrouping.nullGroup;f;f=f.nextSibling)h=f.nodes=x({childNodes:f.nodes,
localSortingDesc:this.localSortingDesc}),f.first=h[0]||null,f.last=h[h.length-1]||null,d.push.apply(d,h);else d=x(this);B(this,d)}this.event_localSortingChanged(this,c,e)}},setMatchFunction:function(a){if(this.matchFunction!=a){var b=this.matchFunction;this.matchFunction=a;for(var c=this.lastChild;c;c=c.previousSibling)c.match(a);this.event_matchFunctionChanged(this,b)}}},o=u(w,{event_enable:m("enable","node"),event_disable:m("disable","node"),event_select:m("select","node"),event_unselect:m("unselect",
"node"),event_match:m("match","node"),event_unmatch:m("unmatch","node"),event_matchFunctionChanged:m("matchFunctionChanged","node","oldMatchFunction"),selectable:true,selected:false,selection:null,contextSelection:null,matchFunction:null,matched:true,disabled:false,init:function(a){if(this.selection&&this.selection instanceof s==false)this.selection=new H(this.selection);w.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=false,this.select(true)},setSelection:function(a){if(this.selection==
a)return false;var c=this.selection;b(this,j,function(b){if(b.contextSelection==c)b.selected&&c&&c.remove([b]),b.contextSelection=a});this.selection=a;return true},hasOwnSelection:function(){return!!this.selection},select:function(a){var b=this.selected,c=this.contextSelection;if(c)a?b?c.remove([this]):c.add([this]):this.selectable&&c.set([this]);else if(!b&&this.selectable&&!this.isDisabled())this.selected=true,this.event_select(this);return this.selected!=b},unselect:function(){var a=this.selected;
if(a){var b=this.contextSelection;b?b.remove([this]):(this.selected=false,this.event_unselect(this))}return this.selected!=a},enable:function(){if(this.disabled)this.disabled=false,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=true,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!z.findAncestor(this,g("disabled"))},match:function(a){if(typeof a!="function")if(this.matched){if(this.underMatch_)this.underMatch_(this,
true),this.underMatch_=null}else this.matched=true,this.event_match(this);else if(a(this)){if(this.underMatch_=a,!this.matched)this.matched=true,this.event_match(this)}else if(this.underMatch_=null,this.matched)this.matched=false,this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();w.prototype.destroy.call(this)}}),F=u(o,C,{}),G=u(w,C,{event_childNodesModified:function(a,b){c.childNodesModified.call(this,
a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var e=this.owner,d=Array.from(this.nullGroup.nodes),h=d.length;h-- >0;)e.insertBefore(d[h],d[h].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,true);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);c.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:true,
autoDestroyEmptyGroups:true,titleGetter:g("data.title"),groupGetter:Function.$undef,childClass:n,childFactory:function(b){return new this.childClass(a(b,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?false:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new n({autoDestroyIfEmpty:false});w.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),b=a instanceof q,c=this.map_[b?a.eventObjectId:a];!c&&!this.dataSource&&(c=this.appendChild(b?
{delegate:a}:{data:{id:a,title:a}}));return c||this.nullGroup},insertBefore:function(a,b){a=C.insertBefore.call(this,a,b);if("groupId_"in a==false)a.groupId_=a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=a;if(a.first){var c=this.owner,e=c.childNodes,d=a.first,h=a.last,f,g,i;for(f=a;f=f.previousSibling;)if(i=f.last)break;if(!i)i=this.nullGroup.last;for(f=a;f=f.nextSibling;)if(g=f.first)break;if(d.previousSibling!==i||h.nextSibling!==g){if(d.previousSibling)d.previousSibling.nextSibling=
h.nextSibling;if(h.nextSibling)h.nextSibling.previousSibling=d.previousSibling;f=e.splice(e.indexOf(d),a.nodes.length);var n=e.indexOf(g);f.unshift(n!=-1?n:e.length,0);e.splice.apply(e,f);d.previousSibling=i;h.nextSibling=g;if(i)i.nextSibling=d;if(g)g.previousSibling=h;c.firstChild=e[0];c.lastChild=e[e.length-1]}}return a},removeChild:function(a){C.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){C.clear.call(this);this.map_={}},destroy:function(){this.setOwner();w.prototype.destroy.call(this);
this.map_=null}});w.prototype.localGroupingClass=G;var m=u(s,{autoDestroy:true,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,b){var c=this.memberMap_,e={},d=0,h=0,f=b.inserted,g=b.deleted;if(f&&f.length)for(e.inserted=f;a=f[d];)c[a.eventObjectId]=a,d++;if(g&&g.length)for(e.deleted=g;a=g[h];)delete c[a.eventObjectId],h++;(d||h)&&this.event_datasetChanged(this,e)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:m("sourceNodeChanged")&&
function(a,b){c.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:false,init:function(a,b){s.prototype.init.call(this,b);a&&this.setSourceNode(a)},setSourceNode:function(a){a instanceof w==false&&(a=null);if(a!==this.sourceNode){var b=this.sourceNode;b&&(b.removeHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,b,{deleted:b.childNodes}));a&&(a.addHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,
a,{inserted:a.childNodes}));this.sourceNode=a;this.event_sourceNodeChanged(this,b)}},destroy:function(){this.setSourceNode();s.prototype.destroy.call(this)}}),H=u(l,{multiple:false,event_datasetChanged:function(a,b){l.prototype.event_datasetChanged.call(this,a,b);if(b.inserted)for(var c=0,e;e=b.inserted[c];c++)if(!e.selected)e.selected=true,e.event_select();if(b.deleted)for(c=0;e=b.deleted[c];c++)if(e.selected)e.selected=false,e.event_unselect()},add:function(a){if(!this.multiple)if(this.itemCount)return this.set(a);
else a.splice(1);for(var b=[],c=0,e;e=a[c];c++)e.contextSelection==this&&e.selectable&&b.push(e);return l.prototype.add.call(this,b)},set:function(a){for(var b=[],c=0,e;e=a[c];c++)e.contextSelection==this&&e.selectable&&b.push(e);this.multiple||a.splice(1);return l.prototype.set.call(this,b)}});k.namespace("basis.dom.wrapper",r).extend({AbstractNode:w,InteractiveNode:o,Node:F,GroupingNode:G,PartitionNode:n,simpleTemplate:r,ChildNodesDataset:m,Selection:H})})(basis);
(function(k,p){function v(a,b){return B(b,true).getRule(a,true)}function A(a,b){var c=a.match(/^([^{]+)\{(.*)\}\s*$/);if(c){for(var e=c[1].trim().split(/\s*,\s*/),d=0;d<e.length;d++)this.addRule(e[d],c[2]||null,b++);return b-1}}function x(a,b){var c=j.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:b?"alternate ":"",url:a.quote('"')}));j.tag(null,"HEAD")[0].appendChild(c);c=c.sheet||c.styleSheet;try{if(!c.cssRules)c.cssRules=c.rules}catch(e){}if(!c.insertRule)c.insertRule=
A;if(!c.deleteRule)c.deleteRule=c.removeRule;return c}function B(a,b){a||(a="DefaultGenericStyleSheet");d[a]||b&&(d[a]=new h(x()));return d[a]}function y(a,b,c,d){for(var d=d||{},b=b.qw(),h=0,f;f=b[h];h++)if(typeof e.style[f]!="undefined"){c&&(k.platformFeature["css-"+a]=f);i[a]={key:f,getter:d[f]};break}}function r(a,b){var c=i[a];if(a=c?c.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:c&&c.getter?c.getter(b):b}}function u(a,b,c){if(typeof a.setProperty=="function")return a.setProperty(b,
c);if(b=r(b,c))return a.style[b.key]=b.value}function z(a,b){for(var c in b)u(a,c,b[c]);return a}function m(a,b){return u(a,"display",typeof b=="string"?b:b?"":"none")}function o(a,b){return u(a,"visibility",b?"":"hidden")}function q(a){return G[a]||(G[a]=RegExp("\\s*\\b"+a+"\\b"))}function s(a,b){var c=(b?"g":"s")+a;return t[c]||(t[c]=RegExp((b?"":"\\s*")+"\\b"+a+".*\\b"))}var l=p.document,j=k.dom,f=k.dom.event,g=k.Class,a=/\s*!important/i,b=String("important"),c=1,d={},i={},e=j.createElement("DIV");
y("opacity","opacity MozOpacity KhtmlOpacity filter",true,{fitler:function(a){return"alpha(opacity:"+parseInt(a*100)+")"}});y("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",true);y("float","cssFloat styleFloat");var h=g(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,b){if(!this.map_[a]&&b){for(var c=this.styleSheet,e=this.rules.length,d=c.insertRule(a+"{}",e),h=e;h<=d;h++)this.rules.push(new w(c.cssRules[h]));this.map_[a]=
e!=d?new n(this.rules.splice(e)):this.rules[e]}return this.map_[a]},deleteRule:function(a){var b=this.map_[a];if(b){for(var b=b.rules||[b],c=0;c<b.length;c++){var e=this.rules.indexOf(b[c]);this.stylesheet.deleteRule(e);this.rules.splice(e,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),w=g(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(c,e){var d,h=!!a.test(e),f=this.rule.style;if(h||f.getPropertyPriority&&f.getPropertyPriority(c)==
b){if(e=e.replace(a,""),d=r(c,e)){var g=d.key;f.setProperty?(h||f.removeProperty(g),f.setProperty(g,d.value,h?b:"")):f.cssText=f.cssText.replace(RegExp(f[g]?g+"\\s*:\\s*"+f[g]+"(\\s*!"+b+")?\\s*;?":"^","i"),g+": "+d.value+(h?" !"+b:"")+";")}}else u(this.rule,c,e)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),n=g(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});
["setProperty","setStyle","clear"].forEach(function(a){n.prototype[a]=function(){for(var b,c=0;b=this.rules[c];c++)b[a].apply(b,arguments)}});var C={};["em","ex","px","%"].forEach(function(a){C[a=="%"?"percent":a]=function(b){return b==0||isNaN(b)?"0":b+a}});var F,G={},H=g(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,b,c){c=c||"";typeof a!="undefined"&&this.remove(c+a);typeof b!=
"undefined"&&this.add(c+b)},bool:function(a,b){b?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(q(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(q(a))||(this.element.className+=" "+a)},remove:function(a){var b=this.element.className,a=b.replace(q(a),"");if(a!=b)this.element.className=a},toggle:function(a){var b=this.contains(a);b?this.remove(a):this.add(a);
return!b}}),t={},J=g(null,{delim:"-",init:function(a,b){this.classList=b;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(s(this.prefix,true))},set:function(a){var b=this.items(),a=typeof a!="undefined"?this.prefix+a:"",c=this.classList;if(b)if(b.length==1){if(b[0]===a)return;c.remove(b[0])}else this.clear();a&&c.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});p.DOMTokenList&&l.documentElement.classList?(g=H.prototype,Object.extend(p.DOMTokenList.prototype,{set:g.set,replace:g.replace,bool:g.bool,clear:function(){for(var a=this.length;a-- >0;)this.remove(this[a])},setPrefixToken:g.setPrefixToken}),F=function(a){return(typeof a=="string"?j.get(a):a).classList}):F=function(a){return new H(typeof a=="string"?j.get(a):a)};f.onLoad(function(){F(l.body).bool("opacity-not-support",!k.platformFeature["css-opacity"])});j.extend({setStyleProperty:u,
setStyle:z,display:m,show:function(a){return m(a,1)},hide:function(a){return m(a)},visibility:o,visible:function(a){return o(a,1)},invisible:function(a){return o(a)}});return k.namespace("basis.cssom").extend({setStyleProperty:u,setStyle:z,classList:function(a,b){return b?new J(b,F(a)):F(a)},uniqueRule:function(a){var b="genericRule-"+c++;a&&F(a).add(b);a=v("."+b);a.token=b;return a},cssRule:v,getStyleSheet:B,addStyleSheet:x,CssStyleSheetWrapper:h,CssRuleWrapper:w,CssRuleWrapperSet:n}).extend(C)})(basis,
this);
(function(){function k(f,g){var a={},b;if(f&&f.length)b=a.inserted=f;if(g&&g.length)b=a.deleted=g;if(b)return a}var p=basis.Class,v=Object.extend,A=Function.$self,x=Function.$true,B=Function.$false,y=basis.EventObject.createEvent,r=basis.data.SUBSCRIPTION,u=basis.data.DataObject,z=basis.data.KeyObjectMap,m=basis.data.AbstractDataset,o=basis.data.Dataset;r.add("SOURCE",{sourceChanged:function(f,g){this.remove(f,g);this.add(f,f.source)},sourcesChanged:function(f,g){var a;if(a=g.inserted)for(var b=a.length;b-- >
0;)this.add(f,a[b]);if(a=g.deleted)for(b=a.length;b-- >0;)this.remove(f,a[b])}},function(f,g){for(var a=g.sources||[g.source],b=0,c;c=a[b++];)f(g,c)});r.add("MINUEND",{operandsChanged:function(f,g){this.minuend!==g&&(this.remove(f,g),this.add(f,f.minuend))}},function(f,g){f(g,g.minuend)});r.add("SUBTRAHEND",{operandsChanged:function(f,g,a){this.subtrahend!==a&&(this.remove(f,a),this.add(f,f.subtrahend))}},function(f,g){f(g,g.subtrahend)});var q=p(m,{subscribeTo:r.SOURCE,event_sourcesChanged:y("sourcesChanged",
"dataset","delta"),sources:null,rule:function(f){return f>0},listen:{source:{datasetChanged:function(f,g){var a=this.memberMap_,b={},c,d;if(g.inserted)for(var i=0;c=g.inserted[i];i++)d=c.eventObjectId,a[d]?a[d].count++:a[d]={count:1,object:c},b[d]=a[d];if(g.deleted)for(i=0;c=g.deleted[i];i++)d=c.eventObjectId,b[d]=a[d],a[d].count--;this.applyRule(b)},destroy:function(f){this.removeSource(f)}}},init:function(f){m.prototype.init.call(this,f);f=this.sources;this.sources=[];f&&f.forEach(this.addSource,
this)},setRule:function(f){if(typeof f!="function")f=q.UNION;if(this.rule!==f)this.rule=f,this.applyRule()},applyRule:function(f){var g=this.memberMap_,a=this.rule,b=this.sources.length,c=[],d=[],i,e,h;f||(f=g);for(var j in f)i=g[j],e=b&&i.count&&a(i.count,b),e!=!!this.item_[j]&&(e?c:d).push(i.object),i.count==0&&delete g[j];(h=k(c,d))&&this.event_datasetChanged(this,h)},addSource:function(f){if(f instanceof m&&this.sources.add(f)){f.addHandler(this.listen.source,this);var g=this.memberMap_,a;for(a in f.item_)g[a]?
g[a].count++:g[a]={count:1,object:f.item_[a]};this.applyRule();this.event_sourcesChanged(this,{inserted:[f]});return true}},removeSource:function(f){if(this.sources.remove(f)){f.removeHandler(this.listen.source,this);var g=this.memberMap_,a;for(a in f.item_)g[a].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[f]});return true}},setSources:function(f){for(var g=Array.from(this.sources),a=0,b;b=f[a];a++)b instanceof m&&(g.remove(b)||this.addSource(b));g.forEach(this.removeSource,this)},
clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){m.prototype.destroy.call(this);this.sources=null}});q.UNION=q.prototype.rule;q.INTERSECTION=function(f,g){return f==g};q.DIFFERENCE=function(f){return f==1};q.MORE_THAN_ONE_INCLUDE=function(f,g){return g==1||f>1};q.AT_LEAST_ONE_EXCLUDE=function(f,g){return g==1||f<g};var s=function(f){return!this.has(f)},l=p(m,{subscribeTo:r.MINUEND+r.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:y("operandsChanged",
"dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(f,g){if(this.subtrahend){var a=k(g.inserted&&g.inserted.filter(s,this.subtrahend),g.deleted&&g.deleted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(f,g){if(this.minuend){var a=k(g.deleted&&g.deleted.filter(s,this),g.inserted&&g.inserted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(this.minuend,
null)}}},init:function(f){m.prototype.init.call(this,f);var f=this.minuend,g=this.subtrahend;this.subtrahend=this.minuend=null;(f||g)&&this.setOperands(f,g)},setOperands:function(f,g){var a,b=false;f instanceof m==false&&(f=null);g instanceof m==false&&(g=null);var c=this.minuend,d=this.subtrahend;if(c!==f)b=true,c&&c.removeHandler(this.listen.minuend,this),(this.minuend=f)&&f.addHandler(this.listen.minuend,this);if(d!==g)b=true,d&&d.removeHandler(this.listen.subtrahend,this),(this.subtrahend=g)&&
g.addHandler(this.listen.subtrahend,this);if(!b)return false;this.event_operandsChanged(this,c,d);if(!f||!g)this.itemCount&&this.event_datasetChanged(this,a={deleted:this.getItems()});else{var b=[],c=[],i;for(i in this.item_)(!f.item_[i]||g.item_[i])&&b.push(this.item_[i]);for(i in f.item_)!this.item_[i]&&!g.item_[i]&&c.push(f.item_[i]);(a=k(c,b))&&this.event_datasetChanged(this,a)}return a},clear:function(){this.setOperands()}}),j=p(m,{subscribeTo:r.SOURCE,source:null,event_sourceChanged:y("sourceChanged",
"dataset","oldSource"),map:A,reduce:B,rule:B,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:{update:function(f){var g=this.map?this.map(f):f;if(g instanceof u==false||this.reduce(g))g=null;var a=this.sourceMap_[f.eventObjectId],b=a.member;if(b!=g){var c=this.memberMap_,d,i,e;a.member=g;if(b)a=b.eventObjectId,this.removeMemberRef&&this.removeMemberRef(b,f),--c[a]==0&&(delete c[a],e=[b]);if(g)b=g.eventObjectId,this.addMemberRef&&this.addMemberRef(g,f),c[b]?c[b]++:(c[b]=
1,i=[g]);(d=k(i,e))&&this.event_datasetChanged(this,d)}}},source:{datasetChanged:function(f,g){var a=this.sourceMap_,b=this.memberMap_,c=[],d=[],i,e,h;o.setAccumulateState(true);if(g.inserted)for(var j=0;i=g.inserted[j];j++){h=this.map?this.map(i):i;if(h instanceof u==false||this.reduce(h))h=null;i.addHandler(this.listen.sourceObject,this);a[i.eventObjectId]={sourceObject:i,member:h};if(h)e=h.eventObjectId,b[e]?b[e]++:(b[e]=1,c.push(h)),this.addMemberRef&&this.addMemberRef(h,i)}if(g.deleted)for(j=
0;i=g.deleted[j];j++)if(e=i.eventObjectId,h=a[e].member,i.removeHandler(this.listen.sourceObject,this),delete a[e],h)e=h.eventObjectId,--b[e]==0&&(delete b[e],d.push(h)),this.removeMemberRef&&this.removeMemberRef(h,i);o.setAccumulateState(false);(g=k(c,d))&&this.event_datasetChanged(this,g)},destroy:function(){this.setSource()}}},init:function(f){m.prototype.init.call(this,f);this.sourceMap_={};if(f=this.source)this.source=null,this.setSource(f)},setRule:function(f){typeof f!="function"&&(f=x);if(this.rule!==
f)return this.rule=f,this.applyRule()},setMap:function(f){typeof f!="function"&&(f=A);if(this.map!==f)return this.map=f,this.applyRule()},setSource:function(f){f instanceof m==false&&(f=null);if(this.source!==f){var g=this.source;g&&(g.removeHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,g,{deleted:g.getItems()}));if(this.source=f)f.addHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,f,{inserted:f.getItems()});this.event_sourceChanged(this,
g)}},applyRule:function(){var f=this.sourceMap_,g=this.memberMap_,a,b,c,d,i,e=[],h=[],j,n;for(n in f){i=f[n];d=i.sourceObject;a=i.member;b=this.map?this.map(d):d;if(b instanceof u==false||this.reduce(b))b=null;if(a!=b){i.member=b;if(a)c=a.eventObjectId,this.removeMemberRef&&this.removeMemberRef(a,d),g[c]--;if(b)a=b.eventObjectId,this.addMemberRef&&this.addMemberRef(b,d),a in g?g[a]++:(g[a]=1,e.push(b))}}for(c in this.item_)g[c]==0&&(delete g[c],h.push(this.item_[c]));(j=k(e,h))&&this.event_datasetChanged(this,
j);return j},clear:function(){this.setSource()},destroy:function(){m.prototype.destroy.call(this);this.sourceMap_=null}}),B=p(j,{reduce:function(f){return!this.rule(f)},rule:x}),p=p(j,{map:function(f){return this.keyMap.resolve(f)},rule:x,subsetClass:m,keyMap:null,addMemberRef:function(f,g){f.event_datasetChanged(f,{inserted:[g]})},removeMemberRef:function(f,g){f.event_datasetChanged(f,{deleted:[g]})},init:function(f){if(!this.keyMap||this.keyMap instanceof z==false)this.keyMap=new z(v({keyGetter:this.rule,
itemClass:this.subsetClass},this.keyMap));j.prototype.init.call(this,f)},getSubset:function(f,g){return this.keyMap.get(f,g)},destroy:function(){j.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:q,Subtract:l,MapReduce:j,Subset:B,Split:p})})(basis,this);
(function(){function k(a){if(a instanceof j)return a.set;a=a.nodeType;if(isNaN(a)==false)return a==1?l:"nodeValue"}var p=basis.Class,v=basis.dom,A=basis.Cleaner,x=Function.getter,B=basis.cssom.classList,y=basis.EventObject,r=basis.TimeEventManager,u=y.createEvent,z=basis.data,m=z.DataObject,o=z.STATE,q=p(m,{event_change:u("change"),locked:false,lockValue_:null,extendConstructor_:false,updateCount:0,init:function(a,b,c){m.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy=typeof c=="function"?
c:Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,b){var c=this.value,d=this.proxy?this.proxy(a):d,f=false;if(d!==c)this.value=d,f=true,this.updateCount+=1;!this.locked&&(f||b)&&this.event_change(d,c);return f},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=true},unlock:function(){if(this.locked)this.locked=false,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,b){return this.set(a,b)},reset:function(){this.set(this.initValue)},
destroy:function(){m.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),s={destroy:function(a){this.removeLink(a)}},l=function(a){v.insert(v.clear(this),a)},j=p(q,{links_:null,event_change:function(a,b){q.prototype.event_change.call(this,a,b);if(this.links_.length&&!A.globalDestroy)for(var c=0,d;d=this.links_[c++];)this.power_(d,b)},init:function(a,b,c){q.prototype.init.call(this,a,b,c);this.links_=[];A.add(this)},addLink:function(a,b,
c){if(typeof a!="object"&&a instanceof Object==false)throw Error("basis.data.property: Link to undefined object ignored");b==null&&(b=k(a));typeof c!="function"&&(c=x(Function.$self,c));b={object:a,format:c,field:b,isEventObject:a instanceof y};this.links_.push(b);b.isEventObject&&a.addHandler(s,this);this.power_(b);return a},addLinkShortcut:function(a,b,c){return this.addLink(a,j.shortcut[b],c)},removeLink:function(a,b){if(this.links_!=null){var c=arguments.length<2;!c&&b==null&&(b=k(a));for(var d=
0,f=0,e;e=this.links_[f];f++)e.object===a&&(c||b==e.field)?e.isEventObject&&e.object.removeHandler(s,this):this.links_[d++]=e;this.links_.length=d}},clear:function(){for(var a=0,b;b=this.links_[a];a++)b.isEventObject&&b.object.removeHandler(s,this);this.links_.clear()},power_:function(a,b){var c=a.field;if(c!=null){var d=a.format(this.value),f=a.object;typeof c=="function"?c.call(f,d,arguments.length<2?d:a.format(b)):f[c]=d}},destroy:function(){this.clear();q.prototype.destroy.call(this);this.links_=
null;A.remove(this)}});j.shortcut={className:function(a,b){B(this).replace(b,a)},show:function(a){v.display(this,!!a)},hide:function(a){v.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var f=o.PRIORITY,g={stateChanged:function(){this.fire(false,true)},update:function(){this.fire(true)},change:function(){this.fire(true)},destroy:function(a){this.remove(a)}},p=p(j,{calculateValue:function(){return this.value+1},objects:[],timer_:null,valueChanged_:false,
stateChanged_:true,state:o.UNDEFINED,extendConstructor_:true,init:function(){var a=this.handler;delete this.handler;j.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();A.add(this)},add:function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a];if(c instanceof m)this.objects.add(c)&&c.addHandler(g,
this);else throw Error("basis.data.property: Instance of DataObject required");}this.fire(true,true)},remove:function(a){this.objects.remove(a)&&a.removeHandler(g,this);this.fire(true,true)},clear:function(){for(var a=0,b;b=this.objects[a];a++)b.removeHandler(g,this);this.objects.clear();this.fire(true,true)},fire:function(a,b){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=
true,r.add(this,"update",Date.now())},lock:function(){this.locked=true},unlock:function(){this.locked=false},update:function(){delete this.timer_;r.remove(this,"update");if(!A.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var a=this.objects.length;if(a){for(var b=-2,c,d=0;d<a;d++){var g=this.objects[d],e=f.indexOf(String(g.state));e>b&&(c=g,b=e)}c&&this.setState(c.state,c.state.data)}else this.setState(o.UNDEFINED)}this.stateChanged_=this.valueChanged_=false},
destroy:function(){this.lock();this.clear();r.remove(this,"update");j.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:p,AbstractProperty:q,Property:j,PropertySet:p})})();
(function(k){function p(a,b){if(!a.length)return 0;var c,d,f=0,g=a.length-1;do if(c=f+g>>1,d=a[c]||0,b<d)g=c-1;else if(b>d)f=c+1;else return b==d?c:0;while(f<=g);return c+(d<b)}function v(a,b){if(!a.length)return 0;var c,d,f,g=0,i=a.length-1;do if(c=g+i>>1,f=a[c].value||0,f===d?(f=a[c].object.eventObjectId,d=b.object.eventObjectId):d=b.value||0,d<f)i=c-1;else if(d>f)g=c+1;else return d==f?c:0;while(g<=i);return c+(f<d)}function A(){for(var a=Object.slice(this.item_),b=this.index_.slice(this.offset,
this.offset+this.limit),c=[],d,f=0,g;g=b[f];f++){var i=g.object.eventObjectId;a[i]?delete a[i]:c.push(g.object)}(d=getDelta(c,values(a)))&&o.prototype.event_datasetChanged.call(this,this,d)}function x(a,b){var a=Function.getter(a),c=b+"_"+a.getterIdx_,d=l[c];if(!d)d=l[c]=this,this.indexType=b,this.indexClass=s[b],this.getter=a,this.key=c,this.createInstance=function(a){if(a instanceof o){var b=a.indexes&&a.indexes[this.key];if(!b)b=new this.indexClass(this.getter),b.addHandler(i,a),b.key=this.key;
return b}};return d}function B(a,b,c){var d=a.indexCache_;a.lock();if(b)for(var f=0,g;g=b[f++];){var i=a.valueGetter(g);d[g.eventObjectId]=i;a.add(g,i)}if(c)for(f=0;g=c[f++];)a.remove(g,d[g.eventObjectId]),delete d[g.eventObjectId];a.unlock()}var y=k.Class,r=k.TimeEventManager,u=k.data,z=u.KeyObjectMap,m=u.property.Property,o=u.AbstractDataset,q=u.dataset.MapReduce,u=y(o,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(a,b){var c;if(c=b.inserted)for(var d=0;d<
c.length;d++){var f=c[d],f={value:this.valueGetter(f),object:f},g=v(this.index_,f);this.index_.splice(g,0,f)}if(c=b.deleted)for(d=0;d<c.length;d++)f=c[d],f={value:this.valueGetter(f),object:f},g=v(this.index_,f),this.index_.splice(g,1);A.call(this)},init:function(a){this.index_=[];o.prototype.init.call(this,a)},setRange:function(a,b){this.offset=a;this.limit=b;A.call(this)}}),s=y(m,{autoDestroy:true,valueGetter:Function.$null,dataSource:null,init:function(a){m.prototype.init.call(this,this.value||
0);this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},upd:function(){}});s.Sum=y(s,{add:function(a,b){this.value+=b},remove:function(a,b){this.value-=b},upd:function(a,b,c){this.set(this.value+b-c)}});s.Avg=y(s,{sum_:0,count_:0,add:function(a,b){this.sum_+=b;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,b){this.sum_-=b;this.count_-=1;this.value=this.count_?this.sum_/this.count_:0},upd:function(a,b,c){this.sum_+=b-c;this.set(this.sum_/this.count_)}});
s.Count=y(s,{valueGetter:Function.$true,add:function(a,b){b&&(this.value+=1)},remove:function(a,b){b&&(this.value-=1)},upd:function(a,b){this.set(this.value+(b?1:-1))}});s.Max=y(s,{init:function(a,b){this.stack=[];s.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(p(this.stack,b),0,b);this.value=this.stack[this.stack.length-1]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[this.stack.length-1]},upd:function(a,b,c){this.stack.splice(p(this.stack,c),1);this.stack.splice(p(this.stack,
b),0,b);this.set(this.stack[this.stack.length-1])}});s.Min=y(s,{init:function(a,b){this.stack=[];s.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(p(this.stack,b),0,b);this.value=this.stack[0]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[0]},upd:function(a,b,c){this.stack.splice(p(this.stack,c),1);this.stack.splice(p(this.stack,b),0,b);this.set(this.stack[0])}});var l={},j=function(a){return function(b){return new x(b,a)}},f=j("Sum"),g=j("Avg"),a=j("Count"),
b=j("Min"),j=j("Max"),c={update:function(a){var b,c,d,f=a.eventObjectId,g;for(g in this.indexes)d=this.indexes[g],b=d.indexCache_[f],c=d.valueGetter(a),c!==b&&(d.upd(a,c,b),d.indexCache_[f]=c)}},d={datasetChanged:function(a,b){if(b.inserted)for(var d=0;a=b.inserted[d++];)a.addHandler(c,this);if(b.deleted)for(d=0;a=b.deleted[d++];)a.removeHandler(c,this);for(var f in this.indexes)B(this.indexes[f],b.inserted,b.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},i={destroy:function(a){this.removeIndex(a)}};
o.prototype.createIndex=function(a){if(a instanceof x!=false){if(!this.indexes)this.indexes={},this.addHandler(d),d.datasetChanged.call(this,this,{inserted:this.getItems()});var b=a.key;this.indexes[b]||(a=a.createInstance(this),this.indexes[b]=a,B(a,this.getItems()));return this.indexes[b]}};o.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var b in this.indexes)return;this.removeHandler(d);delete this.indexes}};y=y(q,{calcs:null,
indexes:null,indexes_:null,timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,b){q.prototype.event_sourceChanged.call(this,a,b);var c,d;for(d in this.indexes_)c=this.indexes_[d],b&&(this.removeIndex(d),b.removeIndex(this.indexes[d])),this.source&&this.addIndex(d,this.source.createIndex(c))},listen:{sourceObject:{update:function(a,b){q.prototype.listen.sourceObject.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=true;this.fireUpdate()}},index:{change:function(a){var b=
this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=true;b.fireUpdate()}},member:{subscribersChanged:function(a,b){a.subscriberCount>0&&b==0&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,true)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=b.eventObjectId;a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=true;a.subscriberCount>0&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];a.removeHandler(this.listen.member,
this)},init:function(a){this.indexUpdated=false;this.indexesBind_={};this.memberSourceMap={};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||this.keyMap instanceof z==false)this.keyMap=new z(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));q.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof x)if(this.indexes_[a])return;else this.indexes_[a]=
b,b=this.source&&this.source.createIndex(b);if(b instanceof s)this.indexValues[a]=b.value,this.indexes[a]=b,this.indexesBind_[a]={key:a,indexMap:this},b.addHandler(this.listen.index,this.indexesBind_[a]),this.listen.index.change.call(this.indexesBind_[a],b.value)}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},
addCalc:function(a,b){this.calcs[a]=b;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=true,r.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=false},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=false;var c={},d,f,g;for(g in this.calcs)if(d=this.calcs[g](b.sourceObject.data,this.indexValues),a.data[g]!==d&&(!isNaN(d)||!isNaN(a.data[g])))c[g]=d,f=true;f&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,true)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);q.prototype.destroy.call(this)}});
k.namespace("basis.data.index").extend({IndexedDataset:u,IndexConstructor:x,Index:s,Sum:f,Avg:g,Count:a,Max:j,Min:b,IndexMap:y})})(basis);
(function(k){function p(a){e[a]=e[a]||0;return a+e[a]++}function v(){var a=Array.from(arguments),b=a.pop();typeof b!="function"&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],d=[],e=0,f;e<a.length;e++)f=a[e].quote('"'),c.push(f+" in delta"),d.push("data["+f+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+d.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
true;return b}function A(){return v.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;b-- >0;){if(arguments[b]==null)return null;a.push(arguments[b])}return a.join("-")}))}var x=k.Class,B=k.Cleaner,y=Object.extend,r=Function.$self,u=Function.getter,z=k.data,m=k.EventObject,o=z.Dataset,q=z.dataset.Subset,s=z.dataset.Split,l=z.DataObject,j=z.STATE,f={},g={string:1,number:1},a=[],b=function(a){return isNaN(a)?null:Number(a)},c=function(a){return isNaN(a)?null:Number(a)},
d=function(a){return isNaN(a)?null:parseInt(a)},i=function(a){return a==null?null:String(a)},e={},h=k.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,d){var e=a(c,d);return e!==d&&b[e]?d:e};this.calcWrapper=function(c,d){var e=a(c,d);if(e!==d&&b[e])throw"Duplicate value for index "+d+" => "+c;return e};B.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=this.index[a];if(b&&(!c||c===b))return this.index[a]=
b,true},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],true},destroy:function(){this.index=null}}),z=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},w=function(a,b){return function(c){if(!this.name)this.name=p(b);a.prototype.init.call(this,c)}},n=function(a){return function(b,c){o.setAccumulateState(true);b=(b||[]).map(this.wrapper);o.setAccumulateState(false);return a.prototype.sync.call(this,b,c)}},C=x(o,{wrapper:Function.$self,init:w(o,
"EntitySet"),sync:n(o),set:z(o,"set"),add:z(o,"add"),remove:z(o,"remove"),destroy:function(){o.prototype.destroy.call(this);delete this.wrapper}}),F=x(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),G=x(q,{init:w(q,"EntityCollection"),sync:n(q)});G.sourceHandler=q.sourceHandler;var H=x(s,{subsetClass:F,init:w(s,"EntityGrouping"),sync:n(s),getSubset:function(a,b){var c=s.prototype.getSubset.call(this,a,b);if(c)c.wrapper=this.wrapper;return c}}),t=function(a){if(this instanceof
t){var b=new J(a||r);return function(a,c){return a!=null?(c instanceof C||(c=b.createEntitySet()),c.set(a instanceof o?a.getItems():Array.from(a)),c):null}}};t.className="basis.entity.EntitySetWrapper";var J=x(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),D=function(a){if(this instanceof D){var b=function(a,b){if(a!=null){if(a===b||a.entityType===c)return a;var h,
i=c.idField;if(g[typeof a]){if(!i)return;h=a;a={};a[i]=h}else if(c.compositeKey)h=c.compositeKey(a,a);else if(i)h=a[i];else if(f&&(b=c.singleton,!b))return c.singleton=new e(a);h!=null&&d&&(b=d.get(h,c.entityClass));b&&b.entityType===c?b.update(a):b=new e(a);return b}else return c.singleton},c=new N(a||{},b),d=c.index__,e=c.entityClass,f=c.isSingleton;y(b,{toString:function(){return this.typeName+"()"},entityType:c,type:b,typeName:c.name,index:d,reader:function(a){return c.reader(a)},get:function(a){return c.get(a)},
addField:function(a,b){c.addField(a,b)},all:c.all,createCollection:function(a,d,e){var f=c.collection_[a];return!f&&d?c.collection_[a]=new G({wrapper:b,source:e||c.all,rule:d}):f},getCollection:function(a){return c.collection_[a]},createGrouping:function(a,d,e){var f=c.grouping_[a];return!f&&d?c.grouping_[a]=new H({wrapper:b,source:e||c.all,rule:d}):f},getGrouping:function(a){return c.grouping_[a]},getSlot:function(a,b){return c.getSlot(a,b)}});return b}};D.className="basis.entity.EntityTypeWrapper";
var M=u("singleton"),I={};x(l,{});var N=x(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:false,index__:null,slot_:null,init:function(b,c){this.name=b.name||p(this.name);this.index__=b.index;this.idFields={};a.push(this);this.isSingleton=b.isSingleton;this.wrapper=c;this.all=new F(Object.extend(b.all||{},{wrapper:c}));this.slot_={};if(b.extensible)this.extensible=true;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(b.fields,this.addField,this);b.constrains&&
b.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=M;b.aliases&&Object.iterate(b.aliases,this.addAlias,this);this.collection_={};if(b.collections)for(var d in b.collections)this.collection_[d]=new G({name:d,wrapper:c,source:this.all,rule:b.collections[d]||Function.$true});this.grouping_={};if(b.groupings)for(d in b.groupings)this.grouping_[d]=new H({name:d,wrapper:c,source:this.all,rule:b.groupings[d]||Function.$true});this.entityClass=L(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:c,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(g[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||a==null)return null;for(var c in a){var d=c in this.aliases?this.aliases[c]:"";d&&d in this.fields&&(b[d]=this.fields[d].reader?this.fields[d].reader(a[c]):a[c])}return b},addAlias:function(a,b){b in this.fields&&a in this.aliases==false&&(this.aliases[a]=b)},addField:function(a,
e){if(!this.all.itemCount){this.aliases[a]=a;typeof e=="function"&&(e={type:e});if("type"in e&&typeof e.type!="function")e.type=r;var f=e.type||r;if([b,c,d,i].has(f))e.id=true;if(e.id){if(!this.index__)this.index__=new h(String);this.idFields[a]=true;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=A.apply(null,Object.keys(this.idFields))):this.idField=a}e.calc?this.addCalcField(a,e.calc,void 0):this.fields[a]=f;this.defaults[a]="defValue"in e?e.defValue:f();this.getters["get_"+
a]=function(){return this.data[a]};I[a]||(I[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var d={args:b.args,wrapper:!c?b:function(a,d,e){return c(b(a,d,e))}},e=this.calcs.length,f=0,g=0;g<this.calcs.length;g++)b.args.has(this.calcs[g].key)&&(f=g+1);if(a){d.key=a;for(g=0;g<this.calcs.length;g++)if(this.calcs[g].args.has(a)){e=g;break}if(f>e)return;if(this.idField&&a==this.idField)this.compositeKey=b;this.fields[a]=
function(a,b){typeof console!="undefined"&&console.log("Calculate fields are readonly");return b}}else e=f;this.calcs.splice(Math.min(e,f),0,d)}},get:function(a){a=this.getId(a);if(a!=null)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&a!=null){if(g[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof l)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(b!=
null){var c=this.slot_[b];c||(g[typeof a]&&(c={},this.idField&&!this.compositeKey&&(c[this.idField]=a),a=c),c=this.slot_[b]=new l({delegate:this.get(b),data:a}));return c}}}),K=x(l,{init:m.prototype.init,event_rollbackUpdate:m.createEvent("rollbackUpdate")}),L=function(a,b,c,d,e,g,h){function i(b,c,d){var e=false,f=a.calcs,g=b.__id__,h=b.data;try{if(f)for(var j=0,l;l=f[j++];){var m=l.key;if(m){var n=h[m];h[m]=l.wrapper(c,h,h[m]);h[m]!==n&&(c[m]=n,e=true)}else l.wrapper(c,h)}if(a.compositeKey)b.__id__=
a.compositeKey(c,h,b.__id__);else if(s&&s in c)b.__id__=h[s];b.__id__!==g&&a.index__.calcWrapper(b.__id__)}catch(p){b.__id__=g;for(var o in c)b.data[o]=c[o];if(d)for(o in d)if(!b.modified)b.modified=d;e=false}b.__id__!==g&&k(b,g,b.__id__);return e}function k(a,b,e){b!=null&&(c.remove(b,a),d[b]&&d[b].setDelegate());e!=null&&(c.add(e,a),d[e]&&d[e].setDelegate(a))}var s=a.idField;return x(K,h,{canHaveDelegate:false,modified:null,isTarget:true,extendConstructor_:false,init:function(a){K.prototype.init.call(this);
this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var c,d={},f;for(f in e)f in a?(d[f]=g[f],c=e[f](a[f])):c=g[f],c&&c!==this&&c instanceof m&&c.addHandler(I[f],this)&&(this.fieldHandlers_[f]=true),this.data[f]=c;i(this,d);b.event_datasetChanged(b,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(b,c,d,f){var g=e[b];if(!g){if(!a.extensible)return;g=r}var h,j=this.modified,
c=g(c,this.data[b]),g=this.data[b];if(c!==g&&(!c||!g||c.constructor!==Date||g.constructor!==Date||+c!==+g))a:{h={};if(b!=s)if(d){if(!j)this.modified=j={};if(b in j===false)h.rollback={key:b,value:void 0},j[b]=g;else if(j[b]===c&&(h.rollback={key:b,value:c},delete j[b],!Object.keys(j).length))this.modified=null}else if(j&&b in j)if(j[b]!==c){h.rollback={key:b,value:j[b]};j[b]=c;break a}else return false;this.data[b]=c;this.fieldHandlers_[b]&&(g.removeHandler(I[b],this),this.fieldHandlers_[b]=false);
c&&c!==this&&c instanceof m&&c.addHandler(I[b],this)&&(this.fieldHandlers_[b]=true);h.key=b;h.value=g;h.delta={};h.delta[b]=g}else if(!d&&j&&b in j&&(h={rollback:{key:b,value:j[b]}},delete j[b],!Object.keys(j).length))this.modified=null;if(!f&&h){var d=h.key,b=h.delta||{},k;if(h.rollback)k={},k[h.rollback.key]=h.rollback.value;i(this,b,k)&&(d=true);if(d)this.event_update(this,b),h.delta=b;k&&this.event_rollbackUpdate(this,k)}return h||false},update:function(a,b){if(a){var c,d={},e,f={},g,h;for(h in a)if(g=
this.set(h,a[h],b,true)){if(g.key)c=true,d[g.key]=g.value;if(g.rollback)e=true,f[g.rollback.key]=g.rollback.value}i(this,d,f)&&(c=true);c&&this.event_update(this,d);e&&this.event_rollbackUpdate(this,f)}return c?d:false},reset:function(){this.update(g)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=j.PROCESSING){if(this.modified){var a=
this.modified;this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(j.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.data[a].removeHandler(I[a],this);this.fieldHandlers_=f;this.__id__&&k(this,this.__id__,null);l.prototype.destroy.call(this);b.event_datasetChanged(b,{deleted:[this]});this.data=f;this.modified=null}})};k.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof L},NumericId:b,NumberId:c,IntId:d,StringId:i,Index:h,CalculateField:v,
EntityType:D,Entity:L,BaseEntity:K,EntitySetType:t,EntitySet:C,ReadOnlyEntitySet:F,Collection:G,Grouping:H})})(basis);
(function(k){var p=k.Class,v=k.dom,A=k.html.Template,x=k.cssom.classList,B=Function.getter,y=k.Cleaner,r=k.dom.wrapper.Node,u=k.dom.wrapper.PartitionNode,z=k.dom.wrapper.GroupingNode,m=p.ExtensibleProperty(),o=function(k){return{template:new A("<div/>"),action:m,cssClassName:null,event_update:function(l,j){k.event_update.call(this,l,j);this.templateUpdate(this.tmpl,"update",j)},event_select:function(l){k.event_select.call(this,l);x(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(l){k.event_unselect.call(this,l);x(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(l){k.event_disable.call(this,l);x(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(l){k.event_enable.call(this,l);x(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(l){k.event_match.call(this,l);v.display(this.element,true)},event_unmatch:function(l){k.event_unmatch.call(this,l);v.display(this.element,
false)},init:function(l){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&v.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=v.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;k.init.call(this,l);if(this.id)this.element.id=
this.id;if(l=this.cssClassName){typeof l=="string"&&(l={element:l});for(var j in l){var f=this.tmpl[j];if(f)for(var f=x(f),g=String(l[j]).qw(),a=0,b;b=g[a++];)f.add(b)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&v.insert(this.container,this.element)},templateAction:function(k,j){var f=this.action[k];f&&f.call(this,j)},templateUpdate:function(){},destroy:function(){var l=this.element;k.destroy.call(this);l&&l.parentNode&&l.parentNode.removeChild(l);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},r=p(r,o,{}),B=p(u,o,{titleGetter:B("data.title"),templateUpdate:function(k){if(k.titleText)k.titleText.nodeValue=String(this.titleGetter(this))}}),o=function(k){return{insertBefore:function(l,j){var l=k.insertBefore.call(this,l,j),f=l.groupNode||this,g=l.nextSibling,f=f.childNodesElement||f.element||this.childNodesElement||this.element,a=l.element,g=(g&&g.element.parentNode==f?g.element:null)||f.insertPoint||null;(a.parentNode!==f||a.nextSibling!==
g)&&f.insertBefore(a,g);return l},removeChild:function(l){k.removeChild.call(this,l);var j=l.element,f=j.parentNode;f&&f.removeChild(j);return l},clear:function(l){if(l)for(var j=this.firstChild;j;){var f=j.element;f.parentNode&&f.parentNode.removeChild(f);j=j.nextSibling}k.clear.call(this,l)},setChildNodes:function(l,j){var f=v.createFragment(),g=this.localGrouping||this,a=g.childNodesElement||g.element;g.childNodesElement=f;k.setChildNodes.call(this,l,j);a.insertBefore(f,a.insertPoint||null);g.childNodesElement=
a}}},u=p(z,o,{childClass:B,localGroupingClass:p.SELF,event_ownerChanged:function(k,l){var j=this,f=this.owner,g=null;f&&(g=f.tmpl&&f.tmpl.groupsElement||f.childNodesElement||f.element,g.appendChild(this.nullElement));do j.element=j.childNodesElement=g;while(j=j.localGrouping);z.prototype.event_ownerChanged.call(this,k,l)},init:function(k){this.element=this.childNodesElement=this.nullElement=v.createFragment();z.prototype.init.call(this,k)}}),q=p(r,o,{childClass:r,childFactory:function(k){return new this.childClass(k)},
localGroupingClass:u}),p=p(q,{selection:{},init:function(k){this.document=this;q.prototype.init.call(this,k);y.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;q.prototype.destroy.call(this);y.remove(this)}}),o=function(k,l){for(var j=k.match(/\{(this_[^\}]+)\}/g)||[],f=[],g=0;g<j.length;g++){var a=j[g].match(/\{(this_[^\|\}]+)\}/)[1];f.push("this.tmpl."+a+".nodeValue = "+a.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(c,d,f){a.templateUpdate.call(this,c,d,f);_code_()}},config_)}.toString().replace("_code_()",f.join(";\n")))(new A(k),l)};k.namespace("basis.ui",o).extend({simpleTemplate:o,Node:r,Container:q,PartitionNode:B,GroupingNode:u,Control:p})})(basis);
