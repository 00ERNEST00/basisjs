/*

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>

 @author
 Vladimir Ratsev
 Roman Dvornov

 GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
*/
(function(){var S=document.getElementsByTagName("script"),j=S[S.length-1].src.replace(/[^/]+.js$/,"");!function(k){function x(f,a){for(var c in a)f[c]=a[c];return f}function j(f,a){for(var c in a)!1==c in f&&(f[c]=a[c]);return f}function r(f){return null==f||void 0==f}function q(f){return f}function y(f,a){for(var c=f.split("."),b=k,e,d,p;c.length;)if(e=c.shift(),d=(d?d+".":"")+e,b[e]||(b[e]=function(f,a){var c={},b="function"==typeof a?a:null,t=function(){if(b)return b.apply(this,arguments)};t.path=
f;t.names=function(f){return Object.slice(c,"string"==typeof f?f.qw():f)};t.extend=function(f){j(c,f);x(this,f);return this};t.setWrapper=function(a){"function"==typeof a&&(b&&"undefined"!=typeof console&&console.warn("Wrapper for "+f+" is already set. Probably mistake here."),b=a)};return t}(d,!c.length?a:null),p&&(p.namespaces_[d]=b[e])),b=b[e],!p)p=b,p.namespaces_||(p.namespaces_={});return C[f]=b}function s(f){return f.replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/i,"")}var n=k.document;x(Object,{extend:x,
complete:j,keys:function(f){var a=[],c;for(c in f)a.push(c);return a},values:function(f){var a=[],c;for(c in f)a.push(f[c]);return a},slice:function(f,a){var c={};if(!a)return x(c,f);for(var b=0,e;e=a[b++];)e in f&&(c[e]=f[e]);return c},splice:function(f,a){var c={};if(!a)return x(c,f);for(var b=0,e;e=a[b++];)e in f&&(c[e]=f[e],delete f[e]);return c},iterate:function(f,a,c){var b=[],e;for(e in f)b.push(a.call(c,e,f[e]));return b},coalesce:function(){for(var f=arguments,a=0;a<f.length;a++)if(null!=
f[a])return f[a]}});var u=function(){},m=function(){var f=1,a=[],c={},b={};return function(e,d){var p,h,g;if(!e||e===i)return i;"function"==typeof e?(g=e.basisGetterId_)?p=a[Math.abs(g)-1]:(p=function(f){return e(f)},p.base=e,p.__extend__=m,g=a.push(p),e.basisGetterId_=-g,p.basisGetterId_=g):(p=c[e])?g=p.basisGetterId_:(p=new Function("object","return object != null ? object."+e+" : object"),p.base=e,p.__extend__=m,g=a.push(p),p.basisGetterId_=g,c[e]=p);var l=null!=d&&typeof d;if(!l)return p;var o=
b[g],t;if("string"==l)t=l+d;else if("function"==l)t=d.basisModId_;else if("object"!=l)return p;if(t&&o&&o[t])return o[t];"function"==typeof p.base&&(p=p.base);switch(l){case "string":h=function(f){return d.format(p(f))};break;case "function":t||(t=l+f++,d.basisModId_=t);h=function(f){return d(p(f))};break;case "object":h=function(f){return d[p(f)]}}h.base=p.base||p;h.__extend__=m;t&&(o||(o={},b[g]=o),o[t]=h,h.mod=d,h.basisGetterId_=a.push(h));return h}}(),i=Function();i.__extend__=m;x(Function,{$undefined:function(f){return void 0==
f},$defined:function(f){return void 0!=f},$isNull:r,$isNotNull:function(f){return null!=f&&void 0!=f},$isSame:function(f){return f===this},$isNotSame:function(f){return f!==this},$self:q,$const:function(f){return function(){return f}},$false:function(){return!1},$true:function(){return!0},$null:function(){return null},$undef:u,getter:m,nullGetter:i,def:function(f,a,c){c=c||r;return function(b){b=f(b);return c(b)?a:b}},wrapper:function(f){return function(a){var c={};c[f]=a;return c}},lazyInit:function(f,
a){var c=0,b,e;return b=function(){c++||(b.inited=!0,b.data=e=f.apply(a||this,arguments));return e}},lazyInitAndRun:function(f,a,c){var b=0,e,d;return e=function(){b++||(e.inited=!0,e.data=d=f.call(c||this));a.apply(d,arguments);return d}},runOnce:function(f,a){var c=0;return function(){if(!c++)return f.apply(a||this,arguments)}}});j(Function.prototype,{bind:function(f){var a=this,c=Array.from(arguments,1);return c.length?function(){return a.apply(f,c.concat.apply(c,arguments))}:function(){return a.apply(f,
arguments)}},body:function(){return this.toString().replace(/^\s*\(?\s*function[^(]*\([^\)]*\)[^{]*\{|\}\s*\)?\s*$/g,"")}});j(Array,{isArray:function(f){return"[object Array]"===Object.prototype.toString.call(f)}});x(Array,{from:function(f,a){if(null!=f){var c=f.length;if("undefined"==typeof c)return[f];a||(a=0);if(0<c-a){for(var b=[],e=0,d=a;d<c;)b[e++]=f[d++];return b}}return[]},create:function(f,a,c){for(var b=[],e="function"==typeof a,d=0;d<f;d++)b[d]=e?a.call(c,d,b):a;return b}});j(Array.prototype,
{indexOf:function(f,a){a=parseInt(a)||0;if(0>a)return-1;for(;a<this.length;a++)if(this[a]===f)return a;return-1},lastIndexOf:function(f,a){for(var c=this.length,a=parseInt(a),a=isNaN(a)||a>=c?c-1:(a+c)%c;0<=a;a--)if(this[a]===f)return a;return-1},forEach:function(f,a){for(var c=0,b=this.length;c<b;c++)c in this&&f.call(a,this[c],c,this)},every:function(f,a){for(var c=0,b=this.length;c<b;c++)if(c in this&&!f.call(a,this[c],c,this))return!1;return!0},some:function(a,c){for(var b=0,e=this.length;b<e;b++)if(b in
this&&a.call(c,this[b],b,this))return!0;return!1},filter:function(a,c){for(var b=[],e=0,d=this.length;e<d;e++)e in this&&a.call(c,this[e],e,this)&&b.push(this[e]);return b},map:function(a,c){for(var b=[],e=0,d=this.length;e<d;e++)e in this&&(b[e]=a.call(c,this[e],e,this));return b},reduce:function(a,c){var b=this.length,e=arguments.length;if(0==b&&1==e)throw new TypeError;var d,h=0;1<e&&(d=c,h=1);for(e=0;e<b;e++)e in this&&(d=h++?a.call(null,d,this[e],e,this):this[e]);return d}});x(Array.prototype,
{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[0<=a?a:this.length+a]},search:function(a,c,b){Array.lastSearchIndex=-1;for(var c=Function.getter(c||q),b=parseInt(b)||0,e=this.length;b<e;b++)if(c(this[b])===a)return this[Array.lastSearchIndex=b]},lastSearch:function(a,c,b){Array.lastSearchIndex=-1;for(var c=Function.getter(c||q),e=this.length,b=isNaN(b)||null==b?e:parseInt(b),
e=b>e?e:b;0<e--;)if(c(this[e])===a)return this[Array.lastSearchIndex=e]},binarySearchPos:function(a,c,b,e,d,h){if(!this.length)return e?-1:0;var c=Function.getter(c||q),b=!!b,p,d=isNaN(d)?0:d,g=isNaN(h)?this.length-1:h;do if(h=d+g>>1,p=c(this[h]),b?a>p:a<p)g=h-1;else if(b?a<p:a>p)d=h+1;else return a==p?h:e?-1:0;while(d<=g);return e?-1:h+(p<a^b)},binarySearch:function(a,c){return this.binarySearchPos(a,c,!1,!0)},add:function(a){return-1==this.indexOf(a)&&!!this.push(a)},remove:function(a){a=this.indexOf(a);
return-1!=a&&!!this.splice(a,1)},has:function(a){return-1!=this.indexOf(a)},merge:function(a){return this.reduce(x,a||{})},sortAsObject:function(a,c,b){a=Function.getter(a);b=b?-1:1;return this.map(function(c,b){return{i:b,v:a(c)}}).sort(c||function(a,f){return b*(a.v>f.v||-(a.v<f.v)||(a.i>f.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){this!==a&&(this.length=0,this.push.apply(this,a));return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var l=
Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);2>a.length&&(a[1]=this.length);return l.apply(this,a)}}var o={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"},E=/([\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$])/g,v=/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,w={};String.Entity={laquo:"\u00ab",raquo:"\u00bb",nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};j(String,{toLowerCase:function(a){return(""+
a).toLowerCase()},toUpperCase:function(a){return(""+a).toUpperCase()},trim:function(a){return(""+a).trim()},trimLeft:function(a){return(""+a).trimLeft()},trimRight:function(a){return(""+a).trimRight()},isEmpty:function(a){return null==a||""==""+a},isNotEmpty:function(a){return null!=a&&""!=""+a}});j(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});x(String.prototype,{toObject:function(a){try{return Function("return 0,"+
this)()}catch(c){if(a)throw c;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],c=this.length,b=0;b<c;b++)a[b]=this.charAt(b);return a},repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(E,"\\$1")},format:function(a){for(var c={},b=0;b<arguments.length;b++)c[b]=arguments[b];"object"==typeof a&&x(c,a);return this.replace(v,function(a,f,b,e,d){a=f in
c?c[f]:d?"":a;return b&&!isNaN(a)?(a=Number(a),"."==b?a.toFixed(e):a.lead(e)):a})},quote:function(a,c){var a=a||'"',c=c||o[a]||a,b=(1==a.length?a:"")+(1==c.length?c:"");return a+(b?this.replace(w[b]||(w[b]=RegExp("["+b.forRegExp()+"]","g"),"\\$&")):this)+c},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,c){return c.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+
a.toLowerCase()})}});String.format=String.prototype.format;11!="|||".split(/\|/).length+"|||".split(/(\|)/).length&&(String.prototype.split=function(a){if(""==a||a&&""==a.source)return this.toArray();var c=[],b=0,e;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));e=a.exec(this);)e[0]=this.substring(b,e.index),c.push.apply(c,e),b=a.lastIndex;else for(;-1!=(e=this.indexOf(a,b));)c.push(this.substring(b,e)),b=e+a.length;c.push(this.substr(b));return c});if("2"!="12".substr(-1)){var z=
String.prototype.substr;String.prototype.substr=function(a,c){return z.call(this,a<0?Math.max(0,this.length+a):a,c)}}x(Number.prototype,{fit:function(a,c){return!isNaN(a)&&this<a?Number(a):!isNaN(c)&&this>c?Number(c):this},between:function(a,c){return!isNaN(this)&&this>=a&&this<=c},quote:function(a,c){return(this+"").quote(a,c)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return this<0?-1:+(this>0)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},
lead:function(a,c){return(this+"").replace(/\d+/,function(b){return(a=a-(b.length-1))>1?Array(a).join(c||0)+b:b})},group:function(a,c){return(this+"").replace(/\d+/,function(b){return b.replace(/\d/g,function(e,d){return!d+(b.length-d)%(a||3)?e:(c||" ")+e})})},format:function(a,c,b,e,d){a=this.toFixed(a);if(c||d)a=a.replace(/(\d+)(\.?)/,function(a,b,e){return(c?Number(b).group(3,c):b)+(e?d||e:"")});b&&(a=a.replace(/^-?/,"$&"+(b||"")));return a+(e||"")}});j(Date,{now:function(){return+new Date}});
1900>(new Date).getYear()&&x(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&a<100?Number(a)+1900:a)}});var C={};Function();var D=function(){var a=Array.from(k.document?n.getElementsByTagName("SCRIPT"):null),c={basis:s(a&&a.length?a.item(-1).src:module.filename)},b={},d;if(typeof require=="function"){var h=module.filename.replace(/[^\/\\]+$/,"");d=function(a){return function(){var c=module.constructor.prototype.load;module.constructor.prototype.load=
function(b){this.exports=y(a);c.apply(this,arguments)};var b=require(h+a.replace(/\./g,"/"));module.constructor.prototype.load=c;return b}()}}else{d=function(a,f){if(/[^a-z0-9\_\.]/i.test(a))throw"Namespace `"+a+"` contains wrong chars.";var h=a.replace(/\./g,"/")+".js",g=a.split(".")[0];g==a&&(c[g]=f||s(location?location.href:""));g=c[g];if(!C[a]){if(!/^https?:/.test(g))throw"Path `"+a+"` ("+g+") can't be resolved";if(b[a])throw"Recursive require for "+a;b[a]=true;e(basis.namespace(a),g+h)();d.sequence.push(h)}};
d.sequence=[]}return d}(),g={},d=function(a){if(a in g==false){var c="",b=new XMLHttpRequest;b.open("GET",a,false);b.setRequestHeader("If-Modified-Since",(new Date(0)).toGMTString());b.send("");b.status>=200&&b.status<400?c=b.responseText:typeof console!="undefined"&&console.warn("basis.resource: Unable to load "+a);g[a]=c}return g[a]},h=function(){if(typeof require=="function"){var a=require("path");return function(c){return a.resolve(__dirname,c)}}var c=n.createElement("A");return function(a){c.href=
a;return c.href}}(),b={},a=function(a){a=h(a);if(!b[a]){var c=[],e=function(){return d(a)};e.url=a;e.toString=e;e.update=function(b){b=""+b;if(b!=g[a]){g[a]=b;for(var e=0,d;d=c[e];e++)d.handler.call(d.context,b)}};e.reload=function(){var c=g[a];delete g[a];var b=d(a);if(b!=c){delete g[a];this.update(b)}};e.bindingBridge={attach:function(a,b,e){for(var a=0,f;f=c[a];a++)if(f.handler==b&&f.context==e)return false;c.push({handler:b,context:e});return true},detach:function(a,b){for(var e=0,f;f=c[e];e++)if(f.handler==
a&&f.context==b){c.splice(e,1);return true}return false},get:function(){return d(a)}};b[a]=e}return b[a]},e=function(c,b){var e=s(b);return function(){var h=d(b);if(typeof c.exports!="object")c.exports={};try{Function("exports, module, basis, global, __filename, __dirname, resource",h+"//@ sourceURL="+b).call(c,c.exports,c,basis,k,b,e,function(c){return a(e+c)})}catch(g){throw g;}return c}};(function(){function a(c){return typeof c=="function"&&!!c.basisClassId_}function c(a){for(var b=this;b&&b!==
a;)b=b.superClass_;return b===a}var b=Function(),e=1,d=1,h=Function(),p={},g=function(){for(var a in{toString:1})return;return true}();x(b,{className:"basis.Class",extendConstructor_:false,prototype:{constructor:null,init:h,postInit:h,toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=u}},create:function(h){typeof h!="function"&&(h=b);var t=Function();t.prototype=h.prototype;for(var t=new t,F=d++,F={className:h.className+
"._Class"+F,basisClassId_:F,superClass_:h,extendConstructor_:!!h.extendConstructor_,isSubclassOf:c,subclass:function(){return b.create.apply(null,[g].concat(Array.from(arguments)))},extend:b.extend,__extend__:function(c){return c&&c!==p&&(typeof c=="object"||typeof c=="function"&&!a(c))?b.create.call(null,g,c):c},prototype:t},I=1,M;M=arguments[I];I++)F.extend(typeof M=="function"&&!a(M)?M(h.prototype):M);var H={},g=F.extendConstructor_?function(a,c){this.eventObjectId=e++;var b,I;for(I in a){b=this[I];
this[I]=b&&b.__extend__?b.__extend__(a[I]):a[I]}this.init(c||H);this.postInit()}:function(){this.eventObjectId=e++;this.init.apply(this,arguments);this.postInit()};t.constructor=g;for(var L in t)t[L]===p&&(t[L]=g);x(g,F);return g},extend:function(a){var c=this.prototype;if(a.prototype)a=a.prototype;for(var b in a){var e=a[b],f=c[b];b=="className"||b=="extendConstructor_"?this[b]=e:c[b]=f&&f.__extend__?f.__extend__(e):e}if(g&&a[b="toString"]!==Object.prototype[b])c[b]=a[b];return this}});var i=function(a,
c){return{__extend__:function(a){if(!a||a&&a.__extend__)return a;var b=Function();b.prototype=this;b=new b;c(b,a);return b}}.__extend__(a||{})},l=function(a){return i(a,x)};return y("basis.Class",b.create).extend({SELF:p,BaseClass:b,create:b.create,isClass:a,customExtendProperty:i,extensibleProperty:l,nestedExtendProperty:function(a){return i(a,function(a,c){for(var b in c){var e=a[b];a[b]=e&&e.__extend__?e.__extend__(c[b]):l(c[b])}})},oneFunctionProperty:function(a,b){var c=function(b){var e;if(b){if(b.__extend__)return b;
e={__extend__:c};for(var f in b)b[f]&&(e[f]=a)}return e};return c(b||{})}})})();var c=function(){var a=[];return{add:function(b){b!=null&&a.push(b)},remove:function(b){a.remove(b)}}}();y("basis").extend({namespace:y,require:D,resource:a,wrapScript:e,platformFeature:{},Cleaner:c});k.basis.locale={}}(this);(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){var k=global.document,x=basis.Cleaner,j=Function.getter;(function(){global.msSetImmediate&&global.msClearImmediate&&
(global.setImmediate=global.msSetImmediate,global.clearImmediate=global.msClearImmediate);if(!global.setImmediate){var r="setImmediate.basis",x=function(k){global.nativeSetTimeout_(function(){j(k)},0)},j=function(){var k={},m=1;global.setImmediate=function(){k[++m]={fn:arguments[0],args:Array.from(arguments,1)};x(m);return m};global.clearImmediate=function(i){delete k[i]};return function(i){var l=k[i];if(l)try{typeof l.fn=="function"?l.fn.apply(void 0,l.args):(global.execScript||function(i){global.eval.call(global,
i)})(""+l.fn)}finally{delete k[i]}}}();if(global.MessageChannel)x=function(k){var m=new global.MessageChannel;m.port1.onmessage=function(){j(k)};m.port2.postMessage("")};else{var s=global.postMessage&&!global.importScripts;if(s){var n=global.onmessage;global.onmessage=function(){s=false};global.postMessage("","*");global.onmessage=n}s?(n=function(k){if(k&&k.source==global)(k=(""+k.data).split(r)[1])&&j(k)},global.addEventListener?global.addEventListener("message",n,!0):global.attachEvent("onmessage",
n),x=function(k){postMessage(r+k,"*")}):k&&"onreadystatechange"in k.createElement("script")&&(x=function(n){var m=k.createElement("script");m.onreadystatechange=function(){j(n);m.onreadystatechange=null;m.parentNode.removeChild(m);m=null};k.documentElement.appendChild(m)})}}global.nativeSetTimeout_=global.setTimeout;global.nativeClearTimeout_=global.clearTimeout;global.setTimeout=function(k,m){return isNaN(m)||m<=0?r+global.setImmediate(k):global.nativeSetTimeout_(k,m)};global.clearTimeout=function(k){var m=
(""+k).split(r)[1];return m?global.clearImmediate(m):global.nativeClearTimeout_(k)}})();this.extend({TimeEventManager:function(){function k(){if(!o)if(u.length){var m=Date.now(),n=Math.max(u[0].eventTime,m);n<i&&(clearTimeout(l),l=setTimeout(y,(i=n)-m))}else l=clearTimeout(l),i=s}function q(i,l){var o=i.eventObjectId,n=m[l]&&m[l][o];n&&(u.remove(n),delete m[l][o],k())}function y(){var l=Date.now(),l=u.binarySearchPos(l+15,n);o=!0;u.splice(0,l).forEach(function(i){delete m[i.eventName][i.object.eventObjectId];
i.callback.call(i.object)});o=!1;i=s;k()}var s=2E12,n=j("eventTime"),u=[],m={},i=s,l=null,o=!1;x.add({destroy:function(){o=!0;clearTimeout(l);u.length=0;m=null}});return{add:function(i,l,o){var x=i.eventObjectId,j=m[l];j||(j=m[l]={});var s=j[x];if(s){if(isNaN(o))return q(i,l);if(s.eventTime==o)return;u.remove(s);s.eventTime=o}else{if(isNaN(o))return;s=j[x]={eventName:l,object:i,eventTime:o,callback:i[l]}}u.splice(u.binarySearchPos(o,n),0,s);k()},remove:q}}()})}.body()+"//@ sourceURL="+j+"src/basis/timer.js")).call(basis.namespace("basis.timer"),
basis.namespace("basis.timer"),basis.namespace("basis.timer").exports,this,j+"src/basis/timer.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(k){var n=q[k];n||(n=q[k]=function(){var j=this.handlers_,m,i;n.listen&&(i=this.listen[n.listenName])&&n.listen.call(this,i,arguments);if(j&&j.length)for(var j=r.call(j),l=j.length;0<l--;)m=j[l],(i=m.handler[k])&&"function"==typeof i&&
i.apply(m.thisObject,arguments),(i=m.handler["*"])&&"function"==typeof i&&i.call(m.thisObject,{sender:this,type:k,args:arguments})},y[k]&&j(n,y[k]));return n}var x=basis.Class,j=Object.extend,r=Array.prototype.slice,q={},y={},x=x(null,{className:this.name+".EventObject",handlers_:null,event_destroy:k("destroy","object"),listen:x.nestedExtendProperty(),extendConstructor_:!0,init:function(){this.handler&&(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||
this})},addHandler:function(k,n){var j=this.handlers_;j||(j=this.handlers_=[]);n||(n=this);for(var m=j.length,i;0<m--;)if(i=j[m],i.handler===k&&i.thisObject===n)return!1;return!!j.push({handler:k,thisObject:n})},removeHandler:function(k,n){var j=this.handlers_;if(j){n||(n=this);for(var m=j.length,i;0<m--;)if(i=j[m],i.handler===k&&i.thisObject===n)return!!j.splice(m,1);return!1}},destroy:function(){this.handlers_&&(q.destroy.call(this,this),this.handlers_=null)}});this.extend({LISTEN:{add:function(k,
n,x,m){x||(x=k);y[n]={listenName:k,listen:m||function(i,l){var k;(k=l[1])&&k.removeHandler(i,this);(k=this[x])&&k.addHandler(i,this)}};(k=q[n])&&j(k,y[n])}},create:k,events:q,EventObject:x})}.body()+"//@ sourceURL="+j+"src/basis/event.js")).call(basis.namespace("basis.event"),basis.namespace("basis.event"),basis.namespace("basis.event").exports,this,j+"src/basis/event.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",
function(){function k(i){for(var k=1E6,i=(""+i).split("."),l=0,m=0;4>l&&l<i.length;l++,k/=100)m+=i[l]*k;return m}function j(){for(var i=0;i<arguments.length;i++){var l=arguments[i].toLowerCase();if(l in B){if(B[l])return!0}else{var m=l.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(m){B[l]=!1;var n=m[1].toLowerCase(),x=k(m[3]),m=m[4]||"=";if(n=r[n])return B[l]=!x||"="==m&&n==x||"+"==m&&n>=x||"-"==m&&n<x}}}return!1}var B={},r={},q=global.navigator&&global.navigator.userAgent||"",y="unknown",s={MSIE:["Internet Explorer",
"msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},n;for(n in s)if(!("MSIE"==n&&global.opera)&&!("Safari"==n&&q.match(/chrome/i))&&!("AppleWebKit"==n&&q.match(/iphone/i))&&q.match(RegExp(n+".(\\d+(\\.\\d+)*)","i")))for(var u=s[n],m=global.opera&&
"function"==typeof global.opera.version?global.opera.version():RegExp.$1,i=k(m),y=u[0]+" "+m,m=0;m<u.length;m++)r[u[m].toLowerCase()]=i;basis.platformFeature.datauri=!1;q="undefined"!=typeof Image?new Image:{};q.onload=function(){basis.platformFeature.datauri=!0};q.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";s={set:function(i,l,k,m){document.cookie=i+"="+(null==l?"":escape(l))+";path="+(m||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)+(k?";expires="+
(new Date(Date.now()+1E3*k)).toGMTString():"")},get:function(i){return(i=document.cookie.match(RegExp("(^|;)\\s*"+i+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(i[2])},remove:function(i,l){document.cookie=i+"=;expires="+(new Date(0)).toGMTString()+";path="+(l||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)}};if(j("IE7-"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(l){}this.toString=function(){return y};this.extend({testImage:q,prettyName:y,test:j,is:function(i){return j(i)},
cookies:s,Cookies:s})}.body()+"//@ sourceURL="+j+"src/basis/ua.js")).call(basis.namespace("basis.ua"),basis.namespace("basis.ua"),basis.namespace("basis.ua").exports,this,j+"src/basis/ua.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(a,b,c){if(null!=b)return a.insertBefore(C(b)?b:q(b),c||null)}function j(a,b){return a.outerHTML||s("",b?a:a.cloneNode(!0)).innerHTML}
function B(a){return C(a)||a&&a.nodeType?a:"string"==typeof a?m.getElementById(a):null}function r(a,b,c){var f,d=[],c="string"==typeof c?getter(c):c||Function.$true;b&26&&c(a)&&d.push(a);switch(b){case 1:case 2:for(f=a;(f=f[o])&&f!==a.document;)c(f)&&d.push(f);break;case 64:for(f=a[E];f;)c(f)&&d.push(f),f=f[v];break;case 4:case 8:a[E]&&(b=new D(a),b.nodes(c,d));break;case 128:b=new D(a,c);for(b.cursor_=a[v]||a[o];f=b.next();)d.push(f);break;case 256:for(f=a;f=f[v];)c(f)&&d.push(f);break;case 32:c(a[o])&&
d.push(a[o]);break;case 512:b=new D(a,c,D.BACKWARD);for(b.cursor_=a[w]||a[o];f=b.next();)d.push(f);break;case 1024:for(f=a;f=f[w];)c(f)&&d.push(f)}return d}function q(a){return m.createTextNode(null!=a?a:"")}function y(){for(var a=m.createDocumentFragment(),b=arguments.length,c=y.array=[],f=0;f<b;f++)c.push(k(a,arguments[f]));return a}function s(a,e){var c=void 0!=a&&"string"!=typeof a,f=(c?a.description:a)||"",g="div",i=f.match(/^([a-z0-9\_\-]+)(.*)$/i);i&&(g=i[1],f=i[2]);if(""!=f){for(var K=[],
l={},o;i=b.exec(f);){if(i[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+f+"\n\nProblem place:\n> "+f.substr(0,i.index)+"--\>"+f.substr(i.index)+"<--");o=i[1]||i[2]||i[3];i[1]?l.id=o:i[2]?K.push(o):"class"!=o&&(l[o]=i[4]?i[5]||i[6]||i[7]||"":o)}d&&l.name&&/^(input|textarea|select)$/i.test(g)&&(g="<"+g+" name="+l.name+">")}f=m.createElement(g);if(l){l.style&&h&&(f.style.cssText=l.style);for(var p in l)f.setAttribute(p,l[p],0)}K&&K.length&&(f.className=K.join(" "));
1<arguments.length&&k(f,y.apply(0,Array.from(arguments,1).flatten()));if(c&&(a.css&&basis.cssom&&basis.cssom.setStyle(f,a.css),basis.dom.event))for(var L in a)"function"==typeof a[L]?basis.dom.event.addHandler(f,L,a[L],f):a[L]instanceof basis.dom.event.Handler&&basis.dom.event.addHandler(f,L,a[L].handler,a[L].thisObject);return f}function n(a,b){return a[o]?a[o].replaceChild(b,a):a}function u(a){if(m.selection){var b=m.selection.createRange();0!=b.compareEndPoints("StartToEnd",b)&&b.collapse(a);return b.getBookmark().charCodeAt(2)-
2}}var m=global.document,i=basis.Class,l=m.createElement("div"),o="parentNode",E="firstChild",v="nextSibling",w="previousSibling",z;z="function"==typeof l.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)}:function(a,b){return a==b?0:a.document!=b.document?33:a.sourceIndex>b.sourceIndex?2|8*b.contains(childA):4|16*a.contains(childB)};var C;"undefined"!=typeof Node?(C=function(a){return a instanceof Node},Node.prototype.contains||(Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&
16)})):C=function(a){return a&&a.ownerDocument===m};var D=i(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,b,c){this.setRoot(a);this.setDirection(c);if(typeof b=="function")this.filter=b},setDirection:function(a){Object.extend(this,a?{a:"lastChild",b:w,c:v,d:E}:{a:E,b:v,c:w,d:"lastChild"})},setRoot:function(a){this.root_=a||m;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},
nodes:function(a,b){var c;b||(b=[]);for(this.reset();c=this.next(a);)b.push(c);return b},next:function(a){var a=a||this.filter,b=this.cursor_||this.root_;do for(var c=b[this.a];!c;){if(b===this.root_)return this.cursor_=null;(c=b[this.b])||(b=b[o])}while(!a(b=c));return this.cursor_=b},prev:function(a){var a=a||this.filter,b=this.cursor_,c=this.c,f=this.d;do{var d=b?b[c]:this.root_[f];if(d){for(;d[f];)d=d[f];b=d}else b&&(b=b[o]);if(!b||b===this.root_){b=null;break}}while(!a(b));return this.cursor_=
b},destroy:function(){this.cursor_=this.root_=null}});D.BACKWARD=!0;var g="textContent innerText nodeValue".qw(),d=function(){var a=m.createElement("input");a.name="a";return!/name/.test(j(a))}(),h;l.setAttribute("style","color: red");h="red"!==l.style.color;var b=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;this.extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,
PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:D,outerHTML:j,textContent:function(a){for(var b=0,c;c=g[b++];)if(a[c]!=
null)return a[c];return r(a,4,function(a){return a.nodeType==3}).map(getter("nodeValue")).join("")},get:B,tag:function(a,b){a=B(a)||m;return b=="*"&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(b||"*"))},axis:r,findAncestor:function(a,b,c){for(;a&&a!==c;){if(b(a))return a;a=a.parentNode}},createElement:s,createText:q,createFragment:y,insert:function(a,b,c,f){a=B(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(c){case void 0:case "end":f=null;break;case "begin":f=
a[E];break;case "before":break;case "after":f=f[v];break;default:f=Number(c).between(0,a.childNodes.length)?a.childNodes[c]:null}c=!C(a);if(!b||!Array.isArray(b))c=c?b&&a.insertBefore(b,f):k(a,b,f);else if(c)for(var c=[],d=0,h=b.length;d<h;d++)c[d]=a.insertBefore(b[d],f);else{a.insertBefore(y.apply(0,b),f);c=y.array}return c},remove:function(a){return a[o]?a[o].removeChild(a):a},replace:n,swap:function(a,b){if(a===b||z(a,b)&25)return false;n(a,l);n(b,a);n(l,b);return true},clone:function(a,b){var c=
a.cloneNode(!b);c.attachEvent&&r(c,8).forEach(Event.clearHandlers);return c},clear:function(a){for(a=B(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,b,c){var f=[],c=Function.getter(c||Function.$self),d;for(d in b)for(var h=0;h<a.length;h++){var g=c(a[h]);f[h]=b[d](a[h],h,g)?s(d,g):a[h]}return f},setAttribute:function(a,b,c){c==null?a.removeAttribute(b):a.setAttribute(b,c)},parentOf:function(a,b){return a.contains(b)},isInside:function(a,b){return a==b||b.contains(a)},focus:function(a,
b){try{a=B(a);a.focus();b&&a.select&&a.select()}catch(c){}},setSelectionRange:function(a,b,c){arguments.length<3&&(c=b);if(a.setSelectionRange)a.setSelectionRange(b,c);else if(a.createTextRange){var f=a.createTextRange();f.collapse(true);f.moveStart("character",b);f.moveEnd("character",c-b);f.select()}},getSelectionStart:function(a){return typeof a.selectionStart!="undefined"?a.selectionStart:u(true)},getSelectionEnd:function(a){return typeof a.selectionEnd!="undefined"?a.selectionEnd:u(false)}})}.body()+
"//@ sourceURL="+j+"src/basis/dom.js")).call(basis.namespace("basis.dom"),basis.namespace("basis.dom"),basis.namespace("basis.dom").exports,this,j+"src/basis/dom.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(g){return g||global.event}function j(g){return"string"==typeof g?i.get(g):g}function B(g){g=k(g);g.stopPropagation?g.stopPropagation():g.cancelBubble=!0}function r(g){g=
k(g);g.preventDefault?g.preventDefault():g.returnValue=!1}function q(g,d){(d=j(d))?s(d,g,q):(r(g),B(g))}function y(g){var d=Array.from(w[g.type]);if(d)for(var h=d.length;0<h--;){var b=d[h];b.handler.call(b.thisObject,g)}}function s(g,d,h,b){g=j(g);if(!g)throw"basis.event.addHandler: can't attach event listener to undefined";if("function"!=typeof h)throw"basis.event.addHandler: handler is not a function";g[E]||(g[E]={});var a={handler:h,thisObject:b},e=g[E],c=e[d];if(c){for(g=0;e=c[g];g++)if(e.handler===
h&&e.thisObject===b)return;c.push(a)}else c=e[d]=[a],c.fireEvent=function(a){a=k(a);if(z&&a&&w[d]&&"undefined"==typeof a.returnValue){y(a);if(!0===a.cancelBubble)return;"undefined"==typeof a.returnValue&&(a.returnValue=!0)}for(var b=0,e;e=c[b++];)e.handler.call(e.thisObject,a)},g.addEventListener?g.addEventListener(d,c.fireEvent,!1):g.attachEvent("on"+d,c.fireEvent)}function n(g,d,h,b){var g=j(g),a=g[E];if(a&&(a=a[d]))for(var e=0,c;c=a[e];e++)if(c.handler===h&&c.thisObject===b){a.splice(e,1);a.length||
u(g,d);break}}function u(g,d){var g=j(g),h=g[E];if(h)if("string"!=typeof d)for(d in h)u(g,d);else{var b=h[d];b&&(g.removeEventListener?g.removeEventListener(d,b.fireEvent,!1):g.detachEvent("on"+d,b.fireEvent),delete h[d])}}var m=global.document,i=basis.dom,l=Function.$null,o=!!m.addEventListener,E="__basisEvents",v={mousewheel:["mousewheel","DOMMouseScroll"]},w={},z=!m.addEventListener,C=function(){function g(){if(!h++)for(var a=0;a<b.length;a++)b[a].callback.call(b[a].thisObject)}function d(){try{m.documentElement.doScroll("left"),
g()}catch(a){setTimeout(d,1)}}var h=!1,b=[];if("undefined"!=typeof window){if(o)s(m,"DOMContentLoaded",g);else{s(m,"readystatechange",g);try{null==window.frameElement&&m.documentElement.doScroll&&d()}catch(a){}}s(global,"load",g)}return function(a,c){h||b.push({callback:a,thisObject:c})}}(),D={};this.setWrapper(k);this.extend({W3CSUPPORT:o,KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,
INSERT:45,DELETE:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(g){return v[g]||[g]},Handler:function(g,d){this.handler=g;this.thisObject=d},sender:function(g){g=k(g);return g.target||g.srcElement},cancelBubble:B,cancelDefault:r,kill:q,key:function(g){g=k(g);return g.keyCode||g.which||0},charCode:function(g){g=k(g);return g.charCode||g.keyCode||0},
mouseButton:function(g,d){g=k(g);return"number"==typeof g.which?g.which==d.VALUE:g.button&d.BIT},mouseX:function(g){g=k(g);return g.changedTouches?g.changedTouches[0].pageX:"pageX"in g?g.pageX:g.clientX+(m.documentElement.scrollLeft||m.body.scrollLeft)},mouseY:function(g){g=k(g);return g.changedTouches?g.changedTouches[0].pageY:"pageY"in g?g.pageY:g.clientY+(m.documentElement.scrollTop||m.body.scrollTop)},wheelDelta:function(g){g=k(g);return"wheelDelta"in g?g.wheelDelta/120:"DOMMouseScroll"==g.type?
-g.detail/3:0},addGlobalHandler:function(g,d,h){var b=w[g];if(b)for(g=b.length;0<g--;){var a=b[g];if(a.handler===d&&a.thisObject===h)return}else z?s(m,g,l):m.addEventListener(g,y,!0),b=w[g]=[];b.push({handler:d,thisObject:h})},removeGlobalHandler:function(g,d,h){var b=w[g];if(b)for(var a=0,e;e=b[a];a++)if(e.handler===d&&e.thisObject===h){b.splice(a,1);b.length||(delete w[g],z?n(m,g,l):m.removeEventListener(g,y,!0));break}},addHandler:s,addHandlers:function(g,d,h){var g=j(g),b;for(b in d)s(g,b,d[b],
h)},removeHandler:n,clearHandlers:u,fireEvent:function(g,d,h){g=j(g);(g=g[E])&&g[d]&&g[d].fireEvent(h)},onLoad:C,onUnload:function(g,d){s(global,"unload",g,d)},getEventInfo:function(g,d){d||(d="div");var h=d+"-"+g;if(D[h])return D[h];var b=!1,a=!1;if(!o){var e="on"+g,c=i.createElement(d);i.createElement("div",c)[e]=function(){a=!0};try{c.fireEvent(e),b=!0}catch(f){}}return D[h]={supported:b,bubble:a}}});basis.namespace("basis.dom").extend({ready:C})}.body()+"//@ sourceURL="+j+"src/basis/dom/event.js")).call(basis.namespace("basis.dom.event"),
basis.namespace("basis.dom.event"),basis.namespace("basis.dom.event").exports,this,j+"src/basis/dom/event.js",j+"src/basis/dom/",basis,function(k){return basis.resource(j+"src/basis/dom/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(d,h,b){for(var a=1,e;h;)h&1&&(e=E[a],b&a?(d.addHandler(e.handler,e.context),e.action(e.context.add,d)):(d.removeHandler(e.handler,e.context),e.action(e.context.remove,d))),h>>=1,a<<=1}function j(d){return Array.isArray(d)?
d.map(j):{data:d}}var B=basis.Class,r=Object.values,q=Function.$self,y=basis.event.EventObject,s=basis.event.LISTEN,n=basis.event.create,u=basis.event.events,m={},i=[],l={},o={PRIORITY:[],add:function(d,h){var b=d.toUpperCase(),a=d.toLowerCase();this[b]=a;l[a]=b;h=h?this.PRIORITY.indexOf(h):-1;-1==h?this.PRIORITY.push(a):this.PRIORITY.splice(h,0,a)},getList:function(){return Object.values(l)}};o.add("READY");o.add("DEPRECATED");o.add("UNDEFINED");o.add("ERROR");o.add("PROCESSING");var E={},v=1,w=
{NONE:0,ALL:0,add:function(d,h,b){E[v]={handler:h,action:b,context:{add:function(a,b){if(b){var c=w[d]+"_"+a.eventObjectId;b.subscribers_||(b.subscribers_={});if(!b.subscribers_[c]){var f=b.subscriberCount;b.subscribers_[c]=a;b.subscriberCount+=1;b.event_subscribersChanged(b,f)}}},remove:function(a,b){if(b){var c=w[d]+"_"+a.eventObjectId;if(b.subscribers_[c]){var f=b.subscriberCount;delete b.subscribers_[c];b.subscriberCount-=1;b.event_subscribersChanged(b,f)}}}}};w[d]=v;w.ALL|=v;v<<=1}};w.add("DELEGATE",
{delegateChanged:function(d,h){this.remove(d,h);this.add(d,d.delegate)}},function(d,h){d(h,h.delegate)});w.add("TARGET",{targetChanged:function(d,h){this.remove(d,h);this.add(d,d.target)}},function(d,h){d(h,h.target)});s.add("delegate","delegateChanged");s.add("target","targetChanged");var z=B(y,{state:o.READY,data:null,canHaveDelegate:!0,delegate:null,root:null,cascadeDestroy:!1,isTarget:!1,target:null,active:!1,subscribeTo:w.DELEGATE+w.TARGET,subscriberCount:0,subscribers_:null,event_update:n("update",
"object","delta"),event_stateChanged:n("stateChanged","object","oldState"),event_delegateChanged:n("delegateChanged","object","oldDelegate"),event_rootChanged:n("rootChanged","object","oldRoot"),event_targetChanged:n("targetChanged","object","oldTarget"),event_subscribersChanged:n("subscribersChanged","object"),event_activeChanged:n("activeChanged","object"),listen:{delegate:{update:function(d,h){this.data=d.data;this.event_update(this,h)},stateChanged:function(d,h){this.state=d.state;this.event_stateChanged(this,
h)},targetChanged:function(d,h){this.target=d.target;this.event_targetChanged(this,h)},rootChanged:function(d,h){this.data=d.data;this.root=d.root;this.event_rootChanged(this,h)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(d){y.prototype.init.call(this,d);if(d=this.delegate)this.delegate=null,this.data=d.data,this.state=d.state,this.setDelegate(d);else if(this.root=this,this.data||(this.data={}),this.isTarget)this.target=this;this.active&&k(this,this.subscribeTo,
w.ALL)},isConnected:function(d){if(d instanceof z){for(;d&&d!==this&&d!==d.delegate;)d=d.delegate;return d===this}return!1},getRootDelegate:function(){for(var d=this;d.delegate&&d.delegate!==d;)d=d.delegate;return d},setDelegate:function(d){if(this.canHaveDelegate&&d&&d instanceof z){if(d.delegate&&this.isConnected(d))return!1}else d=null;if(this.delegate!==d){var h=this.state,b=this.data,a=this.delegate,e=this.target,c=this.root,f={};if(d){this.delegate=d;this.root=d.root;this.data=d.data;this.state=
d.state;this.target=d.target;for(var g in d.data)!1===g in b&&(f[g]=void 0);for(g in b)b[g]!==d.data[g]&&(f[g]=b[g]);for(g in f){this.event_update(this,f);break}h!==this.state&&(""+h!=this.state||h.data!==this.state.data)&&this.event_stateChanged(this,h)}else for(g in this.target=this.delegate=null,this.root=this,this.data={},b)this.data[g]=b[g];this.root!==c&&this.event_rootChanged(this,c);this.target!==e&&this.event_targetChanged(this,e);this.event_delegateChanged(this,a);return!0}return!1},setState:function(d,
h){var b=this.target||this.getRootDelegate();if(b!==this)return b.setState(d,h);b=""+d;if(!l[b])throw Error("Wrong state value");if(this.state!=b||this.state.data!=h){var a=this.state;this.state=Object(b);this.state.data=h;this.event_stateChanged(this,a);return!0}return!1},deprecate:function(){this.state!=o.PROCESSING&&this.setState(o.DEPRECATED)},update:function(d){var h=this.target||this.getRootDelegate();if(h!==this)return h.update(d);if(d){var h={},b=0,a;for(a in d)this.data[a]!==d[a]&&(b++,h[a]=
this.data[a],this.data[a]=d[a]);if(b)return this.event_update(this,h),h}return!1},setActive:function(d){d=!!d;return this.active!=d?(this.active=d,this.event_activeChanged(this),k(this,this.subscribeTo,w.ALL*d),!0):!1},setSubscription:function(d){var d=d&w.ALL,h=this.subscribeTo^d;return h?(this.subscribeTo=d,this.active&&k(this,h,d),!0):!1},destroy:function(){this.active&&k(this,this.subscribeTo,0);this.delegate&&this.setDelegate();y.prototype.destroy.call(this);this.data=m;this.state=o.UNDEFINED;
this.target=this.root=null}}),C={destroy:function(){delete this.map[this.itemId]}},q=B(null,{itemClass:z,keyGetter:q,map_:null,extendConstructor_:!0,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(d){return this.get(this.keyGetter(d),d)},create:function(d){var h={};d instanceof z?h.delegate=d:h.data={id:d,title:d};return new this.itemClass(h)},get:function(d,h){var b=d instanceof z?d.eventObjectId:d,a=this.map_[b];!a&&h&&(a=this.map_[b]=this.create(d,h),a.addHandler(C,{map:this.map_,
itemId:b}));return a},destroy:function(){basis.Cleaner.remove(this);for(var d=r(this.map_),h=0,b;b=d[h++];)b.destroy()}}),D=B(z,{state:o.UNDEFINED,itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:n("datasetChanged","dataset","delta")&&function(d,h){var b,a=0,e=0,c;if(b=h.inserted)for(;c=b[a];)this.item_[c.eventObjectId]=c,a++;if(b=h.deleted)for(;c=b[e];)delete this.item_[c.eventObjectId],e++;this.itemCount+=a-e;this.cache_=null;u.datasetChanged.call(this,d,h)},init:function(d){z.prototype.init.call(this,
d);this.memberMap_={};this.item_={}},has:function(d){return!(!d||!this.item_[d.eventObjectId])},getItems:function(){this.cache_||(this.cache_=r(this.item_));return this.cache_},pick:function(){for(var d in this.item_)return this.item_[d];return null},top:function(d){var h=[];if(d)for(var b in this.item_)if(h.push(this.item_[b])>=d)break;return h},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();z.prototype.destroy.call(this);
this.cache_=i;this.itemCount=0;this.item_=this.memberMap_=null}}),g=B(D,{listen:{item:{destroy:function(d){this.remove([d])}}},init:function(d){D.prototype.init.call(this,d);if(d=this.items)this.items=null,this.set(d)},add:function(d){for(var h,b=this.memberMap_,a=[],e=this.listen.item,c=0;c<d.length;c++){var f=d[c];if(f instanceof z){var g=f.eventObjectId;b[g]||(b[g]=f,e&&f.addHandler(e,this),a.push(f))}}a.length&&this.event_datasetChanged(this,h={inserted:a});return h},remove:function(d){for(var h,
b=this.memberMap_,a=[],e=this.listen.item,c=0;c<d.length;c++){var f=d[c];if(f instanceof z){var g=f.eventObjectId;b[g]&&(e&&f.removeHandler(e,this),delete b[g],a.push(f))}}a.length&&this.event_datasetChanged(this,h={deleted:a});return h},set:function(d){if(!this.itemCount)return this.add(d);if(!d.length)return this.clear();for(var h=this.memberMap_,b={},a=[],e=[],c,f,g,i=this.listen.item,l=0;l<d.length;l++)c=d[l],c instanceof z&&(f=c.eventObjectId,b[f]=c,h[f]||(h[f]=c,i&&c.addHandler(i,this),e.push(c)));
for(f in h)b[f]||(c=h[f],i&&c.removeHandler(i,this),delete h[f],a.push(c));var k;var d={},m;e&&e.length&&(m=d.inserted=e);a&&a.length&&(m=d.deleted=a);m&&(k=d);(g=k)&&this.event_datasetChanged(this,g);return g},sync:function(d,h){if(d){g.setAccumulateState(!0);for(var b=this.memberMap_,a,e,c={},f=[],i,l=0;l<d.length;l++)a=d[l],a instanceof z&&(e=a.eventObjectId,c[e]=a,b[e]||f.push(a));for(e in this.item_)c[e]||this.item_[e].destroy();h&&f.length&&(i=this.add(f));g.setAccumulateState(!1);return i}},
clear:function(){var d,h=this.getItems(),b=this.listen.item;if(h.length){if(b)for(d=h.length;0<d--;)h[d].removeHandler(b,this);this.event_datasetChanged(this,d={deleted:h});this.memberMap_={}}return d}});g.setAccumulateState=function(){function d(a){var b=a.dataset;c.call(b,b,a)}function h(){var a=i;i={};for(var b in a)d(a[b])}function b(a,b){var f=a.eventObjectId,e=b.inserted,h=b.deleted,g=i[f];if(e&&h)return g&&(delete i[f],d(g)),c.call(a,a,b);if(g){var l=g[e?"inserted":"deleted"];if(l)return l.push.apply(l,
e||h);d(g)}i[f]=b;b.dataset=a}function a(){g=null;f&&(f=0,e.event_datasetChanged=c,h())}var e=D.prototype,c=e.event_datasetChanged,f=0,g,i={};return function(d){d?(0==f&&(e.event_datasetChanged=b,g||(g=setTimeout(a,0))),f++):(f-=0<f,0==f&&(e.event_datasetChanged=c,h()))}}();this.setWrapper(j);this.extend({STATE:o,SUBSCRIPTION:w,Object:z,DataObject:z,KeyObjectMap:q,AbstractDataset:D,Dataset:g})}.body()+"//@ sourceURL="+j+"src/basis/data.js")).call(basis.namespace("basis.data"),basis.namespace("basis.data"),
basis.namespace("basis.data").exports,this,j+"src/basis/data.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(a){return function(b){if(!b||!("click"==b.type&&3==b.which)){var c=n.sender(b),f,e;if(c){do if(f=c.getAttributeNode&&c.getAttributeNode(a))break;while(c=c.parentNode);if(c&&f){do if(e=c.basisObjectId)if((e=d[e])&&e.templateAction){c=f.nodeValue.qw();f=0;for(var h;h=
c[f++];)e.templateAction(h,n(b));break}while(c=c.parentNode)}}}}}function j(){this.instances_&&B.call(this)}function B(){var a=this.instances_,b=""+("function"==typeof this.source?this.source():this.source),b=this.isDecl?b.toObject():e(b),b=f(b),c=this.l10n_;if(c){this.l10n_=null;for(var d=0,h;h=c[d];d++)h.token.detach(h.handler,h)}this.createInstance=b.createInstance;this.getBinding=b.getBinding;this.instances_=b.map;var g=b.l10nProtoUpdate;if(a)for(var i in a)a[i].rebuild();if(b.l10n){this.l10n_=
c=[];var a=b.map,l;for(l in b.l10n)h={path:l,token:basis.l10n.getToken(l),handler:function(b){g(this.path,b);for(var c in a)a[c].set(this.path,b)}},h.token.attach(h.handler,h),c.push(h)}}function r(a){return function(){var b;var c=q.getElementById(a);if(c&&"SCRIPT"==c.tagName)switch(c.type){default:b=c.textContent||c.text}return b}}var q=global.document,y=basis.Class,s=basis.dom,n=basis.dom.event,u="undefined"!=typeof window&&1==s.createElement("","a","b").cloneNode(!0).childNodes.length,m=/((?:.|[\r\n])*?)(\{(?:l10n:([a-z\_][a-z0-9\-\_]*(?:\.[a-z\_][a-z0-9\-\_]*)*)\})?|<(\/|!--(\s*\{)?)?|$)/g,
i=/([a-z\_][a-z0-9\-\_]*)(\:|\{|\s*(\/?>)?)/ig,l=/([a-z\_][a-z0-9\-\_]*)(\:|\{|=|\s*)|(\/?>)/ig,o=/(.|[\r\n])*?--\>/g,E=/([a-z\_][a-z0-9\-\_]*(?:\:[a-z\_][a-z0-9\-\_]*)?)>/ig,v=/([a-z\_][a-z0-9\_]*)(\||\}\s*)/ig,w=/"((?:(\\")|[^"])*?)"\s*/g,z=/"/g,C=/\\"/g,D=/^event-(.+)+/,g={},d={seed:1},h={},b={svg:"http://www.w3.org/2000/svg"},a=function(a){var b=[],c=[],f={childs:b},d,e,h,g,t=!1,F=0,I,M={},H,k=m,A=0,j,a=a.trim();try{for(;A<a.length||k!=m;)if(g=k.lastIndex=A,j=k.exec(a),!j||j.index!==A){t&&(f=
c.pop());e&&f.childs.pop();if(e=f.childs.pop())3==e.type&&!e.refs?F-="len"in e?e.len:e.value.length:f.childs.push(e);t=!1;k=m}else{A=k.lastIndex;switch(k){case m:I=g+j[1].length;F!=I&&(d=F==g?j[1]:a.substring(F,I),(e=d.replace(/\s*(\r\n?|\n\r?)\s*/g,""))&&f.childs.push({type:3,len:d.length,value:e}));F=I;j[3]?f.childs.push({type:3,refs:["l10n:"+j[3]],value:"{l10n:"+j[3]+"}"}):"{"==j[2]?(h=A-1,f.childs.push(e={type:3}),k=v):j[4]?"/"==j[4]?(e=null,k=E):(f.childs.push(e={type:8}),j[5]?(h=A-j[5].length,
k=v):(h=A,k=o)):j[2]&&(t=!0,c.push(f),f.childs.push(e={type:1,attrs:[],childs:[]}),f=e,k=i);break;case E:j[1]!==(f.prefix?f.prefix+":":"")+f.name?f.childs.push({type:3,value:"</"+j[0]}):f=c.pop();k=m;break;case i:case l:if(":"==j[2]){if(e.prefix)throw"Invalid or unsupported syntax";e.prefix=j[1];break}j[1]&&(e.name=j[1],2==e.type&&f.attrs.push(e));if("{"==j[2]){k=v;break}if(j[3]){"/>"==j[3]&&(f=c.pop());t=!1;k=m;break}if("="==j[2]){k=w;break}e={type:2};k=l;break;case o:e.value=a.substring(h,A-3);
k=m;break;case v:H=j[1];if(M[H]){var G=M[H];G.refs.splice(G.refs.indexOf(H),1);G.refs.length||delete G.refs}3!=e.type&&(M[H]=e);e.refs?e.refs.push(j[1]):e.refs=[j[1]];"|"!=j[2]&&(3==e.type?(A-=j[2].length-1,e.value=a.substring(h,A),k=m):8==e.type?k=o:2==e.type&&"="==a[A]?(A++,k=w):(e={type:2},k=l));break;case w:e.value=j[1].replace(C,'"');e={type:2};k=l;break;default:throw"Parser bug";}k==m&&(F=A)}F!=A&&f.childs.push({type:3,value:a.substring(F,A)});b.length||b.push({type:3,value:""});!1=="element"in
M&&(b[0].refs?b[0].refs.push("element"):b[0].refs=["element"]);if(1<c.length)throw"No close tag for "+c.pop().name;b.templateDeclaration=!0}catch(n){console.warn(n,a)}return b},e=function(){function b(a,c){i[c]||("#"==c.charAt(0)?i[c]=String.fromCharCode("x"==c.charAt(1)||"X"==c.charAt(1)?parseInt(c.substr(2),16):c.substr(1)):(t.innerHTML=a,i[c]=t.firstChild?t.firstChild.nodeValue:""));return i[c]}function c(a){a=a.refs;return!a||!a.length?0:a}function f(a){for(var I=[],t=0,H,i;H=a[t];t++){var l=
c(H),k=l&&1==l.length?1:0;switch(H.type){case 1:i=k;for(var k=(H.prefix?H.prefix+":":"")+H.name,j=H.attrs,A=[],m=void 0,o=void 0,J=void 0,G=0,n=void 0;n=j[G];G++){m=0;if(n.value)if("class"==n.name){if(o=n.value.match(e)){for(var r=[],x={},q,m=[[]],s=0;q=o[s];s++)(J=q.match(d))?(q=x[J[2]],x[J[2]]||(q=x[J[2]]=[],m[0].push(J[2]),m.push(q)),q.push(J[1]||"")):r.push(q);n.value=r.join(" ");1==m.length&&(m=0)}}else if(o=n.value.split(h),1<o.length){J=[];r=[];x={};for(s=0;s<o.length;s++)s%2?(m=o[s],x[m]||
(x[m]=J.length,J.push(m)),r.push(x[m])):o[s]&&r.push(o[s].replace(g,b));m=[J,r]}else n.value=n.value.replace(g,b);A.push([2,m,c(n),(n.prefix?n.prefix+":":"")+n.name,n.value])}i=[1,i,l,k,A.length?A:0,f(H.childs)];break;case 3:i=[3,k,l,H.value.replace(g,b)];break;case 8:i=[8,k,l,H.value.replace(g,b)]}I.push(i)}return I.length?I:0}var e=/(\S+)/g,d=/^([a-z\_][a-z0-9\-\_]*)?\{([a-z\_][a-z0-9\-\_]*)\}$/i,h=/\{([a-z\_][a-z0-9\_]*|l10n:[a-z\_][a-z0-9\_]*(?:\.[a-z\_][a-z0-9\_]*)*)\}/i,g=/&([a-z]+|#[0-9]+|#x[0-9a-f]{1,4});?/gi,
i={},t=q.createElement("div");return function(b,c){b.templateDeclaration||(b=a(""+b,c));return f(b)}}(),c=function(){function a(b,c){for(var e=0,f;f=b[e];e++)-1==f.indexOf(":")&&d.push(f+":"+c)}function b(a){var c=e.length,c=f[c]||"r"+c;e.push(c+"="+a);return c}function c(f,d){for(var g,I,M,H,p,i,l=0,k=0,j;j=f[l];l++,k++,i=!1){l?f[l+1]?(u&&j[0]==f[l-1][0]&&3==j[0]&&k++,g=d+".childNodes["+k+"]"):g=d+".lastChild":g=d+".firstChild";if(H=j[2])i=!0,g=b(g),a(H,g),j[1]&&h.push([j[0],g,H[0]]);if(1==j[0]){p=
-1;i||(g=b(g),p=e.length);if(I=j[4])for(var m=0,A;A=I[m];m++){var o=A[3];if(H=A[2])i=!0,a(H,b(g+'.getAttributeNode("'+o+'")'));if(H=A[1]){A=[2,g];i=!0;for(var G=0,n;n=H[0][G];G++)n="class"==o?A.concat([n,o,H[G+1]]):A.concat([n,o,H[0],H[1]]),h.push(n)}}(M=j[5])&&c(M,g);!i&&p==e.length&&e.pop()}}}var f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".toArray(),e,d,h;return function(a,b){e=[];d=[];h=[];c(a,b);return{path:e,ref:d,binding:h}}}(),f=function(){function a(b,c){return function(){for(var a=
0,f;f=b[a];a++)this.tmpl.set(f,c[f](this))}}function b(c){var f={};return function(b){var e="bindingId"in b?b.bindingId:null,d=f[e];if(!d){var d=[],t={},h={},g={},p;for(p in c){var i=b[p],l=i&&i.getter;if(l&&(g[p]=l,d.push(p),i.events))for(var i=(""+i.events).qw(),l=0,k;k=i[l];l++)t[k]?t[k].push(p):(h||(h={}),t[k]=[p],h[k]=a(t[k],g))}d={names:d,events:t,sync:a(d,g),handler:h};e&&(f[e]=d)}return d}}function f(a,b){for(var c=[],e=a[5],d=a[4],t,h,g=0;g<e.length;g++)"string"==typeof e[g]?c.push('"'+e[g].replace(z,
'\\"')+'"'):(t=d[e[g]],h=t.indexOf(":"),-1==h?c.push(b?'"{'+t+'}"':"__"+t):c.push('__l10n["'+t.substr(h+1)+'"]'));1==c.length&&c.push('""');return c.join("+")}function e(a){for(var c={},d,t,h,g=[],p=[],i,l,k={},j=0,m;m=a[j];j++){h=m[1];n=m[2];d=c[n];t="_"+j;i="__"+n;var A=n.split(":");if("l10n"==A[0]&&A[1])(i=A[1],l||(l={}),c[i]||(c[i]=[],l[i]=[]),d=c[i],d.l10n=!0,3==m[0])?(d.push(h+'.nodeValue=__l10n["'+i+'"];'),l[i].push(h+".nodeValue=value;")):(l[i].push("bind_attr("+[h,'"'+o+'"',"{}",f(m,!0)]+
");"),g.push(t),d.push(t+"=bind_attr("+[h,'"'+o+'"',t,f(m)]+");"));else switch(c[n]||(d=c[n]=[],g.push(i)),m[0]){case 1:case 8:g.push(t+"="+h);k.bind_node=!0;d.push(t+"=bind_node("+[h,t]+",value);");break;case 3:g.push(t+"="+h);k.bind_nodeValue=!0;d.push(t+"=bind_nodeValue("+[h,t]+",value);");break;case 2:var o=m[3];if("class"==o){m=m[4];for(i=0;i<m.length;i++)g.push(t+'=""'),k.bind_attrClass=!0,d.push(t+"=bind_attrClass("+[h,t,"value",'"'+m[i]+'"']+");")}else k.bind_attr=!0,g.push(t+"="+f(m,!0)),
d.push(t+"=bind_attr("+[h,'"'+o+'"',t,f(m)]+");")}}p.push("function set(bindName,value){\nvalue=resolve(attaches,updateAttach,bindName,value);switch(bindName){");for(var n in c)p.push('case"'+n+'":\n'+(c[n].l10n?c[n].join("\n"):"if(__"+n+"!==value){__"+n+"=value;\n"+c[n].join("\n")+"}")+"break;");p.push("}}");for(var G in k)g.push(G+"=tools."+G);return{vars:g,l10n:l,getBinding:b(c),body:p.join("")}}var h=/\s+/,g="function"==typeof Node&&q instanceof Node,i=g?function(a,b,c){a=c instanceof Node?c:
a;a!==b&&b.parentNode.replaceChild(a,b);return a}:function(a,b,c){c=c&&"object"==typeof c?c:a;if(c!==b)try{b.parentNode.replaceChild(c,b)}catch(f){c=a,b!==c&&b.parentNode.replaceChild(c,b)}return c},l=function(a,b,c,f){c!==f&&(f?a.setAttribute(b,f):a.removeAttribute(b));return f},t={bind_nodeValue:g?function(a,b,c){var f=c instanceof Node?c:a;f!==b&&b.parentNode.replaceChild(f,b);f===a&&(f.nodeValue=c);return f}:function(a,b,c){b=i(a,b,c);b===a&&(b.nodeValue=c);return b},bind_node:i,bind_attr:l,bind_attrClass:global.DOMTokenList&&
q&&q.documentElement.classList instanceof global.DOMTokenList?function(a,b,c,f){c=c?f+c:"";c!=b&&(b&&a.classList.remove(b),c&&a.classList.add(c));return c}:function(a,b,c,f){c=c?f+c:"";c!=b&&(f=a.className.split(h),b&&f.remove(b),c&&f.push(c),a.className=f.join(" "));return c},resolve:function(a,b,c,f){var e=f&&f.bindingBridge,d=a[c];if(e||d)e?(f!==d&&(d&&d.bindingBridge.detach(d,b,c),e.attach(f,b,c),a[c]=f),f=e.get(f)):d&&(d.bindingBridge.detach(d,b,c),delete a[c]);return f}};return function(a){var b=
c(a,"_"),f=e(b.binding),h=G(a),a={},g;if(f.l10n){g={};var i=[],k;for(k in f.l10n)i.push('case"'+k+'":\n__l10n["'+k+'"]=value;'+f.l10n[k].join(";")+"break;");i=new Function("_","__l10n","bind_attr","var "+b.path+";return function(token, value){switch(token){"+i.join("")+"}}");i=i(h,g,l);for(k in f.l10n)i(k,basis.l10n.getToken(k).value)}b=new Function("gMap","tMap","build","tools","__l10n","return function createInstance_(obj,actionCallback,updateCallback){var _=build(),id=gMap.seed++,attaches={},resolve=tools.resolve,"+
b.path.concat(f.vars)+";\nif(obj&&a&&a.nodeType!=3)gMap[a.basisObjectId=id]=obj;\nfunction updateAttach(){set(String(this),attaches[this])};\n"+f.body+";return tMap[id]={"+[b.ref,"set:set,rebuild:function(){if(updateCallback)updateCallback.call(obj)},destroy:function(){for(var key in attaches)if(attaches[key])attaches[key].bindingBridge.detach(attaches[key],updateAttach,key);attaches=null;delete tMap[id];if(obj)delete gMap[id]}"]+"}}");b=b(d,a,function(){return h.cloneNode(!0)},t,g);return{createInstance:b,
getBinding:f.getBinding,l10nProtoUpdate:i,l10n:f.l10n,map:a}}}(),G=function(a){for(var c=q.createDocumentFragment(),f,e,d,h=0,i;i=a[h];h++)switch(i[0]){case 1:var l=i[3];f=l.split(/:/);d=1<f.length?q.createElementNS(b[f[0]],l):q.createElement(l);if(f=i[4])for(var t=0,F;F=f[t];t++){var I=F[3];d.setAttribute(I,F[4]);if(F=I.match(D)){F=F[1];if(!g[F]){g[F]=k(I);for(var I=0,M=n.browserEvents(F),H;H=M[I++];)n.addGlobalHandler(H,g[F])}n.W3CSUPPORT||(I=n.getEventInfo(F,l),I.supported&&!I.bubble&&d.attachEvent("on"+
F,function(a){return function(){n.fireEvent(q,a)}}(F)))}}(e=i[5])&&d.appendChild(G(e));c.appendChild(d);break;case 8:c.appendChild(q.createComment(i[3]));break;case 3:u&&h&&3==a[h-1][0]&&c.appendChild(q.createComment("")),c.appendChild(q.createTextNode(i[3]))}return c},A=y(null,{__extend__:function(a){return a instanceof A?a:new A(a)},init:function(a){this.setSource(a)},createInstance:function(a,b,c){B.call(this);return this.createInstance(a,b,c)},clearInstance:function(a){a.destroy()},getBinding:function(a){B.call(this);
return this.getBinding(a)},setSource:function(a){var b=this.source;if(b!=a){this.isDecl=!1;if("string"==typeof a){var c=a.match(/^([a-z]+):/);if(c){var f=c[1],a=a.substr(c[0].length);switch(f){case "file":a=basis.resource(a);break;case "id":a=r(a);case "tokens":this.isDecl=!0}}}if(b&&b.bindingBridge){if(c=b.url&&h[b.url])c.remove(this),c.length||delete h[b.url];this.source.bindingBridge.detach(b,j,this)}a&&a.bindingBridge&&(a.url&&(h[a.url]||(h[a.url]=[]),h[a.url].add(this)),a.bindingBridge.attach(a,
j,this));this.source=a;j.call(this)}}});this.extend({Template:A,tokenize:a,makeDeclaration:e,buildPathes:c,makeFunctions:f,buildHtml:G,filesMap:h,resolveObjectById:function(a){return d[a]}})}.body()+"//@ sourceURL="+j+"src/basis/template.js")).call(basis.namespace("basis.template"),basis.namespace("basis.template"),basis.namespace("basis.template").exports,this,j+"src/basis/template.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",
function(){var k=basis.dom,j=basis.template.Template,B=global.document.createElement("div");this.extend({Template:j,escape:function(j){return k.createElement("div",k.createText(j)).innerHTML},unescape:function(k){B.innerHTML=k;return B.firstChild.nodeValue},string2Html:function(j){B.innerHTML=j;return k.createFragment.apply(null,Array.from(B.childNodes))}})}.body()+"//@ sourceURL="+j+"src/basis/html.js")).call(basis.namespace("basis.html"),basis.namespace("basis.html"),basis.namespace("basis.html").exports,
this,j+"src/basis/html.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(a){return a.sortingValue||0}function j(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return+(a>b)||-(a<b)}function B(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return-(a>b)||+(a<b)}function r(a){return a.childNodes.sort(a.sortingDesc?B:j)}function q(a,b,c,f,e){if(b!==c){var d=a,h=[];f&&(a.contextSelection=
c,a.selected&&h.push(a));for(;d;){if((f=!d.selection||e&&d===a?d.firstChild:null)&&f.contextSelection!==b)throw"Try change wrong context selection";for(;!f;){if(d===a){h.length&&(b&&b.remove(h),c&&c.add(h));return}f=d.nextSibling;f||(d=d.parentNode)}d=f;d.selected&&h.push(d);d.contextSelection=c}}}function y(a,b){var c=b.length-1;a.childNodes=b;a.firstChild=b[0]||null;a.lastChild=b[c]||null;for(var f=c;c=b[f];f--)c.nextSibling=b[f+1]||null,c.previousSibling=b[f-1]||null,a.insertBefore(c,c.nextSibling)}
function s(a,b){var f;if("function"==typeof a.childFactory&&(f=a.childFactory(b),f instanceof a.childClass))return f;if(!f)throw c;throw e;}var n=this.path,u=basis.Class,m=basis.dom,i=basis.data,l=basis.event.create,o=basis.event.events,E=basis.event.LISTEN,v=i.SUBSCRIPTION,w=i.DataObject,z=i.AbstractDataset,C=i.Dataset,D=Function.getter,g=Function.nullGetter,d=Function.$undef,h=Object.complete,i=u.oneFunctionProperty,b=n+": Node can't be inserted at specified point in hierarchy",a=n+": Node was not found",
e=n+": Child node has wrong class",c=n+": Child node is null",f=n+": Operation is not allowed because node is under dataSource control",G=n+": Node can't has owner and parentNode",A={NONE:"none",PARENT:"parent",OWNER:"owner"};v.add("OWNER",{ownerChanged:function(a,b){this.remove(a,b);this.add(a,a.owner)}},function(a,b){a(b,b.owner)});v.add("DATASOURCE",{dataSourceChanged:function(a,b){this.remove(a,b);this.add(a,a.dataSource)}},function(a,b){a(b,b.dataSource)});var K=u.customExtendProperty({},function(a,
b){for(var c in b){var f=b[c];u.isClass(f)&&(f={instanceOf:f});if(f&&"object"==typeof f){var e=!1,d={instanceOf:f.instanceOf},h={key:c,config:d};typeof f.config&&(d.config=f.config);"function"==typeof f.existsIf&&(e=d.existsIf=f.existsIf);"function"==typeof f.delegate&&(e=d.delegate=f.delegate);"function"==typeof f.dataSource&&(e=d.dataSource=f.dataSource);if(e){var f=f.hook?P.__extend__(f.hook):P,g;for(g in f)if(f[g]===N){h.hook=f;break}}a[c]=h}else a[c]=null}}),N=function(){var a=this.owner,b=this.context.key,
c=this.context.config,f=!c.existsIf||c.existsIf(a),e=a.satellite[b];f?e?(c.delegate&&e.setDelegate(c.delegate(a)),c.dataSource&&e.setDataSource(c.dataSource(a))):(f=("function"==typeof c.config?c.config(a):c.config)||{},f.owner=a,c.delegate&&(f.delegate=c.delegate(a)),c.dataSource&&(f.dataSource=c.dataSource(a)),e=new c.instanceOf(f),a.satellite[b]=e,a.event_satelliteChanged(this,b,null),a.listen.satellite&&e.addHandler(a.listen.satellite,a)):e&&(delete a.satellite[b],a.event_satelliteChanged(a,b,
e),e.destroy())},P=i(N,{update:!0});E.add("owner","ownerChanged");E.add("dataSource","dataSourceChanged");var p=u(w,{event_update:function(a,b){w.prototype.event_update.call(this,a,b);var c=this.parentNode;c&&(c.matchFunction&&this.match(c.matchFunction),c.insertBefore(this,this.nextSibling))},event_childNodesModified:l("childNodesModified","node","delta")&&function(a,b){o.childNodesModified.call(this,a,b);var c=this.listen.childNode,f;if(c){if(f=b.inserted)for(var e=0,d;d=f[e];e++)d.addHandler(c,
this);if(f=b.deleted)for(e=0;d=f[e];e++)d.removeHandler(c,this)}},event_dataSourceChanged:l("dataSourceChanged","node","oldDataSource"),event_groupingChanged:l("groupingChanged","node","oldGroupingNode"),event_sortingChanged:l("sortingChanged","node","oldSorting","oldSortingDesc"),event_ownerChanged:l("ownerChanged","node","oldOwner"),event_satelliteChanged:l("satelliteChanged","node","key","oldSattelite"),subscribeTo:w.prototype.subscribeTo+v.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},
autoDelegate:A.NONE,nodeType:"DOMWrapperNode",childNodes:null,childClass:p,dataSource:null,dataSourceMap_:null,destroyDataSourceMember:!0,parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,sorting:g,sortingDesc:!1,grouping:null,groupingClass:null,groupNode:null,satelliteConfig:K,satellite:null,owner:null,init:function(a){var b=this.dataSource,c=this.childNodes,f=this.grouping;b&&(this.dataSource=null);w.prototype.init.call(this,a);f&&(this.grouping=null,this.setGrouping(f));
if(this.childClass)this.childNodes=[],b?(this.dataSource=null,this.setDataSource(b)):c&&this.setChildNodes(c);else if(c&&(this.childNodes=null),b)this.dataSource=null;if(this.satellite){var a=this.listen.satellite,e;for(e in this.satellite)b=this.satellite[e],b.setOwner(this),this.event_satelliteChanged(this,e,null),a&&b.addHandler(a,this)}else this.satellite={};if(this.satelliteConfig!==K)for(e in this.satelliteConfig)if((a=this.satelliteConfig[e])&&"object"==typeof a)b={context:a,owner:this},a.hook&&
this.addHandler(a.hook,b),N.call(b);if(e=this.owner)this.owner=null,this.setOwner(e)},setSatellite:function(a,b){var c=this.satellite[a];!1==b instanceof w&&(b=null);if(c!=b&&!this.satelliteConfig[a]){var f=this.listen.satellite;c&&(c.setOwner(null),f&&c.removeHandler(f,this));if(this.satellite[a]=b)b.setOwner(this),f&&b.addHandler(f,this);this.event_satelliteChanged(this,a,c)}},appendChild:function(){},insertBefore:function(){},removeChild:function(){},replaceChild:function(){},clear:function(){},
setChildNodes:function(){},setGrouping:function(){},setSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||!1==a instanceof p)a=null;if(a&&this.parentNode)throw G;var b=this.owner;b!==a&&(this.owner=a,this.event_ownerChanged(this,b),this.autoDelegate==A.OWNER&&this.setDelegate(a))},destroy:function(){w.prototype.destroy.call(this);this.dataSource?this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);this.grouping&&(this.grouping.setOwner(),
this.grouping=null);this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var b=this.satellite[a];b.owner=null;b.destroy()}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=null}}),L=u(p,{autoDestroyIfEmpty:!1,nodes:null,first:null,last:null,init:function(a){this.nodes=[];p.prototype.init.call(this,a)},insert:function(a,b){var c=this.nodes,f=b?c.indexOf(b):-1;-1==f?(c.push(a),this.last=a):c.splice(f,0,a);
this.first=c[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var b=this.nodes;b.remove(a)&&(this.first=b[0]||null,this.last=b[b.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]}));!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=this.nodes,b=a.length;0<b--;)a[b].groupNode=null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&
this.destroy()}},destroy:function(){p.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),Q={childClass:p,childFactory:null,listen:{dataSource:{datasetChanged:function(a,b){var c={},f=[];if(b.deleted)if(c.deleted=f,this.childNodes.length==b.deleted.length){var f=Array.from(this.childNodes),e=this.dataSource;this.dataSource=null;this.clear(!0);this.dataSource=e;this.dataSourceMap_={}}else for(var e=0,d;d=b.deleted[e];e++){d=d.eventObjectId;var h=this.dataSourceMap_[d];delete this.dataSourceMap_[d];
h.canHaveDelegate=!0;this.removeChild(h);f.push(h)}if(b.inserted){c.inserted=[];for(e=0;d=b.inserted[e];e++)h=s(this,{cascadeDestroy:!1,delegate:d}),h.canHaveDelegate=!1,this.dataSourceMap_[d.eventObjectId]=h,c.inserted.push(h),this.firstChild&&this.insertBefore(h)}this.firstChild?this.event_childNodesModified(this,c):this.setChildNodes(c.inserted);if(this.destroyDataSourceMember&&f.length)for(e=0;d=f[e];e++)d.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},
insertBefore:function(c,e){if(!this.childClass)throw b;if(c.firstChild)for(var d=this;d=d.parentNode;)if(d===c)throw b;var h=c&&c instanceof this.childClass;if(this.dataSource&&(!h||this.dataSourceMap_[c.delegate.eventObjectId]!==c))throw f;h||(c=s(this,c instanceof w?{delegate:c}:c));if(c.owner)throw G;var h=c.parentNode===this,i=c.groupNode,p=this.grouping,l=this.sorting,j,m=this.childNodes,n,o=null,d=-1,L=!1,J,K;h&&(J=c.nextSibling,K=c.previousSibling);if(l!==g&&(e=null,j=this.sortingDesc,n=l(c)||
0,h))if(n===c.sortingValue)L=!0;else if((!J||(j?J.sortingValue<=n:J.sortingValue>=n))&&(!K||(j?K.sortingValue>=n:K.sortingValue<=n)))c.sortingValue=n,L=!0;if(p){o=p.getGroupNode(c,!0);p=o.nodes;if(i===o&&(L||h&&J===e))return c;l!==g?L?d=J&&J.groupNode===o?p.indexOf(J):p.length:(d=p.binarySearchPos(n,k,j),c.sortingValue=n):d=e&&e.groupNode===o?p.indexOf(e):p.length;if(d<p.length)e=p[d];else if(o.last)e=o.last.nextSibling;else{d=o;for(e=null;(d=d.nextSibling)&&!(e=d.first););}if(c===e||h&&J===e)return i!==
o&&(i&&i.remove(c),o.insert(c,e)),c;d=-1}else if(l!==g){if(L)return c;d=m.binarySearchPos(n,k,j);e=m[d];c.sortingValue=n;if(c===e||h&&J===e)return c}else{if(e&&e.parentNode!==this)throw a;if(h){if(J===e)return c;if(c===e)throw b;}}this.domVersion_=(this.domVersion_||0)+1;if(h){if(J?(J.previousSibling=K,c.nextSibling=null):this.lastChild=K,K?(K.nextSibling=J,c.previousSibling=null):this.firstChild=J,-1==d?m.remove(c):(j=m.indexOf(c),m.splice(j,1),d-=j<d),i)i.remove(c),i=null}else c.parentNode&&c.parentNode.removeChild(c);
i!=o&&o.insert(c,e);if(e){-1==d&&(d=m.indexOf(e));if(-1==d)throw a;c.nextSibling=e;m.splice(d,0,c)}else d=m.length,m.push(c),e={previousSibling:this.lastChild},this.lastChild=c;c.parentNode=this;c.previousSibling=e.previousSibling;0==d?this.firstChild=c:e.previousSibling.nextSibling=c;e.previousSibling=c;q(c,c.contextSelection,this.selection||this.contextSelection,!0);h||(c.match&&c.match(this.matchFunction),c.autoDelegate==A.PARENT&&c.setDelegate(this),this.dataSource||this.event_childNodesModified(this,
{inserted:[c]}));return c},removeChild:function(b){if(!b||b.parentNode!==this)throw a;if(!1==b instanceof this.childClass)throw e;if(this.dataSource&&this.dataSource.has(b.delegate))throw f;var c=this.childNodes.indexOf(b);if(-1==c)throw a;this.childNodes.splice(c,1);b.parentNode=null;b.nextSibling?b.nextSibling.previousSibling=b.previousSibling:this.lastChild=b.previousSibling;b.previousSibling?b.previousSibling.nextSibling=b.nextSibling:this.firstChild=b.nextSibling;b.nextSibling=null;b.previousSibling=
null;q(b,b.contextSelection,null,!0);b.groupNode&&b.groupNode.remove(b);this.dataSource||this.event_childNodesModified(this,{deleted:[b]});b.autoDelegate==A.PARENT&&b.setDelegate();return b},replaceChild:function(b,c){if(this.dataSource)throw f;if(null==c||c.parentNode!==this)throw a;this.insertBefore(b,c);return this.removeChild(c)},clear:function(a){if(this.dataSource&&this.dataSource.itemCount)throw f;if(this.firstChild){a&&q(this,this.selection||this.contextSelection,null,!1,!0);var b=this.childNodes;
this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:b});for(var c=b.length;0<c--;){var e=b[c];e.parentNode=null;e.groupNode=null;a?(e.nextSibling=null,e.previousSibling=null,e.autoDelegate==A.PARENT&&e.setDelegate()):e.destroy()}if(this.grouping){b=this.grouping.childNodes;for(c=b.length-1;a=b[c];c--)a.clear()}}},setChildNodes:function(a,b){this.dataSource||this.clear(b);if(a&&(!1=="length"in a&&(a=[a]),a.length)){var c=this.event_childNodesModified;
this.event_childNodesModified=d;for(var f=0,e=a.length;f<e;f++)this.insertBefore(a[f]);this.event_childNodesModified=c;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.childClass||!1==a instanceof z)a=null;if(this.dataSource!==a){var b=this.dataSource,c=this.listen.dataSource;b&&(this.dataSource=this.dataSourceMap_=null);this.firstChild&&this.clear();if(this.dataSource=a)this.dataSourceMap_={},c&&a.itemCount&&c.datasetChanged&&c.datasetChanged.call(this,
a,{inserted:a.getItems()});this.event_dataSourceChanged(this,b)}},setGrouping:function(a){if("function"==typeof a||"string"==typeof a)a={groupGetter:a};!1==a instanceof O&&(a=a&&"object"==typeof a?new this.groupingClass(a):null);if(this.grouping!==a){var b=this.grouping,c;if(this.grouping){if(!a&&(this.grouping=null,this.firstChild)){c=this.sorting!==g?r(this):this.childNodes;for(var f=c.length;0<f--;)c[f].groupNode=null;y(this,c)}b.setOwner()}if(a&&(this.grouping=a,a.setOwner(this),this.firstChild)){c=
this.sorting!==g?r(this):this.childNodes;for(f=0;a=c[f];f++)a.groupNode=this.grouping.getGroupNode(a,!0);for(f=0;a=c[f];f++)a.groupNode.nodes.push(a);c.length=0;for(f=this.grouping.nullGroup;f;f=f.nextSibling)a=f.nodes,f.first=a[0]||null,f.last=a[a.length-1]||null,c.push.apply(c,a),f.event_childNodesModified(f,{inserted:a});y(this,c)}this.event_groupingChanged(this,b)}},setSorting:function(a,b){a=D(a);b=!!b;if(this.sorting!==a||this.sortingDesc!=!!b){var c=this.sorting,f=this.sortingDesc;this.sorting=
a;this.sortingDesc=!!b;if(a!==g&&this.firstChild){var e=[],d;for(d=this.firstChild;d;d=d.nextSibling)d.sortingValue=a(d)||0;if(this.grouping)for(var h=this.grouping.nullGroup;h;h=h.nextSibling)d=h.nodes=r({childNodes:h.nodes,sortingDesc:this.sortingDesc}),h.first=d[0]||null,h.last=d[d.length-1]||null,e.push.apply(e,d);else e=r(this);y(this,e)}this.event_sortingChanged(this,c,f)}},setMatchFunction:function(a){if(this.matchFunction!=a){var b=this.matchFunction;this.matchFunction=a;for(var c=this.lastChild;c;c=
c.previousSibling)c.match(a);this.event_matchFunctionChanged(this,b)}}},n=u(p,Q,{event_enable:l("enable","node"),event_disable:l("disable","node"),event_select:l("select","node"),event_unselect:l("unselect","node"),event_match:l("match","node"),event_unmatch:l("unmatch","node"),event_matchFunctionChanged:l("matchFunctionChanged","node","oldMatchFunction"),selectable:!0,selected:!1,selection:null,contextSelection:null,matchFunction:null,matched:!0,disabled:!1,init:function(a){this.selection&&!1==this.selection instanceof
z&&(this.selection=new R(this.selection));p.prototype.init.call(this,a);this.disabled&&this.event_disable(this);this.selected&&(this.selected=!1,this.select(!0))},setSelection:function(a){if(this.selection!==a)return q(this,this.selection||this.contextSelection,a||this.contextSelection,!1,!0),this.selection=a,!0},hasOwnSelection:function(){return!!this.selection},select:function(a){var b=this.selected,c=this.contextSelection;c?a?b?c.remove([this]):c.add([this]):this.selectable&&c.set([this]):!b&&
this.selectable&&(this.selected=!0,this.event_select(this));return this.selected!=b},unselect:function(){var a=this.selected;if(a){var b=this.contextSelection;b?b.remove([this]):(this.selected=!1,this.event_unselect(this))}return this.selected!=a},enable:function(){this.disabled&&(this.disabled=!1,this.event_enable(this))},disable:function(){this.disabled||(this.disabled=!0,this.event_disable(this))},isDisabled:function(){return this.disabled||!!m.findAncestor(this,D("disabled"))},match:function(a){"function"!=
typeof a&&(a=null);this.underMatch_&&!a&&this.underMatch_(this,!0);this.underMatch_=a;a=!a||a(this);this.matched!=a&&((this.matched=a)?this.event_match(this):this.event_unmatch(this))},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),this.selection=null);this.unselect();p.prototype.destroy.call(this)}}),O=u(p,Q,{event_childNodesModified:function(a,b){o.childNodesModified.call(this,a,b);this.nullGroup.nextSibling=this.firstChild;var c;if(c=b.inserted){for(var f=0,e;e=c[f++];)e.groupId_=
e.delegate?e.delegate.eventObjectId:e.data.id,this.map_[e.groupId_]=e;if(this.dataSource&&this.nullGroup.first){c=this.owner;e=Array.from(this.nullGroup.nodes);for(f=e.length;0<f--;)c.insertBefore(e[f],e[f].nextSibling)}}},event_ownerChanged:function(a,b){b&&b.grouping===this&&b.setGrouping(null,!0);this.owner&&this.owner.grouping!==this&&this.owner.setGrouping(this);o.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:!0,autoDestroyEmptyGroups:!0,
groupGetter:g,childClass:L,childFactory:function(a){return new this.childClass(h({autoDestroyIfEmpty:this.dataSource?!1:this.autoDestroyEmptyGroups},a))},init:function(a){this.map_={};this.nullGroup=new L;p.prototype.init.call(this,a)},getGroupNode:function(a,b){var c=this.groupGetter(a),f=c instanceof w,e=this.map_[f?c.eventObjectId:c];this.dataSource&&(b=!1);!e&&b&&(e=this.appendChild(f?c:{data:{id:c,title:c}}));return e||this.nullGroup},insertBefore:function(a,b){var a=Q.insertBefore.call(this,
a,b),c=a.first;if(c){for(var f=c.parentNode,e=a.last,d,h,g,i=null,p=a;(p=p.nextSibling)&&!(i=p.first););g=i?i.previousSibling:f.lastChild;d=c.previousSibling;h=e.nextSibling;if(h!==i){var l=f.childNodes,p=a.nodes,k=p.length;d&&(d.nextSibling=h);h&&(h.previousSibling=d);g&&(g.nextSibling=c);i&&(i.previousSibling=e);c.previousSibling=g;e.nextSibling=i;var e=l.indexOf(c),j=i?l.indexOf(i):l.length;j>e&&(j-=k);l.splice(e,k);l.splice.apply(l,[j,0].concat(p));if(!g||!d)f.firstChild=l[0];if(!i||!h)f.lastChild=
l[l.length-1];if(c instanceof L)for(c=k;0<c--;)f.insertBefore(p[c],i)}}return a},removeChild:function(a){if(a=Q.removeChild.call(this,a)){delete this.map_[a.groupId_];for(var b=0,c;c=a.nodes[b];b++)c.parentNode.insertBefore(c)}return a},clear:function(a){var b=[],c=this.getGroupNode,f=this.nullGroup;this.getGroupNode=function(){return f};for(var e=this.firstChild;e;e=e.nextSibling)b.push.apply(b,e.nodes);for(var e=0,d;d=b[e];e++)d.parentNode.insertBefore(d);this.getGroupNode=c;Q.clear.call(this,a);
this.map_={}},destroy:function(){this.autoDestroyWithNoOwner=!1;p.prototype.destroy.call(this);this.nullGroup.destroy();this.map_=this.nullGroup=null}});p.prototype.groupingClass=O;var l=u(z,{autoDestroy:!0,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,b){var c=this.memberMap_,f={},e,d=0,h=0,g=b.inserted,i=b.deleted;if(g&&g.length)for(f.inserted=g;e=g[d];)c[e.eventObjectId]=e,d++;if(i&&i.length)for(f.deleted=i;e=i[h];)delete c[e.eventObjectId],h++;(d||h)&&this.event_datasetChanged(this,
f)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:l("sourceNodeChanged")&&function(a,b){o.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:!1,init:function(a,b){z.prototype.init.call(this,b);a&&this.setSourceNode(a)},setSourceNode:function(a){!1==a instanceof p&&(a=null);if(a!==this.sourceNode){var b=this.sourceNode,c=this.listen.sourceNode;this.sourceNode=a;if(c){var f=c.childNodesModified;
b&&(b.removeHandler(c,this),f&&f.call(this,b,{deleted:b.childNodes}));a&&(a.addHandler(c,this),f&&f.call(this,a,{inserted:a.childNodes}))}this.event_sourceNodeChanged(this,b)}},destroy:function(){this.setSourceNode();z.prototype.destroy.call(this)}}),R=u(C,{multiple:!1,event_datasetChanged:function(a,b){C.prototype.event_datasetChanged.call(this,a,b);if(b.inserted)for(var c=0,f;f=b.inserted[c];c++)f.selected||(f.selected=!0,f.event_select(f));if(b.deleted)for(c=0;f=b.deleted[c];c++)f.selected&&(f.selected=
!1,f.event_unselect(f))},add:function(a){if(!this.multiple){if(this.itemCount)return this.set(a);a=[a[0]]}for(var b=[],c=0,f;f=a[c];c++)f.contextSelection==this&&f.selectable&&b.push(f);return C.prototype.add.call(this,b)},set:function(a){for(var b=[],c=0,f;f=a[c];c++)f.contextSelection==this&&f.selectable&&b.push(f);this.multiple||b.splice(1);return C.prototype.set.call(this,b)}});this.extend({DELEGATE:A,AbstractNode:p,Node:n,GroupingNode:O,PartitionNode:L,ChildNodesDataset:l,Selection:R,nullSelection:new z})}.body()+
"//@ sourceURL="+j+"src/basis/dom/wrapper.js")).call(basis.namespace("basis.dom.wrapper"),basis.namespace("basis.dom.wrapper"),basis.namespace("basis.dom.wrapper").exports,this,j+"src/basis/dom/wrapper.js",j+"src/basis/dom/",basis,function(k){return basis.resource(j+"src/basis/dom/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(a,b){return r(b,!0).createRule(a)}function j(a,b){var c=a.match(/^([^{]+)\{(.*)\}\s*$/);if(c){for(var f=c[1].trim().split(/\s*,\s*/),
e=0;e<f.length;e++)this.addRule(f[e],c[2]||null,b++);return b-1}}function B(a,b){var c=o.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:b?"alternate ":"",url:a.quote('"')}));o.tag(null,"HEAD")[0].appendChild(c);c=c.sheet||c.styleSheet;try{c.cssRules||(c.cssRules=c.rules)}catch(f){}c.insertRule||(c.insertRule=j);c.deleteRule||(c.deleteRule=c.removeRule);return c}function r(b,c){b||(b="DefaultGenericStyleSheet");g[b]||c&&(g[b]=new a(B()));
return g[b]}function q(a,c,f,e){for(var e=e||{},c=c.qw(),d=0,g;g=c[d];d++)if("undefined"!=typeof b.style[g]){f&&(basis.platformFeature["css-"+a]=g);h[a]={key:g,getter:e[g]};break}}function y(a,b,c){var f;var e=b;f=(e=(f=h[e])?f.key:e.replace(/^-ms-/,"ms-").camelize())?{key:e,value:f&&f.getter?f.getter(c):c}:void 0;if(f){var g=f.key,i=!!z.test(c),e=a.style;if(i||e.getPropertyPriority&&e.getPropertyPriority(b)==C)if(c.replace(z,""),e.setProperty)i||e.removeProperty(g),e.setProperty(g,f.value,i?C:"");
else{a=g+": "+f.value+(i?" !"+C:"")+";";b=e[g]?g+"\\s*:\\s*"+e[g]+"(\\s*!"+C+")?\\s*;?":"^";try{e.cssText=e.cssText.replace(RegExp(b,"i"),a)}catch(l){}}else{if(d)try{a.style[f.key]=f.value}catch(k){}else a.style[f.key]=f.value;return a.style[f.key]}}}function s(a,b){for(var c in b)y(a,c,b[c]);return a}function n(a,b){return y(a,"display","string"==typeof b?b:b?"":"none")}function u(a,b){return y(a,"visibility",b?"":"hidden")}function m(a){return A[a]||(A[a]=RegExp("\\s*\\b"+a+"\\b"))}function i(a,
b){var c=(b?"g":"s")+a;return N[c]||(N[c]=RegExp((b?"":"\\s*")+"\\b"+a+"\\S*\\b"))}var l=global.document,o=basis.dom,E=basis.dom.event,v=basis.Class,w=global.DOMTokenList&&l&&l.documentElement.classList instanceof global.DOMTokenList,z=/\s*!important/i,C="important",D=1,g={},d=function(){var a=o.createElement();try{a.style.width="badvalue"}catch(b){return!0}return!1}(),h={},b=o.createElement("DIV");q("opacity","opacity MozOpacity KhtmlOpacity filter",!0,{fitler:function(a){return"alpha(opacity:"+
parseInt(a*100)+")"}});q("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",!0);q("float","cssFloat styleFloat");var a=v(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[]},createRule:function(a){var b=this.styleSheet,f=this.rules.length;b.insertRule(a+"{}",f);a=Array.from(b.cssRules,f);a=a[1]?new c(a,this):new e(a[0],this);this.rules.push.apply(this.rules,a.rules||[a]);return a},deleteRule:function(a){if(a instanceof c)a.rules.forEach(this.deleteRule,
this);else{var b=this.rules.indexOf(a);-1!=b&&(this.rules.splice(b,1),this.styleSheet.deleteRule(b))}a.owner=null;a.destroy()},destroy:function(){this.rules.forEach(function(a){a.destroy()});this.rules=this.styleSheet=null}}),e=v(null,{rule:null,selector:"",init:function(a,b){this.owner=b;this.rule=a;this.selector=a.selectorText},setProperty:function(a,b){y(this.rule,a,b)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){this.owner&&
this.owner.deleteRule(this);this.rule=this.owner=null}}),c=v(null,{rules:null,init:function(a,b){this.owner=b;this.rules=a.map(function(){return new e(rule,this)},this)},createRule:function(a){a=this.owner.createRule(a);this.rules.push(a);a.owner=this;return a},deleteRule:function(a){var b=this.rules.indexOf(a);-1!=b&&(this.rules.splice(b,1),this.owner.deleteRule(a))},destroy:function(){this.owner&&this.owner.deleteRule(this);this.rules=this.owner=null}});["setProperty","setStyle","clear"].forEach(function(a){c.prototype[a]=
function(){for(var b,c=0;b=this.rules[c];c++)b[a].apply(b,arguments)}});var f={};["em","ex","px","%"].forEach(function(a){f["%"==a?"percent":a]=function(b){return 0==b||isNaN(b)?"0":b+a}});var G,A={},K=v(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,b,c){c=c||"";"undefined"!=typeof a&&this.remove(c+a);"undefined"!=typeof b&&this.add(c+b)},bool:function(a,b){b?this.add(a):this.remove(a)},
clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(m(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(m(a))||(this.element.className+=" "+a)},remove:function(a){var b=this.element.className,a=b.replace(m(a),"");a!=b&&(this.element.className=a)},toggle:function(a){var b=this.contains(a);b?this.remove(a):this.add(a);return!b}}),N={},P=v(null,{delim:"-",init:function(a,b){this.classList=b;this.prefix=
a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(i(this.prefix,!0))},set:function(a){var b=this.items(),a="undefined"!=typeof a?this.prefix+a:"",c=this.classList;if(b)if(1==b.length){if(b[0]===a)return;c.remove(b[0])}else this.clear();a&&c.add(a)},clear:function(){this.items().forEach(this.classList.remove,this.classList)}});w?(v=K.prototype,Object.extend(global.DOMTokenList.prototype,
{set:v.set,replace:v.replace,bool:v.bool,clear:function(){for(var a=this.length;0<a--;)this.remove(this[a])},setPrefixToken:v.setPrefixToken}),G=function(a){return("string"==typeof a?o.get(a):a).classList}):G=function(a){return new K("string"==typeof a?o.get(a):a)};E.onLoad(function(){G(l.body).bool("opacity-not-support",!basis.platformFeature["css-opacity"])});this.extend({setStyleProperty:y,setStyle:s,classList:function(a,b){return b?new P(b,G(a)):G(a)},uniqueRule:function(a){var b="genericRule-"+
D++;a&&G(a).add(b);a=k("."+b);a.token=b;return a},createRule:k,getStyleSheet:r,addStyleSheet:B,StyleSheet:a,Rule:e,RuleSet:c}).extend(f);basis.namespace("basis.dom").extend({setStyleProperty:y,setStyle:s,display:n,show:function(a){return n(a,1)},hide:function(a){return n(a)},visibility:u,visible:function(a){return u(a,1)},invisible:function(a){return u(a)}})}.body()+"//@ sourceURL="+j+"src/basis/cssom.js")).call(basis.namespace("basis.cssom"),basis.namespace("basis.cssom"),basis.namespace("basis.cssom").exports,
this,j+"src/basis/cssom.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(b,a){var e={},c;b&&b.length&&(c=e.inserted=b);a&&a.length&&(c=e.deleted=a);if(c)return e}function j(b,a){if(!b.length)return 0;var e,c=a.object.eventObjectId,f=a.value||0,d,h,g=0,i=b.length-1;do if(e=g+i>>1,h=b[e],d=h.value,d===f)if(h=h.object.eventObjectId,c<h)i=e-1;else if(c>h)g=e+1;else return c==
h?e:0;else if(f<d)i=e-1;else if(f>d)g=e+1;else return f==d?e:0;while(g<=i);return e+(d<f)}function B(b,a){return+(b.value>a.value)||-(b.value<a.value)||b.object.eventObjectId-a.object.eventObjectId}var r=basis.Class,q=r.oneFunctionProperty,y=Object.extend,s=Object.values,n=Function.$self,u=Function.$true,m=Function.$false,i=basis.event.create,l=basis.data.SUBSCRIPTION,o=basis.data.DataObject,E=basis.data.KeyObjectMap,v=basis.data.AbstractDataset,w=basis.data.Dataset;l.add("SOURCE",{sourceChanged:function(b,
a){this.remove(b,a);this.add(b,b.source)},sourcesChanged:function(b,a){var e;if(e=a.inserted)for(var c=e.length;0<c--;)this.add(b,e[c]);if(e=a.deleted)for(c=e.length;0<c--;)this.remove(b,e[c])}},function(b,a){for(var e=a.sources||[a.source],c=0,f;f=e[c++];)b(a,f)});l.add("MINUEND",{operandsChanged:function(b,a){this.minuend!==a&&(this.remove(b,a),this.add(b,b.minuend))}},function(b,a){b(a,a.minuend)});l.add("SUBTRAHEND",{operandsChanged:function(b,a,e){this.subtrahend!==e&&(this.remove(b,e),this.add(b,
b.subtrahend))}},function(b,a){b(a,a.subtrahend)});var z=r(v,{subscribeTo:l.SOURCE,event_sourcesChanged:i("sourcesChanged","dataset","delta"),sources:null,rule:function(b){return 0<b},listen:{source:{datasetChanged:function(b,a){var e=this.memberMap_,c={},f,d;if(a.inserted)for(var h=0;f=a.inserted[h];h++)d=f.eventObjectId,e[d]?e[d].count++:e[d]={count:1,object:f},c[d]=e[d];if(a.deleted)for(h=0;f=a.deleted[h];h++)d=f.eventObjectId,c[d]=e[d],e[d].count--;this.applyRule(c)},destroy:function(b){this.removeSource(b)}}},
init:function(b){v.prototype.init.call(this,b);b=this.sources;this.sources=[];b&&b.forEach(this.addSource,this)},setRule:function(b){"function"!=typeof b&&(b=z.UNION);this.rule!==b&&(this.rule=b,this.applyRule())},applyRule:function(b){var a=this.memberMap_,e=this.rule,c=this.sources.length,f=[],d=[],h,g,i;b||(b=a);for(var l in b)h=a[l],g=c&&h.count&&e(h.count,c),g!=!!this.item_[l]&&(g?f:d).push(h.object),0==h.count&&delete a[l];(i=k(f,d))&&this.event_datasetChanged(this,i);return i},addSource:function(b){if(b instanceof
v&&this.sources.add(b)){this.listen.source&&b.addHandler(this.listen.source,this);var a=this.memberMap_,e;for(e in b.item_)a[e]?a[e].count++:a[e]={count:1,object:b.item_[e]};this.applyRule();this.event_sourcesChanged(this,{inserted:[b]});return!0}},removeSource:function(b){if(this.sources.remove(b)){this.listen.source&&b.removeHandler(this.listen.source,this);var a=this.memberMap_,e;for(e in b.item_)a[e].count--;this.applyRule();this.event_sourcesChanged(this,{deleted:[b]});return!0}},setSources:function(b){for(var a=
Array.from(this.sources),e=0,c;c=b[e];e++)c instanceof v&&(a.remove(c)||this.addSource(c));a.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){v.prototype.destroy.call(this);this.sources=null}});z.UNION=z.prototype.rule;z.INTERSECTION=function(b,a){return b==a};z.DIFFERENCE=function(b){return 1==b};z.MORE_THAN_ONE_INCLUDE=function(b,a){return 1==a||1<b};z.AT_LEAST_ONE_EXCLUDE=function(b,a){return 1==a||b<a};var C=function(b){return!this.has(b)},
D=r(v,{subscribeTo:l.MINUEND+l.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:i("operandsChanged","dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(b,a){if(this.subtrahend){var e=k(a.inserted&&a.inserted.filter(C,this.subtrahend),a.deleted&&a.deleted.filter(this.has,this));e&&this.event_datasetChanged(this,e)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(b,a){if(this.minuend){var e=k(a.deleted&&a.deleted.filter(C,
this),a.inserted&&a.inserted.filter(this.has,this));e&&this.event_datasetChanged(this,e)}},destroy:function(){this.setOperands(this.minuend,null)}}},init:function(b){v.prototype.init.call(this,b);var b=this.minuend,a=this.subtrahend;this.subtrahend=this.minuend=null;(b||a)&&this.setOperands(b,a)},setOperands:function(b,a){var e,c=!1;!1==b instanceof v&&(b=null);!1==a instanceof v&&(a=null);var f=this.minuend,d=this.subtrahend;if(f!==b){c=!0;this.minuend=b;var h=this.listen.minuend;h&&(f&&f.removeHandler(h,
this),b&&b.addHandler(h,this))}if(d!==a&&(c=!0,this.subtrahend=a,h=this.listen.subtrahend))d&&d.removeHandler(h,this),a&&a.addHandler(h,this);if(!c)return!1;this.event_operandsChanged(this,f,d);if(!b||!a)this.itemCount&&this.event_datasetChanged(this,e={deleted:this.getItems()});else{var c=[],f=[],g;for(g in this.item_)(!b.item_[g]||a.item_[g])&&c.push(this.item_[g]);for(g in b.item_)!this.item_[g]&&!a.item_[g]&&f.push(b.item_[g]);(e=k(f,c))&&this.event_datasetChanged(this,e)}return e},setMinuend:function(b){return this.setOperands(b,
this.subtrahend)},setSubtrahend:function(b){return this.setOperands(this.minuend,b)},clear:function(){this.setOperands()}}),g={subscribeTo:l.SOURCE,source:null,sourceMap_:null,event_sourceChanged:i("sourceChanged","dataset","oldSource"),listen:{source:{destroy:function(){this.setSource()}}},init:function(b){this.sourceMap_={};var a=this.source;a&&(this.source=null);v.prototype.init.call(this,b);a&&this.setSource(a)},setSource:function(b){!1==b instanceof v&&(b=null);if(this.source!==b){var a=this.source,
e=this.listen.source;this.source=b;if(e){var c=e.datasetChanged;a&&(a.removeHandler(e,this),c&&c.call(this,a,{deleted:a.getItems()}));b&&(b.addHandler(e,this),c&&c.call(this,b,{inserted:b.getItems()}))}this.event_sourceChanged(this,a)}},clear:function(){this.setSource()},destroy:function(){v.prototype.destroy.call(this);this.sourceMap_=null}},d=r(v,g,{map:n,reduce:m,rule:Function.getter(u),ruleEvents:q(function(b){var a=this.map?this.map(b):object;if(!1==a instanceof o||this.reduce(a))a=null;var e=
this.sourceMap_[b.eventObjectId],c=e.member;if(c!==a){var f=this.memberMap_,d,h,g;e.member=a;c&&(e=c.eventObjectId,this.removeMemberRef&&this.removeMemberRef(c,b),0==--f[e]&&(delete f[e],g=[c]));a&&(c=a.eventObjectId,this.addMemberRef&&this.addMemberRef(a,b),f[c]?f[c]++:(f[c]=1,h=[a]));(d=k(h,g))&&this.event_datasetChanged(this,d)}},{update:!0}),addMemberRef:null,removeMemberRef:null,listen:{source:{datasetChanged:function(b,a){var e=this.sourceMap_,c=this.memberMap_,f=[],d=[],h,g,i,l=this.ruleEvents;
w.setAccumulateState(!0);if(a.inserted)for(var j=0;h=a.inserted[j];j++){i=this.map?this.map(h):h;if(!1==i instanceof o||this.reduce(i))i=null;l&&h.addHandler(l,this);e[h.eventObjectId]={sourceObject:h,member:i};i&&(g=i.eventObjectId,c[g]?c[g]++:(c[g]=1,f.push(i)),this.addMemberRef&&this.addMemberRef(i,h))}if(a.deleted)for(j=0;h=a.deleted[j];j++)g=h.eventObjectId,i=e[g].member,l&&h.removeHandler(l,this),delete e[g],i&&(g=i.eventObjectId,0==--c[g]&&(delete c[g],d.push(i)),this.removeMemberRef&&this.removeMemberRef(i,
h));w.setAccumulateState(!1);(a=k(f,d))&&this.event_datasetChanged(this,a)}}},setMap:function(b){"function"!=typeof b&&(b=n);if(this.map!==b)return this.map=b,this.applyRule()},setReduce:function(b){"function"!=typeof b&&(b=m);if(this.reduce!==b)return this.reduce=b,this.applyRule()},setRule:function(b){"function"!=typeof b&&(b=u);if(this.rule!==b)return this.rule=b,this.applyRule()},applyRule:function(){var b=this.sourceMap_,a=this.memberMap_,e,c,f,d,h,g=[],i=[],l,j;for(j in b){h=b[j];d=h.sourceObject;
e=h.member;c=this.map?this.map(d):d;if(!1==c instanceof o||this.reduce(c))c=null;if(e!=c&&(h.member=c,e&&(f=e.eventObjectId,this.removeMemberRef&&this.removeMemberRef(e,d),a[f]--),c))e=c.eventObjectId,this.addMemberRef&&this.addMemberRef(c,d),e in a?a[e]++:(a[e]=1,g.push(c))}for(f in this.item_)0==a[f]&&(delete a[f],i.push(this.item_[f]));(l=k(g,i))&&this.event_datasetChanged(this,l);return l}}),l=r(d,{reduce:function(b){return!this.rule(b)}}),h=r(d,{subsetClass:v,keyMap:null,map:function(b){return this.keyMap.resolve(b)},
setRule:function(b){"function"!=typeof b&&(b=u);if(this.rule!==b)return this.rule=b,this.keyMap.keyGetter=b,this.applyRule()},addMemberRef:function(b,a){b.event_datasetChanged(b,{inserted:[a]})},removeMemberRef:function(b,a){b.event_datasetChanged(b,{deleted:[a]})},init:function(b){if(!this.keyMap||!1==this.keyMap instanceof E)this.keyMap=new E(y({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));d.prototype.init.call(this,b)},getSubset:function(b,a){return this.keyMap.get(b,a)},destroy:function(){d.prototype.destroy.call(this);
this.keyMap.destroy();this.keyMap=null}}),i=r(v,g,{rule:Function.getter(u),ruleEvents:q(function(b){var a=this.sourceMap_[b.eventObjectId],b=this.rule(b),e=this.index_;b!==a.value&&(e.splice(j(e,a),1),a.value=b,e.splice(j(e,a),0,a),this.applyRule())},{update:!0}),index_:null,orderDesc:!1,offset:0,limit:10,listen:{source:{datasetChanged:function(b,a){var e=this.sourceMap_,c=this.index_,f=this.ruleEvents,d=!1,h=!1,g,i=a.inserted,l=a.deleted;if(l){l.length>c.length-l.length&&(d=!0,h=l.length!=c.length,
c.length=0);for(var k=0,m;m=l[k];k++)d||(g=e[m.eventObjectId],c.splice(j(c,g),1)),delete e[m.eventObjectId],f&&m.removeHandler(f,this);if(h)for(var n in e)g=e[n],c.splice(j(c,g),0,g)}if(i){h=!c.length;for(k=0;m=i[k];k++)g={object:m,value:this.rule(m)},e[m.eventObjectId]=g,h?c.push(g):c.splice(j(c,g),0,g),f&&m.addHandler(f,this);h&&c.sort(B)}this.applyRule()}}},event_rangeChanged:i("rangeChanged","dataset","oldOffset","oldLimit"),init:function(b){this.index_=[];g.init.call(this,b)},setRange:function(b,
a){var e=this.offset,c=this.limit;if(e!=b||c!=a)this.offset=b,this.limit=a,this.applyRule(),this.event_rangeChanged(this,e,c)},setOffset:function(b){return this.setRange(b,this.limit)},setLimit:function(b){return this.setRange(this.offset,b)},applyRule:function(){var b=this.offset,a=b+this.limit;this.orderDesc&&(b=this.index_.length-a,a=b+this.limit);for(var e=Object.slice(this.item_),b=this.index_.slice(Math.max(0,b),Math.max(0,a)),a=[],c,f=0,d;d=b[f];f++){var h=d.object.eventObjectId;e[h]?delete e[h]:
a.push(d.object)}(c=k(a,s(e)))&&this.event_datasetChanged(this,c);return c},destroy:function(){g.destroy.call(this);this.index_=null}}),r=r(v,g,{subsetClass:v,rule:Function.getter(m),ruleEvents:q(function(b){var a=this.sourceMap_,e=this.memberMap_,c=b.eventObjectId,f=a[c].list,a=a[c].list={},c=this.rule(b),d,h=[],g=[],i;if(Array.isArray(c))for(var l=0;l<c.length;l++)if(i=this.keyMap.resolve(c[l]))j=i.eventObjectId,a[j]=i,f[j]||(i.event_datasetChanged(i,{inserted:[b]}),e[j]?e[j]++:(h.push(i),e[j]=
1));for(var j in f)a[j]||(i=f[j],i.event_datasetChanged(i,{deleted:[b]}),--e[j]||(delete e[j],g.push(i)));(d=k(h,g))&&this.event_datasetChanged(this,d)},{update:!0}),keyMap:null,map:n,listen:{source:{datasetChanged:function(b,a){var e=this.sourceMap_,c=this.memberMap_,f=this.ruleEvents,d,h,g,i=[],l=[];w.setAccumulateState(!0);if(d=a.inserted)for(var j=0,m;m=d[j];j++){var n=this.rule(m),o={object:m,list:{}};e[m.eventObjectId]=o;if(Array.isArray(n))for(var q=0;q<n.length;q++)if((h=this.keyMap.get(n[q],
!0))&&!h.has(m))g=h.eventObjectId,o.list[g]=h,h.event_datasetChanged(h,{inserted:[m]}),c[g]?c[g]++:(i.push(h),c[g]=1);f&&m.addHandler(f,this)}if(d=a.deleted)for(j=0;m=d[j];j++){h=m.eventObjectId;n=e[h].list;delete e[h];for(g in n)h=n[g],h.event_datasetChanged(h,{deleted:[m]}),--c[g]||(delete c[g],l.push(h));f&&m.removeHandler(f,this)}w.setAccumulateState(!1);(a=k(i,l))&&this.event_datasetChanged(this,a)}}},init:function(b){if(!this.keyMap||!1==this.keyMap instanceof E)this.keyMap=new E(y({keyGetter:this.map,
itemClass:this.subsetClass},this.keyMap));g.init.call(this,b)},getSubset:function(b,a){return this.keyMap.get(b,a)},destroy:function(){g.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});this.extend({Merge:z,Subtract:D,MapReduce:d,Subset:l,Split:h,Slice:i,Cloud:r})}.body()+"//@ sourceURL="+j+"src/basis/data/dataset.js")).call(basis.namespace("basis.data.dataset"),basis.namespace("basis.data.dataset"),basis.namespace("basis.data.dataset").exports,this,j+"src/basis/data/dataset.js",j+"src/basis/data/",
basis,function(k){return basis.resource(j+"src/basis/data/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(d){if(d instanceof D)return d.set;d=d.nodeType;if(!1==isNaN(d))return 1==d?C:"nodeValue"}var j=this.path,B=basis.Class,r=basis.dom,q=basis.Cleaner,y=Function.getter,s=basis.cssom.classList,n=basis.timer.TimeEventManager,u=basis.event.EventObject,m=basis.event.create,i=basis.data,l=i.DataObject,o=i.STATE,E=j+": Instance of DataObject required",
v=j+": Link to undefined object ignored",w=B(l,{event_change:m("change"),locked:!1,lockValue_:null,extendConstructor_:!1,updateCount:0,init:function(d,b,a){l.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy="function"==typeof a?a:Function.$self;this.initValue=this.value=this.proxy(d)},set:function(d,b){var a=this.value,e=this.proxy?this.proxy(d):e,c=!1;e!==a&&(this.value=e,c=!0,this.updateCount+=1);!this.locked&&(c||b)&&this.event_change(e,a);return c},lock:function(){this.locked||(this.lockValue_=
this.value,this.locked=!0)},unlock:function(){this.locked&&(this.locked=!1,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_))},update:function(d,b){return this.set(d,b)},reset:function(){this.set(this.initValue)},destroy:function(){l.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),z={destroy:function(d){this.removeLink(d)}},C=function(d){r.insert(r.clear(this),d)},D=B(w,{links_:null,bindingBridge:{attach:function(d,
b,a){return d.addLink(a,b)},detach:function(d,b,a){return d.removeLink(a,b)},get:function(d){return d.value}},event_change:function(d,b){w.prototype.event_change.call(this,d,b);if(this.links_.length&&!q.globalDestroy)for(var a=0,e;e=this.links_[a++];)this.power_(e,b)},init:function(d,b,a){w.prototype.init.call(this,d,b,a);this.links_=[];q.add(this)},addLink:function(d,b,a){if(null==b){if("object"!=typeof d&&!1==d instanceof Object)throw Error(v);b=k(d)}"function"!=typeof a&&(a=y(Function.$self,a));
b={object:d,format:a,field:b,isEventObject:d instanceof u};this.links_.push(b);b.isEventObject&&d.addHandler(z,this);this.power_(b);return d},addLinkShortcut:function(d,b,a){return this.addLink(d,D.shortcut[b],a)},removeLink:function(d,b){if(null!=this.links_){var a=2>arguments.length;!a&&null==b&&(b=k(d));for(var e=0,c=0,f;f=this.links_[c];c++)f.object===d&&(a||b==f.field)?f.isEventObject&&f.object.removeHandler(z,this):this.links_[e++]=f;this.links_.length=e}},clear:function(){for(var d=0,b;b=this.links_[d];d++)b.isEventObject&&
b.object.removeHandler(z,this);this.links_.clear()},power_:function(d,b){var a=d.field;if(null!=a){var e=d.format(this.value),c=d.object;"function"==typeof a?a.call(c,e,2>arguments.length?e:d.format(b)):c[a]=e}},destroy:function(){this.clear();w.prototype.destroy.call(this);this.links_=null;q.remove(this)}});D.shortcut={className:function(d,b){s(this).replace(b,d)},show:function(d){r.display(this,!!d)},hide:function(d){r.display(this,!d)},disable:function(d){this.disabled=!!d},enable:function(d){this.disabled=
!d}};var g=o.PRIORITY,d={stateChanged:function(){this.fire(!1,!0)},update:function(){this.fire(!0)},change:function(){this.fire(!0)},destroy:function(d){this.remove(d)}},j=B(D,{calculateValue:function(){return this.value+1},objects:null,timer_:null,valueChanged_:!1,stateChanged_:!0,state:o.UNDEFINED,extendConstructor_:!0,init:function(){var d=this.handler;delete this.handler;D.prototype.init.call(this,this.value||0,d,this.proxy);d=this.objects;this.objects=[];d&&Array.isArray(d)&&(this.lock(),this.add.apply(this,
d),this.unlock());this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();q.add(this)},add:function(){for(var g=0,b=arguments.length;g<b;g++){var a=arguments[g];if(a instanceof l)this.objects.add(a)&&a.addHandler(d,this);else throw Error(E);}this.fire(!0,!0)},remove:function(g){this.objects.remove(g)&&g.removeHandler(d,this);this.fire(!0,!0)},clear:function(){for(var g=0,b;b=this.objects[g];g++)b.removeHandler(d,this);this.objects.clear();this.fire(!0,!0)},fire:function(d,b){if(!this.locked&&
(this.valueChanged_=this.valueChanged_||!!d,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=!0,n.add(this,"update",Date.now())},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},update:function(){delete this.timer_;n.remove(this,"update");if(!q.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var d=this.objects.length;if(d){for(var b=-2,a,e=0;e<d;e++){var c=this.objects[e],f=g.indexOf(""+
c.state);f>b&&(a=c,b=f)}a&&this.setState(a.state,a.state.data)}else this.setState(o.UNDEFINED)}this.stateChanged_=this.valueChanged_=!1},destroy:function(){this.lock();this.clear();n.remove(this,"update");D.prototype.destroy.call(this)}});this.extend({DataObjectSet:j,AbstractProperty:w,Property:D,PropertySet:j})}.body()+"//@ sourceURL="+j+"src/basis/data/property.js")).call(basis.namespace("basis.data.property"),basis.namespace("basis.data.property"),basis.namespace("basis.data.property").exports,
this,j+"src/basis/data/property.js",j+"src/basis/data/",basis,function(k){return basis.resource(j+"src/basis/data/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function k(a,b){if(!a.length)return 0;var d,e,g=0,h=a.length-1;do if(d=g+h>>1,e=a[d]||0,b<e)h=d-1;else if(b>e)g=d+1;else return b==e?d:0;while(g<=h);return d+(e<b)}function j(a,b,d){if(!r.isClass(a)||!a.isSubclassOf(m))throw"Wrong class for index constructor";b=Function.getter(b);d=d||"update";
if("string"!=typeof d)throw"Events must be a event names space separated string";var d=d.qw().sort(),e=[a.basisClassId_,b.basisGetterId_,d].join("_"),g=w[e];if(g)return g.owner;for(var g={},h=0;h<d.length;h++)g[d[h]]=!0;w[e]={owner:this,indexClass:a.subclass({indexId:e,updateEvents:g,valueGetter:b})};this.indexId=e}function B(a,b,d){var e=a.indexCache_;a.lock();if(b)for(var g=0,h;h=b[g++];){var i=a.valueGetter(h);e[h.eventObjectId]=i;a.add_(i)}if(d)for(g=0;h=d[g++];)b=h.eventObjectId,a.remove_(e[b]),
delete e[b];a.unlock()}var r=basis.Class,q=basis.data,y=q.KeyObjectMap,s=q.AbstractDataset,n=basis.data.property.Property,u=basis.data.dataset.MapReduce,m=r(n,{autoDestroy:!0,indexCache_:null,valueGetter:Function.$null,updateEvents:{},init:function(){this.indexCache_={};n.prototype.init.call(this,0)},add_:function(){},remove_:function(){},update_:function(){},destroy:function(){n.prototype.destroy.call(this);this.indexCache_=null}}),q=r(m,{add_:function(a){this.value+=a},remove_:function(a){this.value-=
a},update_:function(a,b){this.set(this.value-b+a)}}),i=r(m,{valueGetter:Function.$true,add_:function(a){this.value+=!!a},remove_:function(a){this.value-=!!a},update_:function(a,b){this.set(this.value-!!b+!!a)}}),l=r(m,{sum_:0,count_:0,add_:function(a){this.sum_+=a;this.count_+=1;this.value=this.sum_/this.count_},remove_:function(a){this.sum_-=a;this.value=(this.count_-=1)?this.sum_/this.count_:0},update_:function(a,b){this.sum_+=a-b;this.set(this.sum_/this.count_)}}),o=r(m,{itemGetter:Function.$null,
vector_:null,init:function(){this.vector_=[];m.prototype.init.call(this)},add_:function(a){this.vector_.splice(k(this.vector_,a),0,a);this.value=this.vectorGetter(this.vector_)},remove_:function(a){this.vector_.splice(k(this.vector_,a),1);this.value=this.vectorGetter(this.vector_)},update_:function(a,b){this.vector_.splice(k(this.vector_,b),1);this.vector_.splice(k(this.vector_,a),0,a);this.set(this.vectorGetter(this.vector_))},destroy:function(){m.prototype.destroy.call(this);this.vector_=null}}),
E=r(o,{vectorGetter:function(a){return a[0]}}),v=r(o,{vectorGetter:function(a){return a[a.length-1]}}),w={},z={destroy:function(a){this.deleteIndex(a)}},C=function(a){return function(b,d){return new j(a,b,d)}},D=C(i),g=C(q),d=C(l),h=C(E),b=C(v),a={"*":function(a){var b,d,e=a.type,g=a.args[0],h=g.eventObjectId,i;for(i in this.indexes)d=this.indexes[i],d.updateEvents[e]&&(a=d.indexCache_[h],b=d.valueGetter(g),b!==a&&(d.update_(b,a),d.indexCache_[h]=b))}},e={datasetChanged:function(b,d){var e;if(e=d.inserted)for(var g=
e.length;0<g--;)e[g].addHandler(a,this);if(e=d.deleted)for(g=e.length;0<g--;)e[g].removeHandler(a,this);for(var h in this.indexes)B(this.indexes[h],d.inserted,d.deleted)},destroy:function(){var a=Object.values(this.indexes),b;for(b in a)this.deleteIndex(a[b])}};s.extend({indexes:null,getIndex:function(a){if(!1!=a instanceof j){this.indexes||(this.indexes={},this.addHandler(e),e.datasetChanged.call(this,this,{inserted:this.getItems()}));var b=a.indexId,a=this.indexes[b];if(!a){a=w[b];if(!a)throw"Wrong index constructor";
a=new a.indexClass;a.addHandler(z,this);this.indexes[b]=a;B(a,this.getItems())}return a}},deleteIndex:function(a){if(this.indexes&&this.indexes[a.indexId]){delete this.indexes[a.indexId];a.removeHandler(z,this);a.destroy();for(var b in this.indexes)return;this.removeHandler(e);this.indexes=null}}});s=r(u,{calcs:null,indexes:null,indexes_:null,timer_:void 0,indexUpdated:null,memberSourceMap:null,keyMap:null,map:function(a){return this.keyMap.get(a,!0)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=
b.eventObjectId;this.listen.member&&a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=!0;0<a.subscriberCount&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];this.listen.member&&a.removeHandler(this.listen.member,this)},event_sourceChanged:function(a,b){u.prototype.event_sourceChanged.call(this,a,b);var d,e;for(e in this.indexes_)d=this.indexes_[e],b&&(this.deleteIndex(e),b.deleteIndex(this.indexes[e])),this.source&&this.addIndex(e,
this.source.getIndex(d))},listen:{index:{change:function(a){var b=this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=!0;b.recalcRequest()}},member:{subscribersChanged:function(a,b){0<a.subscriberCount&&0==b&&this.calcMember(a)}}},ruleEvents:r.oneFunctionProperty(function(a,b){u.prototype.ruleEvents.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=!0;this.recalcRequest()},{update:!0}),init:function(a){this.recalc=this.recalc.bind(this);this.indexUpdated=!1;this.indexesBind_={};this.memberSourceMap=
{};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||!1==this.keyMap instanceof y)this.keyMap=new y(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));u.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof j){if(this.indexes_[a])return;this.indexes_[a]=b;b=this.source&&this.source.getIndex(b)}if(b instanceof m){this.indexValues[a]=
b.value;this.indexes[a]=b;this.indexesBind_[a]={key:a,indexMap:this};var d=this.listen.index;d&&(b.addHandler(d,this.indexesBind_[a]),d.change&&d.change.call(this.indexesBind_[a],b.value))}}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.listen.index&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},addCalc:function(a,b){this.calcs[a]=b;this.recalcRequest()},
removeCalc:function(a){delete this.calcs[a]},lock:function(){for(var a in this.indexes)this.indexes[a].lock()},unlock:function(){for(var a in this.indexes)this.indexes[a].unlock()},recalcRequest:function(){this.timer_||(this.timer_=setTimeout(this.recalc,0))},recalc:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.indexUpdated=!1;this.timer_=clearTimeout(this.timer_)},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];if(a.subscriberCount&&(b.updated||
this.indexUpdated)){b.updated=!1;var d={},e,g,h,i;for(i in this.calcs)if(e=this.calcs[i](b.sourceObject.data,this.indexValues,b.sourceObject),g=a.data[i],a.data[i]!==e&&("number"!=typeof e||"number"!=typeof g||!isNaN(e)||!isNaN(g)))d[i]=e,h=!0;h&&a.update(d)}},getMember:function(a){return this.keyMap.get(a,!0)},destroy:function(){this.timer_=clearTimeout(this.timer_);this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndex(a);
u.prototype.destroy.call(this)}});this.extend({IndexConstructor:j,createIndexConstructor:C,Index:m,Count:i,Sum:q,Avg:l,VectorIndex:o,Min:E,Max:v,count:D,sum:g,avg:d,max:b,min:h,IndexMap:s})}.body()+"//@ sourceURL="+j+"src/basis/data/index.js")).call(basis.namespace("basis.data.index"),basis.namespace("basis.data.index"),basis.namespace("basis.data.index").exports,this,j+"src/basis/data/index.js",j+"src/basis/data/",basis,function(k){return basis.resource(j+"src/basis/data/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",
function(){function k(b){a[b]=a[b]||0;return b+a[b]++}function j(){var a=Array.from(arguments),b=a.pop();"function"!=typeof b&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],d=[],e=0,f;e<a.length;e++)f=a[e].quote('"'),c.push(f+" in delta"),d.push("data["+f+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+d.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
!0;return b}function B(){return j.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;0<b--;){if(null==arguments[b])return null;a.push(arguments[b])}return a.join("-")}))}var r=basis.Class,q=basis.Cleaner,y=Object.extend,s=Function.$self,n=Function.getter,u=basis.event.EventObject,m=basis.event.create,i=basis.data,l=i.Dataset,o=i.dataset.Subset,E=i.dataset.Split,v=i.DataObject,w=i.STATE,z={},C={string:1,number:1},D=[],g=function(a){return isNaN(a)?null:Number(a)},d=
function(a){return isNaN(a)?null:Number(a)},h=function(a){return isNaN(a)?null:parseInt(a)},b=function(a){return null==a?null:""+a},a={},e=basis.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,d){var e=a(c,d);return e!==d&&b[e]?d:e};this.calcWrapper=function(c,d){var e=a(c,d);if(e!==d&&b[e])throw"Duplicate value for index "+d+" => "+c;return e};q.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=
this.index[a];if(b&&(!c||c===b))return this.index[a]=b,!0},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],!0},destroy:function(){this.index=null}}),i=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},c=function(a,b){return function(c){this.name||(this.name=k(b));a.prototype.init.call(this,c)}},f=function(a){return function(b,c){l.setAccumulateState(!0);b=(b||[]).map(this.wrapper);l.setAccumulateState(!1);return a.prototype.sync.call(this,
b,c)}},G=r(l,{wrapper:Function.$self,init:c(l,"EntitySet"),sync:f(l),set:i(l,"set"),add:i(l,"add"),remove:i(l,"remove"),destroy:function(){l.prototype.destroy.call(this);delete this.wrapper}}),A=r(G,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),K=r(o,{init:c(o,"EntityCollection"),sync:f(o)});K.sourceHandler=o.sourceHandler;var N=r(E,{subsetClass:A,init:c(E,"EntityGrouping"),sync:f(E),getSubset:function(a,b){var c=E.prototype.getSubset.call(this,a,b);c&&(c.wrapper=
this.wrapper);return c}}),P=function(a){if(this instanceof P){a||(a=s);var b=new p({entitySetClass:{name:"Set of {"+((a.entityType||a).name||"UnknownWrapper")+"}",wrapper:a}}),a=function(a,c){return null!=a?(c instanceof G||(c=b.createEntitySet()),c.set(a instanceof l?a.getItems():Array.from(a)),c):null};a.entitySetType=b;return a}},p=r(null,{entitySetClass:G,extendConstructor_:!0,createEntitySet:function(){return new this.entitySetClass}}),L=function(a){if(this instanceof L){var b=function(a,b){if(null!=
a){if(a===b||a.entityType===c)return a;var g,h=c.idField;if(C[typeof a]){if(!h)return;g=a;a={};a[h]=g}else if(c.compositeKey)g=c.compositeKey(a,a);else if(h)g=a[h];else if(f&&(b=c.singleton,!b))return c.singleton=new e(a);null!=g&&d&&(b=d.get(g,c.entityClass));b&&b.entityType===c?b.update(a):b=new e(a);return b}return c.singleton},c=new R(a||{},b),d=c.index__,e=c.entityClass,f=c.isSingleton;y(b,{toString:function(){return this.typeName+"()"},entityType:c,type:b,typeName:c.name,index:d,reader:function(a){return c.reader(a)},
get:function(a){return c.get(a)},addField:function(a,b){c.addField(a,b)},all:c.all,createCollection:function(a,d,e){var f=c.collection_[a];return!f&&d?c.collection_[a]=new K({wrapper:b,source:e||c.all,rule:d}):f},getCollection:function(a){return c.collection_[a]},createGrouping:function(a,d,e){var f=c.grouping_[a];return!f&&d?c.grouping_[a]=new N({wrapper:b,source:e||c.all,rule:d}):f},getGrouping:function(a){return c.grouping_[a]},getSlot:function(a,b){return c.getSlot(a,b)}});return b}},Q=n("singleton"),
O={};r(v,{});var R=r(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:!1,index__:null,slot_:null,init:function(a,b){this.name=a.name||k(this.name);this.index__=a.index;this.idFields={};D.push(this);this.isSingleton=a.isSingleton;this.wrapper=b;this.all=new A(Object.extend(a.all||{},{wrapper:b}));this.slot_={};a.extensible&&(this.extensible=!0);this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(a.fields,this.addField,this);a.constrains&&a.constrains.forEach(function(a){this.addCalcField(null,
a)},this);this.isSingleton&&(this.get=Q);a.aliases&&Object.iterate(a.aliases,this.addAlias,this);this.collection_={};if(a.collections)for(var c in a.collections)this.collection_[c]=new K({name:c,wrapper:b,source:this.all,rule:a.collections[c]||Function.$true});this.grouping_={};if(a.groupings)for(c in a.groupings)this.grouping_[c]=new N({name:c,wrapper:b,source:this.all,rule:a.groupings[c]||Function.$true});this.entityClass=F(this,this.all,this.index__,this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,
type:b,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(C[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||null==a)return null;for(var c in a){var d=c in this.aliases?this.aliases[c]:"";d&&d in this.fields&&(b[d]=this.fields[d].reader?this.fields[d].reader(a[c]):a[c])}return b},addAlias:function(a,b){b in this.fields&&!1==a in this.aliases&&(this.aliases[a]=b)},addField:function(a,c){if(!this.all.itemCount){this.aliases[a]=a;"function"==typeof c&&
(c={type:c});"type"in c&&"function"!=typeof c.type&&(c.type=s);var f=c.type||s;[g,d,h,b].has(f)&&(c.id=!0);c.id&&((this.index__||(this.index__=new e(String)),this.idFields[a]=!0,this.idField||this.compositeKey)?(this.idField=null,this.compositeKey=B.apply(null,Object.keys(this.idFields))):this.idField=a);c.calc?this.addCalcField(a,c.calc,void 0):this.fields[a]=f;this.defaults[a]="defValue"in c?c.defValue:f();this.getters["get_"+a]=function(){return this.data[a]};O[a]||(O[a]={destroy:function(){this.set(a,
null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){this.calcs||(this.calcs=[]);for(var d={args:b.args||[],wrapper:!c?b:function(a,d,e){return c(b(a,d,e))}},e=this.calcs.length,f=0,g=0;g<this.calcs.length;g++)b.args.has(this.calcs[g].key)&&(f=g+1);if(a){d.key=a;for(g=0;g<this.calcs.length;g++)if(this.calcs[g].args.has(a)){e=g;break}if(f>e)return;this.idField&&a==this.idField&&(this.compositeKey=b);this.fields[a]=function(a,b){return b}}else e=f;this.calcs.splice(Math.min(e,f),0,d)}},get:function(a){a=
this.getId(a);if(null!=a)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(C[typeof a])return a;if(a&&a.entityType===this)return a.__id__;a instanceof v&&(a=a.data);return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var c=this.slot_[b];c||(C[typeof a]&&(c={},this.idField&&!this.compositeKey&&(c[this.idField]=a),a=c),c=this.slot_[b]=new v({delegate:this.get(b),data:a}));
return c}}}),t=r(v,{init:u.prototype.init,event_rollbackUpdate:m("rollbackUpdate")}),F=function(a,b,c,d,e,f,g){function h(b,c,d){var e=!1,f=a.calcs,g=b.__id__,j=b.data;try{if(f)for(var k=0,m;m=f[k++];){var n=m.key;if(n){var o=j[n];j[n]=m.wrapper(c,j,j[n]);j[n]!==o&&(c[n]=o,e=!0)}else m.wrapper(c,j)}a.compositeKey?b.__id__=a.compositeKey(c,j,b.__id__):l&&l in c&&(b.__id__=j[l]);b.__id__!==g&&a.index__.calcWrapper(b.__id__)}catch(p){b.__id__=g;for(var q in c)b.data[q]=c[q];if(d)for(q in d)b.modified||
(b.modified=d);e=!1}b.__id__!==g&&i(b,g,b.__id__);return e}function i(a,b,e){null!=b&&(c.remove(b,a),d[b]&&d[b].setDelegate());null!=e&&(c.add(e,a),d[e]&&d[e].setDelegate(a))}var l=a.idField;return r(t,g,{canHaveDelegate:!1,modified:null,isTarget:!0,extendConstructor_:!1,init:function(a){t.prototype.init.call(this);this.fieldHandlers_={};this.data={};this.root=this;this.target=this;var c,d={},g;for(g in e)g in a?(d[g]=f[g],c=e[g](a[g])):c=f[g],c&&c!==this&&c instanceof u&&c.addHandler(O[g],this)&&
(this.fieldHandlers_[g]=!0),this.data[g]=c;h(this,d);b.event_datasetChanged(b,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(b,c,d,f){var g=e[b];if(!g){if(!a.extensible)return;g=s}var i,j=this.modified,c=g(c,this.data[b]),g=this.data[b];if(c!==g&&(!c||!g||c.constructor!==Date||g.constructor!==Date||+c!==+g))a:{i={};if(b!=l)if(d)(j||(this.modified=j={}),!1===b in j)?(i.rollback={key:b,
value:void 0},j[b]=g):j[b]===c&&(i.rollback={key:b,value:c},delete j[b],Object.keys(j).length||(this.modified=null));else if(j&&b in j)if(j[b]!==c){i.rollback={key:b,value:j[b]};j[b]=c;break a}else return!1;this.data[b]=c;this.fieldHandlers_[b]&&(g.removeHandler(O[b],this),this.fieldHandlers_[b]=!1);c&&c!==this&&c instanceof u&&c.addHandler(O[b],this)&&(this.fieldHandlers_[b]=!0);i.key=b;i.value=g;i.delta={};i.delta[b]=g}else!d&&j&&b in j&&(i={rollback:{key:b,value:j[b]}},delete j[b],Object.keys(j).length||
(this.modified=null));if(!f&&i){var d=i.key,b=i.delta||{},k;i.rollback&&(k={},k[i.rollback.key]=i.rollback.value);h(this,b,k)&&(d=!0);d&&(this.event_update(this,b),i.delta=b);k&&this.event_rollbackUpdate(this,k)}return i||!1},update:function(a,b){if(a){var c,d={},e,f={},g,i;for(i in a)if(g=this.set(i,a[i],b,!0))if(g.key&&(c=!0,d[g.key]=g.value),g.rollback)e=!0,f[g.rollback.key]=g.rollback.value;h(this,d,f)&&(c=!0);c&&this.event_update(this,d);e&&this.event_rollbackUpdate(this,f)}return c?d:!1},reset:function(){this.update(f)},
clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=w.PROCESSING){if(this.modified){var a=this.modified;this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(w.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.fieldHandlers_[a]&&this.data[a].removeHandler(O[a],this);
this.fieldHandlers_=z;null!=this.__id__&&i(this,this.__id__,null);v.prototype.destroy.call(this);b.event_datasetChanged(b,{deleted:[this]});this.data=z;this.modified=null}})};this.extend({isEntity:function(a){return a&&a instanceof F},NumericId:g,NumberId:d,IntId:h,StringId:b,Index:e,CalculateField:j,EntityType:L,Entity:F,BaseEntity:t,EntitySetType:P,EntitySet:G,ReadOnlyEntitySet:A,Collection:K,Grouping:N})}.body()+"//@ sourceURL="+j+"src/basis/entity.js")).call(basis.namespace("basis.entity"),basis.namespace("basis.entity"),
basis.namespace("basis.entity").exports,this,j+"src/basis/entity.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){function j(i,l){if(!n||-1!=n.indexOf(l)){var k=r[i.namespace]+"/"+l;q[k]||(q[k]=!0,Function(basis.resource(k+".js"))())}}function x(i,l){var j=y[i];!j&&l&&(j=y[i]=new m(i));return j}var B=basis.Class,r={},q={},y={},s="base",n,u=B(null,{bindingBridge:{attach:function(i,
l,j){return i.attach(l,j)},detach:function(i,l,j){return i.detach(l,j)},get:function(i){return i.value}},listeners:null,value:null,init:function(i,j){this.listeners=[];this.value="";this.dictionary=i;this.name=j},set:function(i){if(i!=this.value){this.value=i;for(var j=0,k;k=this.listeners[j];j++)k.handler.call(k.context,i)}},get:function(){return this.value},attach:function(i,j){for(var k=0,m;m=this.listeners[k];k++)if(m.handler==i&&m.context==j)return!1;this.listeners.push({handler:i,context:j});
return!0},detach:function(i,j){for(var k=0,m;m=this.listeners[k];k++)if(m.handler==i&&m.context==j)return this.listeners.splice(k,1),!0;return!1},destroy:function(){for(var i=0,j;j=this.listeners[i];i++)this.detach(j.handler,j.context);delete this.listeners;delete this.value}}),m=B(null,{init:function(i){this.namespace=i;this.tokens={};this.resources={}},update:function(i,j){for(var k in j)this.setCultureValue(i,k,j[k])},setCulture:function(i){for(var j in this.tokens)this.setTokenValue(j,i)},setTokenValue:function(i,
j){this.tokens[i].set(this.getCultureValue(j,i)||this.getCultureValue("base",i))},setCultureValue:function(i,j,k){var m=this.resources[i];m||(m=this.resources[i]={});m[j]=k;this.tokens[j]&&("base"==i||i==s)&&this.setTokenValue(j,s)},getCultureValue:function(i,j){return this.resources[i]&&this.resources[i][j]},getToken:function(i){i in this.tokens||(this.tokens[i]=new u(this,i),this.setTokenValue(i,s));return this.tokens[i]},destroy:function(){delete this.namespace;delete this.tokens;delete this.resources}});
this.extend({Token:u,getToken:function(i){1<arguments.length&&(i=Array.from(arguments).join("."));var j=i.lastIndexOf(".");return x(i.substr(0,j),!0).getToken(i.substr(j+1))},setCulture:function(i){if(s!=i){s=i||"base";for(var l in y){var i=y[l],m=s;"base"!=m&&j(i,m);i.setCulture(m)}}},setCultureList:function(i){"string"==typeof i&&(i=i.qw());n=i},getCultureList:function(){return n},createDictionary:function(i,j,k){x(i,!0).update("base",k);r[i]=j},updateDictionary:function(i,j,k){(i=x(i))&&i.update(j,
k)},loadCultureForDictionary:j})}.body()+"//@ sourceURL="+j+"src/basis/l10n.js")).call(basis.namespace("basis.l10n"),basis.namespace("basis.l10n"),basis.namespace("basis.l10n").exports,this,j+"src/basis/l10n.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){var j=basis.Class,x=basis.dom,B=basis.Cleaner,r=basis.template.Template,q=basis.cssom.classList,y=Function.getter,s=basis.event.create,
n=basis.dom.wrapper.Node,u=basis.dom.wrapper.PartitionNode,m=basis.dom.wrapper.GroupingNode,i=1,l=function(){var g={},d=/^([a-z\_][a-z0-9\_]*)\:(.*)/i;return{add:function(d,b){g[d]||(g[d]=b)},process:function(h,b){var a;if("string"==typeof b){var e=b.match(d);e&&(a=g[e[1]],b=e[2]||h)}return a?a(b):b}}}();l.add("data",function(g){return["data."+g,"update"]});l.add("satellite",function(g){return{events:"satelliteChanged",getter:function(d){return d.satellite[g]?d.satellite[g].element:null}}});l.add("l10n",
function(g){return Function.$const(basis.l10n.getToken(g))});l.add("resource",function(g){return Function.$const(basis.resource(g))});var o=j.customExtendProperty({selected:{events:"select unselect",getter:'selected && "selected"'},disabled:{events:"disable enable",getter:function(g){return g.disabled?"disabled":""}},state:{events:"stateChanged",getter:"state"},childCount:{events:"childNodesModified",getter:function(g){return g.childNodes?g.childNodes.length:0}},hasChilds:{events:"childNodesModified",
getter:function(g){return g.childNodes&&g.childNodes.length?"hasChilds":""}}},function(g,d){g.bindingId=i++;for(var h in d){var b=null;(b=d[h])?(b=l.process(h,b),b="object"!=typeof b?{getter:y(b)}:Array.isArray(b)?{getter:y(b[0]),events:b[1]}:{getter:y(b.getter),l10n:!!b.l10n,l10nProxy:b.l10nProxy,events:b.events}):b=null;g[h]=b}}),E=j.extensibleProperty(),v=new r("<div/>"),w=function(g){return{template:v,tmpl:null,action:E,binding:o,id:null,cssClassName:null,event_templateChanged:s("templateChanged"),
event_templateUpdate:s("templateUpdate"),event_update:function(d,h){this.templateUpdate(this.tmpl,"update",h);g.event_update.call(this,d,h)},event_match:function(d){g.event_match.call(this,d);x.display(this.element,!0)},event_unmatch:function(d){g.event_unmatch.call(this,d);x.display(this.element,!1)},init:function(d){var h=this.template;h&&(this.template=null,this.setTemplate(h));g.init.call(this,d)},postInit:function(){g.postInit.call(this);this.template&&(this.templateSync(!0),this.container&&
(x.insert(this.container,this.element),this.container=null))},templateSync:function(d){var g=this.template,b=g.getBinding(this.binding,this)||null,a=this.templateBinding_,e=this.tmpl,c=this.element;if(b!==a){a&&a.handler&&this.removeHandler(a.handler);d||(this.tmpl&&this.tmpl.destroy(),e=g.createInstance(this,this.templateAction,this.templateSync),e.childNodesHere&&(e.childNodesElement=e.childNodesHere.parentNode,e.childNodesElement.insertPoint=e.childNodesHere),this.tmpl=e,this.element=e.element,
this.childNodesElement=e.childNodesElement||e.element);if(this.content)if(this.content instanceof basis.l10n.Token){var f=this.content,i=x.createText(f.value),j=function(a){this.nodeValue=a};f.attach(j,i);this.addHandler({destroy:function(){f.detach(j,i)}});x.insert(e.content||e.element,i)}else x.insert(e.content||e.element,this.content);this.id&&(e.element.id=this.id);if(d=this.cssClassName){"string"==typeof d&&(d={element:d});for(var k in d)if(g=e[k])for(var g=q(g),a=(""+d[k]).qw(),l=0,m;m=a[l++];)g.add(m)}this.templateUpdate(this.tmpl);
b&&b.names.length&&(b.handler&&this.addHandler(b.handler),b.sync.call(this));for(e=this.lastChild;e;e=e.previousSibling)this.insertBefore(e,e.nextSibling);c&&this.element&&c!==this.element&&((e=c&&c.parentNode)&&e.replaceChild(this.element,c),this.event_templateChanged(this));this.templateBinding_=b}},setTemplate:function(d){!1==d instanceof r&&(d=null);if(this.template!==d){var g=this.template,b=this.element;if(g){g.clearInstance(this.tmpl,this);var a=g.getBinding(this.binding,this);a&&a.handler&&
this.removeHandler(a.handler);this.templateBinding_=null}(this.template=d)?(d=d.createInstance(this,this.templateAction,this.templateSync),d.childNodesHere&&(d.childNodesElement=d.childNodesHere.parentNode,d.childNodesElement.insertPoint=d.childNodesHere),this.tmpl=d,this.element=d.element,this.childNodesElement=d.childNodesElement||d.element,g&&this.templateSync(!0)):this.childNodesElement=this.element=this.tmpl=null;b&&!this.element&&(g=b&&b.parentNode)&&g.nodeType==x.ELEMENT_NODE&&g.removeChild(b)}},
updateBind:function(d){var g=this.binding[d];(g=g&&g.getter)&&this.tmpl&&this.tmpl.set(d,g(this))},templateAction:function(d,g){var b=this.action[d];b&&b.call(this,g)},templateUpdate:function(){},destroy:function(){g.destroy.call(this);this.setTemplate()}}},z=function(g){return{insertBefore:function(d,h){var d=g.insertBefore.call(this,d,h),b=d.groupNode||this,b=b.childNodesElement||b.element||this.childNodesElement||this.element,a=d.nextSibling,e=d.element,a=(a&&a.element.parentNode==b?a.element:
null)||b.insertPoint||null;(e.parentNode!==b||e.nextSibling!==a)&&b.insertBefore(e,a);return d},removeChild:function(d){g.removeChild.call(this,d);var h=d.element,b=h.parentNode;b&&b.removeChild(h);return d},clear:function(d){if(d)for(var h=this.firstChild;h;){var b=h.element,a=b.parentNode;a&&a.removeChild(b);h=h.nextSibling}g.clear.call(this,d)},setChildNodes:function(d,h){var b=x.createFragment(),a=this.grouping||this,e=a.childNodesElement||a.element;a.childNodesElement=b;g.setChildNodes.call(this,
d,h);e.insertBefore(b,e.insertPoint||null);a.childNodesElement=e}}},u=j(u,w,{binding:{title:"data:"}}),C=j(m,z,{childClass:u,groupingClass:j.SELF,event_ownerChanged:function(g,d){this.syncDomRefs();m.prototype.event_ownerChanged.call(this,g,d)},listen:{owner:{templateChanged:function(){this.syncDomRefs();for(var g=this.lastChild;g;g=g.previousSibling)this.insertBefore(g,g.nextSibling)}}},init:function(g){this.element=this.childNodesElement=this.nullElement=x.createFragment();m.prototype.init.call(this,
g)},syncDomRefs:function(){var g=this,d=this.owner,h=null;d&&(h=d.tmpl&&d.tmpl.groupsElement||d.childNodesElement||d.element,h.appendChild(this.nullElement));do g.element=g.childNodesElement=h;while(g=g.grouping)}}),n=j(n,w,{childClass:null}),D=j(n,z,{childClass:n,childFactory:function(g){return new this.childClass(g)},groupingClass:C}),j=j(D,{selection:!0,init:function(g){D.prototype.init.call(this,g);B.add(this)},destroy:function(){D.prototype.destroy.call(this);B.remove(this)}}),z=function(g,d){for(var h=
g.match(/\{(this_[^\}]+)\}/g)||[],b=[],a=0;a<h.length;a++){var e=h[a].match(/\{(this_[^\|\}]+)\}/)[1];b.push("this.tmpl."+e+".nodeValue = "+e.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,templateUpdate:function(b,d,e){a.templateUpdate.call(this,b,d,e);_code_()}},config_)}.toString().replace("_code_()",b.join(";\n")))(new r(g),d)};this.setWrapper(z);this.extend({simpleTemplate:z,BINDING_PRESET:l,Node:n,Container:D,PartitionNode:u,GroupingNode:C,
Control:j})}.body()+"//@ sourceURL="+j+"src/basis/ui.js")).call(basis.namespace("basis.ui"),basis.namespace("basis.ui"),basis.namespace("basis.ui").exports,this,j+"src/basis/ui.js",j+"src/basis/",basis,function(k){return basis.resource(j+"src/basis/"+k)});(new Function("module, exports, global, __filename, __dirname, basis, resource",function(){}.body()+"//@ sourceURL="+j+"src/package/ui.js")).call(basis.namespace("package.ui"),basis.namespace("package.ui"),basis.namespace("package.ui").exports,this,
j+"src/package/ui.js",j+"src/package/",basis,function(k){return basis.resource(j+"src/package/"+k)})})();
