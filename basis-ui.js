/*!
 * Basis javasript library 
 * http://code.google.com/p/basis-js/
 *
 * @license
 * GNU General Public License v2.0 <http://www.gnu.org/licenses/gpl-2.0.html>
 */

(function(j){function q(a,d){for(var i in d)a[i]=d[i];return a}function u(a,d){for(var i in d)!1==i in a&&(a[i]=d[i]);return a}function A(a){return null==a||void 0==a}function v(a){return a}function B(a){var d={};a.names=function(a){return Object.slice(d,"string"==typeof a?a.qw():a)};a.extend=function(a){u(d,a);q(this,a);return this};return a}function w(a,d){for(var i=a.split("."),b=j,c,e,h;i.length;)if(c=i.shift(),e=(e?e+".":"")+c,b[c]||(b[c]=B((!i.length?d:null)||function(){},e),h&&(h.namespaces_[e]=
b[c])),b=b[c],!h&&(h=b,!h.namespaces_))h.namespaces_={};return o[a]=b}q(Object,{extend:q,complete:u,keys:function(a){var d=[],b;for(b in a)d.push(b);return d},values:function(a){var d=[],b;for(b in a)d.push(a[b]);return d},slice:function(a,d){var b={};if(!d)return q(b,a);for(var f=0,c;c=d[f++];)c in a&&(b[c]=a[c]);return b},splice:function(a,d){var b={};if(!d)return q(b,a);for(var f=0,c;c=d[f++];)c in a&&(b[c]=a[c],delete a[c]);return b},iterate:function(a,d,b){var f=[],c;for(c in a)f.push(d.call(b,
c,a[c]));return f},coalesce:function(){for(var a=arguments,d=0;d<a.length;d++)if(null!=a[d])return a[d]}});var s=function(){},t=function(){var a=1,d={},b={};a++;return function(f,c){var e,h;if(!c){if(f.getter)return f.getter;if("function"==typeof f)return f}if("function"!=typeof f)b[f]?e=b[f]:(e=new Function("object","return object != null ? object."+f+" : object"),e.path=f,e.getterIdx_=a++,b[f]=e);else if(e=f,!e.getterIdx_)e.getterIdx_=a++;h=e.getterIdx_;var m=d[h];if(m)if("undefined"==typeof c){if(m.nmg)return m.nmg}else for(h=
0;h<m.length;h++){if(m[h].modificator===c)return m[h].getter}else m=d[h]=[];var p=!0;switch(c&&typeof c){case "string":h=function(a){return c.format(e(a))};break;case "function":h=function(a){return c(e(a))};break;case "object":p=!1;h=function(a){return c[e(a)]};break;default:h=e.path?e:function(a){return e(a)}}if(p&&(m.push({getter:h,modificator:c}),"undefined"==typeof c))m.nmg=h;return h.getter=h}}();q(Function,{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:A,
$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:v,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},$null:function(){return null},$undef:s,getter:t,def:function(a,d,b){b=b||A;return function(f){f=a(f);return b(f)?d:f}},wrapper:function(a){return function(d){var b={};b[a]=d;return b}},lazyInit:function(a,d){var b=0,f;return function(){b++||(f=a.apply(d||this,arguments));
return f}},lazyInitAndRun:function(a,d,b){var f=0,c;return function(){f++||(c=a.call(b||this));d.apply(c,arguments);return c}},runOnce:function(a,d){var b=0;return function(){if(!b++)return a.apply(d||this,arguments)}}});u(Function.prototype,{bind:function(a){var d=this,b=Array.from(arguments,1);return b.length?function(){return d.apply(a,b.concat.apply(b,arguments))}:function(){return d.apply(a,arguments)}}});u(Array,{isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)}});
q(Array,{from:function(a,d){if(null!=a){var b=a.length;if("undefined"==typeof b)return[a];d||(d=0);if(0<b-d){for(var c=[],g=0,e=d;e<b;)c[g++]=a[e++];return c}}return[]},create:function(a,d,b){for(var c=[],g="function"==typeof d,e=0;e<a;e++)c[e]=g?d.call(b,e,c):d;return c}});u(Array.prototype,{indexOf:function(a,d){d=parseInt(d)||0;if(0>d)return-1;for(;d<this.length;d++)if(this[d]===a)return d;return-1},lastIndexOf:function(a,d){for(var b=this.length,d=parseInt(d),d=isNaN(d)||d>=b?b-1:(d+b)%b;0<=d;d--)if(this[d]===
a)return d;return-1},forEach:function(a,d){for(var b=0,c=this.length;b<c;b++)b in this&&a.call(d,this[b],b,this)},every:function(a,d){for(var b=0,c=this.length;b<c;b++)if(b in this&&!a.call(d,this[b],b,this))return!1;return!0},some:function(a,d){for(var b=0,c=this.length;b<c;b++)if(b in this&&a.call(d,this[b],b,this))return!0;return!1},filter:function(a,d){for(var b=[],c=0,g=this.length;c<g;c++)c in this&&a.call(d,this[c],c,this)&&b.push(this[c]);return b},map:function(a,d){for(var b=[],c=0,g=this.length;c<
g;c++)c in this&&(b[c]=a.call(d,this[c],c,this));return b},reduce:function(a,d){var b=this.length,c=arguments.length;if(0==b&&1==c)throw new TypeError;var g,e=0;1<c&&(g=d,e=1);for(c=0;c<b;c++)c in this&&(g=e++?a.call(null,g,this[c],c,this):this[c]);return g}});q(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return Array.create(parseInt(a)||0,this).flatten()},item:function(a){a=parseInt(a||0);return this[0<=a?a:this.length+a]},search:function(a,d,b){Array.lastSearchIndex=
-1;for(var d=Function.getter(d||v),b=parseInt(b)||0,c=this.length;b<c;b++)if(d(this[b])===a)return this[Array.lastSearchIndex=b]},lastSearch:function(a,d,b){Array.lastSearchIndex=-1;for(var d=Function.getter(d||v),c=this.length,b=isNaN(b)||null==b?c:parseInt(b),c=b>c?c:b;0<c--;)if(d(this[c])===a)return this[Array.lastSearchIndex=c]},binarySearchPos:function(a,b,c,f,g,e){if(!this.length)return f?-1:0;var b=Function.getter(b||v),c=!!c,h,g=isNaN(g)?0:g,m=isNaN(e)?this.length-1:e;do if(e=g+m>>1,h=b(this[e]),
c?a>h:a<h)m=e-1;else if(c?a<h:a>h)g=e+1;else return a==h?e:f?-1:0;while(g<=m);return f?-1:e+(h<a^c)},binarySearch:function(a,b){return this.binarySearchPos(a,b,!1,!0)},add:function(a){return-1==this.indexOf(a)&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return-1!=a&&!!this.splice(a,1)},has:function(a){return-1!=this.indexOf(a)},merge:function(a){return this.reduce(q,a||{})},sortAsObject:function(a,b,c){a=Function.getter(a);c=c?-1:1;return this.map(function(b,d){return{i:d,v:a(b)}}).sort(b||
function(a,b){return c*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(a){return this[a.i]},this)},set:function(a){if(this!==a)this.length=0,this.push.apply(this,a);return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var y=Array.prototype.splice;Array.prototype.splice=function(){var a=Array.from(arguments);if(2>a.length)a[1]=this.length;return y.apply(this,a)}}var l={"<":">","[":"]","(":")","{":"}","\u00ab":"\u00bb"};String.Entity={laquo:"\u00ab",raquo:"\u00bb",
nbsp:"\u00a0",quot:'"',quote:'"',copy:"\u00a9",shy:"\u00ad",para:"\u00b6",sect:"\u00a7",deg:"\u00b0",mdash:"\u2014",hellip:"\u2026"};u(String,{toLowerCase:function(a){return(""+a).toLowerCase()},toUpperCase:function(a){return(""+a).toUpperCase()},trim:function(a){return(""+a).trim()},trimLeft:function(a){return(""+a).trimLeft()},trimRight:function(a){return(""+a).trimRight()},isEmpty:function(a){return null==a||""==""+a},isNotEmpty:function(a){return null!=a&&""!=""+a}});u(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,
"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});q(String.prototype,{toObject:function(a){try{return Function("return 0,"+this)()}catch(b){if(a)throw b;}},toArray:(new String("a"))[0]?function(){return Array.from(this)}:function(){for(var a=[],b=this.length,c=0;c<b;c++)a[c]=this.charAt(c);return a},repeat:function(a){return Array(parseInt(a)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(/[\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$]/g,
"\\$&")},format:function(a){for(var b={},c=0;c<arguments.length;c++)b[c]=arguments[c];"object"==typeof a&&q(b,a);return this.replace(/\{([a-z\d\_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,function(a,c,e,h,i){a=c in b?b[c]:i?"":a;return e&&!isNaN(a)?(a=Number(a),"."==e?a.toFixed(h):a.lead(h)):a})},quote:function(a,b){var a=a||'"',b=b||l[a]||a,c=(1==a.length?a:"")+(1==b.length?b:"");return a+(c?this.replace(RegExp("["+c.forRegExp()+"]","g"),"\\$&"):this)+b},capitalize:function(){return this.charAt(0).toUpperCase()+
this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,b){return b.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});String.format=String.prototype.format;if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length)String.prototype.split=function(a){if(""==a||a&&""==a.source)return this.toArray();var b=[],c=0,f;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));f=a.exec(this);)f[0]=
this.substring(c,f.index),b.push.apply(b,f),c=a.lastIndex;else for(;-1!=(f=this.indexOf(a,c));)b.push(this.substring(c,f)),c=f+a.length;b.push(this.substr(c));return b};if("2"!="12".substr(-1)){var r=String.prototype.substr;String.prototype.substr=function(a,b){return r.call(this,0>a?Math.max(0,this.length+a):a,b)}}q(Number.prototype,{fit:function(a,b){return!isNaN(a)&&this<a?Number(a):!isNaN(b)&&this>b?Number(b):this},between:function(a,b){return!isNaN(this)&&this>=a&&this<=b},quote:function(a,b){return(this+
"").quote(a,b)},toHex:function(){return parseInt(this).toString(16).toUpperCase()},sign:function(){return 0>this?-1:+(0<this)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,b){return(this+"").replace(/\d+/,function(c){return 1<(a-=c.length-1)?Array(a).join(b||0)+c:c})},group:function(a,b){return(this+"").replace(/\d+/,function(c){return c.replace(/\d/g,function(f,g){return!g+(c.length-g)%(a||3)?f:(b||" ")+f})})},format:function(a,b,c,f,g){a=this.toFixed(a);if(b||g)a=
a.replace(/(\d+)(\.?)/,function(a,c,f){return(b?Number(c).group(3,b):c)+(f?g||f:"")});c&&(a=a.replace(/^-?/,"$&"+(c||"")));return a+(f||"")}});u(Date,{now:function(){return+new Date}});1900>(new Date).getYear()&&q(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&100>a?Number(a)+1900:a)}});var o={},n=function(){function a(a,b){for(var d=o[a],c=b?b.split(/\./):[];d&&c.length;)d=d[c.shift()];return d}var b=j.document?j.document.getElementsByTagName("SCRIPT"):
null,c=(b?b[b.length-1].src:module.filename).replace(/[^\/]+$/,""),f={},g;"function"==typeof require?g=function(a){return require(requirePath+a.replace(/\./g,"/"))}:(g=function(b,d){var m=b.match(/^([a-z][a-zA-Z0-9\_]*(\.[a-z][a-zA-Z0-9\_]*)*)?/)[0],p=b.substr(m.length?m.length+1:0),C=a(m,p),F=/^basis\./.test(m)?c:(location?location.href:"").replace(/[a-z0-9\-\_\.]+\.[a-z0-9]+$/,"");if(!o[m]||!C)if(/^https?:/.test(F)){if(f[b])throw"Attempt to load namespace, probably cycle require";f[b]=1;var F=F+
(d||"")+b.replace(/\./g,"/")+".js",D=new XMLHttpRequest;D.open("POST",F,!1);D.send(null);if(200==D.status){try{(new Function(D.responseText)).call(j)}catch(k){throw k;}g.sequence.push(b.replace(/\./g,"/")+".js")}else if(404==D.status&&p)n(m);else throw"!";}else throw"Path `"+b+"` can't be resolved";return C||a(m,p)},g.sequence=[]);return g}(),z=function(){function a(a){return"function"==typeof a&&a.basisClass_}var b=Function(),c=1,f={},g=function(){for(var a in{toString:1})return;return!0}();q(b,
{className:"basis.Class",extendConstructor_:!1,prototype:{constructor:null,init:Function(),toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=s}},create:function(e){"function"!=typeof e&&(e=b);var p=Function();p.prototype=e.prototype;for(var p=new p,h={className:e.className+"._SubClass_",basisClass_:!0,superClass_:e,extendConstructor_:!!e.extendConstructor_,__extend__:function(c){return c&&("object"==typeof c||
"function"==typeof c&&!a(c))&&c!==f?b.create.call(null,x,c):c},extend:b.extend,subclass:function(){return b.create.apply(null,[x].concat(Array.from(arguments)))},prototype:p},g=arguments,D=1;D<g.length;D++)h.extend("function"==typeof g[D]&&!a(g[D])?g[D](e.prototype):g[D]);var k={},x=h.extendConstructor_?function(a,b){this.eventObjectId=c++;var d,x;for(x in a)d=this[x],this[x]=d&&d.__extend__?d.__extend__(a[x]):a[x];this.init(b||k)}:function(){this.eventObjectId=c++;this.init.apply(this,arguments)};
p.constructor=x;for(var E in p)p[E]===f&&(p[E]=x);q(x,h);return x},extend:function(a){var b=this.prototype;if(a.prototype)a=a.prototype;for(var c in a){var d=a[c],e=b[c];"className"==c||"extendConstructor_"==c?this[c]=d:b[c]=e&&e.__extend__?e.__extend__(d):d}if(g&&a[c="toString"]!==Object.prototype[c])b[c]=a[c];return this}});var e=function(a,b){return{__extend__:function(a){var c=Function();c.prototype=this;c=new c;b(c,a);return c}}.__extend__(a)},h=function(a){return e(a,q)};return w("basis.Class",
b.create).extend({SELF:f,BaseClass:b,create:b.create,isClass:a,CustomExtendProperty:e,ExtensibleProperty:h,NestedExtProperty:function(a){return e(a,function(a,b){for(var c in b){var d=a[c];a[c]=d&&d.__extend__?d.__extend__(b[c]):h(b[c])}})}})}(),k=function(){function a(a){var h=c[a];h||(h=c[a]=function(){var c=this.handlers_,p,h;if(c&&c.length)for(var c=b.call(c),f=c.length;0<f--;)p=c[f],h=p.handler[a],"function"==typeof h&&h.apply(p.thisObject,arguments)});return h}var b=Array.prototype.slice,c=
{},f,g=z(null,{handlers_:null,event_destroy:f=a("destroy","object"),listen:z.NestedExtProperty(),extendConstructor_:!0,init:function(){if(this.handler)(this.handlers_||(this.handlers_=[])).push({handler:this.handler,thisObject:this.handlerContext||this})},addHandler:function(a,b){var c=this.handlers_;if(!c)c=this.handlers_=[];b||(b=this);for(var d=c.length,f;0<d--;)if(f=c[d],f.handler===a&&f.thisObject===b)return!1;return!!c.push({handler:a,thisObject:b||this})},removeHandler:function(a,b){var c=
this.handlers_;if(c){b||(b=this);for(var d=c.length,f;0<d--;)if(f=c[d],f.handler===a&&f.thisObject===b)return!!c.splice(d,1);return!1}},destroy:function(){if(this.handlers_)f.call(this,this),this.handlers_=null}});g.createEvent=a;g.event=c;return g}(),b=function(){var a=[];return{add:function(b){null!=b&&a.push(b)},remove:function(b){a.remove(b)}}}();(function(){function a(a){if(b){if(a.source!=j||a.data!=c)return;basis.dom.event.kill(a)}f.length&&(a=f.shift(),delete g[a.key],a.fn())}var b="function"==
typeof addEventListener&&"function"==typeof postMessage,c="zeroTimeoutMessage",f=[],g={},e=1;b&&j.addEventListener("message",a,!0);var h=setTimeout;j.setTimeout=function(p,C){var m;C?m=h.call(j,p,C):(m={key:"z"+e++,fn:"function"==typeof p?p:new Function(p)},g[m.key]=m,f.push(m),b?postMessage(c,"*"):m.timer=h.call(j,a,0),m=m.key);return m};var m=clearTimeout;j.clearTimeout=function(a){if(/z\d+/.test(a)){var b=g[a];b&&(clearTimeout(b.timer),f.remove(b),delete g[a])}else return m.call(j,a)}})();var c=
function(){function a(){if(!C)if(e.length){var a=Date.now(),b=Math.max(e[0].eventTime,a);b<m&&(clearTimeout(p),p=setTimeout(i,(m=b)-a))}else p=clearTimeout(p),m=f}function c(b,d){var p=b.eventObjectId,x=h[d]&&h[d][p];x&&(e.remove(x),delete h[d][p],a())}function i(){var b=Date.now(),b=e.binarySearchPos(b+15,g);C=!0;e.splice(0,b).forEach(function(a){delete h[a.eventName][a.object.eventObjectId];a.callback.call(a.object)});C=!1;m=f;a()}var f=2E12,g=t("eventTime"),e=[],h={},m=f,p=null,C=!1;b.add({destroy:function(){C=
!0;clearTimeout(p);e.length=0;h=null}});return{add:function(b,p,f){var x=b.eventObjectId,E=h[p];E||(E=h[p]={});var H=E[x];if(H){if(isNaN(f))return c(b,p);if(H.eventTime==f)return;e.remove(H);H.eventTime=f}else{if(isNaN(f))return;H=E[x]={eventName:p,object:b,eventTime:f,callback:b[p]}}e.splice(e.binarySearchPos(f,g),0,H);a()},remove:c}}();w("basis").extend({namespace:w,platformFeature:{},EventObject:k,TimeEventManager:c,Cleaner:b,require:n});j.basis.locale={}})(this);
(function(j,q){function u(k){for(var b=1E6,k=(""+k).split("."),c=0,a=0;4>c&&c<k.length;c++,b/=100)a+=k[c]*b;return a}function A(){for(var k=0;k<arguments.length;k++){var b=arguments[k].toLowerCase();if(b in B){if(B[b])return!0}else{var c=b.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(c){B[b]=!1;var a=c[1].toLowerCase(),d=u(c[3]),c=c[4]||"=";if(a=w[a])return B[b]=!d||"="==c&&a==d||"+"==c&&a>=d||"-"==c&&a<d}}}return!1}var v="basis.ua",B={},w={},s=q.navigator&&q.navigator.userAgent,t="unknown",y={MSIE:["Internet Explorer",
"msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]},l;for(l in y)if(!("MSIE"==l&&q.opera)&&!("Safari"==l&&s.match(/chrome/i))&&!("AppleWebKit"==l&&s.match(/iphone/i))&&s.match(RegExp(l+".(\\d+(\\.\\d+)*)","i")))for(var r=y[l],o=q.opera&&"function"==
typeof q.opera.version?q.opera.version():RegExp.$1,n=u(o),t=r[0]+" "+o,o=0;o<r.length;o++)w[r[o].toLowerCase()]=n;j.platformFeature.datauri=!1;s="undefined"!=typeof Image?new Image:{};s.onload=function(){j.platformFeature.datauri=!0};s.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";if(A("IE7-"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(z){}v=j.namespace(v);v.toString=function(){return t};return v.extend({testImage:s,prettyName:t,test:A,
is:function(k){return A(k)},Cookies:{set:function(k,b,c,a){document.cookie=k+"="+(null==b?"":escape(b))+";path="+(a||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)+(c?";expires="+(new Date(Date.now()+1E3*c)).toGMTString():"")},get:function(k){return(k=document.cookie.match(RegExp("(^|;)\\s*"+k+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(k[2])},remove:function(k,b){document.cookie=k+"=;expires="+(new Date(0)).toGMTString()+";path="+(b||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)}}})})(basis,
this);
(function(j,q){function u(a,b,c){if(null!=b)return a.insertBefore(i(b)?b:w(b),c||null)}function A(a){return t("",a.cloneNode(!0)).innerHTML}function v(a){return i(a)||a&&a.nodeType?a:"string"==typeof a?o.getElementById(a):null}function B(d,e,h){var i,g=[],h="string"==typeof h?getter(h):h||Function.$true;e&26&&h(d)&&g.push(d);switch(e){case 1:case 2:for(i=d;(i=i[k])&&i!==d.document;)h(i)&&g.push(i);break;case 64:for(i=d[b];i;)h(i)&&g.push(i),i=i[c];break;case 4:case 8:d[b]&&(e=new f(d),e.nodes(h,g));
break;case 128:e=new f(d,h);for(e.cursor_=d[c]||d[k];i=e.next();)g.push(i);break;case 256:for(i=d;i=i[c];)h(i)&&g.push(i);break;case 32:h(d[k])&&g.push(d[k]);break;case 512:e=new f(d,h,f.BACKWARD);for(e.cursor_=d[a]||d[k];i=e.next();)g.push(i);break;case 1024:for(i=d;i=i[a];)h(i)&&g.push(i)}return g}function w(a){return o.createTextNode(null!=a?a:"")}function s(){for(var a=o.createDocumentFragment(),b=arguments.length,c=s.array=[],d=0;d<b;d++)c.push(u(a,arguments[d]));return a}function t(a,b){var c=
void 0!=a&&"string"!=typeof a,d=(c?a.description:a)||"",f="div",x=d.match(/^([a-z0-9\_\-]+)(.*)$/i);x&&(f=x[1],d=x[2]);if(""!=d){for(var E=[],i={},g;x=m.exec(d);){if(x[8])throw Error("Create element error in basis.dom.createElement()\n\nDescription:\n> "+d+"\n\nProblem place:\n> "+d.substr(0,x.index)+"--\>"+d.substr(x.index)+"<--");g=x[1]||x[2]||x[3];x[1]?i.id=g:x[2]?E.push(g):"class"!=g&&(i[g]=x[4]?r(x[5],x[6],x[7]):g)}e&&i.name&&/^(input|textarea|select)$/i.test(f)&&(f="<"+f+" name="+i.name+">")}d=
o.createElement(f);if(i){if(i.style&&h)d.style.cssText=i.style;for(var k in i)d.setAttribute(k,i[k],0)}if(E&&E.length)d.className=E.join(" ");1<arguments.length&&u(d,s.apply(0,Array.from(arguments,1).flatten()));if(c&&(a.css&&j.cssom&&j.cssom.setStyle(d,a.css),j.dom.event))for(var n in a)"function"==typeof a[n]?j.dom.event.addHandler(d,n,a[n],d):a[n]instanceof j.dom.event.Handler&&j.dom.event.addHandler(d,n,a[n].handler,a[n].thisObject);return d}function y(a,b){return a[k]?a[k].replaceChild(b,a):
a}function l(a){if(o.selection){var b=o.selection.createRange();0!=b.compareEndPoints("StartToEnd",b)&&b.collapse(a);return b.getBookmark().charCodeAt(2)-2}}var r=Object.coalesce,o=q.document,n=j.Class,z=o.createElement("div"),k="parentNode",b="firstChild",c="nextSibling",a="previousSibling",d;d="function"==typeof z.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)}:function(a,b){return a==b?0:a.document!=b.document?33:a.sourceIndex>b.sourceIndex?2|8*b.contains(childA):4|16*
a.contains(childB)};var i;if("undefined"!=typeof Node){if(i=function(a){return a instanceof Node},!Node.prototype.contains)Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)}}else i=function(a){return a&&a.ownerDocument===o};var f=n(null,{root_:null,cursor_:null,filter:Function.$true,init:function(a,b,c){this.setRoot(a);this.setDirection(c);if("function"==typeof b)this.filter=b},setDirection:function(d){Object.extend(this,d?{a:"lastChild",b:a,c:c,d:b}:{a:b,b:c,c:a,d:"lastChild"})},
setRoot:function(a){this.root_=a||o;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,b){var c;b||(b=[]);for(this.reset();c=this.next(a);)b.push(c);return b},next:function(a){var a=a||this.filter,b=this.cursor_||this.root_;do for(var c=b[this.a];!c;){if(b===this.root_)return this.cursor_=null;(c=b[this.b])||(b=b[k])}while(!a(b=c));return this.cursor_=b},prev:function(a){var a=a||
this.filter,b=this.cursor_,c=this.c,d=this.d;do{var e=b?b[c]:this.root_[d];if(e){for(;e[d];)e=e[d];b=e}else b&&(b=b[k]);if(!b||b===this.root_){b=null;break}}while(!a(b));return this.cursor_=b},destroy:function(){this.cursor_=this.root_=null}});f.BACKWARD=!0;var g="textContent innerText nodeValue".qw(),e=function(){var a=o.createElement("input");a.name="a";return!/name/.test(A(a))}(),h;z.setAttribute("style","color: red");h="red"!==z.style.color;var m=/#([a-z0-9\_\-\:]+)|\.([a-z0-9\_\-\:]+)|\[([a-z0-9\_\-:]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
return j.namespace("basis.dom").extend({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:1,AXIS_ANCESTOR_OR_SELF:2,AXIS_DESCENDANT:4,AXIS_DESCENDANT_OR_SELF:8,AXIS_SELF:16,AXIS_PARENT:32,AXIS_CHILD:64,AXIS_FOLLOWING:128,AXIS_FOLLOWING_SIBLING:256,AXIS_PRESCENDING:512,AXIS_PRESCENDING_SIBLING:1024,INSERT_BEGIN:"begin",
INSERT_END:"end",INSERT_BEFORE:"before",INSERT_AFTER:"after",TreeWalker:f,outerHTML:A,textContent:function(a){for(var b=0,c;c=g[b++];)if(null!=a[c])return a[c];return B(a,4,function(a){return 3==a.nodeType}).map(getter("nodeValue")).join("")},get:v,tag:function(a,b){a=v(a)||o;return"*"==b&&a.all?Array.from(a.all):Array.from(a.getElementsByTagName(b||"*"))},axis:B,findAncestor:function(a,b,c){for(;a&&a!==c;){if(b(a))return a;a=a.parentNode}},createElement:t,createText:w,createFragment:s,insert:function(a,
d,e,h){a=v(a);if(!a)throw Error("basis.dom.insert: destination node can't be null");switch(e){case void 0:case "end":h=null;break;case "begin":h=a[b];break;case "before":break;case "after":h=h[c];break;default:h=Number(e).between(0,a.childNodes.length)?a.childNodes[e]:null}e=!i(a);if(!d||!Array.isArray(d))e=e?d&&a.insertBefore(d,h):u(a,d,h);else if(e)for(var e=[],f=0,x=d.length;f<x;f++)e[f]=a.insertBefore(d[f],h);else a.insertBefore(s.apply(0,d),h),e=s.array;return e},remove:function(a){return a[k]?
a[k].removeChild(a):a},replace:y,swap:function(a,b){if(a===b||d(a,b)&25)return!1;y(a,z);y(b,a);y(z,b);return!0},clone:function(a,b){var c=a.cloneNode(!b);c.attachEvent&&B(c,8).forEach(Event.clearHandlers);return c},clear:function(a){for(a=v(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,b,c){var d=[],c=Function.getter(c||Function.$self),e;for(e in b)for(var x=0;x<a.length;x++){var E=c(a[x]);d[x]=b[e](a[x],x,E)?t(e,E):a[x]}return d},setAttribute:function(a,b,c){null==c?a.removeAttribute(b):
a.setAttribute(b,c)},parentOf:function(a,b){return a.contains(b)},isInside:function(a,b){return a==b||b.contains(a)},focus:function(a,b){try{a=v(a),a.focus(),b&&a.select&&a.select()}catch(c){}},setSelectionRange:function(a,b,c){3>arguments.length&&(c=b);if(a.setSelectionRange)a.setSelectionRange(b,c);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0);d.moveStart("character",b);d.moveEnd("character",c-b);d.select()}},getSelectionStart:function(a){return"undefined"!=typeof a.selectionStart?
a.selectionStart:l(!0)},getSelectionEnd:function(a){return"undefined"!=typeof a.selectionEnd?a.selectionEnd:l(!1)}})})(basis,this);
(function(j,q){function u(a){return a||q.event}function A(a){return"string"==typeof a?r.get(a):a}function v(a){a=u(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function B(a){a=u(a);a.preventDefault?a.preventDefault():a.returnValue=!1}function w(a){var b=Array.from(k[a.type]);if(b)for(var c=b.length;0<c--;){var f=b[c];f.handler.call(f.thisObject,a)}}function s(a,c,i,f){a=A(a);if(!a)throw Error("Event.addHandler: can't attach event listener to undefined");if("function"!=typeof i)throw Error("Event.addHandler: handler must be a function");
a[n]||(a[n]={});var g={handler:i,thisObject:f},e=a[n],h=e[c];if(h){for(a=0;c=h[a];a++)if(c.handler===i&&c.thisObject===f)return;h.push(g)}else h=e[c]=[g],h.fireEvent=function(a){a=u(a);if(b&&a&&"undefined"==typeof a.returnValue){w(a);if(!0===a.cancelBubble)return;if("undefined"==typeof a.returnValue)a.returnValue=!0}for(var c=0,d;d=h[c++];)d.handler.call(d.thisObject,a)},a.addEventListener?a.addEventListener(c,h.fireEvent,!1):a.attachEvent("on"+c,h.fireEvent)}function t(a,b,c,f){var a=A(a),g=a[n];
if(g&&(g=g[b]))for(var e=0,h;h=g[e];e++)if(h.handler===c&&h.thisObject===f){g.splice(e,1);g.length||y(a,b);break}}function y(a,b){var a=A(a),c=a[n];if(c)if("string"!=typeof b)for(b in c)y(a,b);else{var f=c[b];f&&(a.removeEventListener?a.removeEventListener(b,f.fireEvent,!1):a.detachEvent("on"+b,f.fireEvent),delete c[b])}}var l=q.document,r=j.dom,o=Function.$null,n="__basisEvents",z={mousewheel:["mousewheel","DOMMouseScroll"]},k={},b=!l.addEventListener,c=function(){function a(){b++||setTimeout(function(){for(var a=
0;a<c.length;a++)c[a].callback.call(c[a].thisObject)},10)}var b=!1,c=[];if(j.ua.is("ie7-"))(function(){var b="_"+Date.now();l.write('<script id="'+b+'" defer src="//:"><\/script>');A(b).onreadystatechange=function(){"complete"==this.readyState&&(r.remove(this),a())}})();else if(j.ua.is("safari525-"))var f=setInterval(function(){/loaded|complete/.test(l.readyState)&&(clearInterval(f),a())},15);else s(l,"DOMContentLoaded",a,!1);s(l,"load",a,!1);s(q,"load",a,!1);return function(a,e){b||c.push({callback:a,
thisObject:e})}}();return j.namespace("basis.dom.event",u).extend({KEY:{BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F5:116},MOUSE_LEFT:{VALUE:1,BIT:1},MOUSE_RIGHT:{VALUE:3,BIT:2},MOUSE_MIDDLE:{VALUE:2,BIT:4},browserEvents:function(a){return z[a]||[a]},Handler:function(a,b){this.handler=a;this.thisObject=b},sender:function(a){a=u(a);return a.target||a.srcElement},cancelBubble:v,
cancelDefault:B,kill:function(a,b){(b=A(b))?s(b,a,Event.kill):(B(a),v(a))},key:function(a){a=u(a);return a.keyCode||a.which||0},charCode:function(a){a=u(a);return a.charCode||a.keyCode||0},mouseButton:function(a,b){a=u(a);return"number"==typeof a.which?a.which==b.VALUE:a.button&b.BIT},mouseX:function(a){a=u(a);return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(l.documentElement.scrollLeft||l.body.scrollLeft)},mouseY:function(a){a=u(a);return a.changedTouches?a.changedTouches[0].pageY:
"pageY"in a?a.pageY:a.clientY+(l.documentElement.scrollTop||l.body.scrollTop)},wheelDelta:function(a){a=u(a);return"wheelDelta"in a?a.wheelDelta/120:"DOMMouseScroll"==a.type?-a.detail/3:0},addGlobalHandler:function(a,b,c){var f=k[a];if(f)for(a=f.length;0<a--;){var g=f[a];if(g.handler===b&&g.thisObject===c)return}else l.addEventListener?l.addEventListener(a,w,!0):s(l,a,o),f=k[a]=[];f.push({handler:b,thisObject:c})},removeGlobalHandler:function(a,b,c){var f=k[a];if(f)for(var g=0,e;e=f[g];g++)if(e.handler===
b&&e.thisObject===c){f.splice(g,1);f.length||(delete k[a],l.removeEventListener?l.removeEventListener(a,w,!0):t(l,a,o));break}},addHandler:s,addHandlers:function(a,b,c){var a=A(a),f;for(f in b)s(a,f,b[f],c)},removeHandler:t,clearHandlers:y,fireEvent:function(a,b){var a=A(a),c=a[n];c&&c[b]&&c[b].fireEvent()},onLoad:c,onUnload:function(a,b){s(q,"unload",a,b)}})})(basis,this);
(function(){function j(b,c,a){for(var d=1,i;c;)c&1&&(i=l[d],a&d?(b.addHandler(i.handler,i.context),i.action(i.context.add,b)):(b.removeHandler(i.handler,i.context),i.action(i.context.remove,b))),c>>=1,d<<=1}function q(b){return Array.isArray(b)?b.map(q):{data:b}}var u=basis.Class,A=basis.EventObject,v=Object.values,B=Function.$self,w=A.createEvent,s=A.event,t={},y=[],l={},r=1,o={NONE:0,MASK:0,regType:function(b,c,a){l[r]={handler:c,action:a,context:{add:function(a,c){if(c){var f=o[b]+"_"+a.eventObjectId;
if(!c.subscribers_)c.subscribers_={};if(!c.subscribers_[f]){var g=c.subscriberCount;c.subscribers_[f]=a;c.subscriberCount+=1;c.event_subscribersChanged(c,g)}}},remove:function(a,c){if(c){var f=o[b]+"_"+a.eventObjectId;if(c.subscribers_[f]){var g=c.subscriberCount;delete c.subscribers_[f];c.subscriberCount-=1;c.event_subscribersChanged(c,g)}}}}};o[b]=r;o.MASK|=r;r<<=1}};o.regType("DELEGATE",{delegateChanged:function(b,c){this.remove(b,c);this.add(b,b.delegate)}},function(b,c){b(c,c.delegate)});o.regType("TARGET",
{targetChanged:function(b,c){this.remove(b,c);this.add(b,b.target)}},function(b,c){b(c,c.target)});var n=u(A,{state:"ready",data:null,canHaveDelegate:!0,delegate:null,root:null,cascadeDestroy:!1,isTarget:!1,target:null,active:!1,subscribeTo:o.DELEGATE+o.TARGET,subscriberCount:0,subscribers_:null,event_update:w("update","object","delta"),event_stateChanged:w("stateChanged","object","oldState"),event_delegateChanged:w("delegateChanged","object","oldDelegate"),event_rootChanged:w("rootChanged","object",
"oldRoot"),event_targetChanged:w("targetChanged","object","oldTarget")&&function(b,c){var a=this.listen.target;a&&(c&&c.removeHandler(a,this),this.target&&this.target.addHandler(a,this));s.targetChanged.call(this,b,c)},event_subscribersChanged:w("subscribersChanged","object"),event_activeChanged:w("activeChanged","object"),listen:{delegate:{update:function(b,c){this.data=b.data;this.event_update(this,c)},stateChanged:function(b,c){this.state=b.state;this.event_stateChanged(this,c)},targetChanged:function(b,
c){this.target=b.target;this.event_targetChanged(this,c)},rootChanged:function(b,c){this.data=b.data;this.event_rootChanged(this,c)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(b){A.prototype.init.call(this,b);if(b=this.delegate)this.delegate=null,this.data=b.data,this.state=b.state,this.setDelegate(b);else{this.root=this;if(!this.data)this.data={};if(this.isTarget)this.target=this}this.active&&j(this,this.subscribeTo,o.MASK)},isConnected:function(b){if(b instanceof
n){for(;b&&b!==this&&b!==b.delegate;)b=b.delegate;return b===this}return!1},getRootDelegate:function(){for(var b=this;b.delegate&&b.delegate!==b;)b=b.delegate;return b},setDelegate:function(b){if(this.canHaveDelegate&&b&&b instanceof n){if(b.delegate&&this.isConnected(b))return!1}else b=null;if(this.delegate!==b){var c=this.state,a=this.data,d=this.delegate,i=this.target,f=this.root,g={};d&&d.removeHandler(this.listen.delegate,this);if(b){this.delegate=b;this.root=b.root;this.data=b.data;this.state=
b.state;this.target=b.target;b.addHandler(this.listen.delegate,this);for(var e in b.data)!1===e in a&&(g[e]=void 0);for(e in a)a[e]!==b.data[e]&&(g[e]=a[e])}else for(e in this.target=this.delegate=null,this.root=this,this.data={},a)this.data[e]=a[e];this.event_delegateChanged(this,d);this.root!==f&&this.event_rootChanged(this,f);this.target!==i&&this.event_targetChanged(this,i);if(b){for(e in g){this.event_update(this,g);break}c!==this.state&&(""+c!=this.state||c.data!==this.state.data)&&this.event_stateChanged(this,
c)}return!0}return!1},setState:function(b,c){var a=this.target||this.getRootDelegate();if(a!==this)return a.setState(b,c);return this.state!=""+b||this.state.data!=c?(a=this.state,this.state=Object(""+b),this.state.data=c,this.event_stateChanged(this,a),!0):!1},deprecate:function(){"processing"!=this.state&&this.setState("deprecated")},update:function(b){var c=this.target||this.getRootDelegate();if(c!==this)return c.update(b);if(b){var c={},a=0,d;for(d in b)this.data[d]!==b[d]&&(a++,c[d]=this.data[d],
this.data[d]=b[d]);if(a)return this.event_update(this,c),c}return!1},setActive:function(b){b=!!b;return this.active!=b?(this.active=b,this.event_activeChanged(this),j(this,this.subscribeTo,o.MASK*b),!0):!1},setSubscription:function(b){var b=b&o.MASK,c=this.subscribeTo^b;return c?(this.subscribeTo=b,this.active&&j(this,c,b),!0):!1},destroy:function(){this.active&&j(this,this.subscribeTo,0);this.delegate&&this.setDelegate();A.prototype.destroy.call(this);this.data=t;this.state="undefined";this.target=
this.root=null}}),B=u(null,{itemClass:n,keyGetter:B,map_:null,extendConstructor_:!0,init:function(){this.map_={};basis.Cleaner.add(this)},resolve:function(b){return this.get(this.keyGetter(b),b)},create:function(b){var c={};b instanceof n?c.delegate=b:c.data={id:b,title:b};return new this.itemClass(c)},get:function(b,c){var a=b instanceof n?b.eventObjectId:b,d=this.map_[a];!d&&c&&(d=this.map_[a]=this.create(b,c),d.addHandler({destroy:function(){delete this.map_[a]}},this));return d},destroy:function(){basis.Cleaner.remove(this);
for(var b=v(this.map_),c=0,a;a=b[c++];)a.destroy()}}),z=u(n,{state:"undefined",itemCount:0,item_:null,memberMap_:null,cache_:null,event_datasetChanged:w("datasetChanged","dataset","delta")&&function(b,c){var a,d=0,i=0,f;if(a=c.inserted)for(;f=a[d];)this.item_[f.eventObjectId]=f,d++;if(a=c.deleted)for(;f=a[i];)delete this.item_[f.eventObjectId],i++;this.itemCount+=d-i;this.cache_=null;s.datasetChanged.call(this,b,c)},init:function(b){n.prototype.init.call(this,b);this.memberMap_={};this.item_={}},
has:function(b){return!(!b||!this.item_[b.eventObjectId])},getItems:function(){if(!this.cache_)this.cache_=v(this.item_);return this.cache_},pick:function(){for(var b in this.item_)return this.item_[b];return null},top:function(b){var c=[];if(b)for(var a in this.item_)if(c.push(this.item_[a])>=b)break;return c},add:function(){},remove:function(){},set:function(){},sync:function(){},clear:function(){},destroy:function(){this.clear();n.prototype.destroy.call(this);this.cache_=y;this.itemCount=0;this.item_=
this.memberMap_=null}}),k=u(z,{listen:{item:{destroy:function(b){this.memberMap_[b.eventObjectId]&&this.remove([b])}}},init:function(b){z.prototype.init.call(this,b);if(b=this.items)this.set(b),this.items=null},add:function(b){for(var c,a=this.memberMap_,d=[],i=0;i<b.length;i++){var f=b[i];if(f instanceof n){var g=f.eventObjectId;a[g]||(a[g]=f,f.addHandler(this.listen.item,this),d.push(f))}}d.length&&this.event_datasetChanged(this,c={inserted:d});return c},remove:function(b){for(var c,a=this.memberMap_,
d=[],i=0;i<b.length;i++){var f=b[i];if(f instanceof n){var g=f.eventObjectId;a[g]&&(f.removeHandler(this.listen.item,this),delete a[g],d.push(f))}}d.length&&this.event_datasetChanged(this,c={deleted:d});return c},set:function(b){if(!this.itemCount)return this.add(b);if(!b.length)return this.clear();for(var c=this.memberMap_,a={},d=[],i=[],f,g,e,h=0;h<b.length;h++)if(f=b[h],f instanceof n)g=f.eventObjectId,a[g]=f,c[g]||(c[g]=f,f.addHandler(this.listen.item,this),i.push(f));for(g in c)a[g]||(f=c[g],
f.removeHandler(this.listen.item,this),delete c[g],d.push(f));var m;var b={},p;if(i&&i.length)p=b.inserted=i;if(d&&d.length)p=b.deleted=d;p&&(m=b);(e=m)&&this.event_datasetChanged(this,e);return e},sync:function(b,c){if(b){k.setAccumulateState(!0);for(var a=this.memberMap_,d,i,f={},g=[],e,h=0;h<b.length;h++)if(d=b[h],d instanceof n)i=d.eventObjectId,f[i]=d,a[i]||g.push(d);for(i in this.item_)f[i]||this.item_[i].destroy();c&&g.length&&(e=this.add(g));k.setAccumulateState(!1);return e}},clear:function(){var b,
c=this.getItems();if(c.length){for(b=c.length;0<b--;)c[b].removeHandler(this.listen.item,this);this.event_datasetChanged(this,b={deleted:c});this.memberMap_={}}return b}});k.setAccumulateState=function(){function b(a){var b=a.dataset;i.call(b,b,a)}function c(a,c){var d=a.eventObjectId,f=c.inserted,g=c.deleted,k=e[d];if(f&&g)return k&&(delete e[d],b(k)),i.call(a,a,c);if(k){var n=k[f?"inserted":"deleted"];if(n)return n.push.apply(n,f||g);b(k)}e[d]=c;c.dataset=a}function a(){f=1;setAccumulateState(!1)}
var d=z.prototype,i=d.event_datasetChanged,f=0,g,e={};return function(h){if(h){if(0==f)d.event_datasetChanged=c,g=setTimeout(a,0);f++}else if(f-=0<f,0==f)clearTimeout(g),d.event_datasetChanged=i,h=e,e={},v(h).forEach(b)}}();basis.namespace("basis.data",q).extend({STATE:{UNDEFINED:"undefined",READY:"ready",PROCESSING:"processing",ERROR:"error",DEPRECATED:"deprecated"},Subscription:o,Object:n,DataObject:n,KeyObjectMap:B,AbstractDataset:z,Dataset:k})})(basis,this);
(function(j,q){function u(a,c,f,g){for(var c=c.split(/\{([a-z0-9\_]+(?:\|[^}]*)?)\}/i),e=k(),h,m=0;m<c.length;m++)m%2?(h=c[m].split(/\|/),a.getters[h[0]]=f+"childNodes["+g+"]",h=1<h.length?h[1]:h[0]):h=c[m].length?c[m]:null,null!=h&&(z&&(e.lastChild&&e.appendChild(s.createComment("")),g++),e.appendChild(b(h)),g++);return e}function A(a){return function(b){if(!b||!("click"==b.type&&3==b.which)){var c=j.dom.event.sender(b),g,e;do if(g=c.getAttributeNode&&c.getAttributeNode(a))break;while(c=c.parentNode);
if(c&&g){do if(e=c.basisObjectId)if((e=r[e])&&e.templateAction){c=g.nodeValue.qw();g=0;for(var h;h=c[g++];)e.templateAction(h,j.dom.event(b));break}while(c=c.parentNode)}}}}function v(a,b,c){b=b.trim();if(!b)return"";for(var g="",e;e=n.exec(b);){var h=e[2],m=e[4]||e[5]||h;e[3]&&(a.getters[e[3]]=c+'.getAttributeNode("'+h+'")');if(e=h.match(/^event-([a-z]+)/i)){var p=e[1];if(!l[p]){l[p]=!0;e=0;for(var p=j.dom.event.browserEvents(p),k;k=p[e++];)j.dom.event.addGlobalHandler(k,A(h))}if(!window.__basis_emitEvent)window.__basis_emitEvent=
function(a,b){var a=j.dom.event(a),c=this,d;do if(d=c.basisObjectId)if((d=r[d])&&d.templateAction){for(var c=b.qw(),e=0,h;h=c[e++];)d.templateAction(h,j.dom.event(a));break}while(c=c.parentNode)}}g+="class"==h?m.trim().replace(/^(.)|\s+/g,".$1"):"["+h+(m?"="+m.quote('"'):"")+"]"}return g}function B(a,b){if(!a.stack)a.stack=[];if(!a.source)a.source=a.str;b||(b=".");for(var c=k(),g,e=0,h,m=a.stack;h=o.exec(a.str);){g=RegExp.leftContext;a.str=a.str.substr(g.length+h[0].length);if(g.length)c.appendChild(u(a,
g,b,e)),e=c.childNodes.length;if(h[5]){if(h[5]==m[m.length-1])return m.pop(),c;throw"Wrong end tag";}if(h[6])h[7]&&(a.getters[h[7]]=b+"childNodes["+e+"]"),c.appendChild(s.createComment(h[6]));else{g=h[1];var p=h[2],n=!!h[4],j=b+"childNodes["+e+"]";h=t.createElement(g+v(a,h[3],j));p&&(a.getters[p]=j);n||(m.push(g),h.appendChild(B(a,j+".")));c.appendChild(h)}e++}a.str.length&&c.appendChild(u(a,a.str,b,e));if(m.length)throw"No end tag for "+m.reverse();return c}function w(a){if(!this.proto){a=this.source;
if("function"==typeof a)this.source=a=a();for(var a=a.trim(),a={str:a,getters:{element:".childNodes[0]"}},b=B(a),a=Object.iterate(a.getters,function(a,c){for(var d=a.split(/\|/).map(String.format,"obj_.{0}"),e=c.split(/(\.?childNodes\[(\d+)\])/),h=b,f=0;f<e.length;f+=3){var x=e[f+2];if(!x)break;e[f+2]="";h=h.childNodes[x];h.previousSibling?h.nextSibling||(e[f+1]=".lastChild"):e[f+1]=".firstChild"}return{name:d[0],alias:d.join("="),path:"dom_"+e.join("")}}).sortAsObject("path"),c=0;c<a.length;c++)for(var g=
RegExp("^"+a[c].path.forRegExp()),e=c+1,h;h=a[e++];)h.path=h.path.replace(g,a[c].name);this.createInstance=(new Function("proto_","map_","var obj_, dom_; return "+function(a,b){obj_=a||{};dom_=proto_.cloneNode(!0);_code_();if(b&&obj_.element){var c=obj_.element.basisObjectId=map_.seed++;map_[c]=b}return obj_}.toString().replace("_code_()",a.map(String.format,"{alias}={path};\n").join(""))))(b,r);this.clearInstance=(new Function("map_","var obj_; return "+function(a){obj_=a;(a=obj_.element&&obj_.element.basisObjectId)&&
delete map_[a];_code_()}.toString().replace("_code_()",a.map(String.format,"{alias}=null;\n").join(""))))(r)}}var s=q.document,t=j.dom,y=j.Class,l={},r={seed:1},o=/<([a-z0-9\_]+)(?:\{([a-z0-9\_\|]+)\})?([^>]*?)(\/?)>|<\/([a-z0-9\_]+)>|<\!--(\s*\{([a-z0-9\_\|]+)\}\s*|.*?)--\>/i,n=/(?:([a-z0-9\_\-]+):)?([a-z0-9\_\-]+)(?:\{([a-z0-9\_\|]+)\})?(?:="((?:\\.|[^"])*?)"|='((?:\\.|[^'])*?)')?\s*/gi;t.createFragment();var z=1==t.createElement("","a","b").cloneNode(!0).childNodes.length,k=t.createFragment,b=
t.createText,c=y(null,{__extend__:function(a){return a instanceof c?a:new c(a)},init:function(a){this.source=a},createInstance:function(a,b){w.call(this);return this.createInstance(a,b)},clearInstance:function(){w.call(this)}}),a=s.createElement("DIV");return j.namespace("basis.html").extend({Template:c,escape:function(a){return t.createElement("DIV",t.createText(a)).innerHTML},unescape:function(b){a.innerHTML=b;return a.firstChild.nodeValue},string2Html:function(b){a.innerHTML=b;return t.createFragment.apply(null,
Array.from(a.childNodes))}})})(basis,this);
(function(j){function q(a){return a.sortingValue||0}function u(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return+(a>b)||-(a<b)}function A(a,b){a=a.sortingValue||0;b=b.sortingValue||0;return-(a>b)||+(a<b)}function v(a){return a.childNodes.sort(a.localSortingDesc?A:u)}function B(a,b){var c=b.length-1;a.childNodes=b;a.firstChild=b[0]||null;a.lastChild=b[c]||null;for(var d=c;c=b[d];d--)c.nextSibling=b[d+1]||null,c.previousSibling=b[d-1]||null,a.insertBefore(c,c.nextSibling)}function w(a,b){var c=a.childFactory||
a.document&&a.document.childFactory,d,b=Object.extend({document:a.document,contextSelection:a.selection||a.contextSelection},b);if(c&&(d=c.call(a,b),d instanceof a.childClass))return d;if(!d)throw"basis.dom.wrapper: Child node is null";throw"basis.dom.wrapper: Child node has wrong class (expected "+(a.childClass&&a.childClass.className)+" but "+(d&&d.constructor&&d.constructor.className)+")";}function s(){return j.ui.apply(this,arguments)}var t=j.Class,y=j.dom,l=j.data,r=l.Subscription,o=l.DataObject,
n=l.AbstractDataset,z=l.Dataset,k=y.AXIS_DESCENDANT,b=y.AXIS_DESCENDANT_OR_SELF,c=Function.getter,a=Object.complete,d=y.axis,l=j.EventObject.createEvent,i=j.EventObject.event;r.regType("DATASOURCE",{dataSourceChanged:function(a,b){this.remove(a,b);this.add(a,a.dataSource)}},function(a,b){a(b,b.dataSource)});var f=t.ExtensibleProperty(),g={ownerChanged:function(){},destroy:function(a){y.replace(a.element,this)}},e=function(){var a=this.key,b=this.config,c=this.owner,d="function"!=typeof b.existsIf||
b.existsIf(c),e=c.satellite[a];if(d){var d="delegate"in b,h="dataSource"in b,f="function"==typeof b.delegate?b.delegate(c):null,i="function"==typeof b.dataSource?b.dataSource(c):null;if(e)d&&e.setDelegate(f),h&&e.setDataSource(i);else{var G=c.tmpl[b.replace||a],e={owner:c};if(d)e.delegate=f;if(h)e.dataSource=i;b.config&&Object.complete(e,"function"==typeof b.config?b.config(c):b.config);e=new b.instanceOf(e);c.satellite[a]=e;G&&e instanceof j.ui.Node&&e.element&&(y.replace(G,e.element),e.addHandler(g,
G))}}else if(e)e.destroy(),e.owner=null,delete c.satellite[a]},h=t.CustomExtendProperty({update:!0},function(a,b){for(var c in b)a[c]=b[c]?e:null}),m=t(o,{event_update:function(a,b){o.prototype.event_update.call(this,a,b);var c=this.parentNode;c&&(c.matchFunction&&(this.match(),this.match(c.matchFunction)),c.insertBefore(this,this.nextSibling))},event_childNodesModified:l("childNodesModified","node","delta"),event_dataSourceChanged:l("dataSourceChanged","node","oldDataSource"),event_localGroupingChanged:l("localGroupingChanged",
"node","oldGroupingNode"),event_localSortingChanged:l("localSortingChanged","node","oldLocalSorting","oldLocalSortingDesc"),event_ownerChanged:l("ownerChanged","node","oldOwner"),event_satellitesChanged:l("satellitesChanged","node","delta"),subscribeTo:o.prototype.subscribeTo+r.DATASOURCE,listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegateParent:!1,nodeType:"DOMWrapperNode",canHaveChildren:!1,childNodes:null,dataSource:null,colMap_:null,destroyDataSourceMember:!0,document:null,parentNode:null,
nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,localSorting:null,localSortingDesc:!1,localGrouping:null,localGroupingClass:null,groupNode:null,satelliteConfig:f,satellite:null,owner:null,init:function(a){var b=this.dataSource,c=this.childNodes,d=this.localGrouping;if(b)this.dataSource=null;o.prototype.init.call(this,a);if(d)this.localGrouping=null,this.setLocalGrouping(d);if(this.canHaveChildren)this.childNodes=[],b?(this.dataSource=null,this.setDataSource(b)):c&&this.setChildNodes(c);
else{if(c)this.childNodes=null;if(b)this.dataSource=null}if(!this.satellite)this.satellite={};if(this.satelliteConfig!==f)for(var g in this.satelliteConfig)if(a=this.satelliteConfig[g],t.isClass(a)&&(a={instanceOf:a}),"object"==typeof a){b={key:g,owner:this,config:a};a=a.hook?h.__extend__(a.hook):h;for(g in a)if(a[g]===e){this.addHandler(a,b);break}e.call(b)}if(g=this.owner)this.owner=null,this.setOwner(g)},appendChild:function(){},insertBefore:function(){},removeChild:function(){},replaceChild:function(){},
clear:function(){},hasChildNodes:function(){return 0<this.childNodes.length},setChildNodes:function(){},setLocalGrouping:function(){},setLocalSorting:function(){},setDataSource:function(){},setOwner:function(a){if(!a||!1==a instanceof m)a=null;if(this.owner!==a){var b=this.owner;b&&b.removeHandler(this.listen.owner,this);(this.owner=a)&&a.addHandler(this.listen.owner,this);this.event_ownerChanged(this,b)}},destroy:function(){o.prototype.destroy.call(this);this.dataSource?this.setDataSource():this.firstChild&&
this.clear();this.parentNode&&this.parentNode.removeChild(this);if(this.localGrouping)this.localGrouping.destroy(),this.localGrouping=null;this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var b=this.satellite[a];b.destroy();b.owner=null}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=this.document=null}}),p=t(m,{autoDestroyIfEmpty:!1,nodes:null,first:null,last:null,init:function(a){this.nodes=[];m.prototype.init.call(this,
a)},insert:function(a,b){var c=this.nodes,d=b?c.indexOf(b):-1;-1==d?(c.push(a),this.last=a):c.splice(d,0,a);this.first=c[0];a.groupNode=this;this.event_childNodesModified(this,{inserted:[a]})},remove:function(a){var b=this.nodes;if(b.remove(a))this.first=b[0]||null,this.last=b[b.length-1]||null,a.groupNode=null,this.event_childNodesModified(this,{deleted:[a]});!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=this.nodes,b=a.length;0<b--;)a[b].groupNode=
null;this.nodes=[];this.last=this.first=null;this.event_childNodesModified(this,{deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){m.prototype.destroy.call(this);this.last=this.first=this.nodes=null}}),C={canHaveChildren:!0,childClass:m,childFactory:null,listen:{dataSource:{datasetChanged:function(a,b){var c={},d=[];if(b.deleted)if(c.deleted=d,this.childNodes.length==b.deleted.length){d.push.apply(d,this.childNodes);var e=this.dataSource;this.dataSource=null;this.clear(!0);
this.dataSource=e;this.colMap_={}}else for(var e=0,h;h=b.deleted[e];e++){h=h.eventObjectId;var f=this.colMap_[h];delete this.colMap_[h];f.canHaveDelegate=!0;this.removeChild(f);d.push(f)}if(b.inserted){c.inserted=[];for(e=0;h=b.inserted[e];e++)f=w(this,{cascadeDestroy:!1,delegate:h}),f.canHaveDelegate=!1,this.colMap_[h.eventObjectId]=f,c.inserted.push(f),this.firstChild&&this.insertBefore(f)}this.firstChild?this.event_childNodesModified(this,c):this.setChildNodes(c.inserted);if(this.destroyDataSourceMember&&
d.length)for(e=0;h=d[e];e++)h.destroy()},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,b){if(!this.canHaveChildren)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";if(a.firstChild){var c=this;do if(c==a)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";while(c=c.parentNode)}if(this.dataSource&&!this.dataSource.has(a.delegate))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";
!1==a instanceof this.childClass&&(a=w(this,a instanceof o?{delegate:a}:a));var e=a.parentNode===this,h=a.groupNode,f=this.localGrouping,g=this.localSorting,i,G=this.childNodes,m,p,n=null,c=-1,j=!1,l;if(e)l=a.nextSibling,p=a.previousSibling;if(g&&(b=null,i=this.localSortingDesc,m=g(a)||0,e))if(m===a.sortingValue)j=!0;else if((!l||(i?l.sortingValue<=m:l.sortingValue>=m))&&(!p||(i?p.sortingValue>=m:p.sortingValue<=m)))a.sortingValue=m,j=!0;if(f){n=f.getGroupNode(a);p=n.nodes;if(h===n&&(j||e&&l===b))return a;
g?j?c=l&&l.groupNode===n?p.indexOf(l):p.length:(c=p.binarySearchPos(m,q,i),a.sortingValue=m):c=b&&b.groupNode===n?p.indexOf(b):p.length;if(c<p.length)b=p[c];else if(n.last)b=n.last.nextSibling;else{c=n;for(b=null;(c=c.nextSibling)&&!(b=c.first););}if(a===b||e&&a.nextSibling===b)return h!==n&&(h&&h.remove(a),n.insert(a)),a;c=-1}else if(g){if(j)return a;c=G.binarySearchPos(m,q,i);b=G[c];a.sortingValue=m;if(a===b||e&&l===b)return a}else{if(b&&b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";
if(e){if(l===b)return a;if(a===b)throw"basis.dom.wrapper: Node can't be inserted at specified point in hierarchy";}}e?(a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.previousSibling=null,a.nextSibling=null,-1==c?G.remove(a):(i=G.indexOf(a),G.splice(i,1),i<c&&c--),h&&(h.remove(a),h=null)):a.parentNode&&a.parentNode.removeChild(a);h!=n&&n.insert(a,b);if(b){-1==
c&&(c=G.indexOf(b));if(-1==c)throw"basis.dom.wrapper: Node was not found";a.nextSibling=b;G.splice(c,0,a)}else c=G.length,G.push(a),b={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=b.previousSibling;0==c?this.firstChild=a:b.previousSibling.nextSibling=a;b.previousSibling=a;var z=!1,C=!1,r=this.selection||this.contextSelection;if(!a.document&&a.document!==this.document)z=this.document,a.document=this.document;if(!a.contextSelection&&a.contextSelection!==r)a.contextSelection=
r,C=!a.selection,a.selected&&r.add([a]);a.firstChild&&(z||C)&&d(a,k).forEach(function(a){if(z&&!a.document)a.document=z;if(C&&!a.contextSelection)a.selected&&a.unselect(),a.contextSelection=r});e||(a.match&&a.match(this.matchFunction),a.autoDelegateParent&&a.setDelegate(this),this.dataSource||this.event_childNodesModified(this,{inserted:[a]}));return a},removeChild:function(a){if(null==a||a.parentNode!==this)throw"basis.dom.wrapper: Node was not found";if(!1==a instanceof this.childClass)throw"basis.dom.wrapper: Child node has wrong class";
if(this.dataSource&&this.dataSource.has(a))throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";this.childNodes.splice(this.childNodes.indexOf(a),1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.document===this.document&&d(a,b).forEach(function(a){if(a.document==
this.document)a.document=null},this);if(a.contextSelection){for(var c=a.contextSelection,e=a,h=[];e;){if(e.contextSelection===c)e.selected&&h.push(e),e.contextSelection=null;if(!e.selection&&e.firstChild)e=e.firstChild;else if(e.nextSibling)e=e.nextSibling;else for(;e=e.parentNode;)if(e.nextSibling){e=e.nextSibling;break}}c.remove(h)}a.groupNode&&a.groupNode.remove(a);this.dataSource||this.event_childNodesModified(this,{deleted:[a]});a.autoDelegateParent&&a.setDelegate();return a},replaceChild:function(a,
b){if(this.dataSource)throw"basis.dom.wrapper: Operation is not allowed because node is under dataSource control";if(null==b||b.parentNode!==this)throw"basis.dom.wrapper: Node was not found";this.insertBefore(a,b);return this.removeChild(b)},clear:function(a){if(this.dataSource)this.setDataSource();else if(this.firstChild){var b=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.event_childNodesModified(this,{deleted:b});for(var c=b.length;0<c--;){var e=b[c];e.parentNode=
null;e.groupNode=null;a?((e.selection||e.document)&&d(e,y.AXIS_DESCENDANT_OR_SELF).forEach(function(a){if(this.selection&&a.selection===this.selection)a.selected&&a.selection.remove([a]),a.selection=null;if(a.document===this.document)a.document=null},this),e.nextSibling=null,e.previousSibling=null,e.autoDelegateParent&&e.setDelegate()):e.destroy()}if(this.localGrouping){a=this.localGrouping.childNodes;for(c=a.length-1;b=a[c];c--)b.clear()}}},setChildNodes:function(a,b){this.dataSource||this.clear(!!b);
if(a&&(!1=="length"in a&&(a=[a]),a.length)){var c=this.event_childNodesModified;this.event_childNodesModified=Function.$undef;for(var e=0,d=a.length;e<d;e++)this.insertBefore(a[e]);this.event_childNodesModified=c;this.event_childNodesModified(this,{inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.canHaveChildren||!1==a instanceof n)a=null;if(this.dataSource!==a){var b=this.dataSource;if(b)this.colMap_=this.dataSource=null,b.removeHandler(this.listen.dataSource,this),b.itemCount&&
this.clear();if(a)this.dataSource=a,this.colMap_={},a.addHandler(this.listen.dataSource,this),a.itemCount&&this.listen.dataSource.datasetChanged.call(this,a,{inserted:a.getItems()});this.event_dataSourceChanged(this,b)}},setLocalGrouping:function(a){if("function"==typeof a||"string"==typeof a)a={groupGetter:c(a)};!1==a instanceof D&&(a=null!=a&&"object"==typeof a?new this.localGroupingClass(Object.complete({},a)):null);if(this.localGrouping!==a){var b=this.localGrouping,e;if(this.localGrouping){if(!a&&
(this.localGrouping=null,this.firstChild)){e=this.localSorting?v(this):this.childNodes;for(var d=e.length;0<d--;)e[d].groupNode=null;B(this,e)}b.setOwner()}if(a&&(this.localGrouping=a,a.setOwner(this),this.firstChild)){e=this.localSorting?v(this):this.childNodes;for(d=0;a=e[d];d++)a.groupNode=this.localGrouping.getGroupNode(a);for(d=0;a=e[d];d++)a.groupNode.nodes.push(a);e.length=0;for(d=this.localGrouping.nullGroup;d;d=d.nextSibling)a=d.nodes,d.first=a[0]||null,d.last=a[a.length-1]||null,e.push.apply(e,
a),d.event_childNodesModified(d,{inserted:a});B(this,e)}this.event_localGroupingChanged(this,b)}},setLocalSorting:function(a,b){a&&(a=c(a));if(this.localSorting!=a||this.localSortingDesc!=!!b){var e=this.localSorting,d=this.localSortingDesc;this.localSortingDesc=!!b;this.localSorting=a||null;if(a&&this.firstChild){var h=[],f;for(f=this.firstChild;f;f=f.nextSibling)f.sortingValue=a(f)||0;if(this.localGrouping)for(var g=this.localGrouping.nullGroup;g;g=g.nextSibling)f=g.nodes=v({childNodes:g.nodes,
localSortingDesc:this.localSortingDesc}),g.first=f[0]||null,g.last=f[f.length-1]||null,h.push.apply(h,f);else h=v(this);B(this,h)}this.event_localSortingChanged(this,e,d)}},setMatchFunction:function(a){if(this.matchFunction!=a){this.matchFunction=a;for(var b=this.lastChild;b;b=b.previousSibling)b.match(a)}}},r=t(m,{event_enable:l("enable","node"),event_disable:l("disable","node"),event_select:l("select","node"),event_unselect:l("unselect","node"),event_match:l("match","node"),event_unmatch:l("unmatch",
"node"),selectable:!0,selected:!1,selection:null,contextSelection:null,matchFunction:null,matched:!0,disabled:!1,init:function(a){if(this.selection&&!1==this.selection instanceof n)this.selection=new I(this.selection);m.prototype.init.call(this,a);this.disabled&&this.event_disable(this);if(this.selected)this.selected=!1,this.select(!0)},setSelection:function(a){if(this.selection==a)return!1;var b=this.selection;d(this,k,function(c){if(c.contextSelection==b)c.selected&&b&&b.remove([c]),c.contextSelection=
a});this.selection=a;return!0},hasOwnSelection:function(){return!!this.selection},select:function(a){var b=this.selected,c=this.contextSelection;if(c)a?b?c.remove([this]):c.add([this]):this.selectable&&c.set([this]);else if(!b&&this.selectable&&!this.isDisabled())this.selected=!0,this.event_select(this);return this.selected!=b},unselect:function(){var a=this.selected;if(a){var b=this.contextSelection;b?b.remove([this]):(this.selected=!1,this.event_unselect(this))}return this.selected!=a},enable:function(){if(this.disabled)this.disabled=
!1,this.event_enable(this)},disable:function(){if(!this.disabled)this.disabled=!0,this.event_disable(this)},isDisabled:function(){return this.disabled||this.document&&this.document.disabled||!!y.findAncestor(this,c("disabled"))},match:function(a){if("function"!=typeof a)if(this.matched){if(this.underMatch_)this.underMatch_(this,!0),this.underMatch_=null}else this.matched=!0,this.event_match(this);else if(a(this)){if(this.underMatch_=a,!this.matched)this.matched=!0,this.event_match(this)}else if(this.underMatch_=
null,this.matched)this.matched=!1,this.event_unmatch(this)},setMatchFunction:function(){},destroy:function(){this.hasOwnSelection()&&(this.selection.destroy(),delete this.selection);this.unselect();m.prototype.destroy.call(this)}}),F=t(r,C,{}),D=t(m,C,{event_childNodesModified:function(a,b){i.childNodesModified.call(this,a,b);this.nullGroup.nextSibling=this.firstChild;if(b.inserted&&this.dataSource&&this.nullGroup.first)for(var c=this.owner,e=Array.from(this.nullGroup.nodes),d=e.length;0<d--;)c.insertBefore(e[d],
e[d].nextSibling)},event_ownerChanged:function(a,b){b&&b.localGrouping===this&&b.setLocalGrouping(null,!0);this.owner&&this.owner.localGrouping!==this&&this.owner.setLocalGrouping(this);i.ownerChanged.call(this,a,b);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:!0,autoDestroyEmptyGroups:!0,titleGetter:c("data.title"),groupGetter:Function.$undef,childClass:p,childFactory:function(b){return new this.childClass(a(b,{titleGetter:this.titleGetter,autoDestroyIfEmpty:this.dataSource?
!1:this.autoDestroyEmptyGroups}))},init:function(a){this.map_={};this.nullGroup=new p({autoDestroyIfEmpty:!1});m.prototype.init.call(this,a)},getGroupNode:function(a){var a=this.groupGetter(a),b=a instanceof o,c=this.map_[b?a.eventObjectId:a];!c&&!this.dataSource&&(c=this.appendChild(b?{delegate:a}:{data:{id:a,title:a}}));return c||this.nullGroup},insertBefore:function(a,b){a=C.insertBefore.call(this,a,b);if(!1=="groupId_"in a)a.groupId_=a.delegate?a.delegate.eventObjectId:a.data.id,this.map_[a.groupId_]=
a;if(a.first){var c=this.owner,e=c.childNodes,d=a.first,h=a.last,f,g,i;for(f=a;(f=f.previousSibling)&&!(i=f.last););if(!i)i=this.nullGroup.last;for(f=a;(f=f.nextSibling)&&!(g=f.first););if(d.previousSibling!==i||h.nextSibling!==g){if(d.previousSibling)d.previousSibling.nextSibling=h.nextSibling;if(h.nextSibling)h.nextSibling.previousSibling=d.previousSibling;f=e.splice(e.indexOf(d),a.nodes.length);var m=e.indexOf(g);f.unshift(-1!=m?m:e.length,0);e.splice.apply(e,f);d.previousSibling=i;h.nextSibling=
g;if(i)i.nextSibling=d;if(g)g.previousSibling=h;c.firstChild=e[0];c.lastChild=e[e.length-1]}}return a},removeChild:function(a){C.removeChild.call(this,a);delete this.map_[a.groupId_];return a},clear:function(){C.clear.call(this);this.map_={}},destroy:function(){this.setOwner();m.prototype.destroy.call(this);this.map_=null}});m.prototype.localGroupingClass=D;var l=t(n,{autoDestroy:!0,sourceNode:null,listen:{sourceNode:{childNodesModified:function(a,b){var c=this.memberMap_,e={},d=0,h=0,f=b.inserted,
g=b.deleted;if(f&&f.length)for(e.inserted=f;a=f[d];)c[a.eventObjectId]=a,d++;if(g&&g.length)for(e.deleted=g;a=g[h];)delete c[a.eventObjectId],h++;(d||h)&&this.event_datasetChanged(this,e)},destroy:function(){this.autoDestroy?this.destroy():this.setSourceNode()}}},event_sourceNodeChanged:l("sourceNodeChanged")&&function(a,b){i.sourceNodeChanged.call(this,a,b);!this.sourceNode&&this.autoDestroy&&this.destroy()},extendConstructor_:!1,init:function(a,b){n.prototype.init.call(this,b);a&&this.setSourceNode(a)},
setSourceNode:function(a){!1==a instanceof m&&(a=null);if(a!==this.sourceNode){var b=this.sourceNode;b&&(b.removeHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,b,{deleted:b.childNodes}));a&&(a.addHandler(this.listen.sourceNode,this),this.listen.sourceNode.childNodesModified.call(this,a,{inserted:a.childNodes}));this.sourceNode=a;this.event_sourceNodeChanged(this,b)}},destroy:function(){this.setSourceNode();n.prototype.destroy.call(this)}}),I=t(z,{multiple:!1,
event_datasetChanged:function(a,b){z.prototype.event_datasetChanged.call(this,a,b);if(b.inserted)for(var c=0,e;e=b.inserted[c];c++)if(!e.selected)e.selected=!0,e.event_select();if(b.deleted)for(c=0;e=b.deleted[c];c++)if(e.selected)e.selected=!1,e.event_unselect()},add:function(a){if(!this.multiple){if(this.itemCount)return this.set(a);a.splice(1)}for(var b=[],c=0,e;e=a[c];c++)e.contextSelection==this&&e.selectable&&b.push(e);return z.prototype.add.call(this,b)},set:function(a){for(var b=[],c=0,e;e=
a[c];c++)e.contextSelection==this&&e.selectable&&b.push(e);this.multiple||a.splice(1);return z.prototype.set.call(this,b)}});j.namespace("basis.dom.wrapper",s).extend({AbstractNode:m,InteractiveNode:r,Node:F,GroupingNode:D,PartitionNode:p,simpleTemplate:s,ChildNodesDataset:l,Selection:I})})(basis);
(function(j,q){function u(a,b){return B(b,!0).getRule(a,!0)}function A(a,b){var c=a.match(/^([^{]+)\{(.*)\}\s*$/);if(c){for(var e=c[1].trim().split(/\s*,\s*/),d=0;d<e.length;d++)this.addRule(e[d],c[2]||null,b++);return b-1}}function v(a,b){var c=k.createElement(!a?'STYLE[type="text/css"]':'LINK[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:b?"alternate ":"",url:a.quote('"')}));k.tag(null,"HEAD")[0].appendChild(c);c=c.sheet||c.styleSheet;try{if(!c.cssRules)c.cssRules=c.rules}catch(e){}if(!c.insertRule)c.insertRule=
A;if(!c.deleteRule)c.deleteRule=c.removeRule;return c}function B(a,b){a||(a="DefaultGenericStyleSheet");i[a]||b&&(i[a]=new e(v()));return i[a]}function w(a,b,c,e){for(var e=e||{},b=b.qw(),d=0,h;h=b[d];d++)if("undefined"!=typeof g.style[h]){c&&(j.platformFeature["css-"+a]=h);f[a]={key:h,getter:e[h]};break}}function s(a,b){var c=f[a];if(a=c?c.key:a.replace(/^-ms-/,"ms-").camelize())return{key:a,value:c&&c.getter?c.getter(b):b}}function t(a,b,c){if("function"==typeof a.setProperty)return a.setProperty(b,
c);if(b=s(b,c))return a.style[b.key]=b.value}function y(a,b){for(var c in b)t(a,c,b[c]);return a}function l(a,b){return t(a,"display","string"==typeof b?b:b?"":"none")}function r(a,b){return t(a,"visibility",b?"":"hidden")}function o(a){return F[a]||(F[a]=RegExp("\\s*\\b"+a+"\\b"))}function n(a,b){var c=(b?"g":"s")+a;return I[c]||(I[c]=RegExp((b?"":"\\s*")+"\\b"+a+".*\\b"))}var z=q.document,k=j.dom,b=j.dom.event,c=j.Class,a=/\s*!important/i,d=1,i={},f={},g=k.createElement("DIV");w("opacity","opacity MozOpacity KhtmlOpacity filter",
!0,{fitler:function(a){return"alpha(opacity:"+parseInt(100*a)+")"}});w("border-radius","borderRadius MozBorderRadius WebkitBorderRadius",!0);w("float","cssFloat styleFloat");var e=c(null,{styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[];this.map_={}},getRule:function(a,b){if(!this.map_[a]&&b){for(var c=this.styleSheet,e=this.rules.length,d=c.insertRule(a+"{}",e),f=e;f<=d;f++)this.rules.push(new h(c.cssRules[f]));this.map_[a]=e!=d?new m(this.rules.splice(e)):this.rules[e]}return this.map_[a]},
deleteRule:function(a){var b=this.map_[a];if(b){for(var b=b.rules||[b],c=0;c<b.length;c++){var e=this.rules.indexOf(b[c]);this.stylesheet.deleteRule(e);this.rules.splice(e,1)}delete this.map_[a]}},destroy:function(){delete this.rules}}),h=c(null,{rule:null,selector:"",init:function(a){if(a)this.rule=a,this.selector=a.selectorText},setProperty:function(b,c){var e,d=!!a.test(c),h=this.rule.style;if(d||h.getPropertyPriority&&"important"==h.getPropertyPriority(b)){if(c=c.replace(a,""),e=s(b,c)){var f=
e.key;h.setProperty?(d||h.removeProperty(f),h.setProperty(f,e.value,d?"important":"")):h.cssText=h.cssText.replace(RegExp(h[f]?f+"\\s*:\\s*"+h[f]+"(\\s*!important)?\\s*;?":"^","i"),f+": "+e.value+(d?" !important":"")+";")}}else t(this.rule,b,c)},setStyle:function(a){Object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){delete this.rule}}),m=c(null,{rules:null,init:function(a){this.rules=a},destroy:function(){delete this.rules}});["setProperty","setStyle",
"clear"].forEach(function(a){m.prototype[a]=function(){for(var b,c=0;b=this.rules[c];c++)b[a].apply(b,arguments)}});var p={};["em","ex","px","%"].forEach(function(a){p["%"==a?"percent":a]=function(b){return 0==b||isNaN(b)?"0":b+a}});var C,F={},D=c(null,{init:function(a){this.element=a},toString:function(){return this.element.className},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,b,c){c=c||"";"undefined"!=typeof a&&this.remove(c+a);"undefined"!=typeof b&&this.add(c+
b)},bool:function(a,b){b?this.add(a):this.remove(a)},clear:function(){this.element.className=""},contains:function(a){return!!this.element.className.match(o(a))},item:function(a){return this.element.className.qw()[a]},add:function(a){this.element.className.match(o(a))||(this.element.className+=" "+a)},remove:function(a){var b=this.element.className,a=b.replace(o(a),"");if(a!=b)this.element.className=a},toggle:function(a){var b=this.contains(a);b?this.remove(a):this.add(a);return!b}}),I={},x=c(null,
{delim:"-",init:function(a,b){this.classList=b;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+a)},items:function(){var a=this.classList.toString();if(a)return a.toString().match(n(this.prefix,!0))},set:function(a){var b=this.items(),a="undefined"!=typeof a?this.prefix+a:"",c=this.classList;if(b)if(1==b.length){if(b[0]===a)return;c.remove(b[0])}else this.clear();a&&c.add(a)},clear:function(){this.items().forEach(this.classList.remove,
this.classList)}});q.DOMTokenList&&z.documentElement.classList?(c=D.prototype,Object.extend(q.DOMTokenList.prototype,{set:c.set,replace:c.replace,bool:c.bool,clear:function(){for(var a=this.length;0<a--;)this.remove(this[a])},setPrefixToken:c.setPrefixToken}),C=function(a){return("string"==typeof a?k.get(a):a).classList}):C=function(a){return new D("string"==typeof a?k.get(a):a)};b.onLoad(function(){C(z.body).bool("opacity-not-support",!j.platformFeature["css-opacity"])});k.extend({setStyleProperty:t,
setStyle:y,display:l,show:function(a){return l(a,1)},hide:function(a){return l(a)},visibility:r,visible:function(a){return r(a,1)},invisible:function(a){return r(a)}});return j.namespace("basis.cssom").extend({setStyleProperty:t,setStyle:y,classList:function(a,b){return b?new x(b,C(a)):C(a)},uniqueRule:function(a){var b="genericRule-"+d++;a&&C(a).add(b);a=u("."+b);a.token=b;return a},cssRule:u,getStyleSheet:B,addStyleSheet:v,CssStyleSheetWrapper:e,CssRuleWrapper:h,CssRuleWrapperSet:m}).extend(p)})(basis,
this);
(function(){function j(b,c){var a={},d;if(b&&b.length)d=a.inserted=b;if(c&&c.length)d=a.deleted=c;if(d)return a}var q=basis.Class,u=Object.extend,A=Function.$self,v=Function.$true,B=Function.$false,w=basis.EventObject.createEvent,s=basis.data.Subscription,t=basis.data.DataObject,y=basis.data.KeyObjectMap,l=basis.data.AbstractDataset,r=basis.data.Dataset;Subscription.regType("SOURCE",{sourceChanged:function(b,c){this.remove(b,c);this.add(b,b.source)},sourcesChanged:function(b,c){var a;if(a=c.inserted)for(var d=a.length;0<
d--;)this.add(b,a[d]);if(a=c.deleted)for(d=a.length;0<d--;)this.remove(b,a[d])}},function(b,c){for(var a=c.sources||[c.source],d=0,i;i=a[d++];)b(c,i)});var o=q(l,{subscribeTo:s.SOURCE,event_sourcesChanged:w("sourcesChanged","dataset","delta"),sources:null,rule:function(b){return 0<b},listen:{source:{datasetChanged:function(b,c){var a=this.memberMap_,d={},i,f;if(c.inserted)for(var g=0;i=c.inserted[g];g++)f=i.eventObjectId,a[f]?a[f].count++:a[f]={count:1,object:i},d[f]=a[f];if(c.deleted)for(g=0;i=c.deleted[g];g++)f=
i.eventObjectId,d[f]=a[f],a[f].count--;this.applyRule(d)},destroy:function(b){this.removeSource(b)}}},init:function(b){l.prototype.init.call(this,b);b=this.sources;this.sources=[];b&&b.forEach(this.addSource,this)},setRule:function(b){if("function"!=typeof b)b=o.UNION;if(this.rule!==b)this.rule=b,this.applyRule()},applyRule:function(b){var c=this.memberMap_,a=this.rule,d=this.sources.length,i=[],f=[],g,e,h;b||(b=c);for(var m in b)g=c[m],e=d&&g.count&&a(g.count,d),e!=!!this.item_[m]&&(e?i:f).push(g.object),
0==g.count&&delete c[m];(h=j(i,f))&&this.event_datasetChanged(this,h)},addSource:function(b){if(b instanceof l&&this.sources.add(b)){b.addHandler(this.listen.source,this);var c=this.memberMap_,a;for(a in b.item_)c[a]?c[a].count++:c[a]={count:1,object:b.item_[a]};this.applyRule();this.event_sourcesChanged(this,{inserted:[b]});return!0}},removeSource:function(b){if(this.sources.remove(b)){b.removeHandler(this.listen.source,this);var c=this.memberMap_,a;for(a in b.item_)c[a].count--;this.applyRule();
this.event_sourcesChanged(this,{deleted:[b]});return!0}},setSources:function(b){for(var c=Array.from(this.sources),a=0,d;d=b[a];a++)d instanceof l&&(c.remove(d)||this.addSource(d));c.forEach(this.removeSource,this)},clear:function(){Array.from(this.sources).forEach(this.removeSource,this)},destroy:function(){l.prototype.destroy.call(this);this.sources=null}});o.UNION=o.prototype.rule;o.INTERSECTION=function(b,c){return b==c};o.DIFFERENCE=function(b){return 1==b};o.MORE_THAN_ONE_INCLUDE=function(b,
c){return 1==c||1<b};o.AT_LEAST_ONE_EXCLUDE=function(b,c){return 1==c||b<c};var n=function(b){return!this.has(b)};s.regType("MINUEND",{operandsChanged:function(b,c){this.minuend!==c&&(this.remove(b,c),this.add(b,b.minuend))}},function(b,c){b(c,c.minuend)});s.regType("SUBTRAHEND",{operandsChanged:function(b,c,a){this.subtrahend!==a&&(this.remove(b,a),this.add(b,b.subtrahend))}},function(b,c){b(c,c.subtrahend)});var z=q(l,{subscribeTo:s.MINUEND+s.SUBTRAHEND,minuend:null,subtrahend:null,event_operandsChanged:w("operandsChanged",
"dataset","oldMinuend","oldSubtrahend"),listen:{minuend:{datasetChanged:function(b,c){if(this.subtrahend){var a=j(c.inserted&&c.inserted.filter(n,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{datasetChanged:function(b,c){if(this.minuend){var a=j(c.deleted&&c.deleted.filter(n,this),c.inserted&&c.inserted.filter(this.has,this));a&&this.event_datasetChanged(this,a)}},destroy:function(){this.setOperands(this.minuend,
null)}}},init:function(b){l.prototype.init.call(this,b);var b=this.minuend,c=this.subtrahend;this.subtrahend=this.minuend=null;(b||c)&&this.setOperands(b,c)},setOperands:function(b,c){var a,d=!1;!1==b instanceof l&&(b=null);!1==c instanceof l&&(c=null);var i=this.minuend,f=this.subtrahend;if(i!==b)d=!0,i&&i.removeHandler(this.listen.minuend,this),(this.minuend=b)&&b.addHandler(this.listen.minuend,this);if(f!==c)d=!0,f&&f.removeHandler(this.listen.subtrahend,this),(this.subtrahend=c)&&c.addHandler(this.listen.subtrahend,
this);if(!d)return!1;this.event_operandsChanged(this,i,f);if(!b||!c)this.itemCount&&this.event_datasetChanged(this,a={deleted:this.getItems()});else{var d=[],i=[],g;for(g in this.item_)(!b.item_[g]||c.item_[g])&&d.push(this.item_[g]);for(g in b.item_)!this.item_[g]&&!c.item_[g]&&i.push(b.item_[g]);(a=j(i,d))&&this.event_datasetChanged(this,a)}return a},clear:function(){this.setOperands()}}),k=q(l,{subscribeTo:s.SOURCE,source:null,event_sourceChanged:w("sourceChanged","dataset","oldSource"),map:A,
reduce:B,rule:B,addMemberRef:null,removeMemberRef:null,sourceMap_:null,listen:{sourceObject:{update:function(b){var c=this.map?this.map(b):b;if(!1==c instanceof t||this.reduce(c))c=null;var a=this.sourceMap_[b.eventObjectId],d=a.member;if(d!=c){var i=this.memberMap_,f,g,e;a.member=c;if(d)a=d.eventObjectId,this.removeMemberRef&&this.removeMemberRef(d,b),0==--i[a]&&(delete i[a],e=[d]);if(c)d=c.eventObjectId,this.addMemberRef&&this.addMemberRef(c,b),i[d]?i[d]++:(i[d]=1,g=[c]);(f=j(g,e))&&this.event_datasetChanged(this,
f)}}},source:{datasetChanged:function(b,c){var a=this.sourceMap_,d=this.memberMap_,i=[],f=[],g,e,h;r.setAccumulateState(!0);if(c.inserted)for(var m=0;g=c.inserted[m];m++){h=this.map?this.map(g):g;if(!1==h instanceof t||this.reduce(h))h=null;g.addHandler(this.listen.sourceObject,this);a[g.eventObjectId]={sourceObject:g,member:h};if(h)e=h.eventObjectId,d[e]?d[e]++:(d[e]=1,i.push(h)),this.addMemberRef&&this.addMemberRef(h,g)}if(c.deleted)for(m=0;g=c.deleted[m];m++)if(e=g.eventObjectId,h=a[e].member,
g.removeHandler(this.listen.sourceObject,this),delete a[e],h)e=h.eventObjectId,0==--d[e]&&(delete d[e],f.push(h)),this.removeMemberRef&&this.removeMemberRef(h,g);r.setAccumulateState(!1);(c=j(i,f))&&this.event_datasetChanged(this,c)},destroy:function(){this.setSource()}}},init:function(b){l.prototype.init.call(this,b);this.sourceMap_={};if(b=this.source)this.source=null,this.setSource(b)},setRule:function(b){"function"!=typeof b&&(b=v);if(this.rule!==b)return this.rule=b,this.applyRule()},setMap:function(b){"function"!=
typeof b&&(b=A);if(this.map!==b)return this.map=b,this.applyRule()},setSource:function(b){!1==b instanceof l&&(b=null);if(this.source!==b){var c=this.source;c&&(c.removeHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,c,{deleted:c.getItems()}));if(this.source=b)b.addHandler(this.listen.source,this),this.listen.source.datasetChanged.call(this,b,{inserted:b.getItems()});this.event_sourceChanged(this,c)}},applyRule:function(){var b=this.sourceMap_,c=this.memberMap_,a,d,i,
f,g,e=[],h=[],m,p;for(p in b){g=b[p];f=g.sourceObject;a=g.member;d=this.map?this.map(f):f;if(!1==d instanceof t||this.reduce(d))d=null;if(a!=d){g.member=d;if(a)i=a.eventObjectId,this.removeMemberRef&&this.removeMemberRef(a,f),c[i]--;if(d)a=d.eventObjectId,this.addMemberRef&&this.addMemberRef(d,f),a in c?c[a]++:(c[a]=1,e.push(d))}}for(i in this.item_)0==c[i]&&(delete c[i],h.push(this.item_[i]));(m=j(e,h))&&this.event_datasetChanged(this,m);return m},clear:function(){this.setSource()},destroy:function(){l.prototype.destroy.call(this);
this.sourceMap_=null}}),B=q(k,{reduce:function(b){return!this.rule(b)},rule:v}),q=q(k,{map:function(b){return this.keyMap.resolve(b)},rule:v,subsetClass:l,keyMap:null,addMemberRef:function(b,c){b.event_datasetChanged(b,{inserted:[c]})},removeMemberRef:function(b,c){b.event_datasetChanged(b,{deleted:[c]})},init:function(b){if(!this.keyMap||!1==this.keyMap instanceof y)this.keyMap=new y(u({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));k.prototype.init.call(this,b)},getSubset:function(b,
c){return this.keyMap.get(b,c)},destroy:function(){k.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});basis.namespace("basis.data.dataset").extend({Merge:o,Subtract:z,MapReduce:k,Subset:B,Split:q})})(basis,this);
(function(){function j(a){if(a instanceof k)return a.set;a=a.nodeType;if(!1==isNaN(a))return 1==a?z:"nodeValue"}var q=basis.Class,u=basis.dom,A=basis.Cleaner,v=Function.getter,B=basis.cssom.classList,w=basis.EventObject,s=basis.TimeEventManager,t=w.createEvent,y=basis.data,l=y.DataObject,r=y.STATE,o=q(l,{event_change:t("change"),locked:!1,lockValue_:null,extendConstructor_:!1,updateCount:0,init:function(a,b,c){l.prototype.init.call(this,{});b&&this.addHandler(b);this.proxy="function"==typeof c?c:
Function.$self;this.initValue=this.value=this.proxy(a)},set:function(a,b){var c=this.value,f=this.proxy?this.proxy(a):f,g=!1;if(f!==c)this.value=f,g=!0,this.updateCount+=1;!this.locked&&(g||b)&&this.event_change(f,c);return g},lock:function(){if(!this.locked)this.lockValue_=this.value,this.locked=!0},unlock:function(){if(this.locked)this.locked=!1,this.value!==this.lockValue_&&this.event_change(this.value,this.lockValue_)},update:function(a,b){return this.set(a,b)},reset:function(){this.set(this.initValue)},
destroy:function(){l.prototype.destroy.call(this);delete this.initValue;delete this.proxy;delete this.lockValue_;delete this.value}}),n={destroy:function(a){this.removeLink(a)}},z=function(a){u.insert(u.clear(this),a)},k=q(o,{links_:null,event_change:function(a,b){o.prototype.event_change.call(this,a,b);if(this.links_.length&&!A.globalDestroy)for(var c=0,f;f=this.links_[c++];)this.power_(f,b)},init:function(a,b,c){o.prototype.init.call(this,a,b,c);this.links_=[];A.add(this)},addLink:function(a,b,
c){if("object"!=typeof a&&!1==a instanceof Object)throw Error("basis.data.property: Link to undefined object ignored");null==b&&(b=j(a));"function"!=typeof c&&(c=v(Function.$self,c));b={object:a,format:c,field:b,isEventObject:a instanceof w};this.links_.push(b);b.isEventObject&&a.addHandler(n,this);this.power_(b);return a},addLinkShortcut:function(a,b,c){return this.addLink(a,k.shortcut[b],c)},removeLink:function(a,b){if(null!=this.links_){var c=2>arguments.length;!c&&null==b&&(b=j(a));for(var f=
0,g=0,e;e=this.links_[g];g++)e.object===a&&(c||b==e.field)?e.isEventObject&&e.object.removeHandler(n,this):this.links_[f++]=e;this.links_.length=f}},clear:function(){for(var a=0,b;b=this.links_[a];a++)b.isEventObject&&b.object.removeHandler(n,this);this.links_.clear()},power_:function(a,b){var c=a.field;if(null!=c){var f=a.format(this.value),g=a.object;"function"==typeof c?c.call(g,f,2>arguments.length?f:a.format(b)):g[c]=f}},destroy:function(){this.clear();o.prototype.destroy.call(this);this.links_=
null;A.remove(this)}});k.shortcut={className:function(a,b){B(this).replace(b,a)},show:function(a){u.display(this,!!a)},hide:function(a){u.display(this,!a)},disable:function(a){this.disabled=!!a},enable:function(a){this.disabled=!a}};var b=[r.READY,r.DEPRECATED,r.UNDEFINED,r.ERROR,r.PROCESSING],c={stateChanged:function(){this.fire(!1,!0)},update:function(){this.fire(!0)},change:function(){this.fire(!0)},destroy:function(a){this.remove(a)}},q=q(k,{calculateValue:function(){return this.value+1},objects:[],
timer_:null,valueChanged_:!1,stateChanged_:!0,state:r.UNDEFINED,extendConstructor_:!0,init:function(){var a=this.handler;delete this.handler;k.prototype.init.call(this,this.value||0,a,this.proxy);this.objects.length?(a=this.objects,this.objects=[],this.lock(),this.add.apply(this,a),this.unlock()):this.objects=[];this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update();A.add(this)},add:function(){for(var a=0,b=arguments.length;a<b;a++){var i=arguments[a];if(i instanceof l)this.objects.add(i)&&
i.addHandler(c,this);else throw Error("basis.data.property: Instance of DataObject required");}this.fire(!0,!0)},remove:function(a){this.objects.remove(a)&&a.removeHandler(c,this);this.fire(!0,!0)},clear:function(){for(var a=0,b;b=this.objects[a];a++)b.removeHandler(c,this);this.objects.clear();this.fire(!0,!0)},fire:function(a,b){if(!this.locked&&(this.valueChanged_=this.valueChanged_||!!a,this.stateChanged_=this.stateChanged_||!!b,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=
!0,s.add(this,"update",Date.now())},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},update:function(){delete this.timer_;s.remove(this,"update");if(!A.globalDestroy&&(this.valueChanged_&&this.set(this.calculateValue()),this.stateChanged_)){var a=this.objects.length;if(a){for(var c=-2,i,f=0;f<a;f++){var g=this.objects[f],e=b.indexOf(""+g.state);e>c&&(i=g,c=e)}i&&this.setState(i.state,i.state.data)}else this.setState(r.UNDEFINED)}this.stateChanged_=this.valueChanged_=!1},destroy:function(){this.lock();
this.clear();s.remove(this,"update");k.prototype.destroy.call(this)}});basis.namespace("basis.data.property").extend({DataObjectSet:q,AbstractProperty:o,Property:k,PropertySet:q})})();
(function(j){function q(a,b){if(!a.length)return 0;var c,d,f=0,g=a.length-1;do if(c=f+g>>1,d=a[c]||0,b<d)g=c-1;else if(b>d)f=c+1;else return b==d?c:0;while(f<=g);return c+(d<b)}function u(a,b){if(!a.length)return 0;var c,d,f,g=0,i=a.length-1;do if(c=g+i>>1,f=a[c].value||0,f===d?(f=a[c].object.eventObjectId,d=b.object.eventObjectId):d=b.value||0,d<f)i=c-1;else if(d>f)g=c+1;else return d==f?c:0;while(g<=i);return c+(f<d)}function A(){for(var a=Object.slice(this.item_),b=this.index_.slice(this.offset,
this.offset+this.limit),c=[],d,f=0,g;g=b[f];f++){var i=g.object.eventObjectId;a[i]?delete a[i]:c.push(g.object)}(d=getDelta(c,values(a)))&&r.prototype.event_datasetChanged.call(this,this,d)}function v(a,b){var a=Function.getter(a),c=b+"_"+a.getterIdx_,d=z[c];if(!d)d=z[c]=this,this.indexType=b,this.indexClass=n[b],this.getter=a,this.key=c,this.createInstance=function(a){if(a instanceof r){var b=a.indexes&&a.indexes[this.key];if(!b)b=new this.indexClass(this.getter),b.addHandler(g,a),b.key=this.key;
return b}};return d}function B(a,b,c){var d=a.indexCache_;a.lock();if(b)for(var f=0,g;g=b[f++];){var i=a.valueGetter(g);d[g.eventObjectId]=i;a.add(g,i)}if(c)for(f=0;g=c[f++];)a.remove(g,d[g.eventObjectId]),delete d[g.eventObjectId];a.unlock()}var w=j.Class,s=j.TimeEventManager,t=j.data,y=t.KeyObjectMap,l=t.property.Property,r=t.AbstractDataset,o=t.dataset.MapReduce,t=w(r,{valueGetter:Function.$true,index_:null,offset:0,limit:10,event_datasetChanged:function(a,b){var c;if(c=b.inserted)for(var d=0;d<
c.length;d++){var f=c[d],f={value:this.valueGetter(f),object:f},g=u(this.index_,f);this.index_.splice(g,0,f)}if(c=b.deleted)for(d=0;d<c.length;d++)f=c[d],f={value:this.valueGetter(f),object:f},g=u(this.index_,f),this.index_.splice(g,1);A.call(this)},init:function(a){this.index_=[];r.prototype.init.call(this,a)},setRange:function(a,b){this.offset=a;this.limit=b;A.call(this)}}),n=w(l,{autoDestroy:!0,valueGetter:Function.$null,dataSource:null,init:function(a){l.prototype.init.call(this,this.value||0);
this.indexCache_={};this.valueGetter=a},add:function(){},remove:function(){},upd:function(){}});n.Sum=w(n,{add:function(a,b){this.value+=b},remove:function(a,b){this.value-=b},upd:function(a,b,c){this.set(this.value+b-c)}});n.Avg=w(n,{sum_:0,count_:0,add:function(a,b){this.sum_+=b;this.count_+=1;this.value=this.sum_/this.count_},remove:function(a,b){this.sum_-=b;this.value=(this.count_-=1)?this.sum_/this.count_:0},upd:function(a,b,c){this.sum_+=b-c;this.set(this.sum_/this.count_)}});n.Count=w(n,{valueGetter:Function.$true,
add:function(a,b){b&&(this.value+=1)},remove:function(a,b){b&&(this.value-=1)},upd:function(a,b){this.set(this.value+(b?1:-1))}});n.Max=w(n,{init:function(a,b){this.stack=[];n.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(q(this.stack,b),0,b);this.value=this.stack[this.stack.length-1]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[this.stack.length-1]},upd:function(a,b,c){this.stack.splice(q(this.stack,c),1);this.stack.splice(q(this.stack,b),0,b);this.set(this.stack[this.stack.length-
1])}});n.Min=w(n,{init:function(a,b){this.stack=[];n.prototype.init.call(this,a,b)},add:function(a,b){this.stack.splice(q(this.stack,b),0,b);this.value=this.stack[0]},remove:function(a,b){this.stack.remove(b);this.value=this.stack[0]},upd:function(a,b,c){this.stack.splice(q(this.stack,c),1);this.stack.splice(q(this.stack,b),0,b);this.set(this.stack[0])}});var z={},k=function(a){return function(b){return new v(b,a)}},b=k("Sum"),c=k("Avg"),a=k("Count"),d=k("Min"),k=k("Max"),i={update:function(a){var b,
c,d,f=a.eventObjectId,g;for(g in this.indexes)d=this.indexes[g],b=d.indexCache_[f],c=d.valueGetter(a),c!==b&&(d.upd(a,c,b),d.indexCache_[f]=c)}},f={datasetChanged:function(a,b){if(b.inserted)for(var c=0;a=b.inserted[c++];)a.addHandler(i,this);if(b.deleted)for(c=0;a=b.deleted[c++];)a.removeHandler(i,this);for(var d in this.indexes)B(this.indexes[d],b.inserted,b.deleted)},destroy:function(){for(var a in this.indexes)this.indexes[a].destroy()}},g={destroy:function(a){this.removeIndex(a)}};r.prototype.createIndex=
function(a){if(!1!=a instanceof v){if(!this.indexes)this.indexes={},this.addHandler(f),f.datasetChanged.call(this,this,{inserted:this.getItems()});var b=a.key;this.indexes[b]||(a=a.createInstance(this),this.indexes[b]=a,B(a,this.getItems()));return this.indexes[b]}};r.prototype.removeIndex=function(a){if(this.indexes&&this.indexes[a.key]){delete this.indexes[a.key];a.destroy();for(var b in this.indexes)return;this.removeHandler(f);delete this.indexes}};w=w(o,{calcs:null,indexes:null,indexes_:null,
timer_:null,indexUpdated:null,memberSourceMap:null,keyMap:null,event_sourceChanged:function(a,b){o.prototype.event_sourceChanged.call(this,a,b);var c,d;for(d in this.indexes_)c=this.indexes_[d],b&&(this.removeIndex(d),b.removeIndex(this.indexes[d])),this.source&&this.addIndex(d,this.source.createIndex(c))},listen:{sourceObject:{update:function(a,b){o.prototype.listen.sourceObject.update.call(this,a,b);this.sourceMap_[a.eventObjectId].updated=!0;this.fireUpdate()}},index:{change:function(a){var b=
this.indexMap;b.indexValues[this.key]=a;b.indexUpdated=!0;b.fireUpdate()}},member:{subscribersChanged:function(a,b){0<a.subscriberCount&&0==b&&this.calcMember(a)}}},map:function(a){return this.keyMap.get(a,!0)},addMemberRef:function(a,b){this.memberSourceMap[a.eventObjectId]=b.eventObjectId;a.addHandler(this.listen.member,this);this.sourceMap_[b.eventObjectId].updated=!0;0<a.subscriberCount&&this.calcMember(a)},removeMemberRef:function(a){delete this.memberSourceMap[a.eventObjectId];a.removeHandler(this.listen.member,
this)},init:function(a){this.indexUpdated=!1;this.indexesBind_={};this.memberSourceMap={};var b=this.indexes;this.indexes={};this.indexes_={};this.calcs=this.calcs||{};this.indexValues={};if(!this.keyMap||!1==this.keyMap instanceof y)this.keyMap=new y(Object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));o.prototype.init.call(this,a);Object.iterate(b,this.addIndex,this)},addIndex:function(a,b){if(!this.indexes[a]){if(b instanceof v){if(this.indexes_[a])return;this.indexes_[a]=
b;b=this.source&&this.source.createIndex(b)}if(b instanceof n)this.indexValues[a]=b.value,this.indexes[a]=b,this.indexesBind_[a]={key:a,indexMap:this},b.addHandler(this.listen.index,this.indexesBind_[a]),this.listen.index.change.call(this.indexesBind_[a],b.value)}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.indexes[a].removeHandler(this.listen.index,this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},
addCalc:function(a,b){this.calcs[a]=b;this.fireUpdate()},removeCalc:function(){delete this.calcs[name]},lock:function(){Object.values(this.indexes).forEach(function(a){a.lock()})},unlock:function(){Object.values(this.indexes).forEach(function(a){a.unlock()})},fireUpdate:function(){if(!this.timer_)this.timer_=!0,s.add(this,"apply",Date.now())},apply:function(){for(var a in this.item_)this.calcMember(this.item_[a]);this.timer_=this.indexUpdated=!1},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.eventObjectId]];
if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=!1;var c={},d,f,g;for(g in this.calcs)if(d=this.calcs[g](b.sourceObject.data,this.indexValues),a.data[g]!==d&&(!isNaN(d)||!isNaN(a.data[g])))c[g]=d,f=!0;f&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,!0)},destroy:function(){this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=this.timer_=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndexConstructor(a);o.prototype.destroy.call(this)}});
j.namespace("basis.data.index").extend({IndexedDataset:t,IndexConstructor:v,Index:n,Sum:b,Avg:c,Count:a,Max:k,Min:d,IndexMap:w})})(basis);
(function(j){function q(a){e[a]=e[a]||0;return a+e[a]++}function u(){var a=Array.from(arguments),b=a.pop();"function"!=typeof b&&console.warn("Last argument for calculate field constructor must be a function");for(var c=[],d=[],e=0,f;e<a.length;e++)f=a[e].quote('"'),c.push(f+" in delta"),d.push("data["+f+"]");b=(new Function("calc","return function(delta, data, oldValue){"+(c.length?"if ("+c.join(" || ")+")":"")+"return calc("+d.join(", ")+");"+(c.length?"return oldValue;":"")+"}"))(b);b.args=a;b.isCalcField=
!0;return b}function A(){return u.apply(null,Array.from(arguments).concat(function(){for(var a=[],b=arguments.length;0<b--;){if(null==arguments[b])return null;a.push(arguments[b])}return a.join("-")}))}var v=j.Class,B=j.Cleaner,w=Object.extend,s=Function.$self,t=Function.getter,y=j.data,l=j.EventObject,r=y.Dataset,o=y.dataset.Subset,n=y.dataset.Split,z=y.DataObject,k=y.STATE,b={},c={string:1,number:1},a=[],d=function(a){return isNaN(a)?null:Number(a)},i=function(a){return isNaN(a)?null:Number(a)},
f=function(a){return isNaN(a)?null:parseInt(a)},g=function(a){return null==a?null:""+a},e={},h=j.Class(null,{init:function(a){var b=this.index={};this.normalize=a;this.valueWrapper=function(c,d){var e=a(c,d);return e!==d&&b[e]?d:e};this.calcWrapper=function(c,d){var e=a(c,d);if(e!==d&&b[e])throw"Duplicate value for index "+d+" => "+c;return e};B.add(this)},get:function(a,b){var c=this.index[a];if(c&&(!b||c instanceof b))return c},add:function(a,b){var c=this.index[a];if(b&&(!c||c===b))return this.index[a]=
b,!0},remove:function(a,b){if(this.index[a]===b)return delete this.index[a],!0},destroy:function(){this.index=null}}),y=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}},m=function(a,b){return function(c){if(!this.name)this.name=q(b);a.prototype.init.call(this,c)}},p=function(a){return function(b,c){r.setAccumulateState(!0);b=(b||[]).map(this.wrapper);r.setAccumulateState(!1);return a.prototype.sync.call(this,b,c)}},C=v(r,{wrapper:Function.$self,init:m(r,"EntitySet"),
sync:p(r),set:y(r,"set"),add:y(r,"add"),remove:y(r,"remove"),destroy:function(){r.prototype.destroy.call(this);delete this.wrapper}}),F=v(C,{set:Function.$false,add:Function.$false,remove:Function.$false,clear:Function.$false}),D=v(o,{init:m(o,"EntityCollection"),sync:p(o)});D.sourceHandler=o.sourceHandler;var I=v(n,{subsetClass:F,init:m(n,"EntityGrouping"),sync:p(n),getSubset:function(a,b){var c=n.prototype.getSubset.call(this,a,b);if(c)c.wrapper=this.wrapper;return c}}),x=function(a){if(this instanceof
x){var b=new E(a||s);return function(a,c){return null!=a?(c instanceof C||(c=b.createEntitySet()),c.set(a instanceof r?a.getItems():Array.from(a)),c):null}}};x.className="basis.entity.EntitySetWrapper";var E=v(null,{init:function(a){this.wrapper=a},createEntitySet:function(){return new C({wrapper:this.wrapper,name:"Set of "+((this.wrapper.entityType||this.wrapper).name||"").quote("{")})}}),H=function(a){if(this instanceof H){var b=function(a,b){if(null!=a){if(a===b||a.entityType===d)return a;var h,
i=d.idField;if(c[typeof a]){if(!i)return;h=a;a={};a[i]=h}else if(d.compositeKey)h=d.compositeKey(a,a);else if(i)h=a[i];else if(g&&(b=d.singleton,!b))return d.singleton=new f(a);null!=h&&e&&(b=e.get(h,d.entityClass));b&&b.entityType===d?b.update(a):b=new f(a);return b}return d.singleton},d=new N(a||{},b),e=d.index__,f=d.entityClass,g=d.isSingleton;w(b,{toString:function(){return this.typeName+"()"},entityType:d,type:b,typeName:d.name,index:e,reader:function(a){return d.reader(a)},get:function(a){return d.get(a)},
addField:function(a,b){d.addField(a,b)},all:d.all,createCollection:function(a,c,e){var f=d.collection_[a];return!f&&c?d.collection_[a]=new D({wrapper:b,source:e||d.all,rule:c}):f},getCollection:function(a){return d.collection_[a]},createGrouping:function(a,c,e){var f=d.grouping_[a];return!f&&c?d.grouping_[a]=new I({wrapper:b,source:e||d.all,rule:c}):f},getGrouping:function(a){return d.grouping_[a]},getSlot:function(a,b){return d.getSlot(a,b)}});return b}};H.className="basis.entity.EntityTypeWrapper";
var M=t("singleton"),J={};v(z,{});var N=v(null,{name:"UntitledEntityType",defaults:null,fields:null,extensible:!1,index__:null,slot_:null,init:function(b,c){this.name=b.name||q(this.name);this.index__=b.index;this.idFields={};a.push(this);this.isSingleton=b.isSingleton;this.wrapper=c;this.all=new F(Object.extend(b.all||{},{wrapper:c}));this.slot_={};if(b.extensible)this.extensible=!0;this.fields={};this.defaults={};this.aliases={};this.getters={};Object.iterate(b.fields,this.addField,this);b.constrains&&
b.constrains.forEach(function(a){this.addCalcField(null,a)},this);if(this.isSingleton)this.get=M;b.aliases&&Object.iterate(b.aliases,this.addAlias,this);this.collection_={};if(b.collections)for(var d in b.collections)this.collection_[d]=new D({name:d,wrapper:c,source:this.all,rule:b.collections[d]||Function.$true});this.grouping_={};if(b.groupings)for(d in b.groupings)this.grouping_[d]=new I({name:d,wrapper:c,source:this.all,rule:b.groupings[d]||Function.$true});this.entityClass=L(this,this.all,this.index__,
this.slot_,this.fields,this.defaults,this.getters).extend({entityType:this,type:c,typeName:this.name,getId:function(){return this.__id__}})},reader:function(a){var b={};if(c[typeof a])return this.idField?(b[this.idField]=a,b):null;if(!a||null==a)return null;for(var d in a){var e=d in this.aliases?this.aliases[d]:"";e&&e in this.fields&&(b[e]=this.fields[e].reader?this.fields[e].reader(a[d]):a[d])}return b},addAlias:function(a,b){b in this.fields&&!1==a in this.aliases&&(this.aliases[a]=b)},addField:function(a,
b){if(!this.all.itemCount){this.aliases[a]=a;"function"==typeof b&&(b={type:b});if("type"in b&&"function"!=typeof b.type)b.type=s;var c=b.type||s;if([d,i,f,g].has(c))b.id=!0;if(b.id){if(!this.index__)this.index__=new h(String);this.idFields[a]=!0;this.idField||this.compositeKey?(this.idField=null,this.compositeKey=A.apply(null,Object.keys(this.idFields))):this.idField=a}b.calc?this.addCalcField(a,b.calc,void 0):this.fields[a]=c;this.defaults[a]="defValue"in b?b.defValue:c();this.getters["get_"+a]=
function(){return this.data[a]};J[a]||(J[a]={destroy:function(){this.set(a,null)}})}},addCalcField:function(a,b,c){if(!a||!this.fields[a]){if(!this.calcs)this.calcs=[];for(var d={args:b.args,wrapper:!c?b:function(a,d,e){return c(b(a,d,e))}},e=this.calcs.length,f=0,g=0;g<this.calcs.length;g++)b.args.has(this.calcs[g].key)&&(f=g+1);if(a){d.key=a;for(g=0;g<this.calcs.length;g++)if(this.calcs[g].args.has(a)){e=g;break}if(f>e)return;if(this.idField&&a==this.idField)this.compositeKey=b;this.fields[a]=function(a,
b){"undefined"!=typeof console&&console.log("Calculate fields are readonly");return b}}else e=f;this.calcs.splice(Math.min(e,f),0,d)}},get:function(a){a=this.getId(a);if(null!=a)return this.index__.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(c[typeof a])return a;if(a&&a.entityType===this)return a.__id__;if(a instanceof z)a=a.data;return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var d=
this.slot_[b];d||(c[typeof a]&&(d={},this.idField&&!this.compositeKey&&(d[this.idField]=a),a=d),d=this.slot_[b]=new z({delegate:this.get(b),data:a}));return d}}}),K=v(z,{init:l.prototype.init,event_rollbackUpdate:l.createEvent("rollbackUpdate")}),L=function(a,c,d,e,f,g,h){function i(b,c,d){var e=!1,f=a.calcs,g=b.__id__,h=b.data;try{if(f)for(var k=0,j;j=f[k++];){var l=j.key;if(l){var z=h[l];h[l]=j.wrapper(c,h,h[l]);h[l]!==z&&(c[l]=z,e=!0)}else j.wrapper(c,h)}if(a.compositeKey)b.__id__=a.compositeKey(c,
h,b.__id__);else if(m&&m in c)b.__id__=h[m];b.__id__!==g&&a.index__.calcWrapper(b.__id__)}catch(o){b.__id__=g;for(var p in c)b.data[p]=c[p];if(d)for(p in d)if(!b.modified)b.modified=d;e=!1}b.__id__!==g&&n(b,g,b.__id__);return e}function n(a,b,c){null!=b&&(d.remove(b,a),e[b]&&e[b].setDelegate());null!=c&&(d.add(c,a),e[c]&&e[c].setDelegate(a))}var m=a.idField;return v(K,h,{canHaveDelegate:!1,modified:null,isTarget:!0,extendConstructor_:!1,init:function(a){K.prototype.init.call(this);this.fieldHandlers_=
{};this.data={};this.root=this;this.target=this;var b,d={},e;for(e in f)e in a?(d[e]=g[e],b=f[e](a[e])):b=g[e],b&&b!==this&&b instanceof l&&b.addHandler(J[e],this)&&(this.fieldHandlers_[e]=!0),this.data[e]=b;i(this,d);c.event_datasetChanged(c,{inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},get:function(a){return this.data[a]},set:function(b,c,d,e){var g=f[b];if(!g){if(!a.extensible)return;g=s}var h,k=this.modified,c=g(c,this.data[b]),
g=this.data[b];if(c!==g&&(!c||!g||c.constructor!==Date||g.constructor!==Date||+c!==+g))a:{h={};if(b!=m)if(d){if(!k)this.modified=k={};if(!1===b in k)h.rollback={key:b,value:void 0},k[b]=g;else if(k[b]===c&&(h.rollback={key:b,value:c},delete k[b],!Object.keys(k).length))this.modified=null}else if(k&&b in k)if(k[b]!==c){h.rollback={key:b,value:k[b]};k[b]=c;break a}else return!1;this.data[b]=c;this.fieldHandlers_[b]&&(g.removeHandler(J[b],this),this.fieldHandlers_[b]=!1);c&&c!==this&&c instanceof l&&
c.addHandler(J[b],this)&&(this.fieldHandlers_[b]=!0);h.key=b;h.value=g;h.delta={};h.delta[b]=g}else if(!d&&k&&b in k&&(h={rollback:{key:b,value:k[b]}},delete k[b],!Object.keys(k).length))this.modified=null;if(!e&&h){var d=h.key,b=h.delta||{},n;if(h.rollback)n={},n[h.rollback.key]=h.rollback.value;i(this,b,n)&&(d=!0);if(d)this.event_update(this,b),h.delta=b;n&&this.event_rollbackUpdate(this,n)}return h||!1},update:function(a,b){if(a){var c,d={},e,f={},g,h;for(h in a)if(g=this.set(h,a[h],b,!0)){if(g.key)c=
!0,d[g.key]=g.value;if(g.rollback)e=!0,f[g.rollback.key]=g.rollback.value}i(this,d,f)&&(c=!0);c&&this.event_update(this,d);e&&this.event_rollbackUpdate(this,f)}return c?d:!1},reset:function(){this.update(g)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.event_rollbackUpdate(this,b)},rollback:function(){if(this.state!=k.PROCESSING){if(this.modified){var a=this.modified;
this.modified=null;this.update(a);this.event_rollbackUpdate(this,a)}this.setState(k.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.data[a].removeHandler(J[a],this);this.fieldHandlers_=b;this.__id__&&n(this,this.__id__,null);z.prototype.destroy.call(this);c.event_datasetChanged(c,{deleted:[this]});this.data=b;this.modified=null}})};j.namespace("basis.entity").extend({isEntity:function(a){return a&&a instanceof L},NumericId:d,NumberId:i,IntId:f,StringId:g,Index:h,CalculateField:u,
EntityType:H,Entity:L,BaseEntity:K,EntitySetType:x,EntitySet:C,ReadOnlyEntitySet:F,Collection:D,Grouping:I})})(basis);
(function(j){var q=j.Class,u=j.dom,A=j.html.Template,v=j.cssom.classList,B=Function.getter,w=j.Cleaner,s=j.dom.wrapper.Node,t=j.dom.wrapper.PartitionNode,y=j.dom.wrapper.GroupingNode,l=q.ExtensibleProperty(),r=function(n){return{template:new A("<div/>"),action:l,cssClassName:null,event_update:function(j,k){n.event_update.call(this,j,k);this.templateUpdate(this.tmpl,"update",k)},event_select:function(j){n.event_select.call(this,j);v(this.tmpl.selected||this.tmpl.content||this.element).add("selected")},
event_unselect:function(j){n.event_unselect.call(this,j);v(this.tmpl.selected||this.tmpl.content||this.element).remove("selected")},event_disable:function(j){n.event_disable.call(this,j);v(this.tmpl.disabled||this.element).add("disabled")},event_enable:function(j){n.event_enable.call(this,j);v(this.tmpl.disabled||this.element).remove("disabled")},event_match:function(j){n.event_match.call(this,j);u.display(this.element,!0)},event_unmatch:function(j){n.event_unmatch.call(this,j);u.display(this.element,
!1)},init:function(j){this.tmpl={};if(this.template){this.template.createInstance(this.tmpl,this);this.element=this.tmpl.element;if(this.tmpl.childNodesHere)this.tmpl.childNodesElement=this.tmpl.childNodesHere.parentNode,this.tmpl.childNodesElement.insertPoint=this.tmpl.childNodesHere;this.content&&u.insert(this.tmpl.content||this.element,this.content)}else this.element=this.tmpl.element=u.createElement();this.childNodesElement=this.tmpl.childNodesElement||this.element;n.init.call(this,j);if(this.id)this.element.id=
this.id;if(j=this.cssClassName){"string"==typeof j&&(j={element:j});for(var k in j){var b=this.tmpl[k];if(b)for(var b=v(b),c=(""+j[k]).qw(),a=0,d;d=c[a++];)b.add(d)}}this.tmpl&&this.templateUpdate(this.tmpl);this.container&&u.insert(this.container,this.element)},templateAction:function(j,k){var b=this.action[j];b&&b.call(this,k)},templateUpdate:function(){},destroy:function(){var j=this.element;n.destroy.call(this);j&&j.parentNode&&j.parentNode.removeChild(j);this.template&&this.template.clearInstance(this.tmpl,
this);this.childNodesElement=this.tmpl=this.element=null}}},s=q(s,r,{}),B=q(t,r,{titleGetter:B("data.title"),templateUpdate:function(j){if(j.titleText)j.titleText.nodeValue=""+this.titleGetter(this)}}),r=function(j){return{insertBefore:function(l,k){var l=j.insertBefore.call(this,l,k),b=l.groupNode||this,c=l.nextSibling,b=b.childNodesElement||b.element||this.childNodesElement||this.element,a=l.element,c=(c&&c.element.parentNode==b?c.element:null)||b.insertPoint||null;(a.parentNode!==b||a.nextSibling!==
c)&&b.insertBefore(a,c);return l},removeChild:function(l){j.removeChild.call(this,l);var k=l.element,b=k.parentNode;b&&b.removeChild(k);return l},clear:function(l){if(l)for(var k=this.firstChild;k;){var b=k.element;b.parentNode&&b.parentNode.removeChild(b);k=k.nextSibling}j.clear.call(this,l)},setChildNodes:function(l,k){var b=u.createFragment(),c=this.localGrouping||this,a=c.childNodesElement||c.element;c.childNodesElement=b;j.setChildNodes.call(this,l,k);a.insertBefore(b,a.insertPoint||null);c.childNodesElement=
a}}},t=q(y,r,{childClass:B,localGroupingClass:q.SELF,event_ownerChanged:function(j,l){var k=this,b=this.owner,c=null;b&&(c=b.tmpl&&b.tmpl.groupsElement||b.childNodesElement||b.element,c.appendChild(this.nullElement));do k.element=k.childNodesElement=c;while(k=k.localGrouping);y.prototype.event_ownerChanged.call(this,j,l)},init:function(j){this.element=this.childNodesElement=this.nullElement=u.createFragment();y.prototype.init.call(this,j)}}),o=q(s,r,{childClass:s,childFactory:function(j){return new this.childClass(j)},
localGroupingClass:t}),q=q(o,{selection:{},init:function(j){this.document=this;o.prototype.init.call(this,j);w.add(this)},destroy:function(){if(this.selection)this.selection.destroy(),this.selection=null;o.prototype.destroy.call(this);w.remove(this)}}),r=function(j,l){for(var k=j.match(/\{(this_[^\}]+)\}/g)||[],b=[],c=0;c<k.length;c++){var a=k[c].match(/\{(this_[^\|\}]+)\}/)[1];b.push("this.tmpl."+a+".nodeValue = "+a.replace(/_/g,"."))}return Function("tmpl_","config_","return "+function(a){return Object.extend({template:tmpl_,
templateUpdate:function(b,c,g){a.templateUpdate.call(this,b,c,g);_code_()}},config_)}.toString().replace("_code_()",b.join(";\n")))(new A(j),l)};j.namespace("basis.ui",r).extend({simpleTemplate:r,Node:s,Container:o,PartitionNode:B,GroupingNode:t,Control:q})})(basis);
