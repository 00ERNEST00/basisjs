<!doctype html>

<html>

<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <title>Basis Test Suite - l10n</title>

  <style type="text/css">
    @import "../style/style.css";

    /* */
    BODY
    {
      font-family: Georgia;
      font-size: small;
      _font-size: x-small;
    }
  </style>
  
  <script type="text/javascript" data-basis-config="" src="../../src/basis.js"></script>
  <script type="text/javascript" src="../test.js"></script>
  <script type="text/javascript" src="../common.js"></script>
</head>

<body>
  <script type="text/javascript">
    loadTest((function(){
      basis.require('basis.l10n');
      
      return [
        {
          name: 'base',
          testcase: [
            {
              name: 'fallback',
              test: function(){
                var res = basis.resource('l10n.l10n').fetch();
                var dict = basis.l10n.dictionary('l10n.l10n');
                basis.l10n.setCulture('en-US');
                this.is('base', dict.token('value').value);

                basis.l10n.setCultureList('en-US a/b b/c c');

                basis.l10n.setCulture('c');
                this.is('base', dict.token('value').value);
                basis.l10n.setCulture('b');
                this.is('base', dict.token('value').value);
                basis.l10n.setCulture('a');
                this.is('base', dict.token('value').value);

                res['c'] = { value: 'c' };
                dict.resource.update(JSON.stringify(res));
                basis.l10n.setCulture('c');
                this.is('c', dict.token('value').value);

                basis.l10n.setCulture('b');
                this.is('c', dict.token('value').value);
                basis.l10n.setCulture('a');
                this.is('c', dict.token('value').value);
                res['b'] = { value: 'b' };
                dict.resource.update(JSON.stringify(res));
                this.is('b', dict.token('value').value);
                basis.l10n.setCulture('b');
                this.is('b', dict.token('value').value);
                basis.l10n.setCulture('c');
                this.is('c', dict.token('value').value);

                res['a'] = { value: 'a' };
                dict.resource.update(JSON.stringify(res));
                basis.l10n.setCulture('a');
                this.is('a', dict.token('value').value);
                basis.l10n.setCulture('b');
                this.is('b', dict.token('value').value);
                basis.l10n.setCulture('c');
                this.is('c', dict.token('value').value);
              }
            }
          ]
        }
      ];

    })());


  </script>
</body>

</html>